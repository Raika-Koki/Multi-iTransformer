[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.3596, 0.2108| Seasonal Loss: 1.3700, 0.6317| Residual Loss: 0.7301, 0.7020
Epoch 2/100, (Training, Validation) Trend Loss: 0.1830, 0.1266| Seasonal Loss: 0.6175, 0.6508| Residual Loss: 0.3892, 0.2653
Epoch 3/100, (Training, Validation) Trend Loss: 0.1199, 0.2387| Seasonal Loss: 0.5515, 0.3631| Residual Loss: 0.2479, 0.2312
Epoch 4/100, (Training, Validation) Trend Loss: 0.1251, 0.1661| Seasonal Loss: 0.3385, 0.3347| Residual Loss: 0.2421, 0.2211
Epoch 5/100, (Training, Validation) Trend Loss: 0.2232, 0.1148| Seasonal Loss: 0.2746, 0.2456| Residual Loss: 0.2251, 0.1752
Epoch 6/100, (Training, Validation) Trend Loss: 0.1517, 0.1191| Seasonal Loss: 0.2361, 0.2273| Residual Loss: 0.2228, 0.1661
Epoch 7/100, (Training, Validation) Trend Loss: 0.1178, 0.0847| Seasonal Loss: 0.2054, 0.2141| Residual Loss: 0.1971, 0.1470
Epoch 8/100, (Training, Validation) Trend Loss: 0.0804, 0.0697| Seasonal Loss: 0.1828, 0.1481| Residual Loss: 0.1716, 0.1371
Epoch 9/100, (Training, Validation) Trend Loss: 0.0682, 0.0845| Seasonal Loss: 0.1595, 0.1308| Residual Loss: 0.1494, 0.1293
Epoch 10/100, (Training, Validation) Trend Loss: 0.0568, 0.0584| Seasonal Loss: 0.1425, 0.1254| Residual Loss: 0.1363, 0.1207
Epoch 11/100, (Training, Validation) Trend Loss: 0.0497, 0.0617| Seasonal Loss: 0.1382, 0.1320| Residual Loss: 0.1272, 0.1158
Epoch 12/100, (Training, Validation) Trend Loss: 0.0406, 0.0371| Seasonal Loss: 0.1342, 0.1826| Residual Loss: 0.1213, 0.1116
Epoch 13/100, (Training, Validation) Trend Loss: 0.0442, 0.0795| Seasonal Loss: 0.1549, 0.2047| Residual Loss: 0.1165, 0.1103
Epoch 14/100, (Training, Validation) Trend Loss: 0.0568, 0.0738| Seasonal Loss: 0.1398, 0.1508| Residual Loss: 0.1139, 0.1073
Epoch 15/100, (Training, Validation) Trend Loss: 0.0926, 0.0879| Seasonal Loss: 0.1236, 0.1292| Residual Loss: 0.1125, 0.1155
Epoch 16/100, (Training, Validation) Trend Loss: 0.0597, 0.0435| Seasonal Loss: 0.1058, 0.1180| Residual Loss: 0.1144, 0.1196
Epoch 17/100, (Training, Validation) Trend Loss: 0.0548, 0.0347| Seasonal Loss: 0.0974, 0.1132| Residual Loss: 0.1219, 0.1536
Epoch 18/100, (Training, Validation) Trend Loss: 0.0562, 0.0407| Seasonal Loss: 0.0882, 0.1035| Residual Loss: 0.1303, 0.1642
Epoch 19/100, (Training, Validation) Trend Loss: 0.0357, 0.0466| Seasonal Loss: 0.0869, 0.1089| Residual Loss: 0.1408, 0.1493
Epoch 20/100, (Training, Validation) Trend Loss: 0.0306, 0.0332| Seasonal Loss: 0.0960, 0.1019| Residual Loss: 0.1372, 0.1152
Epoch 21/100, (Training, Validation) Trend Loss: 0.0308, 0.0309| Seasonal Loss: 0.1525, 0.1032| Residual Loss: 0.1359, 0.1013
Epoch 22/100, (Training, Validation) Trend Loss: 0.0283, 0.0340| Seasonal Loss: 0.1535, 0.0976| Residual Loss: 0.1229, 0.1001
Epoch 23/100, (Training, Validation) Trend Loss: 0.0255, 0.0272| Seasonal Loss: 0.0861, 0.0897| Residual Loss: 0.1075, 0.0983
Epoch 24/100, (Training, Validation) Trend Loss: 0.0240, 0.0248| Seasonal Loss: 0.0915, 0.0889| Residual Loss: 0.0990, 0.0961
Epoch 25/100, (Training, Validation) Trend Loss: 0.0226, 0.0256| Seasonal Loss: 0.0775, 0.0967| Residual Loss: 0.0965, 0.0956
Epoch 26/100, (Training, Validation) Trend Loss: 0.0219, 0.0230| Seasonal Loss: 0.0730, 0.0974| Residual Loss: 0.0944, 0.0942
Epoch 27/100, (Training, Validation) Trend Loss: 0.0211, 0.0221| Seasonal Loss: 0.0686, 0.0889| Residual Loss: 0.0929, 0.0936
Epoch 28/100, (Training, Validation) Trend Loss: 0.0204, 0.0220| Seasonal Loss: 0.0650, 0.0860| Residual Loss: 0.0914, 0.0930
Epoch 29/100, (Training, Validation) Trend Loss: 0.0197, 0.0209| Seasonal Loss: 0.0624, 0.0862| Residual Loss: 0.0902, 0.0925
Epoch 30/100, (Training, Validation) Trend Loss: 0.0191, 0.0204| Seasonal Loss: 0.0597, 0.0863| Residual Loss: 0.0892, 0.0920
Epoch 31/100, (Training, Validation) Trend Loss: 0.0186, 0.0202| Seasonal Loss: 0.0579, 0.0849| Residual Loss: 0.0882, 0.0916
Epoch 32/100, (Training, Validation) Trend Loss: 0.0181, 0.0196| Seasonal Loss: 0.0561, 0.0830| Residual Loss: 0.0873, 0.0912
Epoch 33/100, (Training, Validation) Trend Loss: 0.0177, 0.0193| Seasonal Loss: 0.0546, 0.0824| Residual Loss: 0.0864, 0.0909
Epoch 34/100, (Training, Validation) Trend Loss: 0.0173, 0.0190| Seasonal Loss: 0.0531, 0.0820| Residual Loss: 0.0856, 0.0905
Epoch 35/100, (Training, Validation) Trend Loss: 0.0169, 0.0186| Seasonal Loss: 0.0518, 0.0817| Residual Loss: 0.0849, 0.0902
Epoch 36/100, (Training, Validation) Trend Loss: 0.0166, 0.0184| Seasonal Loss: 0.0506, 0.0811| Residual Loss: 0.0842, 0.0900
Epoch 37/100, (Training, Validation) Trend Loss: 0.0163, 0.0182| Seasonal Loss: 0.0496, 0.0808| Residual Loss: 0.0835, 0.0897
Epoch 38/100, (Training, Validation) Trend Loss: 0.0160, 0.0179| Seasonal Loss: 0.0486, 0.0805| Residual Loss: 0.0829, 0.0895
Epoch 39/100, (Training, Validation) Trend Loss: 0.0158, 0.0177| Seasonal Loss: 0.0477, 0.0803| Residual Loss: 0.0823, 0.0893
Epoch 40/100, (Training, Validation) Trend Loss: 0.0156, 0.0175| Seasonal Loss: 0.0468, 0.0799| Residual Loss: 0.0817, 0.0891
Epoch 41/100, (Training, Validation) Trend Loss: 0.0153, 0.0173| Seasonal Loss: 0.0460, 0.0796| Residual Loss: 0.0811, 0.0889
Epoch 42/100, (Training, Validation) Trend Loss: 0.0151, 0.0172| Seasonal Loss: 0.0453, 0.0794| Residual Loss: 0.0806, 0.0887
Epoch 43/100, (Training, Validation) Trend Loss: 0.0150, 0.0170| Seasonal Loss: 0.0446, 0.0791| Residual Loss: 0.0801, 0.0885
Epoch 44/100, (Training, Validation) Trend Loss: 0.0148, 0.0169| Seasonal Loss: 0.0440, 0.0788| Residual Loss: 0.0797, 0.0884
Epoch 45/100, (Training, Validation) Trend Loss: 0.0146, 0.0167| Seasonal Loss: 0.0434, 0.0786| Residual Loss: 0.0792, 0.0882
Epoch 46/100, (Training, Validation) Trend Loss: 0.0145, 0.0166| Seasonal Loss: 0.0428, 0.0784| Residual Loss: 0.0788, 0.0881
Epoch 47/100, (Training, Validation) Trend Loss: 0.0144, 0.0165| Seasonal Loss: 0.0423, 0.0782| Residual Loss: 0.0784, 0.0879
Epoch 48/100, (Training, Validation) Trend Loss: 0.0142, 0.0164| Seasonal Loss: 0.0418, 0.0780| Residual Loss: 0.0780, 0.0878
Epoch 49/100, (Training, Validation) Trend Loss: 0.0141, 0.0163| Seasonal Loss: 0.0413, 0.0778| Residual Loss: 0.0777, 0.0877
Epoch 50/100, (Training, Validation) Trend Loss: 0.0140, 0.0162| Seasonal Loss: 0.0409, 0.0776| Residual Loss: 0.0773, 0.0876
Epoch 51/100, (Training, Validation) Trend Loss: 0.0139, 0.0161| Seasonal Loss: 0.0405, 0.0775| Residual Loss: 0.0770, 0.0875
Epoch 52/100, (Training, Validation) Trend Loss: 0.0138, 0.0160| Seasonal Loss: 0.0401, 0.0773| Residual Loss: 0.0767, 0.0874
Epoch 53/100, (Training, Validation) Trend Loss: 0.0137, 0.0159| Seasonal Loss: 0.0397, 0.0772| Residual Loss: 0.0764, 0.0873
Epoch 54/100, (Training, Validation) Trend Loss: 0.0136, 0.0159| Seasonal Loss: 0.0394, 0.0770| Residual Loss: 0.0761, 0.0872
Epoch 55/100, (Training, Validation) Trend Loss: 0.0136, 0.0158| Seasonal Loss: 0.0391, 0.0769| Residual Loss: 0.0758, 0.0871
Epoch 56/100, (Training, Validation) Trend Loss: 0.0135, 0.0157| Seasonal Loss: 0.0388, 0.0768| Residual Loss: 0.0756, 0.0871
Epoch 57/100, (Training, Validation) Trend Loss: 0.0134, 0.0157| Seasonal Loss: 0.0385, 0.0767| Residual Loss: 0.0753, 0.0870
Epoch 58/100, (Training, Validation) Trend Loss: 0.0134, 0.0156| Seasonal Loss: 0.0382, 0.0766| Residual Loss: 0.0751, 0.0869
Epoch 59/100, (Training, Validation) Trend Loss: 0.0133, 0.0155| Seasonal Loss: 0.0380, 0.0765| Residual Loss: 0.0749, 0.0868
Epoch 60/100, (Training, Validation) Trend Loss: 0.0132, 0.0155| Seasonal Loss: 0.0377, 0.0764| Residual Loss: 0.0747, 0.0868
Epoch 61/100, (Training, Validation) Trend Loss: 0.0132, 0.0154| Seasonal Loss: 0.0375, 0.0763| Residual Loss: 0.0745, 0.0867
Epoch 62/100, (Training, Validation) Trend Loss: 0.0131, 0.0154| Seasonal Loss: 0.0373, 0.0762| Residual Loss: 0.0743, 0.0867
Epoch 63/100, (Training, Validation) Trend Loss: 0.0131, 0.0153| Seasonal Loss: 0.0371, 0.0761| Residual Loss: 0.0741, 0.0866
Epoch 64/100, (Training, Validation) Trend Loss: 0.0130, 0.0153| Seasonal Loss: 0.0369, 0.0760| Residual Loss: 0.0739, 0.0866
Epoch 65/100, (Training, Validation) Trend Loss: 0.0130, 0.0153| Seasonal Loss: 0.0367, 0.0760| Residual Loss: 0.0737, 0.0865
Epoch 66/100, (Training, Validation) Trend Loss: 0.0129, 0.0152| Seasonal Loss: 0.0365, 0.0759| Residual Loss: 0.0736, 0.0865
Epoch 67/100, (Training, Validation) Trend Loss: 0.0129, 0.0152| Seasonal Loss: 0.0364, 0.0758| Residual Loss: 0.0734, 0.0864
Epoch 68/100, (Training, Validation) Trend Loss: 0.0129, 0.0152| Seasonal Loss: 0.0362, 0.0758| Residual Loss: 0.0733, 0.0864
Epoch 69/100, (Training, Validation) Trend Loss: 0.0128, 0.0151| Seasonal Loss: 0.0361, 0.0757| Residual Loss: 0.0732, 0.0863
Epoch 70/100, (Training, Validation) Trend Loss: 0.0128, 0.0151| Seasonal Loss: 0.0359, 0.0757| Residual Loss: 0.0730, 0.0863
Epoch 71/100, (Training, Validation) Trend Loss: 0.0128, 0.0151| Seasonal Loss: 0.0358, 0.0756| Residual Loss: 0.0729, 0.0863
Epoch 72/100, (Training, Validation) Trend Loss: 0.0127, 0.0150| Seasonal Loss: 0.0357, 0.0756| Residual Loss: 0.0728, 0.0862
Epoch 73/100, (Training, Validation) Trend Loss: 0.0127, 0.0150| Seasonal Loss: 0.0355, 0.0755| Residual Loss: 0.0727, 0.0862
Epoch 74/100, (Training, Validation) Trend Loss: 0.0127, 0.0150| Seasonal Loss: 0.0354, 0.0755| Residual Loss: 0.0726, 0.0862
Epoch 75/100, (Training, Validation) Trend Loss: 0.0127, 0.0150| Seasonal Loss: 0.0353, 0.0754| Residual Loss: 0.0725, 0.0861
Epoch 76/100, (Training, Validation) Trend Loss: 0.0126, 0.0149| Seasonal Loss: 0.0352, 0.0754| Residual Loss: 0.0724, 0.0861
Epoch 77/100, (Training, Validation) Trend Loss: 0.0126, 0.0149| Seasonal Loss: 0.0351, 0.0754| Residual Loss: 0.0723, 0.0861
Epoch 78/100, (Training, Validation) Trend Loss: 0.0126, 0.0149| Seasonal Loss: 0.0350, 0.0753| Residual Loss: 0.0722, 0.0861
Epoch 79/100, (Training, Validation) Trend Loss: 0.0126, 0.0149| Seasonal Loss: 0.0349, 0.0753| Residual Loss: 0.0721, 0.0860
Epoch 80/100, (Training, Validation) Trend Loss: 0.0126, 0.0148| Seasonal Loss: 0.0349, 0.0753| Residual Loss: 0.0720, 0.0860
Epoch 81/100, (Training, Validation) Trend Loss: 0.0125, 0.0148| Seasonal Loss: 0.0348, 0.0752| Residual Loss: 0.0719, 0.0860
Epoch 82/100, (Training, Validation) Trend Loss: 0.0125, 0.0148| Seasonal Loss: 0.0347, 0.0752| Residual Loss: 0.0718, 0.0860
Epoch 83/100, (Training, Validation) Trend Loss: 0.0125, 0.0148| Seasonal Loss: 0.0346, 0.0752| Residual Loss: 0.0718, 0.0860
Epoch 84/100, (Training, Validation) Trend Loss: 0.0125, 0.0148| Seasonal Loss: 0.0346, 0.0751| Residual Loss: 0.0717, 0.0859
Epoch 85/100, (Training, Validation) Trend Loss: 0.0125, 0.0148| Seasonal Loss: 0.0345, 0.0751| Residual Loss: 0.0716, 0.0859
Epoch 86/100, (Training, Validation) Trend Loss: 0.0125, 0.0148| Seasonal Loss: 0.0344, 0.0751| Residual Loss: 0.0716, 0.0859
Epoch 87/100, (Training, Validation) Trend Loss: 0.0124, 0.0147| Seasonal Loss: 0.0344, 0.0751| Residual Loss: 0.0715, 0.0859
Epoch 88/100, (Training, Validation) Trend Loss: 0.0124, 0.0147| Seasonal Loss: 0.0343, 0.0750| Residual Loss: 0.0715, 0.0859
Epoch 89/100, (Training, Validation) Trend Loss: 0.0124, 0.0147| Seasonal Loss: 0.0343, 0.0750| Residual Loss: 0.0714, 0.0858
Epoch 90/100, (Training, Validation) Trend Loss: 0.0124, 0.0147| Seasonal Loss: 0.0342, 0.0750| Residual Loss: 0.0714, 0.0858
Epoch 91/100, (Training, Validation) Trend Loss: 0.0124, 0.0147| Seasonal Loss: 0.0342, 0.0750| Residual Loss: 0.0713, 0.0858
Epoch 92/100, (Training, Validation) Trend Loss: 0.0124, 0.0147| Seasonal Loss: 0.0341, 0.0750| Residual Loss: 0.0713, 0.0858
Epoch 93/100, (Training, Validation) Trend Loss: 0.0124, 0.0147| Seasonal Loss: 0.0341, 0.0750| Residual Loss: 0.0712, 0.0858
Epoch 94/100, (Training, Validation) Trend Loss: 0.0124, 0.0147| Seasonal Loss: 0.0340, 0.0749| Residual Loss: 0.0712, 0.0858
Epoch 95/100, (Training, Validation) Trend Loss: 0.0123, 0.0146| Seasonal Loss: 0.0340, 0.0749| Residual Loss: 0.0711, 0.0858
Epoch 96/100, (Training, Validation) Trend Loss: 0.0123, 0.0146| Seasonal Loss: 0.0340, 0.0749| Residual Loss: 0.0711, 0.0858
Epoch 97/100, (Training, Validation) Trend Loss: 0.0123, 0.0146| Seasonal Loss: 0.0339, 0.0749| Residual Loss: 0.0711, 0.0858
Epoch 98/100, (Training, Validation) Trend Loss: 0.0123, 0.0146| Seasonal Loss: 0.0339, 0.0749| Residual Loss: 0.0710, 0.0857
Epoch 99/100, (Training, Validation) Trend Loss: 0.0123, 0.0146| Seasonal Loss: 0.0338, 0.0749| Residual Loss: 0.0710, 0.0857
Epoch 100/100, (Training, Validation) Trend Loss: 0.0123, 0.0146| Seasonal Loss: 0.0338, 0.0749| Residual Loss: 0.0710, 0.0857
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[169.22211842]
[-0.97320822]
[0.18189104]
[168.43080125]
actual_stock_price: [171.57913208 173.92396545 174.03323364 173.07940674 170.45640564
 170.73460388 171.87721252 174.30149841 176.1594696  176.1098175 ]
add_predicted_stock_price: [171.57913208 173.92396545 174.03323364 173.07940674 170.45640564
 170.73460388 171.87721252 174.30149841 176.1594696  168.43080125]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
