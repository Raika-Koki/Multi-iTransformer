[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.7462, 0.2088| Seasonal Loss: 1.3138, 1.1252| Residual Loss: 0.8684, 0.8858
Epoch 2/100, (Training, Validation) Trend Loss: 0.2526, 0.1904| Seasonal Loss: 0.5310, 0.5611| Residual Loss: 0.4733, 0.3346
Epoch 3/100, (Training, Validation) Trend Loss: 0.1547, 0.0879| Seasonal Loss: 0.3770, 0.3457| Residual Loss: 0.3565, 0.2618
Epoch 4/100, (Training, Validation) Trend Loss: 0.1124, 0.1110| Seasonal Loss: 0.2620, 0.4164| Residual Loss: 0.2463, 0.2318
Epoch 5/100, (Training, Validation) Trend Loss: 0.1192, 0.1076| Seasonal Loss: 0.2520, 0.2568| Residual Loss: 0.2100, 0.2069
Epoch 6/100, (Training, Validation) Trend Loss: 0.1408, 0.2488| Seasonal Loss: 0.2139, 0.2302| Residual Loss: 0.1885, 0.1872
Epoch 7/100, (Training, Validation) Trend Loss: 0.1651, 0.2569| Seasonal Loss: 0.2216, 0.1884| Residual Loss: 0.1752, 0.1718
Epoch 8/100, (Training, Validation) Trend Loss: 0.2081, 0.1623| Seasonal Loss: 0.2211, 0.1865| Residual Loss: 0.1594, 0.1582
Epoch 9/100, (Training, Validation) Trend Loss: 0.2394, 0.1803| Seasonal Loss: 0.1665, 0.1683| Residual Loss: 0.1525, 0.1495
Epoch 10/100, (Training, Validation) Trend Loss: 0.1629, 0.0843| Seasonal Loss: 0.1332, 0.1309| Residual Loss: 0.1418, 0.1397
Epoch 11/100, (Training, Validation) Trend Loss: 0.1131, 0.0785| Seasonal Loss: 0.1217, 0.1211| Residual Loss: 0.1485, 0.1423
Epoch 12/100, (Training, Validation) Trend Loss: 0.0877, 0.1147| Seasonal Loss: 0.1032, 0.1190| Residual Loss: 0.1502, 0.1484
Epoch 13/100, (Training, Validation) Trend Loss: 0.0656, 0.0537| Seasonal Loss: 0.0942, 0.1076| Residual Loss: 0.1823, 0.1568
Epoch 14/100, (Training, Validation) Trend Loss: 0.0480, 0.0441| Seasonal Loss: 0.0856, 0.1056| Residual Loss: 0.1986, 0.1988
Epoch 15/100, (Training, Validation) Trend Loss: 0.0459, 0.0620| Seasonal Loss: 0.0846, 0.1139| Residual Loss: 0.1883, 0.1869
Epoch 16/100, (Training, Validation) Trend Loss: 0.0367, 0.0319| Seasonal Loss: 0.0962, 0.1632| Residual Loss: 0.1558, 0.1637
Epoch 17/100, (Training, Validation) Trend Loss: 0.0371, 0.0455| Seasonal Loss: 0.1209, 0.2768| Residual Loss: 0.1351, 0.1255
Epoch 18/100, (Training, Validation) Trend Loss: 0.0335, 0.0237| Seasonal Loss: 0.1368, 0.1741| Residual Loss: 0.1231, 0.1194
Epoch 19/100, (Training, Validation) Trend Loss: 0.0333, 0.0405| Seasonal Loss: 0.1080, 0.1498| Residual Loss: 0.1169, 0.1165
Epoch 20/100, (Training, Validation) Trend Loss: 0.0375, 0.0215| Seasonal Loss: 0.0856, 0.1231| Residual Loss: 0.1128, 0.1096
Epoch 21/100, (Training, Validation) Trend Loss: 0.0391, 0.0309| Seasonal Loss: 0.0743, 0.1215| Residual Loss: 0.1097, 0.1076
Epoch 22/100, (Training, Validation) Trend Loss: 0.0390, 0.0316| Seasonal Loss: 0.0659, 0.1177| Residual Loss: 0.1068, 0.1046
Epoch 23/100, (Training, Validation) Trend Loss: 0.0263, 0.0212| Seasonal Loss: 0.0624, 0.1151| Residual Loss: 0.1047, 0.1028
Epoch 24/100, (Training, Validation) Trend Loss: 0.0236, 0.0327| Seasonal Loss: 0.0593, 0.1068| Residual Loss: 0.1029, 0.1014
Epoch 25/100, (Training, Validation) Trend Loss: 0.0238, 0.0247| Seasonal Loss: 0.0565, 0.1070| Residual Loss: 0.1013, 0.1000
Epoch 26/100, (Training, Validation) Trend Loss: 0.0238, 0.0329| Seasonal Loss: 0.0590, 0.1019| Residual Loss: 0.0999, 0.0991
Epoch 27/100, (Training, Validation) Trend Loss: 0.0236, 0.0302| Seasonal Loss: 0.0723, 0.1084| Residual Loss: 0.0986, 0.0980
Epoch 28/100, (Training, Validation) Trend Loss: 0.0372, 0.0757| Seasonal Loss: 0.0856, 0.1009| Residual Loss: 0.0975, 0.0973
Epoch 29/100, (Training, Validation) Trend Loss: 0.0507, 0.0360| Seasonal Loss: 0.0634, 0.0993| Residual Loss: 0.0964, 0.0965
Epoch 30/100, (Training, Validation) Trend Loss: 0.0356, 0.0246| Seasonal Loss: 0.0516, 0.1056| Residual Loss: 0.0954, 0.0958
Epoch 31/100, (Training, Validation) Trend Loss: 0.0228, 0.0421| Seasonal Loss: 0.0534, 0.1040| Residual Loss: 0.0945, 0.0952
Epoch 32/100, (Training, Validation) Trend Loss: 0.0235, 0.0281| Seasonal Loss: 0.0477, 0.0995| Residual Loss: 0.0937, 0.0946
Epoch 33/100, (Training, Validation) Trend Loss: 0.0197, 0.0231| Seasonal Loss: 0.0472, 0.0999| Residual Loss: 0.0928, 0.0941
Epoch 34/100, (Training, Validation) Trend Loss: 0.0199, 0.0291| Seasonal Loss: 0.0449, 0.1008| Residual Loss: 0.0921, 0.0936
Epoch 35/100, (Training, Validation) Trend Loss: 0.0186, 0.0281| Seasonal Loss: 0.0439, 0.0993| Residual Loss: 0.0914, 0.0932
Epoch 36/100, (Training, Validation) Trend Loss: 0.0176, 0.0231| Seasonal Loss: 0.0428, 0.0985| Residual Loss: 0.0907, 0.0928
Epoch 37/100, (Training, Validation) Trend Loss: 0.0172, 0.0231| Seasonal Loss: 0.0418, 0.0985| Residual Loss: 0.0901, 0.0924
Epoch 38/100, (Training, Validation) Trend Loss: 0.0168, 0.0240| Seasonal Loss: 0.0411, 0.0978| Residual Loss: 0.0895, 0.0921
Epoch 39/100, (Training, Validation) Trend Loss: 0.0163, 0.0226| Seasonal Loss: 0.0403, 0.0970| Residual Loss: 0.0889, 0.0918
Epoch 40/100, (Training, Validation) Trend Loss: 0.0160, 0.0217| Seasonal Loss: 0.0396, 0.0968| Residual Loss: 0.0884, 0.0915
Epoch 41/100, (Training, Validation) Trend Loss: 0.0158, 0.0218| Seasonal Loss: 0.0390, 0.0965| Residual Loss: 0.0879, 0.0912
Epoch 42/100, (Training, Validation) Trend Loss: 0.0155, 0.0216| Seasonal Loss: 0.0384, 0.0962| Residual Loss: 0.0874, 0.0909
Epoch 43/100, (Training, Validation) Trend Loss: 0.0152, 0.0211| Seasonal Loss: 0.0379, 0.0959| Residual Loss: 0.0869, 0.0907
Epoch 44/100, (Training, Validation) Trend Loss: 0.0150, 0.0207| Seasonal Loss: 0.0374, 0.0958| Residual Loss: 0.0865, 0.0904
Epoch 45/100, (Training, Validation) Trend Loss: 0.0148, 0.0206| Seasonal Loss: 0.0370, 0.0955| Residual Loss: 0.0861, 0.0902
Epoch 46/100, (Training, Validation) Trend Loss: 0.0146, 0.0204| Seasonal Loss: 0.0365, 0.0953| Residual Loss: 0.0857, 0.0900
Epoch 47/100, (Training, Validation) Trend Loss: 0.0145, 0.0201| Seasonal Loss: 0.0361, 0.0952| Residual Loss: 0.0853, 0.0898
Epoch 48/100, (Training, Validation) Trend Loss: 0.0143, 0.0199| Seasonal Loss: 0.0358, 0.0950| Residual Loss: 0.0850, 0.0896
Epoch 49/100, (Training, Validation) Trend Loss: 0.0142, 0.0198| Seasonal Loss: 0.0354, 0.0949| Residual Loss: 0.0846, 0.0895
Epoch 50/100, (Training, Validation) Trend Loss: 0.0140, 0.0196| Seasonal Loss: 0.0351, 0.0947| Residual Loss: 0.0843, 0.0893
Epoch 51/100, (Training, Validation) Trend Loss: 0.0139, 0.0194| Seasonal Loss: 0.0348, 0.0946| Residual Loss: 0.0840, 0.0892
Epoch 52/100, (Training, Validation) Trend Loss: 0.0138, 0.0192| Seasonal Loss: 0.0345, 0.0945| Residual Loss: 0.0837, 0.0890
Epoch 53/100, (Training, Validation) Trend Loss: 0.0137, 0.0191| Seasonal Loss: 0.0342, 0.0944| Residual Loss: 0.0834, 0.0889
Epoch 54/100, (Training, Validation) Trend Loss: 0.0136, 0.0190| Seasonal Loss: 0.0339, 0.0943| Residual Loss: 0.0832, 0.0887
Epoch 55/100, (Training, Validation) Trend Loss: 0.0135, 0.0188| Seasonal Loss: 0.0337, 0.0942| Residual Loss: 0.0829, 0.0886
Epoch 56/100, (Training, Validation) Trend Loss: 0.0134, 0.0187| Seasonal Loss: 0.0335, 0.0941| Residual Loss: 0.0827, 0.0885
Epoch 57/100, (Training, Validation) Trend Loss: 0.0134, 0.0186| Seasonal Loss: 0.0332, 0.0940| Residual Loss: 0.0824, 0.0884
Epoch 58/100, (Training, Validation) Trend Loss: 0.0133, 0.0185| Seasonal Loss: 0.0330, 0.0940| Residual Loss: 0.0822, 0.0883
Epoch 59/100, (Training, Validation) Trend Loss: 0.0132, 0.0184| Seasonal Loss: 0.0328, 0.0939| Residual Loss: 0.0820, 0.0882
Epoch 60/100, (Training, Validation) Trend Loss: 0.0132, 0.0182| Seasonal Loss: 0.0326, 0.0938| Residual Loss: 0.0818, 0.0881
Epoch 61/100, (Training, Validation) Trend Loss: 0.0131, 0.0181| Seasonal Loss: 0.0325, 0.0938| Residual Loss: 0.0816, 0.0880
Epoch 62/100, (Training, Validation) Trend Loss: 0.0131, 0.0181| Seasonal Loss: 0.0323, 0.0937| Residual Loss: 0.0814, 0.0879
Epoch 63/100, (Training, Validation) Trend Loss: 0.0130, 0.0180| Seasonal Loss: 0.0321, 0.0936| Residual Loss: 0.0813, 0.0878
Epoch 64/100, (Training, Validation) Trend Loss: 0.0130, 0.0179| Seasonal Loss: 0.0320, 0.0936| Residual Loss: 0.0811, 0.0877
Epoch 65/100, (Training, Validation) Trend Loss: 0.0129, 0.0178| Seasonal Loss: 0.0319, 0.0935| Residual Loss: 0.0809, 0.0877
Epoch 66/100, (Training, Validation) Trend Loss: 0.0129, 0.0177| Seasonal Loss: 0.0317, 0.0935| Residual Loss: 0.0808, 0.0876
Epoch 67/100, (Training, Validation) Trend Loss: 0.0128, 0.0177| Seasonal Loss: 0.0316, 0.0934| Residual Loss: 0.0807, 0.0875
Epoch 68/100, (Training, Validation) Trend Loss: 0.0128, 0.0176| Seasonal Loss: 0.0315, 0.0934| Residual Loss: 0.0805, 0.0874
Epoch 69/100, (Training, Validation) Trend Loss: 0.0128, 0.0175| Seasonal Loss: 0.0314, 0.0933| Residual Loss: 0.0804, 0.0874
Epoch 70/100, (Training, Validation) Trend Loss: 0.0127, 0.0175| Seasonal Loss: 0.0312, 0.0933| Residual Loss: 0.0803, 0.0873
Epoch 71/100, (Training, Validation) Trend Loss: 0.0127, 0.0174| Seasonal Loss: 0.0311, 0.0933| Residual Loss: 0.0801, 0.0873
Epoch 72/100, (Training, Validation) Trend Loss: 0.0127, 0.0174| Seasonal Loss: 0.0310, 0.0932| Residual Loss: 0.0800, 0.0872
Epoch 73/100, (Training, Validation) Trend Loss: 0.0126, 0.0173| Seasonal Loss: 0.0309, 0.0932| Residual Loss: 0.0799, 0.0872
Epoch 74/100, (Training, Validation) Trend Loss: 0.0126, 0.0173| Seasonal Loss: 0.0309, 0.0931| Residual Loss: 0.0798, 0.0871
Epoch 75/100, (Training, Validation) Trend Loss: 0.0126, 0.0172| Seasonal Loss: 0.0308, 0.0931| Residual Loss: 0.0797, 0.0871
Epoch 76/100, (Training, Validation) Trend Loss: 0.0125, 0.0172| Seasonal Loss: 0.0307, 0.0931| Residual Loss: 0.0796, 0.0870
Epoch 77/100, (Training, Validation) Trend Loss: 0.0125, 0.0171| Seasonal Loss: 0.0306, 0.0931| Residual Loss: 0.0795, 0.0870
Epoch 78/100, (Training, Validation) Trend Loss: 0.0125, 0.0171| Seasonal Loss: 0.0305, 0.0930| Residual Loss: 0.0795, 0.0869
Epoch 79/100, (Training, Validation) Trend Loss: 0.0125, 0.0170| Seasonal Loss: 0.0305, 0.0930| Residual Loss: 0.0794, 0.0869
Epoch 80/100, (Training, Validation) Trend Loss: 0.0125, 0.0170| Seasonal Loss: 0.0304, 0.0930| Residual Loss: 0.0793, 0.0869
Epoch 81/100, (Training, Validation) Trend Loss: 0.0124, 0.0170| Seasonal Loss: 0.0303, 0.0930| Residual Loss: 0.0792, 0.0868
Epoch 82/100, (Training, Validation) Trend Loss: 0.0124, 0.0169| Seasonal Loss: 0.0303, 0.0929| Residual Loss: 0.0792, 0.0868
Epoch 83/100, (Training, Validation) Trend Loss: 0.0124, 0.0169| Seasonal Loss: 0.0302, 0.0929| Residual Loss: 0.0791, 0.0868
Epoch 84/100, (Training, Validation) Trend Loss: 0.0124, 0.0169| Seasonal Loss: 0.0302, 0.0929| Residual Loss: 0.0790, 0.0867
Epoch 85/100, (Training, Validation) Trend Loss: 0.0124, 0.0168| Seasonal Loss: 0.0301, 0.0929| Residual Loss: 0.0790, 0.0867
Epoch 86/100, (Training, Validation) Trend Loss: 0.0124, 0.0168| Seasonal Loss: 0.0301, 0.0928| Residual Loss: 0.0789, 0.0867
Epoch 87/100, (Training, Validation) Trend Loss: 0.0123, 0.0168| Seasonal Loss: 0.0300, 0.0928| Residual Loss: 0.0788, 0.0867
Epoch 88/100, (Training, Validation) Trend Loss: 0.0123, 0.0168| Seasonal Loss: 0.0300, 0.0928| Residual Loss: 0.0788, 0.0866
Epoch 89/100, (Training, Validation) Trend Loss: 0.0123, 0.0167| Seasonal Loss: 0.0299, 0.0928| Residual Loss: 0.0787, 0.0866
Epoch 90/100, (Training, Validation) Trend Loss: 0.0123, 0.0167| Seasonal Loss: 0.0299, 0.0928| Residual Loss: 0.0787, 0.0866
Epoch 91/100, (Training, Validation) Trend Loss: 0.0123, 0.0167| Seasonal Loss: 0.0299, 0.0928| Residual Loss: 0.0786, 0.0866
Epoch 92/100, (Training, Validation) Trend Loss: 0.0123, 0.0167| Seasonal Loss: 0.0298, 0.0928| Residual Loss: 0.0786, 0.0865
Epoch 93/100, (Training, Validation) Trend Loss: 0.0123, 0.0167| Seasonal Loss: 0.0298, 0.0927| Residual Loss: 0.0786, 0.0865
Epoch 94/100, (Training, Validation) Trend Loss: 0.0123, 0.0166| Seasonal Loss: 0.0297, 0.0927| Residual Loss: 0.0785, 0.0865
Epoch 95/100, (Training, Validation) Trend Loss: 0.0123, 0.0166| Seasonal Loss: 0.0297, 0.0927| Residual Loss: 0.0785, 0.0865
Epoch 96/100, (Training, Validation) Trend Loss: 0.0122, 0.0166| Seasonal Loss: 0.0297, 0.0927| Residual Loss: 0.0784, 0.0865
Epoch 97/100, (Training, Validation) Trend Loss: 0.0122, 0.0166| Seasonal Loss: 0.0297, 0.0927| Residual Loss: 0.0784, 0.0864
Epoch 98/100, (Training, Validation) Trend Loss: 0.0122, 0.0166| Seasonal Loss: 0.0296, 0.0927| Residual Loss: 0.0784, 0.0864
Epoch 99/100, (Training, Validation) Trend Loss: 0.0122, 0.0166| Seasonal Loss: 0.0296, 0.0927| Residual Loss: 0.0783, 0.0864
Epoch 100/100, (Training, Validation) Trend Loss: 0.0122, 0.0165| Seasonal Loss: 0.0296, 0.0927| Residual Loss: 0.0783, 0.0864
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[167.59667509]
[-1.21327464]
[1.02905228]
[167.41245273]
actual_stock_price: [171.57913208 173.92396545 174.03323364 173.079422   170.45639038
 170.73458862 171.87721252 174.30148315 176.1594696  176.10980225]
add_predicted_stock_price: [171.57913208 173.92396545 174.03323364 173.079422   170.45639038
 170.73458862 171.87721252 174.30148315 176.1594696  167.41245273]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
