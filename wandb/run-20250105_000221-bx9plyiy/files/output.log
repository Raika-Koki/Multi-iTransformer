[32m[I 2025-01-05 00:02:22,845][0m A new study created in memory with name: no-name-5c7cfa1b-531c-4e85-989a-3db02eb96d07[0m
[32m[I 2025-01-05 00:02:58,051][0m Trial 0 finished with value: 0.21505033682183464 and parameters: {'observation_period_num': 97, 'train_rates': 0.7174193858881074, 'learning_rate': 0.00030926559148938414, 'batch_size': 192, 'step_size': 14, 'gamma': 0.7989697535219547}. Best is trial 0 with value: 0.21505033682183464.[0m
[32m[I 2025-01-05 00:06:10,071][0m Trial 1 finished with value: 0.21343699315682463 and parameters: {'observation_period_num': 164, 'train_rates': 0.609540681232411, 'learning_rate': 1.9038467866193683e-05, 'batch_size': 16, 'step_size': 7, 'gamma': 0.9386905421158372}. Best is trial 1 with value: 0.21343699315682463.[0m
[32m[I 2025-01-05 00:06:49,820][0m Trial 2 finished with value: 0.11712792774577567 and parameters: {'observation_period_num': 169, 'train_rates': 0.7872329116949417, 'learning_rate': 0.00030972080495675206, 'batch_size': 194, 'step_size': 7, 'gamma': 0.8202423367205357}. Best is trial 2 with value: 0.11712792774577567.[0m
[32m[I 2025-01-05 00:07:29,275][0m Trial 3 finished with value: 0.3692154841981863 and parameters: {'observation_period_num': 168, 'train_rates': 0.6153507494222554, 'learning_rate': 7.70204494176227e-05, 'batch_size': 255, 'step_size': 5, 'gamma': 0.8530031522158439}. Best is trial 2 with value: 0.11712792774577567.[0m
[32m[I 2025-01-05 00:09:37,750][0m Trial 4 finished with value: 0.09128233842866522 and parameters: {'observation_period_num': 107, 'train_rates': 0.9501954816613261, 'learning_rate': 2.510191230597544e-05, 'batch_size': 36, 'step_size': 11, 'gamma': 0.8683314239964215}. Best is trial 4 with value: 0.09128233842866522.[0m
[32m[I 2025-01-05 00:10:44,605][0m Trial 5 finished with value: 0.06137833395174572 and parameters: {'observation_period_num': 33, 'train_rates': 0.940173912493321, 'learning_rate': 2.2254276801860063e-05, 'batch_size': 81, 'step_size': 4, 'gamma': 0.9736508102581195}. Best is trial 5 with value: 0.06137833395174572.[0m
[32m[I 2025-01-05 00:11:53,856][0m Trial 6 finished with value: 0.21541045978665352 and parameters: {'observation_period_num': 154, 'train_rates': 0.8288525696369275, 'learning_rate': 4.552979955712184e-06, 'batch_size': 60, 'step_size': 12, 'gamma': 0.9207935964916234}. Best is trial 5 with value: 0.06137833395174572.[0m
[32m[I 2025-01-05 00:13:00,257][0m Trial 7 finished with value: 0.3531761841261008 and parameters: {'observation_period_num': 167, 'train_rates': 0.7069386033974268, 'learning_rate': 9.338119174101591e-06, 'batch_size': 62, 'step_size': 10, 'gamma': 0.8685175398786608}. Best is trial 5 with value: 0.06137833395174572.[0m
[32m[I 2025-01-05 00:13:37,435][0m Trial 8 finished with value: 0.5255016182316118 and parameters: {'observation_period_num': 164, 'train_rates': 0.76135174464876, 'learning_rate': 1.619750980061661e-05, 'batch_size': 218, 'step_size': 5, 'gamma': 0.841737363597303}. Best is trial 5 with value: 0.06137833395174572.[0m
[32m[I 2025-01-05 00:14:23,499][0m Trial 9 finished with value: 0.39563846599307145 and parameters: {'observation_period_num': 89, 'train_rates': 0.6278461894752989, 'learning_rate': 6.897658465477391e-06, 'batch_size': 92, 'step_size': 9, 'gamma': 0.7744640558275078}. Best is trial 5 with value: 0.06137833395174572.[0m
[32m[I 2025-01-05 00:15:12,718][0m Trial 10 finished with value: 0.3007489740848541 and parameters: {'observation_period_num': 10, 'train_rates': 0.9815635488745799, 'learning_rate': 1.1094226533977462e-06, 'batch_size': 134, 'step_size': 2, 'gamma': 0.9877283307584619}. Best is trial 5 with value: 0.06137833395174572.[0m
[32m[I 2025-01-05 00:18:28,495][0m Trial 11 finished with value: 0.03716152953830632 and parameters: {'observation_period_num': 7, 'train_rates': 0.9814311629541559, 'learning_rate': 6.10612367117931e-05, 'batch_size': 23, 'step_size': 2, 'gamma': 0.8979988301683711}. Best is trial 11 with value: 0.03716152953830632.[0m
[32m[I 2025-01-05 00:19:22,180][0m Trial 12 finished with value: 0.0595886267355231 and parameters: {'observation_period_num': 5, 'train_rates': 0.8966509074585326, 'learning_rate': 8.36940192535087e-05, 'batch_size': 107, 'step_size': 1, 'gamma': 0.9152200971922941}. Best is trial 11 with value: 0.03716152953830632.[0m
[32m[I 2025-01-05 00:20:12,495][0m Trial 13 finished with value: 0.21510108896721167 and parameters: {'observation_period_num': 250, 'train_rates': 0.889724917751911, 'learning_rate': 8.760537587542418e-05, 'batch_size': 110, 'step_size': 1, 'gamma': 0.909732715647038}. Best is trial 11 with value: 0.03716152953830632.[0m
[32m[I 2025-01-05 00:21:05,311][0m Trial 14 finished with value: 0.06730503886938095 and parameters: {'observation_period_num': 52, 'train_rates': 0.8709437218369331, 'learning_rate': 9.900365587883384e-05, 'batch_size': 150, 'step_size': 3, 'gamma': 0.8971660372294661}. Best is trial 11 with value: 0.03716152953830632.[0m
[32m[I 2025-01-05 00:21:52,227][0m Trial 15 finished with value: 0.037060756384339553 and parameters: {'observation_period_num': 8, 'train_rates': 0.8978256255058472, 'learning_rate': 0.000933686037420787, 'batch_size': 140, 'step_size': 1, 'gamma': 0.9459775757195619}. Best is trial 15 with value: 0.037060756384339553.[0m
[32m[I 2025-01-05 00:22:39,840][0m Trial 16 finished with value: 0.07615004479885101 and parameters: {'observation_period_num': 60, 'train_rates': 0.9819363935436521, 'learning_rate': 0.0005638307891315538, 'batch_size': 147, 'step_size': 3, 'gamma': 0.9532729885286182}. Best is trial 15 with value: 0.037060756384339553.[0m
[32m[I 2025-01-05 00:23:19,441][0m Trial 17 finished with value: 0.06470224088238131 and parameters: {'observation_period_num': 43, 'train_rates': 0.8406287795569994, 'learning_rate': 0.0005992396696170283, 'batch_size': 177, 'step_size': 6, 'gamma': 0.892476927703734}. Best is trial 15 with value: 0.037060756384339553.[0m
[32m[I 2025-01-05 00:24:11,432][0m Trial 18 finished with value: 0.058026183541249304 and parameters: {'observation_period_num': 76, 'train_rates': 0.9286967513794799, 'learning_rate': 0.0009386631810441306, 'batch_size': 121, 'step_size': 1, 'gamma': 0.9485510408040873}. Best is trial 15 with value: 0.037060756384339553.[0m
[32m[I 2025-01-05 00:24:59,724][0m Trial 19 finished with value: 0.09374154003766867 and parameters: {'observation_period_num': 213, 'train_rates': 0.9290852514669349, 'learning_rate': 0.00018450090533324006, 'batch_size': 166, 'step_size': 15, 'gamma': 0.9317075994713109}. Best is trial 15 with value: 0.037060756384339553.[0m
[32m[I 2025-01-05 00:26:28,406][0m Trial 20 finished with value: 0.3389019750289081 and parameters: {'observation_period_num': 132, 'train_rates': 0.8628400985803395, 'learning_rate': 2.0742987049084692e-06, 'batch_size': 55, 'step_size': 3, 'gamma': 0.9625785308128278}. Best is trial 15 with value: 0.037060756384339553.[0m
[32m[I 2025-01-05 00:27:15,377][0m Trial 21 finished with value: 0.060232165731548326 and parameters: {'observation_period_num': 74, 'train_rates': 0.9120500113917142, 'learning_rate': 0.0009931598019967082, 'batch_size': 125, 'step_size': 1, 'gamma': 0.9503524608485727}. Best is trial 15 with value: 0.037060756384339553.[0m
[33m[W 2025-01-05 00:29:39,599][0m Trial 22 failed with parameters: {'observation_period_num': 22, 'train_rates': 0.9575557329653646, 'learning_rate': 0.0009387650606191279, 'batch_size': 16, 'step_size': 2, 'gamma': 0.8932938425984452} because of the following error: KeyboardInterrupt().[0m
Traceback (most recent call last):
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 412, in <lambda>
    study.optimize(lambda trial: objective(trial, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 83, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 32, in train
    output = model(data)
             ^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<@beartype(src.model.iTransformer.forward) at 0x7fece1cd40e0>", line 66, in forward
  File "/data/student/k2110261/Multi-iTransformer/src/model.py", line 191, in forward
    x = ff_post_norm(x)
        ^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/normalization.py", line 190, in forward
    return F.layer_norm(
           ^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/functional.py", line 2515, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
[33m[W 2025-01-05 00:29:39,616][0m Trial 22 failed with value None.[0m
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 412, in <module>
    study.optimize(lambda trial: objective(trial, depth, dim), n_trials=50) #check
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 412, in <lambda>
    study.optimize(lambda trial: objective(trial, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 83, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 32, in train
    output = model(data)
             ^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<@beartype(src.model.iTransformer.forward) at 0x7fece1cd40e0>", line 66, in forward
  File "/data/student/k2110261/Multi-iTransformer/src/model.py", line 191, in forward
    x = ff_post_norm(x)
        ^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/normalization.py", line 190, in forward
    return F.layer_norm(
           ^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/functional.py", line 2515, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
