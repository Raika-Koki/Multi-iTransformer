[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.4364, 0.2037| Seasonal Loss: 0.6593, 0.9633| Residual Loss: 0.5825, 0.4472
Epoch 2/100, (Training, Validation) Trend Loss: 0.2296, 0.2525| Seasonal Loss: 0.4469, 0.3643| Residual Loss: 0.3033, 0.3609
Epoch 3/100, (Training, Validation) Trend Loss: 0.1679, 0.1439| Seasonal Loss: 0.2824, 0.2858| Residual Loss: 0.2555, 0.2537
Epoch 4/100, (Training, Validation) Trend Loss: 0.1488, 0.1032| Seasonal Loss: 0.2447, 0.3239| Residual Loss: 0.1924, 0.1827
Epoch 5/100, (Training, Validation) Trend Loss: 0.1122, 0.1081| Seasonal Loss: 0.2540, 0.2285| Residual Loss: 0.1686, 0.1661
Epoch 6/100, (Training, Validation) Trend Loss: 0.0923, 0.0706| Seasonal Loss: 0.2419, 0.2749| Residual Loss: 0.1513, 0.1394
Epoch 7/100, (Training, Validation) Trend Loss: 0.0780, 0.0823| Seasonal Loss: 0.3039, 0.2010| Residual Loss: 0.1577, 0.1451
Epoch 8/100, (Training, Validation) Trend Loss: 0.0632, 0.0483| Seasonal Loss: 0.2679, 0.2055| Residual Loss: 0.1591, 0.1433
Epoch 9/100, (Training, Validation) Trend Loss: 0.0594, 0.0809| Seasonal Loss: 0.1927, 0.2062| Residual Loss: 0.1962, 0.1333
Epoch 10/100, (Training, Validation) Trend Loss: 0.0573, 0.0396| Seasonal Loss: 0.1566, 0.1799| Residual Loss: 0.2367, 0.1640
Epoch 11/100, (Training, Validation) Trend Loss: 0.0730, 0.1430| Seasonal Loss: 0.1435, 0.1735| Residual Loss: 0.2016, 0.1575
Epoch 12/100, (Training, Validation) Trend Loss: 0.0912, 0.0831| Seasonal Loss: 0.1316, 0.1651| Residual Loss: 0.1568, 0.1871
Epoch 13/100, (Training, Validation) Trend Loss: 0.1104, 0.1247| Seasonal Loss: 0.1218, 0.1571| Residual Loss: 0.1461, 0.1385
Epoch 14/100, (Training, Validation) Trend Loss: 0.0799, 0.0410| Seasonal Loss: 0.1150, 0.1539| Residual Loss: 0.1315, 0.1215
Epoch 15/100, (Training, Validation) Trend Loss: 0.0598, 0.0425| Seasonal Loss: 0.1081, 0.1480| Residual Loss: 0.1160, 0.1026
Epoch 16/100, (Training, Validation) Trend Loss: 0.0482, 0.0529| Seasonal Loss: 0.1049, 0.1513| Residual Loss: 0.1089, 0.0995
Epoch 17/100, (Training, Validation) Trend Loss: 0.0396, 0.0373| Seasonal Loss: 0.1005, 0.1514| Residual Loss: 0.1045, 0.0957
Epoch 18/100, (Training, Validation) Trend Loss: 0.0355, 0.0391| Seasonal Loss: 0.1050, 0.1728| Residual Loss: 0.1013, 0.0933
Epoch 19/100, (Training, Validation) Trend Loss: 0.0321, 0.0355| Seasonal Loss: 0.1052, 0.1869| Residual Loss: 0.0987, 0.0916
Epoch 20/100, (Training, Validation) Trend Loss: 0.0300, 0.0319| Seasonal Loss: 0.1158, 0.1812| Residual Loss: 0.0965, 0.0896
Epoch 21/100, (Training, Validation) Trend Loss: 0.0284, 0.0311| Seasonal Loss: 0.1050, 0.1494| Residual Loss: 0.0946, 0.0887
Epoch 22/100, (Training, Validation) Trend Loss: 0.0272, 0.0285| Seasonal Loss: 0.1056, 0.1346| Residual Loss: 0.0929, 0.0870
Epoch 23/100, (Training, Validation) Trend Loss: 0.0260, 0.0279| Seasonal Loss: 0.0959, 0.1279| Residual Loss: 0.0914, 0.0865
Epoch 24/100, (Training, Validation) Trend Loss: 0.0252, 0.0265| Seasonal Loss: 0.0871, 0.1279| Residual Loss: 0.0900, 0.0849
Epoch 25/100, (Training, Validation) Trend Loss: 0.0242, 0.0256| Seasonal Loss: 0.0786, 0.1274| Residual Loss: 0.0888, 0.0848
Epoch 26/100, (Training, Validation) Trend Loss: 0.0238, 0.0252| Seasonal Loss: 0.0719, 0.1236| Residual Loss: 0.0875, 0.0833
Epoch 27/100, (Training, Validation) Trend Loss: 0.0228, 0.0238| Seasonal Loss: 0.0686, 0.1226| Residual Loss: 0.0865, 0.0835
Epoch 28/100, (Training, Validation) Trend Loss: 0.0227, 0.0245| Seasonal Loss: 0.0663, 0.1209| Residual Loss: 0.0854, 0.0821
Epoch 29/100, (Training, Validation) Trend Loss: 0.0218, 0.0223| Seasonal Loss: 0.0642, 0.1193| Residual Loss: 0.0845, 0.0824
Epoch 30/100, (Training, Validation) Trend Loss: 0.0220, 0.0242| Seasonal Loss: 0.0625, 0.1180| Residual Loss: 0.0835, 0.0811
Epoch 31/100, (Training, Validation) Trend Loss: 0.0210, 0.0210| Seasonal Loss: 0.0608, 0.1166| Residual Loss: 0.0828, 0.0814
Epoch 32/100, (Training, Validation) Trend Loss: 0.0212, 0.0241| Seasonal Loss: 0.0594, 0.1154| Residual Loss: 0.0818, 0.0803
Epoch 33/100, (Training, Validation) Trend Loss: 0.0202, 0.0200| Seasonal Loss: 0.0580, 0.1143| Residual Loss: 0.0812, 0.0805
Epoch 34/100, (Training, Validation) Trend Loss: 0.0204, 0.0237| Seasonal Loss: 0.0568, 0.1132| Residual Loss: 0.0803, 0.0798
Epoch 35/100, (Training, Validation) Trend Loss: 0.0193, 0.0194| Seasonal Loss: 0.0556, 0.1122| Residual Loss: 0.0797, 0.0798
Epoch 36/100, (Training, Validation) Trend Loss: 0.0194, 0.0227| Seasonal Loss: 0.0546, 0.1112| Residual Loss: 0.0790, 0.0793
Epoch 37/100, (Training, Validation) Trend Loss: 0.0185, 0.0194| Seasonal Loss: 0.0536, 0.1103| Residual Loss: 0.0784, 0.0792
Epoch 38/100, (Training, Validation) Trend Loss: 0.0185, 0.0215| Seasonal Loss: 0.0527, 0.1095| Residual Loss: 0.0778, 0.0789
Epoch 39/100, (Training, Validation) Trend Loss: 0.0179, 0.0195| Seasonal Loss: 0.0518, 0.1087| Residual Loss: 0.0773, 0.0787
Epoch 40/100, (Training, Validation) Trend Loss: 0.0178, 0.0204| Seasonal Loss: 0.0510, 0.1080| Residual Loss: 0.0767, 0.0785
Epoch 41/100, (Training, Validation) Trend Loss: 0.0174, 0.0196| Seasonal Loss: 0.0503, 0.1073| Residual Loss: 0.0762, 0.0783
Epoch 42/100, (Training, Validation) Trend Loss: 0.0172, 0.0197| Seasonal Loss: 0.0496, 0.1066| Residual Loss: 0.0757, 0.0782
Epoch 43/100, (Training, Validation) Trend Loss: 0.0170, 0.0195| Seasonal Loss: 0.0490, 0.1060| Residual Loss: 0.0753, 0.0780
Epoch 44/100, (Training, Validation) Trend Loss: 0.0169, 0.0193| Seasonal Loss: 0.0484, 0.1054| Residual Loss: 0.0748, 0.0779
Epoch 45/100, (Training, Validation) Trend Loss: 0.0167, 0.0192| Seasonal Loss: 0.0478, 0.1048| Residual Loss: 0.0744, 0.0777
Epoch 46/100, (Training, Validation) Trend Loss: 0.0165, 0.0191| Seasonal Loss: 0.0473, 0.1043| Residual Loss: 0.0740, 0.0776
Epoch 47/100, (Training, Validation) Trend Loss: 0.0164, 0.0190| Seasonal Loss: 0.0468, 0.1038| Residual Loss: 0.0736, 0.0775
Epoch 48/100, (Training, Validation) Trend Loss: 0.0162, 0.0189| Seasonal Loss: 0.0463, 0.1033| Residual Loss: 0.0733, 0.0774
Epoch 49/100, (Training, Validation) Trend Loss: 0.0161, 0.0188| Seasonal Loss: 0.0459, 0.1028| Residual Loss: 0.0729, 0.0773
Epoch 50/100, (Training, Validation) Trend Loss: 0.0160, 0.0187| Seasonal Loss: 0.0454, 0.1024| Residual Loss: 0.0726, 0.0772
Epoch 51/100, (Training, Validation) Trend Loss: 0.0159, 0.0186| Seasonal Loss: 0.0450, 0.1020| Residual Loss: 0.0723, 0.0771
Epoch 52/100, (Training, Validation) Trend Loss: 0.0157, 0.0185| Seasonal Loss: 0.0447, 0.1016| Residual Loss: 0.0720, 0.0771
Epoch 53/100, (Training, Validation) Trend Loss: 0.0156, 0.0184| Seasonal Loss: 0.0443, 0.1013| Residual Loss: 0.0717, 0.0770
Epoch 54/100, (Training, Validation) Trend Loss: 0.0155, 0.0184| Seasonal Loss: 0.0440, 0.1009| Residual Loss: 0.0714, 0.0769
Epoch 55/100, (Training, Validation) Trend Loss: 0.0155, 0.0183| Seasonal Loss: 0.0437, 0.1006| Residual Loss: 0.0712, 0.0768
Epoch 56/100, (Training, Validation) Trend Loss: 0.0154, 0.0182| Seasonal Loss: 0.0434, 0.1003| Residual Loss: 0.0709, 0.0768
Epoch 57/100, (Training, Validation) Trend Loss: 0.0153, 0.0182| Seasonal Loss: 0.0431, 0.1000| Residual Loss: 0.0707, 0.0767
Epoch 58/100, (Training, Validation) Trend Loss: 0.0152, 0.0181| Seasonal Loss: 0.0428, 0.0997| Residual Loss: 0.0705, 0.0767
Epoch 59/100, (Training, Validation) Trend Loss: 0.0151, 0.0180| Seasonal Loss: 0.0426, 0.0995| Residual Loss: 0.0702, 0.0766
Epoch 60/100, (Training, Validation) Trend Loss: 0.0151, 0.0180| Seasonal Loss: 0.0423, 0.0992| Residual Loss: 0.0700, 0.0766
Epoch 61/100, (Training, Validation) Trend Loss: 0.0150, 0.0179| Seasonal Loss: 0.0421, 0.0990| Residual Loss: 0.0698, 0.0765
Epoch 62/100, (Training, Validation) Trend Loss: 0.0149, 0.0179| Seasonal Loss: 0.0419, 0.0988| Residual Loss: 0.0696, 0.0765
Epoch 63/100, (Training, Validation) Trend Loss: 0.0149, 0.0178| Seasonal Loss: 0.0417, 0.0985| Residual Loss: 0.0695, 0.0764
Epoch 64/100, (Training, Validation) Trend Loss: 0.0148, 0.0178| Seasonal Loss: 0.0415, 0.0983| Residual Loss: 0.0693, 0.0764
Epoch 65/100, (Training, Validation) Trend Loss: 0.0148, 0.0178| Seasonal Loss: 0.0413, 0.0981| Residual Loss: 0.0691, 0.0764
Epoch 66/100, (Training, Validation) Trend Loss: 0.0147, 0.0177| Seasonal Loss: 0.0411, 0.0980| Residual Loss: 0.0690, 0.0763
Epoch 67/100, (Training, Validation) Trend Loss: 0.0147, 0.0177| Seasonal Loss: 0.0410, 0.0978| Residual Loss: 0.0688, 0.0763
Epoch 68/100, (Training, Validation) Trend Loss: 0.0146, 0.0177| Seasonal Loss: 0.0408, 0.0976| Residual Loss: 0.0687, 0.0763
Epoch 69/100, (Training, Validation) Trend Loss: 0.0146, 0.0176| Seasonal Loss: 0.0407, 0.0975| Residual Loss: 0.0686, 0.0762
Epoch 70/100, (Training, Validation) Trend Loss: 0.0145, 0.0176| Seasonal Loss: 0.0405, 0.0973| Residual Loss: 0.0684, 0.0762
Epoch 71/100, (Training, Validation) Trend Loss: 0.0145, 0.0176| Seasonal Loss: 0.0404, 0.0972| Residual Loss: 0.0683, 0.0762
Epoch 72/100, (Training, Validation) Trend Loss: 0.0144, 0.0175| Seasonal Loss: 0.0403, 0.0970| Residual Loss: 0.0682, 0.0762
Epoch 73/100, (Training, Validation) Trend Loss: 0.0144, 0.0175| Seasonal Loss: 0.0401, 0.0969| Residual Loss: 0.0681, 0.0761
Epoch 74/100, (Training, Validation) Trend Loss: 0.0144, 0.0175| Seasonal Loss: 0.0400, 0.0968| Residual Loss: 0.0680, 0.0761
Epoch 75/100, (Training, Validation) Trend Loss: 0.0143, 0.0174| Seasonal Loss: 0.0399, 0.0967| Residual Loss: 0.0679, 0.0761
Epoch 76/100, (Training, Validation) Trend Loss: 0.0143, 0.0174| Seasonal Loss: 0.0398, 0.0966| Residual Loss: 0.0678, 0.0761
Epoch 77/100, (Training, Validation) Trend Loss: 0.0143, 0.0174| Seasonal Loss: 0.0397, 0.0965| Residual Loss: 0.0677, 0.0761
Epoch 78/100, (Training, Validation) Trend Loss: 0.0143, 0.0174| Seasonal Loss: 0.0396, 0.0964| Residual Loss: 0.0676, 0.0760
Epoch 79/100, (Training, Validation) Trend Loss: 0.0142, 0.0174| Seasonal Loss: 0.0395, 0.0963| Residual Loss: 0.0675, 0.0760
Epoch 80/100, (Training, Validation) Trend Loss: 0.0142, 0.0173| Seasonal Loss: 0.0394, 0.0962| Residual Loss: 0.0674, 0.0760
Epoch 81/100, (Training, Validation) Trend Loss: 0.0142, 0.0173| Seasonal Loss: 0.0393, 0.0961| Residual Loss: 0.0674, 0.0760
Epoch 82/100, (Training, Validation) Trend Loss: 0.0142, 0.0173| Seasonal Loss: 0.0393, 0.0960| Residual Loss: 0.0673, 0.0760
Epoch 83/100, (Training, Validation) Trend Loss: 0.0141, 0.0173| Seasonal Loss: 0.0392, 0.0959| Residual Loss: 0.0672, 0.0760
Epoch 84/100, (Training, Validation) Trend Loss: 0.0141, 0.0173| Seasonal Loss: 0.0391, 0.0958| Residual Loss: 0.0672, 0.0759
Epoch 85/100, (Training, Validation) Trend Loss: 0.0141, 0.0173| Seasonal Loss: 0.0391, 0.0958| Residual Loss: 0.0671, 0.0759
Epoch 86/100, (Training, Validation) Trend Loss: 0.0141, 0.0172| Seasonal Loss: 0.0390, 0.0957| Residual Loss: 0.0670, 0.0759
Epoch 87/100, (Training, Validation) Trend Loss: 0.0141, 0.0172| Seasonal Loss: 0.0389, 0.0956| Residual Loss: 0.0670, 0.0759
Epoch 88/100, (Training, Validation) Trend Loss: 0.0140, 0.0172| Seasonal Loss: 0.0389, 0.0956| Residual Loss: 0.0669, 0.0759
Epoch 89/100, (Training, Validation) Trend Loss: 0.0140, 0.0172| Seasonal Loss: 0.0388, 0.0955| Residual Loss: 0.0669, 0.0759
Epoch 90/100, (Training, Validation) Trend Loss: 0.0140, 0.0172| Seasonal Loss: 0.0388, 0.0955| Residual Loss: 0.0668, 0.0759
Epoch 91/100, (Training, Validation) Trend Loss: 0.0140, 0.0172| Seasonal Loss: 0.0387, 0.0954| Residual Loss: 0.0668, 0.0759
Epoch 92/100, (Training, Validation) Trend Loss: 0.0140, 0.0172| Seasonal Loss: 0.0387, 0.0954| Residual Loss: 0.0667, 0.0759
Epoch 93/100, (Training, Validation) Trend Loss: 0.0140, 0.0172| Seasonal Loss: 0.0386, 0.0953| Residual Loss: 0.0667, 0.0759
Epoch 94/100, (Training, Validation) Trend Loss: 0.0139, 0.0171| Seasonal Loss: 0.0386, 0.0953| Residual Loss: 0.0666, 0.0758
Epoch 95/100, (Training, Validation) Trend Loss: 0.0139, 0.0171| Seasonal Loss: 0.0385, 0.0952| Residual Loss: 0.0666, 0.0758
Epoch 96/100, (Training, Validation) Trend Loss: 0.0139, 0.0171| Seasonal Loss: 0.0385, 0.0952| Residual Loss: 0.0666, 0.0758
Epoch 97/100, (Training, Validation) Trend Loss: 0.0139, 0.0171| Seasonal Loss: 0.0385, 0.0951| Residual Loss: 0.0665, 0.0758
Epoch 98/100, (Training, Validation) Trend Loss: 0.0139, 0.0171| Seasonal Loss: 0.0384, 0.0951| Residual Loss: 0.0665, 0.0758
Epoch 99/100, (Training, Validation) Trend Loss: 0.0139, 0.0171| Seasonal Loss: 0.0384, 0.0951| Residual Loss: 0.0665, 0.0758
Epoch 100/100, (Training, Validation) Trend Loss: 0.0139, 0.0171| Seasonal Loss: 0.0383, 0.0950| Residual Loss: 0.0664, 0.0758
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[169.33438591]
[-1.62103591]
[0.32499964]
[168.03834965]
stock_trend: Date
2019-12-31     78.597273
2020-01-02     78.442342
2020-01-03     78.286210
2020-01-06     78.128781
2020-01-07     77.969964
                 ...
2023-05-24    173.117850
2023-05-25    173.456800
2023-05-26    173.795646
2023-05-30    174.134451
2023-05-31    174.473266
Name: trend, Length: 860, dtype: float64
actual_stock_price: [171.57913208 173.9239502  174.03323364 173.07940674 170.45640564
 170.73458862 171.87721252 174.30151367 176.1594696  176.10980225]
add_predicted_stock_price: [171.57913208 173.9239502  174.03323364 173.07940674 170.45640564
 170.73458862 171.87721252 174.30151367 176.1594696  168.03834965]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
