[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 3.7079, 0.3950| Seasonal Loss: 2.5753, 0.3574| Residual Loss: 2.3081, 0.3640
Epoch 2/100, (Training, Validation) Trend Loss: 0.7159, 0.5757| Seasonal Loss: 0.5262, 0.2933| Residual Loss: 0.5746, 0.5463
Epoch 3/100, (Training, Validation) Trend Loss: 0.4523, 0.3164| Seasonal Loss: 0.3810, 0.2913| Residual Loss: 0.5419, 0.6653
Epoch 4/100, (Training, Validation) Trend Loss: 0.3009, 0.4789| Seasonal Loss: 0.3770, 0.4575| Residual Loss: 0.4994, 0.5336
Epoch 5/100, (Training, Validation) Trend Loss: 0.2781, 0.2224| Seasonal Loss: 0.4668, 0.3838| Residual Loss: 0.4632, 0.3469
Epoch 6/100, (Training, Validation) Trend Loss: 0.1623, 0.1666| Seasonal Loss: 0.2846, 0.3318| Residual Loss: 0.3280, 0.1831
Epoch 7/100, (Training, Validation) Trend Loss: 0.1015, 0.1159| Seasonal Loss: 0.3385, 0.3431| Residual Loss: 0.2283, 0.2059
Epoch 8/100, (Training, Validation) Trend Loss: 0.0712, 0.1053| Seasonal Loss: 0.2270, 0.1948| Residual Loss: 0.1690, 0.1833
Epoch 9/100, (Training, Validation) Trend Loss: 0.0827, 0.1018| Seasonal Loss: 0.1349, 0.1912| Residual Loss: 0.1544, 0.1302
Epoch 10/100, (Training, Validation) Trend Loss: 0.0789, 0.1263| Seasonal Loss: 0.1052, 0.1437| Residual Loss: 0.1222, 0.1278
Epoch 11/100, (Training, Validation) Trend Loss: 0.1844, 0.2296| Seasonal Loss: 0.1064, 0.1279| Residual Loss: 0.1086, 0.1134
Epoch 12/100, (Training, Validation) Trend Loss: 0.1770, 0.1419| Seasonal Loss: 0.1535, 0.1042| Residual Loss: 0.1007, 0.1109
Epoch 13/100, (Training, Validation) Trend Loss: 0.1620, 0.1017| Seasonal Loss: 0.0749, 0.0992| Residual Loss: 0.0870, 0.0880
Epoch 14/100, (Training, Validation) Trend Loss: 0.0851, 0.1320| Seasonal Loss: 0.0824, 0.1248| Residual Loss: 0.0864, 0.0972
Epoch 15/100, (Training, Validation) Trend Loss: 0.0809, 0.0758| Seasonal Loss: 0.0752, 0.1509| Residual Loss: 0.0940, 0.0918
Epoch 16/100, (Training, Validation) Trend Loss: 0.0596, 0.0742| Seasonal Loss: 0.0847, 0.1840| Residual Loss: 0.1081, 0.0888
Epoch 17/100, (Training, Validation) Trend Loss: 0.0547, 0.0725| Seasonal Loss: 0.0770, 0.1395| Residual Loss: 0.0861, 0.1015
Epoch 18/100, (Training, Validation) Trend Loss: 0.0414, 0.0590| Seasonal Loss: 0.0635, 0.1150| Residual Loss: 0.0759, 0.1101
Epoch 19/100, (Training, Validation) Trend Loss: 0.0361, 0.0387| Seasonal Loss: 0.0516, 0.1103| Residual Loss: 0.0919, 0.1582
Epoch 20/100, (Training, Validation) Trend Loss: 0.0324, 0.0403| Seasonal Loss: 0.0441, 0.0981| Residual Loss: 0.0932, 0.1459
Epoch 21/100, (Training, Validation) Trend Loss: 0.0289, 0.0299| Seasonal Loss: 0.0389, 0.0953| Residual Loss: 0.0797, 0.1164
Epoch 22/100, (Training, Validation) Trend Loss: 0.0263, 0.0279| Seasonal Loss: 0.0351, 0.0926| Residual Loss: 0.0689, 0.1069
Epoch 23/100, (Training, Validation) Trend Loss: 0.0239, 0.0242| Seasonal Loss: 0.0319, 0.0858| Residual Loss: 0.0591, 0.1071
Epoch 24/100, (Training, Validation) Trend Loss: 0.0220, 0.0224| Seasonal Loss: 0.0293, 0.0820| Residual Loss: 0.0530, 0.1001
Epoch 25/100, (Training, Validation) Trend Loss: 0.0210, 0.0206| Seasonal Loss: 0.0277, 0.0807| Residual Loss: 0.0478, 0.0935
Epoch 26/100, (Training, Validation) Trend Loss: 0.0201, 0.0208| Seasonal Loss: 0.0258, 0.0787| Residual Loss: 0.0439, 0.0942
Epoch 27/100, (Training, Validation) Trend Loss: 0.0234, 0.0253| Seasonal Loss: 0.0244, 0.0765| Residual Loss: 0.0407, 0.0943
Epoch 28/100, (Training, Validation) Trend Loss: 0.0282, 0.0369| Seasonal Loss: 0.0233, 0.0756| Residual Loss: 0.0386, 0.0959
Epoch 29/100, (Training, Validation) Trend Loss: 0.0542, 0.0644| Seasonal Loss: 0.0222, 0.0744| Residual Loss: 0.0365, 0.0942
Epoch 30/100, (Training, Validation) Trend Loss: 0.0455, 0.0351| Seasonal Loss: 0.0214, 0.0738| Residual Loss: 0.0348, 0.0950
Epoch 31/100, (Training, Validation) Trend Loss: 0.0522, 0.0231| Seasonal Loss: 0.0206, 0.0727| Residual Loss: 0.0334, 0.0965
Epoch 32/100, (Training, Validation) Trend Loss: 0.0325, 0.0368| Seasonal Loss: 0.0199, 0.0722| Residual Loss: 0.0323, 0.0963
Epoch 33/100, (Training, Validation) Trend Loss: 0.0248, 0.0257| Seasonal Loss: 0.0193, 0.0713| Residual Loss: 0.0316, 0.0971
Epoch 34/100, (Training, Validation) Trend Loss: 0.0207, 0.0182| Seasonal Loss: 0.0187, 0.0708| Residual Loss: 0.0314, 0.0974
Epoch 35/100, (Training, Validation) Trend Loss: 0.0210, 0.0226| Seasonal Loss: 0.0183, 0.0700| Residual Loss: 0.0323, 0.1003
Epoch 36/100, (Training, Validation) Trend Loss: 0.0199, 0.0202| Seasonal Loss: 0.0179, 0.0698| Residual Loss: 0.0321, 0.0984
Epoch 37/100, (Training, Validation) Trend Loss: 0.0178, 0.0167| Seasonal Loss: 0.0177, 0.0691| Residual Loss: 0.0322, 0.1025
Epoch 38/100, (Training, Validation) Trend Loss: 0.0170, 0.0182| Seasonal Loss: 0.0174, 0.0693| Residual Loss: 0.0291, 0.1001
Epoch 39/100, (Training, Validation) Trend Loss: 0.0167, 0.0174| Seasonal Loss: 0.0178, 0.0688| Residual Loss: 0.0270, 0.1014
Epoch 40/100, (Training, Validation) Trend Loss: 0.0160, 0.0158| Seasonal Loss: 0.0180, 0.0695| Residual Loss: 0.0259, 0.1043
Epoch 41/100, (Training, Validation) Trend Loss: 0.0155, 0.0158| Seasonal Loss: 0.0191, 0.0695| Residual Loss: 0.0251, 0.1005
Epoch 42/100, (Training, Validation) Trend Loss: 0.0152, 0.0155| Seasonal Loss: 0.0195, 0.0694| Residual Loss: 0.0246, 0.1039
Epoch 43/100, (Training, Validation) Trend Loss: 0.0148, 0.0151| Seasonal Loss: 0.0197, 0.0690| Residual Loss: 0.0240, 0.1033
Epoch 44/100, (Training, Validation) Trend Loss: 0.0145, 0.0148| Seasonal Loss: 0.0183, 0.0670| Residual Loss: 0.0235, 0.1033
Epoch 45/100, (Training, Validation) Trend Loss: 0.0143, 0.0145| Seasonal Loss: 0.0167, 0.0668| Residual Loss: 0.0230, 0.1050
Epoch 46/100, (Training, Validation) Trend Loss: 0.0141, 0.0144| Seasonal Loss: 0.0156, 0.0664| Residual Loss: 0.0226, 0.1046
Epoch 47/100, (Training, Validation) Trend Loss: 0.0139, 0.0141| Seasonal Loss: 0.0152, 0.0663| Residual Loss: 0.0222, 0.1052
Epoch 48/100, (Training, Validation) Trend Loss: 0.0137, 0.0139| Seasonal Loss: 0.0153, 0.0661| Residual Loss: 0.0218, 0.1058
Epoch 49/100, (Training, Validation) Trend Loss: 0.0135, 0.0137| Seasonal Loss: 0.0150, 0.0657| Residual Loss: 0.0215, 0.1059
Epoch 50/100, (Training, Validation) Trend Loss: 0.0134, 0.0135| Seasonal Loss: 0.0148, 0.0656| Residual Loss: 0.0212, 0.1064
Epoch 51/100, (Training, Validation) Trend Loss: 0.0132, 0.0133| Seasonal Loss: 0.0147, 0.0655| Residual Loss: 0.0209, 0.1067
Epoch 52/100, (Training, Validation) Trend Loss: 0.0131, 0.0132| Seasonal Loss: 0.0146, 0.0653| Residual Loss: 0.0206, 0.1070
Epoch 53/100, (Training, Validation) Trend Loss: 0.0130, 0.0131| Seasonal Loss: 0.0145, 0.0652| Residual Loss: 0.0204, 0.1074
Epoch 54/100, (Training, Validation) Trend Loss: 0.0129, 0.0129| Seasonal Loss: 0.0143, 0.0650| Residual Loss: 0.0201, 0.1076
Epoch 55/100, (Training, Validation) Trend Loss: 0.0128, 0.0128| Seasonal Loss: 0.0142, 0.0649| Residual Loss: 0.0199, 0.1079
Epoch 56/100, (Training, Validation) Trend Loss: 0.0127, 0.0127| Seasonal Loss: 0.0141, 0.0648| Residual Loss: 0.0197, 0.1082
Epoch 57/100, (Training, Validation) Trend Loss: 0.0126, 0.0126| Seasonal Loss: 0.0141, 0.0646| Residual Loss: 0.0195, 0.1084
Epoch 58/100, (Training, Validation) Trend Loss: 0.0125, 0.0125| Seasonal Loss: 0.0140, 0.0645| Residual Loss: 0.0193, 0.1087
Epoch 59/100, (Training, Validation) Trend Loss: 0.0125, 0.0125| Seasonal Loss: 0.0139, 0.0644| Residual Loss: 0.0191, 0.1089
Epoch 60/100, (Training, Validation) Trend Loss: 0.0124, 0.0124| Seasonal Loss: 0.0138, 0.0643| Residual Loss: 0.0190, 0.1091
Epoch 61/100, (Training, Validation) Trend Loss: 0.0123, 0.0123| Seasonal Loss: 0.0137, 0.0642| Residual Loss: 0.0188, 0.1093
Epoch 62/100, (Training, Validation) Trend Loss: 0.0123, 0.0123| Seasonal Loss: 0.0137, 0.0642| Residual Loss: 0.0187, 0.1095
Epoch 63/100, (Training, Validation) Trend Loss: 0.0122, 0.0122| Seasonal Loss: 0.0136, 0.0641| Residual Loss: 0.0185, 0.1097
Epoch 64/100, (Training, Validation) Trend Loss: 0.0122, 0.0121| Seasonal Loss: 0.0136, 0.0640| Residual Loss: 0.0184, 0.1098
Epoch 65/100, (Training, Validation) Trend Loss: 0.0121, 0.0121| Seasonal Loss: 0.0135, 0.0639| Residual Loss: 0.0183, 0.1100
Epoch 66/100, (Training, Validation) Trend Loss: 0.0121, 0.0120| Seasonal Loss: 0.0135, 0.0639| Residual Loss: 0.0182, 0.1101
Epoch 67/100, (Training, Validation) Trend Loss: 0.0120, 0.0120| Seasonal Loss: 0.0134, 0.0638| Residual Loss: 0.0181, 0.1103
Epoch 68/100, (Training, Validation) Trend Loss: 0.0120, 0.0120| Seasonal Loss: 0.0134, 0.0637| Residual Loss: 0.0180, 0.1104
Epoch 69/100, (Training, Validation) Trend Loss: 0.0120, 0.0119| Seasonal Loss: 0.0133, 0.0637| Residual Loss: 0.0179, 0.1105
Epoch 70/100, (Training, Validation) Trend Loss: 0.0119, 0.0119| Seasonal Loss: 0.0133, 0.0636| Residual Loss: 0.0178, 0.1107
Epoch 71/100, (Training, Validation) Trend Loss: 0.0119, 0.0118| Seasonal Loss: 0.0132, 0.0636| Residual Loss: 0.0177, 0.1108
Epoch 72/100, (Training, Validation) Trend Loss: 0.0119, 0.0118| Seasonal Loss: 0.0132, 0.0635| Residual Loss: 0.0176, 0.1109
Epoch 73/100, (Training, Validation) Trend Loss: 0.0118, 0.0118| Seasonal Loss: 0.0132, 0.0635| Residual Loss: 0.0175, 0.1110
Epoch 74/100, (Training, Validation) Trend Loss: 0.0118, 0.0118| Seasonal Loss: 0.0131, 0.0634| Residual Loss: 0.0175, 0.1111
Epoch 75/100, (Training, Validation) Trend Loss: 0.0118, 0.0117| Seasonal Loss: 0.0131, 0.0634| Residual Loss: 0.0174, 0.1112
Epoch 76/100, (Training, Validation) Trend Loss: 0.0118, 0.0117| Seasonal Loss: 0.0131, 0.0634| Residual Loss: 0.0173, 0.1113
Epoch 77/100, (Training, Validation) Trend Loss: 0.0117, 0.0117| Seasonal Loss: 0.0130, 0.0633| Residual Loss: 0.0173, 0.1114
Epoch 78/100, (Training, Validation) Trend Loss: 0.0117, 0.0117| Seasonal Loss: 0.0130, 0.0633| Residual Loss: 0.0172, 0.1114
Epoch 79/100, (Training, Validation) Trend Loss: 0.0117, 0.0116| Seasonal Loss: 0.0130, 0.0633| Residual Loss: 0.0172, 0.1115
Epoch 80/100, (Training, Validation) Trend Loss: 0.0117, 0.0116| Seasonal Loss: 0.0130, 0.0632| Residual Loss: 0.0171, 0.1116
Epoch 81/100, (Training, Validation) Trend Loss: 0.0117, 0.0116| Seasonal Loss: 0.0129, 0.0632| Residual Loss: 0.0171, 0.1117
Epoch 82/100, (Training, Validation) Trend Loss: 0.0117, 0.0116| Seasonal Loss: 0.0129, 0.0632| Residual Loss: 0.0170, 0.1117
Epoch 83/100, (Training, Validation) Trend Loss: 0.0116, 0.0116| Seasonal Loss: 0.0129, 0.0631| Residual Loss: 0.0170, 0.1118
Epoch 84/100, (Training, Validation) Trend Loss: 0.0116, 0.0115| Seasonal Loss: 0.0129, 0.0631| Residual Loss: 0.0169, 0.1119
Epoch 85/100, (Training, Validation) Trend Loss: 0.0116, 0.0115| Seasonal Loss: 0.0128, 0.0631| Residual Loss: 0.0169, 0.1119
Epoch 86/100, (Training, Validation) Trend Loss: 0.0116, 0.0115| Seasonal Loss: 0.0128, 0.0631| Residual Loss: 0.0168, 0.1120
Epoch 87/100, (Training, Validation) Trend Loss: 0.0116, 0.0115| Seasonal Loss: 0.0128, 0.0631| Residual Loss: 0.0168, 0.1120
Epoch 88/100, (Training, Validation) Trend Loss: 0.0116, 0.0115| Seasonal Loss: 0.0128, 0.0630| Residual Loss: 0.0168, 0.1121
Epoch 89/100, (Training, Validation) Trend Loss: 0.0116, 0.0115| Seasonal Loss: 0.0128, 0.0630| Residual Loss: 0.0167, 0.1121
Epoch 90/100, (Training, Validation) Trend Loss: 0.0115, 0.0115| Seasonal Loss: 0.0128, 0.0630| Residual Loss: 0.0167, 0.1122
Epoch 91/100, (Training, Validation) Trend Loss: 0.0115, 0.0114| Seasonal Loss: 0.0127, 0.0630| Residual Loss: 0.0167, 0.1122
Epoch 92/100, (Training, Validation) Trend Loss: 0.0115, 0.0114| Seasonal Loss: 0.0127, 0.0630| Residual Loss: 0.0167, 0.1122
Epoch 93/100, (Training, Validation) Trend Loss: 0.0115, 0.0114| Seasonal Loss: 0.0127, 0.0629| Residual Loss: 0.0166, 0.1123
Epoch 94/100, (Training, Validation) Trend Loss: 0.0115, 0.0114| Seasonal Loss: 0.0127, 0.0629| Residual Loss: 0.0166, 0.1123
Epoch 95/100, (Training, Validation) Trend Loss: 0.0115, 0.0114| Seasonal Loss: 0.0127, 0.0629| Residual Loss: 0.0166, 0.1124
Epoch 96/100, (Training, Validation) Trend Loss: 0.0115, 0.0114| Seasonal Loss: 0.0127, 0.0629| Residual Loss: 0.0166, 0.1124
Epoch 97/100, (Training, Validation) Trend Loss: 0.0115, 0.0114| Seasonal Loss: 0.0127, 0.0629| Residual Loss: 0.0165, 0.1124
Epoch 98/100, (Training, Validation) Trend Loss: 0.0115, 0.0114| Seasonal Loss: 0.0127, 0.0629| Residual Loss: 0.0165, 0.1125
Epoch 99/100, (Training, Validation) Trend Loss: 0.0115, 0.0114| Seasonal Loss: 0.0127, 0.0629| Residual Loss: 0.0165, 0.1125
Epoch 100/100, (Training, Validation) Trend Loss: 0.0115, 0.0114| Seasonal Loss: 0.0126, 0.0629| Residual Loss: 0.0165, 0.1125
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[169.68711482]
[0.65377386]
[0.12262263]
[170.46351131]
actual_stock_price: [171.57913208 173.92396545 174.03323364 173.079422   170.45640564
 170.73460388 171.87721252 174.30148315 176.1594696  176.10978699]
add_predicted_stock_price: [171.57913208 173.92396545 174.03323364 173.079422   170.45640564
 170.73460388 171.87721252 174.30148315 176.1594696  170.46351131]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
