Using device: cuda
[*********************100%***********************]  1 of 1 completed
Ticker            AAPL
Date
2012-05-18   15.978587
2012-05-21   16.909506
2012-05-22   16.779655
2012-05-23   17.189081
2012-05-24   17.031216
...                ...
2023-05-24  170.546951
2023-05-25  171.688309
2023-05-26  174.109924
2023-05-30  175.965881
2023-05-31  175.916245

[2776 rows x 1 columns]
/data/student/k2110261/Multi-iTransformer/optunademo.py:104: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df = df.fillna(method='ffill')  # ÂâçÊó•„ÅÆ„Éá„Éº„Çø„Çí‰ΩøÁî®
{'AAPL': Date
2012-05-18     18.353258
2012-05-21     18.337500
2012-05-22     18.321752
2012-05-23     18.306014
2012-05-24     18.290288
                 ...
2023-05-24    161.245439
2023-05-25    161.303011
2023-05-26    161.360578
2023-05-30    161.418142
2023-05-31    161.475702
Name: trend, Length: 2776, dtype: float64, 'DTWEXBGS': Date
2012-05-18     93.1395
2012-05-21     93.0945
2012-05-22     93.1113
2012-05-23     93.8855
2012-05-24     93.8027
                ...
2023-05-24    120.6481
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
Length: 2776, dtype: float64, 'VIXCLS': Date
2012-05-18    25.10
2012-05-21    22.01
2012-05-22    22.48
2012-05-23    22.33
2012-05-24    21.54
              ...
2023-05-24    20.03
2023-05-25    19.14
2023-05-26    17.95
2023-05-30    17.46
2023-05-31    17.94
Length: 2776, dtype: float64, 'DFII10': Date
2012-05-18   -0.39
2012-05-21   -0.41
2012-05-22   -0.38
2012-05-23   -0.41
2012-05-24   -0.37
              ...
2023-05-24    1.48
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
Length: 2776, dtype: float64, 'T10Y2Y': Date
2012-05-18    1.39
2012-05-21    1.45
2012-05-22    1.49
2012-05-23    1.45
2012-05-24    1.48
              ...
2023-05-24   -0.58
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
Length: 2776, dtype: float64}
AAPL„Å´„ÅÇ„Çã„Åå‰ªñ„ÅÆ„Éá„Éº„Çø1„Å´„ÅØ„Å™„ÅÑÊó•‰ªò: DatetimeIndex([], dtype='datetime64[ns]', name='Date', freq=None)
‰ªñ„ÅÆ„Éá„Éº„Çø1„Å´„ÅÇ„Çã„ÅåAAPL„Å´„ÅØ„Å™„ÅÑÊó•‰ªò: DatetimeIndex([], dtype='datetime64[ns]', name='Date', freq=None)
Price      BB_Upper BB_Lower BB_Middle MACD MACD_Signal MACD_Diff RSI SMA_50 SMA_200
Ticker
Date
2012-05-18      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
2012-05-21      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
2012-05-22      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
2012-05-23      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
2012-05-24      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
dict_items([('AAPL', Date
2013-03-07     15.555098
2013-03-08     15.542718
2013-03-11     15.530341
2013-03-12     15.517967
2013-03-13     15.505595
                 ...
2023-05-24    161.245439
2023-05-25    161.303011
2023-05-26    161.360578
2023-05-30    161.418142
2023-05-31    161.475702
Name: trend, Length: 2577, dtype: float64), ('DTWEXBGS', Date
2013-03-07     92.5462
2013-03-08     92.6252
2013-03-11     92.5351
2013-03-12     92.3853
2013-03-13     92.4709
                ...
2023-05-24    120.6481
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
Length: 2577, dtype: float64), ('VIXCLS', Date
2013-03-07    13.06
2013-03-08    12.59
2013-03-11    11.56
2013-03-12    12.27
2013-03-13    11.83
              ...
2023-05-24    20.03
2023-05-25    19.14
2023-05-26    17.95
2023-05-30    17.46
2023-05-31    17.94
Length: 2577, dtype: float64), ('DFII10', Date
2013-03-07   -0.56
2013-03-08   -0.50
2013-03-11   -0.50
2013-03-12   -0.52
2013-03-13   -0.52
              ...
2023-05-24    1.48
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
Length: 2577, dtype: float64), ('T10Y2Y', Date
2013-03-07    1.75
2013-03-08    1.79
2013-03-11    1.80
2013-03-12    1.76
2013-03-13    1.77
              ...
2023-05-24   -0.58
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
Length: 2577, dtype: float64)])
dict_items([('AAPL', Date
2013-03-07    -1.638749
2013-03-08    -1.643298
2013-03-11    -1.518012
2013-03-12    -1.644433
2013-03-13    -1.723842
                ...
2023-05-24    -6.702769
2023-05-25   -10.166891
2023-05-26   -10.041250
2023-05-30    -6.301073
2023-05-31    -3.029963
Name: season, Length: 2577, dtype: float64), ('DTWEXBGS', Date
2013-03-07     92.5462
2013-03-08     92.6252
2013-03-11     92.5351
2013-03-12     92.3853
2013-03-13     92.4709
                ...
2023-05-24    120.6481
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
Length: 2577, dtype: float64), ('VIXCLS', Date
2013-03-07    13.06
2013-03-08    12.59
2013-03-11    11.56
2013-03-12    12.27
2013-03-13    11.83
              ...
2023-05-24    20.03
2023-05-25    19.14
2023-05-26    17.95
2023-05-30    17.46
2023-05-31    17.94
Length: 2577, dtype: float64), ('DFII10', Date
2013-03-07   -0.56
2013-03-08   -0.50
2013-03-11   -0.50
2013-03-12   -0.52
2013-03-13   -0.52
              ...
2023-05-24    1.48
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
Length: 2577, dtype: float64), ('T10Y2Y', Date
2013-03-07    1.75
2013-03-08    1.79
2013-03-11    1.80
2013-03-12    1.76
2013-03-13    1.77
              ...
2023-05-24   -0.58
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
Length: 2577, dtype: float64)])
dict_items([('AAPL', Date
2013-03-07    -0.752929
2013-03-08    -0.701150
2013-03-11    -0.626046
2013-03-12    -0.775842
2013-03-13    -0.686509
                ...
2023-05-24    16.004282
2023-05-25    20.552189
2023-05-26    22.790596
2023-05-30    20.848812
2023-05-31    17.470505
Name: resid, Length: 2577, dtype: float64), ('DTWEXBGS', Date
2013-03-07     92.5462
2013-03-08     92.6252
2013-03-11     92.5351
2013-03-12     92.3853
2013-03-13     92.4709
                ...
2023-05-24    120.6481
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
Length: 2577, dtype: float64), ('VIXCLS', Date
2013-03-07    13.06
2013-03-08    12.59
2013-03-11    11.56
2013-03-12    12.27
2013-03-13    11.83
              ...
2023-05-24    20.03
2023-05-25    19.14
2023-05-26    17.95
2023-05-30    17.46
2023-05-31    17.94
Length: 2577, dtype: float64), ('DFII10', Date
2013-03-07   -0.56
2013-03-08   -0.50
2013-03-11   -0.50
2013-03-12   -0.52
2013-03-13   -0.52
              ...
2023-05-24    1.48
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
Length: 2577, dtype: float64), ('T10Y2Y', Date
2013-03-07    1.75
2013-03-08    1.79
2013-03-11    1.80
2013-03-12    1.76
2013-03-13    1.77
              ...
2023-05-24   -0.58
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
Length: 2577, dtype: float64)])
{'AAPL': Date
2013-03-07     15.555098
2013-03-08     15.542718
2013-03-11     15.530341
2013-03-12     15.517967
2013-03-13     15.505595
                 ...
2023-05-24    161.245439
2023-05-25    161.303011
2023-05-26    161.360578
2023-05-30    161.418142
2023-05-31    161.475702
Name: trend, Length: 2577, dtype: float64, 'DTWEXBGS': Date
2013-03-07     92.5462
2013-03-08     92.6252
2013-03-11     92.5351
2013-03-12     92.3853
2013-03-13     92.4709
                ...
2023-05-24    120.6481
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
Length: 2577, dtype: float64, 'VIXCLS': Date
2013-03-07    13.06
2013-03-08    12.59
2013-03-11    11.56
2013-03-12    12.27
2013-03-13    11.83
              ...
2023-05-24    20.03
2023-05-25    19.14
2023-05-26    17.95
2023-05-30    17.46
2023-05-31    17.94
Length: 2577, dtype: float64, 'DFII10': Date
2013-03-07   -0.56
2013-03-08   -0.50
2013-03-11   -0.50
2013-03-12   -0.52
2013-03-13   -0.52
              ...
2023-05-24    1.48
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
Length: 2577, dtype: float64, 'T10Y2Y': Date
2013-03-07    1.75
2013-03-08    1.79
2013-03-11    1.80
2013-03-12    1.76
2013-03-13    1.77
              ...
2023-05-24   -0.58
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
Length: 2577, dtype: float64, 'BB_Upper': Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    175.360197
2023-05-25    175.401886
2023-05-26    175.825122
2023-05-30    176.541933
2023-05-31    177.020401
Name: BB_Upper, Length: 2776, dtype: float64, 'BB_Lower': Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    165.081602
2023-05-25    165.517552
2023-05-26    165.688247
2023-05-30    165.759883
2023-05-31    166.168964
Name: BB_Lower, Length: 2776, dtype: float64, 'BB_Middle': Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    170.220899
2023-05-25    170.459719
2023-05-26    170.756685
2023-05-30    171.150908
2023-05-31    171.594682
Name: BB_Middle, Length: 2776, dtype: float64, 'MACD': Date
2012-05-18         NaN
2012-05-21         NaN
2012-05-22         NaN
2012-05-23         NaN
2012-05-24         NaN
                ...
2023-05-24    2.332938
2023-05-25    2.209841
2023-05-26    2.281391
2023-05-30    2.459504
2023-05-31    2.567063
Name: MACD, Length: 2776, dtype: float64, 'MACD_Signal': Date
2012-05-18         NaN
2012-05-21         NaN
2012-05-22         NaN
2012-05-23         NaN
2012-05-24         NaN
                ...
2023-05-24    2.724339
2023-05-25    2.621439
2023-05-26    2.553430
2023-05-30    2.534644
2023-05-31    2.541128
Name: MACD_Signal, Length: 2776, dtype: float64, 'MACD_Diff': Date
2012-05-18         NaN
2012-05-21         NaN
2012-05-22         NaN
2012-05-23         NaN
2012-05-24         NaN
                ...
2023-05-24   -0.391401
2023-05-25   -0.411598
2023-05-26   -0.272038
2023-05-30   -0.075140
2023-05-31    0.025935
Name: MACD_Diff, Length: 2776, dtype: float64, 'RSI': Date
2012-05-18          NaN
2012-05-21          NaN
2012-05-22          NaN
2012-05-23          NaN
2012-05-24          NaN
                ...
2023-05-24    55.867137
2023-05-25    58.637764
2023-05-26    63.826637
2023-05-30    67.220673
2023-05-31    67.039506
Name: RSI, Length: 2776, dtype: float64, 'SMA_50': Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    164.409244
2023-05-25    164.810429
2023-05-26    165.203355
2023-05-30    165.650248
2023-05-31    166.048576
Name: SMA_50, Length: 2776, dtype: float64, 'SMA_200': Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    150.685264
2023-05-25    150.729038
2023-05-26    150.763580
2023-05-30    150.811107
2023-05-31    150.840554
Name: SMA_200, Length: 2776, dtype: float64}
AAPL„Å´„ÅÇ„Çã„Åå‰ªñ„ÅÆ„Éá„Éº„Çø1„Å´„ÅØ„Å™„ÅÑÊó•‰ªò: DatetimeIndex([], dtype='datetime64[ns]', name='Date', freq=None)
AAPL null values:
0
DTWEXBGS null values:
0
VIXCLS null values:
0
DFII10 null values:
0
T10Y2Y null values:
0
BB_Upper null values:
19
BB_Lower null values:
19
BB_Middle null values:
19
MACD null values:
25
MACD_Signal null values:
33
MACD_Diff null values:
33
RSI null values:
13
SMA_50 null values:
49
SMA_200 null values:
199
[32m[I 2024-11-17 16:51:16,601][0m A new study created in memory with name: no-name-a8d3152a-9eb0-4b28-accf-1d1d048f63fb[0m
Non-A100 GPU detected, using math or mem efficient attention if input tensor is on cuda
/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/contextlib.py:105: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
[33m[W 2024-11-17 16:51:20,842][0m Trial 0 failed with parameters: {'observation_period_num': 51, 'train_rates': 0.7607672159522904, 'learning_rate': 4.391386258962138e-05, 'batch_size': 22, 'step_size': 2, 'gamma': 0.8134776783000541, 'depth': 5, 'dim': 82} because of the following error: The value nan is not acceptable.[0m
[33m[W 2024-11-17 16:51:20,842][0m Trial 0 failed with value nan.[0m
[32m[I 2024-11-17 16:51:20,843][0m A new study created in memory with name: no-name-720e4613-0241-433d-8be4-d1c76e8e300c[0m
[33m[W 2024-11-17 16:51:22,330][0m Trial 0 failed with parameters: {'observation_period_num': 135, 'train_rates': 0.6335775418660009, 'learning_rate': 7.75548864562421e-05, 'batch_size': 52, 'step_size': 8, 'gamma': 0.8017233738099001, 'depth': 6, 'dim': 187} because of the following error: The value nan is not acceptable.[0m
[33m[W 2024-11-17 16:51:22,331][0m Trial 0 failed with value nan.[0m
[32m[I 2024-11-17 16:51:22,331][0m A new study created in memory with name: no-name-325ef6e0-d62f-44c5-be5c-6c6809ab5986[0m
[33m[W 2024-11-17 16:51:23,187][0m Trial 0 failed with parameters: {'observation_period_num': 74, 'train_rates': 0.9465518135245662, 'learning_rate': 9.22050774961196e-05, 'batch_size': 239, 'step_size': 11, 'gamma': 0.7742749566625274, 'depth': 5, 'dim': 69} because of the following error: The value nan is not acceptable.[0m
[33m[W 2024-11-17 16:51:23,187][0m Trial 0 failed with value nan.[0m
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/optunademo.py", line 261, in <module>
    print("Best hyperparameters (trend):", study_trend.best_params)
                                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/study.py", line 119, in best_params
    return self.best_trial.params
           ^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/study.py", line 162, in best_trial
    best_trial = self._storage.get_best_trial(self._study_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/storages/_in_memory.py", line 232, in get_best_trial
    raise ValueError("No trials are completed yet.")
ValueError: No trials are completed yet.
