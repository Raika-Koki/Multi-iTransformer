[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 2.8392, 0.2427| Seasonal Loss: 1.0876, 0.6770| Residual Loss: 0.8103, 0.4453
Epoch 2/100, (Training, Validation) Trend Loss: 0.5372, 0.2448| Seasonal Loss: 0.4580, 0.6826| Residual Loss: 0.4393, 0.5568
Epoch 3/100, (Training, Validation) Trend Loss: 0.2890, 0.1693| Seasonal Loss: 0.4184, 0.3833| Residual Loss: 0.3749, 0.3134
Epoch 4/100, (Training, Validation) Trend Loss: 0.1987, 0.2256| Seasonal Loss: 0.3010, 0.4027| Residual Loss: 0.2718, 0.2705
Epoch 5/100, (Training, Validation) Trend Loss: 0.2496, 0.1477| Seasonal Loss: 0.2527, 0.2582| Residual Loss: 0.2165, 0.2075
Epoch 6/100, (Training, Validation) Trend Loss: 0.2103, 0.1423| Seasonal Loss: 0.2262, 0.2218| Residual Loss: 0.1942, 0.1685
Epoch 7/100, (Training, Validation) Trend Loss: 0.1614, 0.1094| Seasonal Loss: 0.1823, 0.2164| Residual Loss: 0.1701, 0.1458
Epoch 8/100, (Training, Validation) Trend Loss: 0.1210, 0.1841| Seasonal Loss: 0.1539, 0.1688| Residual Loss: 0.1747, 0.1374
Epoch 9/100, (Training, Validation) Trend Loss: 0.1243, 0.1254| Seasonal Loss: 0.1381, 0.1551| Residual Loss: 0.1674, 0.1281
Epoch 10/100, (Training, Validation) Trend Loss: 0.1090, 0.0935| Seasonal Loss: 0.1280, 0.1408| Residual Loss: 0.1838, 0.1204
Epoch 11/100, (Training, Validation) Trend Loss: 0.0753, 0.0837| Seasonal Loss: 0.1195, 0.1374| Residual Loss: 0.1483, 0.1341
Epoch 12/100, (Training, Validation) Trend Loss: 0.0500, 0.0640| Seasonal Loss: 0.1132, 0.1513| Residual Loss: 0.1427, 0.1274
Epoch 13/100, (Training, Validation) Trend Loss: 0.0528, 0.0749| Seasonal Loss: 0.1241, 0.1800| Residual Loss: 0.1396, 0.1470
Epoch 14/100, (Training, Validation) Trend Loss: 0.0407, 0.0440| Seasonal Loss: 0.1260, 0.2061| Residual Loss: 0.1398, 0.1173
Epoch 15/100, (Training, Validation) Trend Loss: 0.0475, 0.0677| Seasonal Loss: 0.1320, 0.1138| Residual Loss: 0.1222, 0.1016
Epoch 16/100, (Training, Validation) Trend Loss: 0.1016, 0.1245| Seasonal Loss: 0.0967, 0.1224| Residual Loss: 0.1149, 0.0992
Epoch 17/100, (Training, Validation) Trend Loss: 0.2126, 0.1411| Seasonal Loss: 0.0856, 0.1136| Residual Loss: 0.1107, 0.0973
Epoch 18/100, (Training, Validation) Trend Loss: 0.1349, 0.0888| Seasonal Loss: 0.0805, 0.1054| Residual Loss: 0.1059, 0.0933
Epoch 19/100, (Training, Validation) Trend Loss: 0.0930, 0.0679| Seasonal Loss: 0.0730, 0.1081| Residual Loss: 0.1032, 0.0896
Epoch 20/100, (Training, Validation) Trend Loss: 0.0868, 0.0676| Seasonal Loss: 0.0692, 0.0971| Residual Loss: 0.0995, 0.0875
Epoch 21/100, (Training, Validation) Trend Loss: 0.0642, 0.0320| Seasonal Loss: 0.0643, 0.0926| Residual Loss: 0.0967, 0.0861
Epoch 22/100, (Training, Validation) Trend Loss: 0.0543, 0.0346| Seasonal Loss: 0.0606, 0.0917| Residual Loss: 0.0950, 0.0843
Epoch 23/100, (Training, Validation) Trend Loss: 0.0408, 0.0326| Seasonal Loss: 0.0580, 0.0860| Residual Loss: 0.0924, 0.0832
Epoch 24/100, (Training, Validation) Trend Loss: 0.0372, 0.0274| Seasonal Loss: 0.0560, 0.0855| Residual Loss: 0.0910, 0.0818
Epoch 25/100, (Training, Validation) Trend Loss: 0.0325, 0.0285| Seasonal Loss: 0.0543, 0.0822| Residual Loss: 0.0887, 0.0813
Epoch 26/100, (Training, Validation) Trend Loss: 0.0298, 0.0251| Seasonal Loss: 0.0533, 0.0822| Residual Loss: 0.0876, 0.0803
Epoch 27/100, (Training, Validation) Trend Loss: 0.0266, 0.0228| Seasonal Loss: 0.0539, 0.0810| Residual Loss: 0.0856, 0.0800
Epoch 28/100, (Training, Validation) Trend Loss: 0.0249, 0.0232| Seasonal Loss: 0.0535, 0.0806| Residual Loss: 0.0848, 0.0796
Epoch 29/100, (Training, Validation) Trend Loss: 0.0231, 0.0199| Seasonal Loss: 0.0540, 0.0804| Residual Loss: 0.0832, 0.0787
Epoch 30/100, (Training, Validation) Trend Loss: 0.0221, 0.0221| Seasonal Loss: 0.0502, 0.0774| Residual Loss: 0.0836, 0.0806
Epoch 31/100, (Training, Validation) Trend Loss: 0.0205, 0.0178| Seasonal Loss: 0.0469, 0.0775| Residual Loss: 0.0869, 0.0780
Epoch 32/100, (Training, Validation) Trend Loss: 0.0207, 0.0231| Seasonal Loss: 0.0436, 0.0748| Residual Loss: 0.1019, 0.0842
Epoch 33/100, (Training, Validation) Trend Loss: 0.0199, 0.0173| Seasonal Loss: 0.0423, 0.0748| Residual Loss: 0.1233, 0.0815
Epoch 34/100, (Training, Validation) Trend Loss: 0.0229, 0.0317| Seasonal Loss: 0.0416, 0.0746| Residual Loss: 0.0998, 0.0807
Epoch 35/100, (Training, Validation) Trend Loss: 0.0254, 0.0211| Seasonal Loss: 0.0405, 0.0733| Residual Loss: 0.0836, 0.0805
Epoch 36/100, (Training, Validation) Trend Loss: 0.0304, 0.0331| Seasonal Loss: 0.0398, 0.0730| Residual Loss: 0.0859, 0.0783
Epoch 37/100, (Training, Validation) Trend Loss: 0.0277, 0.0144| Seasonal Loss: 0.0389, 0.0721| Residual Loss: 0.0791, 0.0770
Epoch 38/100, (Training, Validation) Trend Loss: 0.0243, 0.0164| Seasonal Loss: 0.0382, 0.0716| Residual Loss: 0.0796, 0.0766
Epoch 39/100, (Training, Validation) Trend Loss: 0.0210, 0.0219| Seasonal Loss: 0.0375, 0.0712| Residual Loss: 0.0773, 0.0771
Epoch 40/100, (Training, Validation) Trend Loss: 0.0186, 0.0155| Seasonal Loss: 0.0369, 0.0706| Residual Loss: 0.0764, 0.0761
Epoch 41/100, (Training, Validation) Trend Loss: 0.0169, 0.0166| Seasonal Loss: 0.0364, 0.0702| Residual Loss: 0.0756, 0.0759
Epoch 42/100, (Training, Validation) Trend Loss: 0.0162, 0.0173| Seasonal Loss: 0.0358, 0.0698| Residual Loss: 0.0748, 0.0763
Epoch 43/100, (Training, Validation) Trend Loss: 0.0156, 0.0153| Seasonal Loss: 0.0354, 0.0694| Residual Loss: 0.0742, 0.0762
Epoch 44/100, (Training, Validation) Trend Loss: 0.0155, 0.0151| Seasonal Loss: 0.0349, 0.0691| Residual Loss: 0.0735, 0.0759
Epoch 45/100, (Training, Validation) Trend Loss: 0.0151, 0.0153| Seasonal Loss: 0.0345, 0.0688| Residual Loss: 0.0730, 0.0758
Epoch 46/100, (Training, Validation) Trend Loss: 0.0148, 0.0146| Seasonal Loss: 0.0341, 0.0685| Residual Loss: 0.0724, 0.0758
Epoch 47/100, (Training, Validation) Trend Loss: 0.0146, 0.0144| Seasonal Loss: 0.0337, 0.0682| Residual Loss: 0.0719, 0.0757
Epoch 48/100, (Training, Validation) Trend Loss: 0.0143, 0.0145| Seasonal Loss: 0.0334, 0.0679| Residual Loss: 0.0714, 0.0755
Epoch 49/100, (Training, Validation) Trend Loss: 0.0141, 0.0141| Seasonal Loss: 0.0330, 0.0677| Residual Loss: 0.0710, 0.0755
Epoch 50/100, (Training, Validation) Trend Loss: 0.0139, 0.0140| Seasonal Loss: 0.0327, 0.0675| Residual Loss: 0.0706, 0.0754
Epoch 51/100, (Training, Validation) Trend Loss: 0.0138, 0.0140| Seasonal Loss: 0.0324, 0.0673| Residual Loss: 0.0701, 0.0753
Epoch 52/100, (Training, Validation) Trend Loss: 0.0136, 0.0138| Seasonal Loss: 0.0322, 0.0671| Residual Loss: 0.0698, 0.0753
Epoch 53/100, (Training, Validation) Trend Loss: 0.0135, 0.0137| Seasonal Loss: 0.0319, 0.0669| Residual Loss: 0.0694, 0.0752
Epoch 54/100, (Training, Validation) Trend Loss: 0.0134, 0.0136| Seasonal Loss: 0.0317, 0.0667| Residual Loss: 0.0690, 0.0752
Epoch 55/100, (Training, Validation) Trend Loss: 0.0133, 0.0135| Seasonal Loss: 0.0314, 0.0666| Residual Loss: 0.0687, 0.0752
Epoch 56/100, (Training, Validation) Trend Loss: 0.0131, 0.0134| Seasonal Loss: 0.0312, 0.0664| Residual Loss: 0.0684, 0.0751
Epoch 57/100, (Training, Validation) Trend Loss: 0.0131, 0.0133| Seasonal Loss: 0.0310, 0.0663| Residual Loss: 0.0681, 0.0751
Epoch 58/100, (Training, Validation) Trend Loss: 0.0130, 0.0132| Seasonal Loss: 0.0308, 0.0661| Residual Loss: 0.0678, 0.0751
Epoch 59/100, (Training, Validation) Trend Loss: 0.0129, 0.0132| Seasonal Loss: 0.0306, 0.0660| Residual Loss: 0.0675, 0.0751
Epoch 60/100, (Training, Validation) Trend Loss: 0.0128, 0.0131| Seasonal Loss: 0.0305, 0.0659| Residual Loss: 0.0673, 0.0751
Epoch 61/100, (Training, Validation) Trend Loss: 0.0127, 0.0130| Seasonal Loss: 0.0303, 0.0658| Residual Loss: 0.0670, 0.0750
Epoch 62/100, (Training, Validation) Trend Loss: 0.0127, 0.0130| Seasonal Loss: 0.0301, 0.0657| Residual Loss: 0.0668, 0.0750
Epoch 63/100, (Training, Validation) Trend Loss: 0.0126, 0.0129| Seasonal Loss: 0.0300, 0.0656| Residual Loss: 0.0666, 0.0750
Epoch 64/100, (Training, Validation) Trend Loss: 0.0125, 0.0129| Seasonal Loss: 0.0298, 0.0655| Residual Loss: 0.0663, 0.0750
Epoch 65/100, (Training, Validation) Trend Loss: 0.0125, 0.0128| Seasonal Loss: 0.0297, 0.0654| Residual Loss: 0.0661, 0.0750
Epoch 66/100, (Training, Validation) Trend Loss: 0.0124, 0.0128| Seasonal Loss: 0.0296, 0.0653| Residual Loss: 0.0659, 0.0750
Epoch 67/100, (Training, Validation) Trend Loss: 0.0124, 0.0127| Seasonal Loss: 0.0295, 0.0653| Residual Loss: 0.0657, 0.0750
Epoch 68/100, (Training, Validation) Trend Loss: 0.0123, 0.0127| Seasonal Loss: 0.0294, 0.0652| Residual Loss: 0.0656, 0.0750
Epoch 69/100, (Training, Validation) Trend Loss: 0.0123, 0.0127| Seasonal Loss: 0.0292, 0.0651| Residual Loss: 0.0654, 0.0750
Epoch 70/100, (Training, Validation) Trend Loss: 0.0122, 0.0126| Seasonal Loss: 0.0291, 0.0651| Residual Loss: 0.0652, 0.0750
Epoch 71/100, (Training, Validation) Trend Loss: 0.0122, 0.0126| Seasonal Loss: 0.0290, 0.0650| Residual Loss: 0.0651, 0.0750
Epoch 72/100, (Training, Validation) Trend Loss: 0.0122, 0.0126| Seasonal Loss: 0.0289, 0.0649| Residual Loss: 0.0649, 0.0750
Epoch 73/100, (Training, Validation) Trend Loss: 0.0121, 0.0125| Seasonal Loss: 0.0289, 0.0649| Residual Loss: 0.0648, 0.0749
Epoch 74/100, (Training, Validation) Trend Loss: 0.0121, 0.0125| Seasonal Loss: 0.0288, 0.0648| Residual Loss: 0.0647, 0.0749
Epoch 75/100, (Training, Validation) Trend Loss: 0.0121, 0.0125| Seasonal Loss: 0.0287, 0.0648| Residual Loss: 0.0645, 0.0749
Epoch 76/100, (Training, Validation) Trend Loss: 0.0120, 0.0124| Seasonal Loss: 0.0286, 0.0648| Residual Loss: 0.0644, 0.0749
Epoch 77/100, (Training, Validation) Trend Loss: 0.0120, 0.0124| Seasonal Loss: 0.0286, 0.0647| Residual Loss: 0.0643, 0.0749
Epoch 78/100, (Training, Validation) Trend Loss: 0.0120, 0.0124| Seasonal Loss: 0.0285, 0.0647| Residual Loss: 0.0642, 0.0749
Epoch 79/100, (Training, Validation) Trend Loss: 0.0120, 0.0124| Seasonal Loss: 0.0284, 0.0646| Residual Loss: 0.0641, 0.0749
Epoch 80/100, (Training, Validation) Trend Loss: 0.0119, 0.0124| Seasonal Loss: 0.0284, 0.0646| Residual Loss: 0.0640, 0.0749
Epoch 81/100, (Training, Validation) Trend Loss: 0.0119, 0.0123| Seasonal Loss: 0.0283, 0.0646| Residual Loss: 0.0639, 0.0749
Epoch 82/100, (Training, Validation) Trend Loss: 0.0119, 0.0123| Seasonal Loss: 0.0282, 0.0645| Residual Loss: 0.0638, 0.0749
Epoch 83/100, (Training, Validation) Trend Loss: 0.0119, 0.0123| Seasonal Loss: 0.0282, 0.0645| Residual Loss: 0.0637, 0.0749
Epoch 84/100, (Training, Validation) Trend Loss: 0.0119, 0.0123| Seasonal Loss: 0.0281, 0.0645| Residual Loss: 0.0636, 0.0749
Epoch 85/100, (Training, Validation) Trend Loss: 0.0118, 0.0123| Seasonal Loss: 0.0281, 0.0644| Residual Loss: 0.0635, 0.0749
Epoch 86/100, (Training, Validation) Trend Loss: 0.0118, 0.0122| Seasonal Loss: 0.0280, 0.0644| Residual Loss: 0.0634, 0.0749
Epoch 87/100, (Training, Validation) Trend Loss: 0.0118, 0.0122| Seasonal Loss: 0.0280, 0.0644| Residual Loss: 0.0634, 0.0749
Epoch 88/100, (Training, Validation) Trend Loss: 0.0118, 0.0122| Seasonal Loss: 0.0280, 0.0644| Residual Loss: 0.0633, 0.0749
Epoch 89/100, (Training, Validation) Trend Loss: 0.0118, 0.0122| Seasonal Loss: 0.0279, 0.0643| Residual Loss: 0.0632, 0.0749
Epoch 90/100, (Training, Validation) Trend Loss: 0.0118, 0.0122| Seasonal Loss: 0.0279, 0.0643| Residual Loss: 0.0632, 0.0749
Epoch 91/100, (Training, Validation) Trend Loss: 0.0117, 0.0122| Seasonal Loss: 0.0278, 0.0643| Residual Loss: 0.0631, 0.0749
Epoch 92/100, (Training, Validation) Trend Loss: 0.0117, 0.0122| Seasonal Loss: 0.0278, 0.0643| Residual Loss: 0.0631, 0.0749
Epoch 93/100, (Training, Validation) Trend Loss: 0.0117, 0.0122| Seasonal Loss: 0.0278, 0.0643| Residual Loss: 0.0630, 0.0749
Epoch 94/100, (Training, Validation) Trend Loss: 0.0117, 0.0122| Seasonal Loss: 0.0277, 0.0642| Residual Loss: 0.0630, 0.0749
Epoch 95/100, (Training, Validation) Trend Loss: 0.0117, 0.0121| Seasonal Loss: 0.0277, 0.0642| Residual Loss: 0.0629, 0.0749
Epoch 96/100, (Training, Validation) Trend Loss: 0.0117, 0.0121| Seasonal Loss: 0.0277, 0.0642| Residual Loss: 0.0629, 0.0749
Epoch 97/100, (Training, Validation) Trend Loss: 0.0117, 0.0121| Seasonal Loss: 0.0277, 0.0642| Residual Loss: 0.0628, 0.0749
Epoch 98/100, (Training, Validation) Trend Loss: 0.0117, 0.0121| Seasonal Loss: 0.0276, 0.0642| Residual Loss: 0.0628, 0.0749
Epoch 99/100, (Training, Validation) Trend Loss: 0.0117, 0.0121| Seasonal Loss: 0.0276, 0.0642| Residual Loss: 0.0627, 0.0749
Epoch 100/100, (Training, Validation) Trend Loss: 0.0116, 0.0121| Seasonal Loss: 0.0276, 0.0642| Residual Loss: 0.0627, 0.0749
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[169.6244917]
[-1.63175619]
[-0.68874966]
[167.30398585]
actual_stock_price: [171.57913208 173.92396545 174.03323364 173.079422   170.45639038
 170.73460388 171.87722778 174.30149841 176.1594696  176.10978699]
add_predicted_stock_price: [171.57913208 173.92396545 174.03323364 173.079422   170.45639038
 170.73460388 171.87722778 174.30149841 176.1594696  167.30398585]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
