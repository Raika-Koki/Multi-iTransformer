[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.8541, 0.3367| Seasonal Loss: 0.6480, 0.4431| Residual Loss: 1.1086, 0.5701
Epoch 2/100, (Training, Validation) Trend Loss: 0.2829, 0.1874| Seasonal Loss: 0.3483, 0.3902| Residual Loss: 0.5201, 0.2844
Epoch 3/100, (Training, Validation) Trend Loss: 0.2208, 0.1858| Seasonal Loss: 0.3264, 0.3237| Residual Loss: 0.3162, 0.2687
Epoch 4/100, (Training, Validation) Trend Loss: 0.1613, 0.1342| Seasonal Loss: 0.2597, 0.2455| Residual Loss: 0.2517, 0.2160
Epoch 5/100, (Training, Validation) Trend Loss: 0.1241, 0.1326| Seasonal Loss: 0.2048, 0.2100| Residual Loss: 0.2232, 0.1957
Epoch 6/100, (Training, Validation) Trend Loss: 0.1124, 0.1207| Seasonal Loss: 0.1743, 0.1741| Residual Loss: 0.1991, 0.1787
Epoch 7/100, (Training, Validation) Trend Loss: 0.0950, 0.1021| Seasonal Loss: 0.1524, 0.1576| Residual Loss: 0.1819, 0.1591
Epoch 8/100, (Training, Validation) Trend Loss: 0.0807, 0.0883| Seasonal Loss: 0.1369, 0.1467| Residual Loss: 0.1660, 0.1463
Epoch 9/100, (Training, Validation) Trend Loss: 0.0670, 0.0777| Seasonal Loss: 0.1294, 0.1492| Residual Loss: 0.1526, 0.1328
Epoch 10/100, (Training, Validation) Trend Loss: 0.0561, 0.0609| Seasonal Loss: 0.1265, 0.1750| Residual Loss: 0.1421, 0.1256
Epoch 11/100, (Training, Validation) Trend Loss: 0.0468, 0.0577| Seasonal Loss: 0.1415, 0.2414| Residual Loss: 0.1328, 0.1157
Epoch 12/100, (Training, Validation) Trend Loss: 0.0439, 0.0450| Seasonal Loss: 0.1565, 0.2680| Residual Loss: 0.1279, 0.1157
Epoch 13/100, (Training, Validation) Trend Loss: 0.0402, 0.0471| Seasonal Loss: 0.1693, 0.1761| Residual Loss: 0.1211, 0.1065
Epoch 14/100, (Training, Validation) Trend Loss: 0.0492, 0.0781| Seasonal Loss: 0.1814, 0.1306| Residual Loss: 0.1227, 0.1168
Epoch 15/100, (Training, Validation) Trend Loss: 0.0664, 0.1219| Seasonal Loss: 0.1873, 0.1415| Residual Loss: 0.1191, 0.1089
Epoch 16/100, (Training, Validation) Trend Loss: 0.1333, 0.2356| Seasonal Loss: 0.1225, 0.1444| Residual Loss: 0.1357, 0.1633
Epoch 17/100, (Training, Validation) Trend Loss: 0.1544, 0.0913| Seasonal Loss: 0.1054, 0.1256| Residual Loss: 0.1543, 0.1797
Epoch 18/100, (Training, Validation) Trend Loss: 0.1138, 0.0570| Seasonal Loss: 0.0954, 0.1200| Residual Loss: 0.2022, 0.2063
Epoch 19/100, (Training, Validation) Trend Loss: 0.0571, 0.0706| Seasonal Loss: 0.0879, 0.1195| Residual Loss: 0.2149, 0.1168
Epoch 20/100, (Training, Validation) Trend Loss: 0.0481, 0.0551| Seasonal Loss: 0.0835, 0.1160| Residual Loss: 0.1587, 0.1107
Epoch 21/100, (Training, Validation) Trend Loss: 0.0421, 0.0477| Seasonal Loss: 0.0795, 0.1134| Residual Loss: 0.1234, 0.1109
Epoch 22/100, (Training, Validation) Trend Loss: 0.0382, 0.0477| Seasonal Loss: 0.0761, 0.1121| Residual Loss: 0.1187, 0.1020
Epoch 23/100, (Training, Validation) Trend Loss: 0.0345, 0.0464| Seasonal Loss: 0.0733, 0.1104| Residual Loss: 0.1113, 0.0965
Epoch 24/100, (Training, Validation) Trend Loss: 0.0324, 0.0415| Seasonal Loss: 0.0707, 0.1091| Residual Loss: 0.1073, 0.0949
Epoch 25/100, (Training, Validation) Trend Loss: 0.0308, 0.0394| Seasonal Loss: 0.0684, 0.1080| Residual Loss: 0.1042, 0.0924
Epoch 26/100, (Training, Validation) Trend Loss: 0.0295, 0.0377| Seasonal Loss: 0.0664, 0.1069| Residual Loss: 0.1018, 0.0904
Epoch 27/100, (Training, Validation) Trend Loss: 0.0284, 0.0356| Seasonal Loss: 0.0645, 0.1060| Residual Loss: 0.1000, 0.0895
Epoch 28/100, (Training, Validation) Trend Loss: 0.0275, 0.0342| Seasonal Loss: 0.0628, 0.1053| Residual Loss: 0.0985, 0.0884
Epoch 29/100, (Training, Validation) Trend Loss: 0.0268, 0.0331| Seasonal Loss: 0.0612, 0.1046| Residual Loss: 0.0972, 0.0876
Epoch 30/100, (Training, Validation) Trend Loss: 0.0261, 0.0320| Seasonal Loss: 0.0597, 0.1040| Residual Loss: 0.0960, 0.0870
Epoch 31/100, (Training, Validation) Trend Loss: 0.0256, 0.0312| Seasonal Loss: 0.0584, 0.1034| Residual Loss: 0.0950, 0.0864
Epoch 32/100, (Training, Validation) Trend Loss: 0.0251, 0.0305| Seasonal Loss: 0.0571, 0.1029| Residual Loss: 0.0940, 0.0859
Epoch 33/100, (Training, Validation) Trend Loss: 0.0246, 0.0299| Seasonal Loss: 0.0560, 0.1025| Residual Loss: 0.0931, 0.0854
Epoch 34/100, (Training, Validation) Trend Loss: 0.0242, 0.0294| Seasonal Loss: 0.0550, 0.1021| Residual Loss: 0.0923, 0.0850
Epoch 35/100, (Training, Validation) Trend Loss: 0.0239, 0.0289| Seasonal Loss: 0.0540, 0.1017| Residual Loss: 0.0916, 0.0846
Epoch 36/100, (Training, Validation) Trend Loss: 0.0235, 0.0285| Seasonal Loss: 0.0531, 0.1014| Residual Loss: 0.0909, 0.0842
Epoch 37/100, (Training, Validation) Trend Loss: 0.0232, 0.0281| Seasonal Loss: 0.0522, 0.1011| Residual Loss: 0.0902, 0.0839
Epoch 38/100, (Training, Validation) Trend Loss: 0.0229, 0.0277| Seasonal Loss: 0.0515, 0.1008| Residual Loss: 0.0896, 0.0836
Epoch 39/100, (Training, Validation) Trend Loss: 0.0227, 0.0274| Seasonal Loss: 0.0507, 0.1006| Residual Loss: 0.0890, 0.0833
Epoch 40/100, (Training, Validation) Trend Loss: 0.0224, 0.0271| Seasonal Loss: 0.0501, 0.1004| Residual Loss: 0.0885, 0.0830
Epoch 41/100, (Training, Validation) Trend Loss: 0.0222, 0.0268| Seasonal Loss: 0.0494, 0.1002| Residual Loss: 0.0880, 0.0828
Epoch 42/100, (Training, Validation) Trend Loss: 0.0220, 0.0266| Seasonal Loss: 0.0488, 0.1000| Residual Loss: 0.0875, 0.0825
Epoch 43/100, (Training, Validation) Trend Loss: 0.0218, 0.0264| Seasonal Loss: 0.0483, 0.0998| Residual Loss: 0.0870, 0.0823
Epoch 44/100, (Training, Validation) Trend Loss: 0.0216, 0.0262| Seasonal Loss: 0.0478, 0.0996| Residual Loss: 0.0866, 0.0821
Epoch 45/100, (Training, Validation) Trend Loss: 0.0214, 0.0260| Seasonal Loss: 0.0473, 0.0995| Residual Loss: 0.0862, 0.0819
Epoch 46/100, (Training, Validation) Trend Loss: 0.0212, 0.0258| Seasonal Loss: 0.0468, 0.0993| Residual Loss: 0.0858, 0.0818
Epoch 47/100, (Training, Validation) Trend Loss: 0.0211, 0.0256| Seasonal Loss: 0.0464, 0.0992| Residual Loss: 0.0854, 0.0816
Epoch 48/100, (Training, Validation) Trend Loss: 0.0209, 0.0254| Seasonal Loss: 0.0460, 0.0991| Residual Loss: 0.0851, 0.0814
Epoch 49/100, (Training, Validation) Trend Loss: 0.0208, 0.0253| Seasonal Loss: 0.0456, 0.0990| Residual Loss: 0.0848, 0.0813
Epoch 50/100, (Training, Validation) Trend Loss: 0.0206, 0.0251| Seasonal Loss: 0.0453, 0.0989| Residual Loss: 0.0845, 0.0812
Epoch 51/100, (Training, Validation) Trend Loss: 0.0205, 0.0250| Seasonal Loss: 0.0449, 0.0988| Residual Loss: 0.0842, 0.0810
Epoch 52/100, (Training, Validation) Trend Loss: 0.0204, 0.0249| Seasonal Loss: 0.0446, 0.0987| Residual Loss: 0.0839, 0.0809
Epoch 53/100, (Training, Validation) Trend Loss: 0.0203, 0.0247| Seasonal Loss: 0.0443, 0.0986| Residual Loss: 0.0836, 0.0808
Epoch 54/100, (Training, Validation) Trend Loss: 0.0202, 0.0246| Seasonal Loss: 0.0440, 0.0985| Residual Loss: 0.0834, 0.0807
Epoch 55/100, (Training, Validation) Trend Loss: 0.0201, 0.0245| Seasonal Loss: 0.0438, 0.0984| Residual Loss: 0.0831, 0.0806
Epoch 56/100, (Training, Validation) Trend Loss: 0.0200, 0.0244| Seasonal Loss: 0.0435, 0.0984| Residual Loss: 0.0829, 0.0805
Epoch 57/100, (Training, Validation) Trend Loss: 0.0199, 0.0243| Seasonal Loss: 0.0433, 0.0983| Residual Loss: 0.0827, 0.0804
Epoch 58/100, (Training, Validation) Trend Loss: 0.0198, 0.0242| Seasonal Loss: 0.0430, 0.0982| Residual Loss: 0.0825, 0.0803
Epoch 59/100, (Training, Validation) Trend Loss: 0.0197, 0.0241| Seasonal Loss: 0.0428, 0.0982| Residual Loss: 0.0823, 0.0802
Epoch 60/100, (Training, Validation) Trend Loss: 0.0197, 0.0241| Seasonal Loss: 0.0426, 0.0981| Residual Loss: 0.0821, 0.0802
Epoch 61/100, (Training, Validation) Trend Loss: 0.0196, 0.0240| Seasonal Loss: 0.0424, 0.0980| Residual Loss: 0.0819, 0.0801
Epoch 62/100, (Training, Validation) Trend Loss: 0.0195, 0.0239| Seasonal Loss: 0.0422, 0.0980| Residual Loss: 0.0817, 0.0800
Epoch 63/100, (Training, Validation) Trend Loss: 0.0194, 0.0238| Seasonal Loss: 0.0421, 0.0979| Residual Loss: 0.0816, 0.0800
Epoch 64/100, (Training, Validation) Trend Loss: 0.0194, 0.0238| Seasonal Loss: 0.0419, 0.0979| Residual Loss: 0.0814, 0.0799
Epoch 65/100, (Training, Validation) Trend Loss: 0.0193, 0.0237| Seasonal Loss: 0.0417, 0.0979| Residual Loss: 0.0813, 0.0799
Epoch 66/100, (Training, Validation) Trend Loss: 0.0193, 0.0236| Seasonal Loss: 0.0416, 0.0978| Residual Loss: 0.0811, 0.0798
Epoch 67/100, (Training, Validation) Trend Loss: 0.0192, 0.0236| Seasonal Loss: 0.0415, 0.0978| Residual Loss: 0.0810, 0.0797
Epoch 68/100, (Training, Validation) Trend Loss: 0.0192, 0.0235| Seasonal Loss: 0.0413, 0.0977| Residual Loss: 0.0809, 0.0797
Epoch 69/100, (Training, Validation) Trend Loss: 0.0191, 0.0235| Seasonal Loss: 0.0412, 0.0977| Residual Loss: 0.0807, 0.0796
Epoch 70/100, (Training, Validation) Trend Loss: 0.0191, 0.0234| Seasonal Loss: 0.0411, 0.0977| Residual Loss: 0.0806, 0.0796
Epoch 71/100, (Training, Validation) Trend Loss: 0.0190, 0.0234| Seasonal Loss: 0.0410, 0.0976| Residual Loss: 0.0805, 0.0796
Epoch 72/100, (Training, Validation) Trend Loss: 0.0190, 0.0233| Seasonal Loss: 0.0409, 0.0976| Residual Loss: 0.0804, 0.0795
Epoch 73/100, (Training, Validation) Trend Loss: 0.0189, 0.0233| Seasonal Loss: 0.0407, 0.0976| Residual Loss: 0.0803, 0.0795
Epoch 74/100, (Training, Validation) Trend Loss: 0.0189, 0.0232| Seasonal Loss: 0.0406, 0.0975| Residual Loss: 0.0802, 0.0794
Epoch 75/100, (Training, Validation) Trend Loss: 0.0189, 0.0232| Seasonal Loss: 0.0406, 0.0975| Residual Loss: 0.0801, 0.0794
Epoch 76/100, (Training, Validation) Trend Loss: 0.0188, 0.0232| Seasonal Loss: 0.0405, 0.0975| Residual Loss: 0.0800, 0.0794
Epoch 77/100, (Training, Validation) Trend Loss: 0.0188, 0.0231| Seasonal Loss: 0.0404, 0.0975| Residual Loss: 0.0800, 0.0793
Epoch 78/100, (Training, Validation) Trend Loss: 0.0188, 0.0231| Seasonal Loss: 0.0403, 0.0974| Residual Loss: 0.0799, 0.0793
Epoch 79/100, (Training, Validation) Trend Loss: 0.0187, 0.0230| Seasonal Loss: 0.0402, 0.0974| Residual Loss: 0.0798, 0.0793
Epoch 80/100, (Training, Validation) Trend Loss: 0.0187, 0.0230| Seasonal Loss: 0.0401, 0.0974| Residual Loss: 0.0797, 0.0793
Epoch 81/100, (Training, Validation) Trend Loss: 0.0187, 0.0230| Seasonal Loss: 0.0401, 0.0974| Residual Loss: 0.0797, 0.0792
Epoch 82/100, (Training, Validation) Trend Loss: 0.0187, 0.0230| Seasonal Loss: 0.0400, 0.0974| Residual Loss: 0.0796, 0.0792
Epoch 83/100, (Training, Validation) Trend Loss: 0.0186, 0.0229| Seasonal Loss: 0.0400, 0.0973| Residual Loss: 0.0795, 0.0792
Epoch 84/100, (Training, Validation) Trend Loss: 0.0186, 0.0229| Seasonal Loss: 0.0399, 0.0973| Residual Loss: 0.0795, 0.0792
Epoch 85/100, (Training, Validation) Trend Loss: 0.0186, 0.0229| Seasonal Loss: 0.0398, 0.0973| Residual Loss: 0.0794, 0.0791
Epoch 86/100, (Training, Validation) Trend Loss: 0.0186, 0.0229| Seasonal Loss: 0.0398, 0.0973| Residual Loss: 0.0794, 0.0791
Epoch 87/100, (Training, Validation) Trend Loss: 0.0185, 0.0228| Seasonal Loss: 0.0397, 0.0973| Residual Loss: 0.0793, 0.0791
Epoch 88/100, (Training, Validation) Trend Loss: 0.0185, 0.0228| Seasonal Loss: 0.0397, 0.0973| Residual Loss: 0.0793, 0.0791
Epoch 89/100, (Training, Validation) Trend Loss: 0.0185, 0.0228| Seasonal Loss: 0.0396, 0.0973| Residual Loss: 0.0792, 0.0791
Epoch 90/100, (Training, Validation) Trend Loss: 0.0185, 0.0228| Seasonal Loss: 0.0396, 0.0972| Residual Loss: 0.0792, 0.0791
Epoch 91/100, (Training, Validation) Trend Loss: 0.0185, 0.0228| Seasonal Loss: 0.0395, 0.0972| Residual Loss: 0.0791, 0.0790
Epoch 92/100, (Training, Validation) Trend Loss: 0.0185, 0.0227| Seasonal Loss: 0.0395, 0.0972| Residual Loss: 0.0791, 0.0790
Epoch 93/100, (Training, Validation) Trend Loss: 0.0184, 0.0227| Seasonal Loss: 0.0395, 0.0972| Residual Loss: 0.0791, 0.0790
Epoch 94/100, (Training, Validation) Trend Loss: 0.0184, 0.0227| Seasonal Loss: 0.0394, 0.0972| Residual Loss: 0.0790, 0.0790
Epoch 95/100, (Training, Validation) Trend Loss: 0.0184, 0.0227| Seasonal Loss: 0.0394, 0.0972| Residual Loss: 0.0790, 0.0790
Epoch 96/100, (Training, Validation) Trend Loss: 0.0184, 0.0227| Seasonal Loss: 0.0394, 0.0972| Residual Loss: 0.0789, 0.0790
Epoch 97/100, (Training, Validation) Trend Loss: 0.0184, 0.0227| Seasonal Loss: 0.0393, 0.0972| Residual Loss: 0.0789, 0.0790
Epoch 98/100, (Training, Validation) Trend Loss: 0.0184, 0.0226| Seasonal Loss: 0.0393, 0.0972| Residual Loss: 0.0789, 0.0789
Epoch 99/100, (Training, Validation) Trend Loss: 0.0184, 0.0226| Seasonal Loss: 0.0393, 0.0971| Residual Loss: 0.0789, 0.0789
Epoch 100/100, (Training, Validation) Trend Loss: 0.0184, 0.0226| Seasonal Loss: 0.0392, 0.0971| Residual Loss: 0.0788, 0.0789
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:189: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:190: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[168.81521976]
[-0.20328068]
[0.75564164]
[169.36758072]
stock_trend: Date
2019-12-31     78.597356
2020-01-02     78.442419
2020-01-03     78.286281
2020-01-06     78.128847
2020-01-07     77.970023
                 ...
2023-05-24    173.117853
2023-05-25    173.456803
2023-05-26    173.795649
2023-05-30    174.134454
2023-05-31    174.473269
Name: trend, Length: 860, dtype: float64
actual_stock_price: [171.57914734 173.92393494 174.0332489  173.07940674 170.4564209
 170.73458862 171.87719727 174.30151367 176.1594696  176.10980225]
add_predicted_stock_price: [171.57914734 173.92393494 174.0332489  173.07940674 170.4564209
 170.73458862 171.87719727 174.30151367 176.1594696  169.36758072]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:237: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
