Using device: cuda
[*********************100%***********************]  1 of 1 completed
Ticker            AAPL
Date
2012-05-18   15.978591
2012-05-21   16.909504
2012-05-22   16.779663
2012-05-23   17.189081
2012-05-24   17.031218
...                ...
2023-05-24  170.546967
2023-05-25  171.688324
2023-05-26  174.109955
2023-05-30  175.965881
2023-05-31  175.916245

[2776 rows x 1 columns]
2012-05-18     93.1395
2012-05-21     93.0945
2012-05-22     93.1113
2012-05-23     93.8855
2012-05-24     93.8027
                ...
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
2023-06-01    120.2628
Length: 2744, dtype: float64
2012-05-18    25.10
2012-05-21    22.01
2012-05-22    22.48
2012-05-23    22.33
2012-05-24    21.54
              ...
2023-05-26    17.95
2023-05-29    17.46
2023-05-30    17.46
2023-05-31    17.94
2023-06-01    15.65
Length: 2785, dtype: float64
2012-05-18   -0.39
2012-05-21   -0.41
2012-05-22   -0.38
2012-05-23   -0.41
2012-05-24   -0.37
              ...
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
2023-06-01    1.45
Length: 2760, dtype: float64
2012-05-18    1.39
2012-05-21    1.45
2012-05-22    1.49
2012-05-23    1.45
2012-05-24    1.48
              ...
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
2023-06-01   -0.72
Length: 2760, dtype: float64
AAPL„Å´„ÅÇ„Çã„Åå‰ªñ„ÅÆ„Éá„Éº„Çø1„Å´„ÅØ„Å™„ÅÑÊó•‰ªò:
DatetimeIndex(['2012-10-08', '2012-11-12', '2013-03-06', '2013-10-14',
               '2013-11-11', '2013-12-10', '2014-02-13', '2014-02-21',
               '2014-03-03', '2014-03-17', '2014-10-13', '2014-11-11',
               '2014-12-26', '2015-02-17', '2015-03-05', '2015-10-12',
               '2015-11-11', '2016-01-22', '2016-01-25', '2016-01-26',
               '2016-10-10', '2016-11-11', '2017-01-20', '2017-10-09',
               '2017-11-10', '2018-03-02', '2018-03-21', '2018-10-08',
               '2018-11-12', '2019-01-14', '2019-02-20', '2019-10-14',
               '2019-11-11', '2019-12-24', '2020-10-12', '2020-11-11',
               '2020-11-27', '2020-12-24', '2021-01-20', '2021-10-11',
               '2021-11-11', '2021-12-31', '2022-10-10', '2022-11-11'],
              dtype='datetime64[ns]', freq=None)
‰ªñ„ÅÆ„Éá„Éº„Çø1„Å´„ÅÇ„Çã„ÅåAAPL„Å´„ÅØ„Å™„ÅÑÊó•‰ªò:
DatetimeIndex(['2013-03-29', '2014-04-18', '2015-04-03', '2016-03-25',
               '2017-04-14', '2018-03-30', '2019-04-19', '2020-04-10',
               '2021-04-02', '2022-04-15', '2023-04-07', '2023-06-01'],
              dtype='datetime64[ns]', freq=None)
[32m[I 2024-11-17 01:58:59,878][0m A new study created in memory with name: no-name-14ab9e06-5eae-4abf-ae9d-0d550064ada9[0m
/data/student/k2110261/Multi-iTransformer/optunademo.py:139: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  learning_rate = trial.suggest_loguniform('learning_rate', 1e-6, 1e-3)
Non-A100 GPU detected, using math or mem efficient attention if input tensor is on cuda
/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/contextlib.py:105: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
[33m[W 2024-11-17 01:59:02,411][0m Trial 0 failed with parameters: {'learning_rate': 1.921632676745481e-06, 'batch_size': 113, 'step_size': 5, 'gamma': 0.9861611102590371, 'depth': 3, 'dim': 219} because of the following error: The value nan is not acceptable.[0m
[33m[W 2024-11-17 01:59:02,412][0m Trial 0 failed with value nan.[0m
[32m[I 2024-11-17 01:59:02,412][0m A new study created in memory with name: no-name-faa972a1-09b5-4803-b0ef-14d69fe45059[0m
[33m[W 2024-11-17 01:59:04,191][0m Trial 0 failed with parameters: {'learning_rate': 0.00015866015401408388, 'batch_size': 50, 'step_size': 8, 'gamma': 0.9716924551585331, 'depth': 6, 'dim': 35} because of the following error: The value nan is not acceptable.[0m
[33m[W 2024-11-17 01:59:04,191][0m Trial 0 failed with value nan.[0m
[32m[I 2024-11-17 01:59:04,191][0m A new study created in memory with name: no-name-8435544e-bc82-4619-87f4-e49bcd6d4488[0m
[33m[W 2024-11-17 01:59:05,722][0m Trial 0 failed with parameters: {'learning_rate': 0.0004840935218005051, 'batch_size': 62, 'step_size': 9, 'gamma': 0.7536536491010015, 'depth': 5, 'dim': 98} because of the following error: The value nan is not acceptable.[0m
[33m[W 2024-11-17 01:59:05,722][0m Trial 0 failed with value nan.[0m
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/optunademo.py", line 191, in <module>
    print("Best hyperparameters (trend):", study_trend.best_params)
                                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/study.py", line 119, in best_params
    return self.best_trial.params
           ^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/study.py", line 162, in best_trial
    best_trial = self._storage.get_best_trial(self._study_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/storages/_in_memory.py", line 232, in get_best_trial
    raise ValueError("No trials are completed yet.")
ValueError: No trials are completed yet.
