[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training | Validation) Trend Loss: 0.4062 | 0.4786, Seasonal Loss: 0.5448 | 0.4343, Residual Loss: 0.5477 | 0.3518
Epoch 2/100, (Training | Validation) Trend Loss: 0.2380 | 0.2106, Seasonal Loss: 0.3346 | 0.3988, Residual Loss: 0.2891 | 0.3989
Epoch 3/100, (Training | Validation) Trend Loss: 0.1610 | 0.1804, Seasonal Loss: 0.2521 | 0.3767, Residual Loss: 0.2499 | 0.2792
Epoch 4/100, (Training | Validation) Trend Loss: 0.1120 | 0.1031, Seasonal Loss: 0.2167 | 0.2883, Residual Loss: 0.2031 | 0.2056
Epoch 5/100, (Training | Validation) Trend Loss: 0.0856 | 0.1387, Seasonal Loss: 0.1730 | 0.2377, Residual Loss: 0.1597 | 0.1725
Epoch 6/100, (Training | Validation) Trend Loss: 0.0681 | 0.0808, Seasonal Loss: 0.1456 | 0.2210, Residual Loss: 0.1453 | 0.1572
Epoch 7/100, (Training | Validation) Trend Loss: 0.0610 | 0.1333, Seasonal Loss: 0.1279 | 0.2043, Residual Loss: 0.1450 | 0.1458
Epoch 8/100, (Training | Validation) Trend Loss: 0.0943 | 0.0651, Seasonal Loss: 0.1085 | 0.1953, Residual Loss: 0.1481 | 0.1427
Epoch 9/100, (Training | Validation) Trend Loss: 0.2043 | 0.2336, Seasonal Loss: 0.1012 | 0.1968, Residual Loss: 0.1206 | 0.1325
Epoch 10/100, (Training | Validation) Trend Loss: 0.1288 | 0.1804, Seasonal Loss: 0.0944 | 0.1802, Residual Loss: 0.1198 | 0.1325
Epoch 11/100, (Training | Validation) Trend Loss: 0.1116 | 0.1169, Seasonal Loss: 0.0788 | 0.1671, Residual Loss: 0.1114 | 0.1198
Epoch 12/100, (Training | Validation) Trend Loss: 0.0768 | 0.1072, Seasonal Loss: 0.0841 | 0.1675, Residual Loss: 0.1147 | 0.1298
Epoch 13/100, (Training | Validation) Trend Loss: 0.0666 | 0.0803, Seasonal Loss: 0.0891 | 0.1916, Residual Loss: 0.1005 | 0.1264
Epoch 14/100, (Training | Validation) Trend Loss: 0.0556 | 0.0883, Seasonal Loss: 0.0739 | 0.1701, Residual Loss: 0.1037 | 0.1181
Epoch 15/100, (Training | Validation) Trend Loss: 0.0504 | 0.0566, Seasonal Loss: 0.0767 | 0.1522, Residual Loss: 0.0958 | 0.1219
Epoch 16/100, (Training | Validation) Trend Loss: 0.0431 | 0.0698, Seasonal Loss: 0.0670 | 0.1642, Residual Loss: 0.0940 | 0.1193
Epoch 17/100, (Training | Validation) Trend Loss: 0.0399 | 0.0417, Seasonal Loss: 0.0629 | 0.1725, Residual Loss: 0.0949 | 0.1251
Epoch 18/100, (Training | Validation) Trend Loss: 0.0357 | 0.0593, Seasonal Loss: 0.0684 | 0.1489, Residual Loss: 0.0891 | 0.1150
Epoch 19/100, (Training | Validation) Trend Loss: 0.0338 | 0.0324, Seasonal Loss: 0.0556 | 0.1519, Residual Loss: 0.0907 | 0.1165
Epoch 20/100, (Training | Validation) Trend Loss: 0.0324 | 0.0616, Seasonal Loss: 0.0515 | 0.1551, Residual Loss: 0.0837 | 0.1182
Epoch 21/100, (Training | Validation) Trend Loss: 0.0338 | 0.0285, Seasonal Loss: 0.0543 | 0.1525, Residual Loss: 0.0839 | 0.1095
Epoch 22/100, (Training | Validation) Trend Loss: 0.0367 | 0.0906, Seasonal Loss: 0.0513 | 0.1504, Residual Loss: 0.0813 | 0.1113
Epoch 23/100, (Training | Validation) Trend Loss: 0.0467 | 0.0393, Seasonal Loss: 0.0472 | 0.1451, Residual Loss: 0.0774 | 0.1122
Epoch 24/100, (Training | Validation) Trend Loss: 0.0526 | 0.1330, Seasonal Loss: 0.0434 | 0.1497, Residual Loss: 0.0781 | 0.1086
Epoch 25/100, (Training | Validation) Trend Loss: 0.0601 | 0.0428, Seasonal Loss: 0.0442 | 0.1474, Residual Loss: 0.0753 | 0.1081
Epoch 26/100, (Training | Validation) Trend Loss: 0.0546 | 0.1008, Seasonal Loss: 0.0442 | 0.1489, Residual Loss: 0.0737 | 0.1097
Epoch 27/100, (Training | Validation) Trend Loss: 0.0477 | 0.0318, Seasonal Loss: 0.0414 | 0.1361, Residual Loss: 0.0728 | 0.1080
Epoch 28/100, (Training | Validation) Trend Loss: 0.0442 | 0.0639, Seasonal Loss: 0.0372 | 0.1384, Residual Loss: 0.0717 | 0.1075
Epoch 29/100, (Training | Validation) Trend Loss: 0.0491 | 0.0400, Seasonal Loss: 0.0354 | 0.1369, Residual Loss: 0.0704 | 0.1079
Epoch 30/100, (Training | Validation) Trend Loss: 0.0486 | 0.0478, Seasonal Loss: 0.0342 | 0.1343, Residual Loss: 0.0694 | 0.1079
Epoch 31/100, (Training | Validation) Trend Loss: 0.0554 | 0.0452, Seasonal Loss: 0.0335 | 0.1366, Residual Loss: 0.0687 | 0.1072
Epoch 32/100, (Training | Validation) Trend Loss: 0.0458 | 0.0394, Seasonal Loss: 0.0329 | 0.1332, Residual Loss: 0.0676 | 0.1067
Epoch 33/100, (Training | Validation) Trend Loss: 0.0410 | 0.0435, Seasonal Loss: 0.0321 | 0.1351, Residual Loss: 0.0666 | 0.1075
Epoch 34/100, (Training | Validation) Trend Loss: 0.0319 | 0.0368, Seasonal Loss: 0.0314 | 0.1327, Residual Loss: 0.0660 | 0.1068
Epoch 35/100, (Training | Validation) Trend Loss: 0.0287 | 0.0397, Seasonal Loss: 0.0308 | 0.1345, Residual Loss: 0.0652 | 0.1064
Epoch 36/100, (Training | Validation) Trend Loss: 0.0254 | 0.0349, Seasonal Loss: 0.0304 | 0.1320, Residual Loss: 0.0643 | 0.1070
Epoch 37/100, (Training | Validation) Trend Loss: 0.0243 | 0.0361, Seasonal Loss: 0.0301 | 0.1362, Residual Loss: 0.0638 | 0.1065
Epoch 38/100, (Training | Validation) Trend Loss: 0.0230 | 0.0329, Seasonal Loss: 0.0302 | 0.1325, Residual Loss: 0.0631 | 0.1064
Epoch 39/100, (Training | Validation) Trend Loss: 0.0224 | 0.0333, Seasonal Loss: 0.0307 | 0.1452, Residual Loss: 0.0624 | 0.1067
Epoch 40/100, (Training | Validation) Trend Loss: 0.0217 | 0.0313, Seasonal Loss: 0.0331 | 0.1422, Residual Loss: 0.0619 | 0.1064
Epoch 41/100, (Training | Validation) Trend Loss: 0.0213 | 0.0313, Seasonal Loss: 0.0369 | 0.1863, Residual Loss: 0.0614 | 0.1064
Epoch 42/100, (Training | Validation) Trend Loss: 0.0208 | 0.0300, Seasonal Loss: 0.0488 | 0.1830, Residual Loss: 0.0608 | 0.1065
Epoch 43/100, (Training | Validation) Trend Loss: 0.0205 | 0.0298, Seasonal Loss: 0.0536 | 0.2385, Residual Loss: 0.0603 | 0.1064
Epoch 44/100, (Training | Validation) Trend Loss: 0.0202 | 0.0290, Seasonal Loss: 0.0669 | 0.1618, Residual Loss: 0.0599 | 0.1064
Epoch 45/100, (Training | Validation) Trend Loss: 0.0200 | 0.0287, Seasonal Loss: 0.0525 | 0.1596, Residual Loss: 0.0594 | 0.1064
Epoch 46/100, (Training | Validation) Trend Loss: 0.0197 | 0.0282, Seasonal Loss: 0.0590 | 0.1319, Residual Loss: 0.0590 | 0.1065
Epoch 47/100, (Training | Validation) Trend Loss: 0.0195 | 0.0279, Seasonal Loss: 0.0570 | 0.1377, Residual Loss: 0.0586 | 0.1065
Epoch 48/100, (Training | Validation) Trend Loss: 0.0193 | 0.0275, Seasonal Loss: 0.0517 | 0.1330, Residual Loss: 0.0582 | 0.1065
Epoch 49/100, (Training | Validation) Trend Loss: 0.0191 | 0.0273, Seasonal Loss: 0.0369 | 0.1334, Residual Loss: 0.0579 | 0.1067
Epoch 50/100, (Training | Validation) Trend Loss: 0.0189 | 0.0270, Seasonal Loss: 0.0314 | 0.1335, Residual Loss: 0.0576 | 0.1069
Epoch 51/100, (Training | Validation) Trend Loss: 0.0187 | 0.0267, Seasonal Loss: 0.0291 | 0.1326, Residual Loss: 0.0575 | 0.1076
Epoch 52/100, (Training | Validation) Trend Loss: 0.0186 | 0.0265, Seasonal Loss: 0.0285 | 0.1324, Residual Loss: 0.0575 | 0.1085
Epoch 53/100, (Training | Validation) Trend Loss: 0.0184 | 0.0263, Seasonal Loss: 0.0280 | 0.1319, Residual Loss: 0.0580 | 0.1111
Epoch 54/100, (Training | Validation) Trend Loss: 0.0183 | 0.0261, Seasonal Loss: 0.0277 | 0.1316, Residual Loss: 0.0594 | 0.1138
Epoch 55/100, (Training | Validation) Trend Loss: 0.0182 | 0.0259, Seasonal Loss: 0.0274 | 0.1313, Residual Loss: 0.0621 | 0.1198
Epoch 56/100, (Training | Validation) Trend Loss: 0.0181 | 0.0258, Seasonal Loss: 0.0272 | 0.1310, Residual Loss: 0.0677 | 0.1205
Epoch 57/100, (Training | Validation) Trend Loss: 0.0179 | 0.0256, Seasonal Loss: 0.0270 | 0.1308, Residual Loss: 0.0738 | 0.1209
Epoch 58/100, (Training | Validation) Trend Loss: 0.0178 | 0.0255, Seasonal Loss: 0.0268 | 0.1306, Residual Loss: 0.0818 | 0.1141
Epoch 59/100, (Training | Validation) Trend Loss: 0.0177 | 0.0254, Seasonal Loss: 0.0267 | 0.1304, Residual Loss: 0.0729 | 0.1098
Epoch 60/100, (Training | Validation) Trend Loss: 0.0176 | 0.0252, Seasonal Loss: 0.0265 | 0.1302, Residual Loss: 0.0650 | 0.1073
Epoch 61/100, (Training | Validation) Trend Loss: 0.0175 | 0.0251, Seasonal Loss: 0.0264 | 0.1300, Residual Loss: 0.0581 | 0.1068
Epoch 62/100, (Training | Validation) Trend Loss: 0.0175 | 0.0250, Seasonal Loss: 0.0262 | 0.1299, Residual Loss: 0.0561 | 0.1069
Epoch 63/100, (Training | Validation) Trend Loss: 0.0174 | 0.0249, Seasonal Loss: 0.0261 | 0.1298, Residual Loss: 0.0554 | 0.1069
Epoch 64/100, (Training | Validation) Trend Loss: 0.0173 | 0.0248, Seasonal Loss: 0.0260 | 0.1296, Residual Loss: 0.0551 | 0.1070
Epoch 65/100, (Training | Validation) Trend Loss: 0.0172 | 0.0247, Seasonal Loss: 0.0259 | 0.1295, Residual Loss: 0.0549 | 0.1070
Epoch 66/100, (Training | Validation) Trend Loss: 0.0172 | 0.0246, Seasonal Loss: 0.0258 | 0.1294, Residual Loss: 0.0547 | 0.1070
Epoch 67/100, (Training | Validation) Trend Loss: 0.0171 | 0.0246, Seasonal Loss: 0.0257 | 0.1293, Residual Loss: 0.0546 | 0.1070
Epoch 68/100, (Training | Validation) Trend Loss: 0.0170 | 0.0245, Seasonal Loss: 0.0256 | 0.1292, Residual Loss: 0.0544 | 0.1071
Epoch 69/100, (Training | Validation) Trend Loss: 0.0170 | 0.0244, Seasonal Loss: 0.0255 | 0.1291, Residual Loss: 0.0543 | 0.1071
Epoch 70/100, (Training | Validation) Trend Loss: 0.0169 | 0.0244, Seasonal Loss: 0.0255 | 0.1291, Residual Loss: 0.0542 | 0.1071
Epoch 71/100, (Training | Validation) Trend Loss: 0.0168 | 0.0243, Seasonal Loss: 0.0254 | 0.1290, Residual Loss: 0.0541 | 0.1071
Epoch 72/100, (Training | Validation) Trend Loss: 0.0168 | 0.0242, Seasonal Loss: 0.0253 | 0.1289, Residual Loss: 0.0540 | 0.1071
Epoch 73/100, (Training | Validation) Trend Loss: 0.0167 | 0.0242, Seasonal Loss: 0.0253 | 0.1289, Residual Loss: 0.0539 | 0.1071
Epoch 74/100, (Training | Validation) Trend Loss: 0.0167 | 0.0241, Seasonal Loss: 0.0252 | 0.1288, Residual Loss: 0.0538 | 0.1071
Epoch 75/100, (Training | Validation) Trend Loss: 0.0167 | 0.0241, Seasonal Loss: 0.0251 | 0.1287, Residual Loss: 0.0537 | 0.1071
Epoch 76/100, (Training | Validation) Trend Loss: 0.0166 | 0.0240, Seasonal Loss: 0.0251 | 0.1287, Residual Loss: 0.0536 | 0.1071
Epoch 77/100, (Training | Validation) Trend Loss: 0.0166 | 0.0240, Seasonal Loss: 0.0250 | 0.1286, Residual Loss: 0.0535 | 0.1071
Epoch 78/100, (Training | Validation) Trend Loss: 0.0165 | 0.0239, Seasonal Loss: 0.0250 | 0.1286, Residual Loss: 0.0534 | 0.1072
Epoch 79/100, (Training | Validation) Trend Loss: 0.0165 | 0.0239, Seasonal Loss: 0.0249 | 0.1286, Residual Loss: 0.0534 | 0.1072
Epoch 80/100, (Training | Validation) Trend Loss: 0.0165 | 0.0238, Seasonal Loss: 0.0249 | 0.1285, Residual Loss: 0.0533 | 0.1072
Epoch 81/100, (Training | Validation) Trend Loss: 0.0164 | 0.0238, Seasonal Loss: 0.0248 | 0.1285, Residual Loss: 0.0532 | 0.1072
Epoch 82/100, (Training | Validation) Trend Loss: 0.0164 | 0.0238, Seasonal Loss: 0.0248 | 0.1284, Residual Loss: 0.0532 | 0.1072
Epoch 83/100, (Training | Validation) Trend Loss: 0.0164 | 0.0237, Seasonal Loss: 0.0247 | 0.1284, Residual Loss: 0.0531 | 0.1072
Epoch 84/100, (Training | Validation) Trend Loss: 0.0163 | 0.0237, Seasonal Loss: 0.0247 | 0.1284, Residual Loss: 0.0530 | 0.1072
Epoch 85/100, (Training | Validation) Trend Loss: 0.0163 | 0.0236, Seasonal Loss: 0.0247 | 0.1283, Residual Loss: 0.0530 | 0.1072
Epoch 86/100, (Training | Validation) Trend Loss: 0.0163 | 0.0236, Seasonal Loss: 0.0246 | 0.1283, Residual Loss: 0.0529 | 0.1072
Epoch 87/100, (Training | Validation) Trend Loss: 0.0163 | 0.0236, Seasonal Loss: 0.0246 | 0.1283, Residual Loss: 0.0529 | 0.1072
Epoch 88/100, (Training | Validation) Trend Loss: 0.0162 | 0.0236, Seasonal Loss: 0.0246 | 0.1283, Residual Loss: 0.0528 | 0.1072
Epoch 89/100, (Training | Validation) Trend Loss: 0.0162 | 0.0235, Seasonal Loss: 0.0245 | 0.1282, Residual Loss: 0.0528 | 0.1072
Epoch 90/100, (Training | Validation) Trend Loss: 0.0162 | 0.0235, Seasonal Loss: 0.0245 | 0.1282, Residual Loss: 0.0527 | 0.1072
Epoch 91/100, (Training | Validation) Trend Loss: 0.0162 | 0.0235, Seasonal Loss: 0.0245 | 0.1282, Residual Loss: 0.0527 | 0.1072
Epoch 92/100, (Training | Validation) Trend Loss: 0.0161 | 0.0235, Seasonal Loss: 0.0245 | 0.1282, Residual Loss: 0.0527 | 0.1072
Epoch 93/100, (Training | Validation) Trend Loss: 0.0161 | 0.0234, Seasonal Loss: 0.0244 | 0.1282, Residual Loss: 0.0526 | 0.1072
Epoch 94/100, (Training | Validation) Trend Loss: 0.0161 | 0.0234, Seasonal Loss: 0.0244 | 0.1281, Residual Loss: 0.0526 | 0.1072
Epoch 95/100, (Training | Validation) Trend Loss: 0.0161 | 0.0234, Seasonal Loss: 0.0244 | 0.1281, Residual Loss: 0.0526 | 0.1072
Epoch 96/100, (Training | Validation) Trend Loss: 0.0161 | 0.0234, Seasonal Loss: 0.0244 | 0.1281, Residual Loss: 0.0525 | 0.1073
Epoch 97/100, (Training | Validation) Trend Loss: 0.0160 | 0.0234, Seasonal Loss: 0.0243 | 0.1281, Residual Loss: 0.0525 | 0.1073
Epoch 98/100, (Training | Validation) Trend Loss: 0.0160 | 0.0233, Seasonal Loss: 0.0243 | 0.1281, Residual Loss: 0.0525 | 0.1073
Epoch 99/100, (Training | Validation) Trend Loss: 0.0160 | 0.0233, Seasonal Loss: 0.0243 | 0.1281, Residual Loss: 0.0524 | 0.1073
Epoch 100/100, (Training | Validation) Trend Loss: 0.0160 | 0.0233, Seasonal Loss: 0.0243 | 0.1280, Residual Loss: 0.0524 | 0.1073
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:189: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:190: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[168.66457337]
[-2.06759463]
[0.54729266]
[167.14427139]
actual_stock_price: [171.57913208 173.9239502  174.0332489  173.079422   170.45640564
 170.73458862 171.87719727 174.30149841 176.1594696  176.1098175 ]
add_predicted_stock_price: [171.57913208 173.9239502  174.0332489  173.079422   170.45640564
 170.73458862 171.87719727 174.30149841 176.1594696  167.14427139]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:236: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
