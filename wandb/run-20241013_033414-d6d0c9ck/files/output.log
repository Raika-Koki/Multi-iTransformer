[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 1.1250, 0.3245| Seasonal Loss: 0.7230, 0.3709| Residual Loss: 0.4934, 0.2633
Epoch 2/100, (Training, Validation) Trend Loss: 0.4736, 0.2796| Seasonal Loss: 0.4294, 0.4282| Residual Loss: 0.3292, 0.2051
Epoch 3/100, (Training, Validation) Trend Loss: 0.2985, 0.2551| Seasonal Loss: 0.3511, 0.4025| Residual Loss: 0.2312, 0.2423
Epoch 4/100, (Training, Validation) Trend Loss: 0.4848, 0.1227| Seasonal Loss: 0.2847, 0.2756| Residual Loss: 0.2381, 0.2274
Epoch 5/100, (Training, Validation) Trend Loss: 0.2546, 0.4257| Seasonal Loss: 0.2246, 0.2048| Residual Loss: 0.2600, 0.1677
Epoch 6/100, (Training, Validation) Trend Loss: 0.2148, 0.2021| Seasonal Loss: 0.1953, 0.1701| Residual Loss: 0.2620, 0.1357
Epoch 7/100, (Training, Validation) Trend Loss: 0.2049, 0.1292| Seasonal Loss: 0.1632, 0.1504| Residual Loss: 0.1783, 0.1336
Epoch 8/100, (Training, Validation) Trend Loss: 0.1168, 0.1647| Seasonal Loss: 0.1434, 0.1418| Residual Loss: 0.1570, 0.1180
Epoch 9/100, (Training, Validation) Trend Loss: 0.1011, 0.0784| Seasonal Loss: 0.1250, 0.1209| Residual Loss: 0.1438, 0.1171
Epoch 10/100, (Training, Validation) Trend Loss: 0.0823, 0.0753| Seasonal Loss: 0.1294, 0.1396| Residual Loss: 0.1221, 0.1058
Epoch 11/100, (Training, Validation) Trend Loss: 0.0758, 0.0933| Seasonal Loss: 0.1617, 0.1146| Residual Loss: 0.1303, 0.1143
Epoch 12/100, (Training, Validation) Trend Loss: 0.0604, 0.0603| Seasonal Loss: 0.2378, 0.1097| Residual Loss: 0.1218, 0.1525
Epoch 13/100, (Training, Validation) Trend Loss: 0.0498, 0.0497| Seasonal Loss: 0.1360, 0.1306| Residual Loss: 0.1351, 0.1787
Epoch 14/100, (Training, Validation) Trend Loss: 0.0443, 0.0607| Seasonal Loss: 0.1146, 0.1057| Residual Loss: 0.1296, 0.1230
Epoch 15/100, (Training, Validation) Trend Loss: 0.0389, 0.0322| Seasonal Loss: 0.1088, 0.1099| Residual Loss: 0.1141, 0.1061
Epoch 16/100, (Training, Validation) Trend Loss: 0.0427, 0.0798| Seasonal Loss: 0.0969, 0.1351| Residual Loss: 0.1033, 0.1121
Epoch 17/100, (Training, Validation) Trend Loss: 0.0527, 0.0530| Seasonal Loss: 0.1076, 0.1769| Residual Loss: 0.0994, 0.0966
Epoch 18/100, (Training, Validation) Trend Loss: 0.0708, 0.0969| Seasonal Loss: 0.1062, 0.1702| Residual Loss: 0.0970, 0.0985
Epoch 19/100, (Training, Validation) Trend Loss: 0.0596, 0.0355| Seasonal Loss: 0.1110, 0.1008| Residual Loss: 0.0972, 0.0971
Epoch 20/100, (Training, Validation) Trend Loss: 0.0480, 0.0339| Seasonal Loss: 0.0798, 0.1159| Residual Loss: 0.1051, 0.0966
Epoch 21/100, (Training, Validation) Trend Loss: 0.0584, 0.0426| Seasonal Loss: 0.0757, 0.1046| Residual Loss: 0.1127, 0.0925
Epoch 22/100, (Training, Validation) Trend Loss: 0.0401, 0.0462| Seasonal Loss: 0.0699, 0.1033| Residual Loss: 0.1035, 0.0925
Epoch 23/100, (Training, Validation) Trend Loss: 0.0298, 0.0336| Seasonal Loss: 0.0663, 0.1058| Residual Loss: 0.0884, 0.0949
Epoch 24/100, (Training, Validation) Trend Loss: 0.0294, 0.0316| Seasonal Loss: 0.0619, 0.1027| Residual Loss: 0.0891, 0.0930
Epoch 25/100, (Training, Validation) Trend Loss: 0.0277, 0.0335| Seasonal Loss: 0.0587, 0.0998| Residual Loss: 0.0842, 0.0914
Epoch 26/100, (Training, Validation) Trend Loss: 0.0248, 0.0281| Seasonal Loss: 0.0569, 0.0981| Residual Loss: 0.0819, 0.0929
Epoch 27/100, (Training, Validation) Trend Loss: 0.0232, 0.0250| Seasonal Loss: 0.0544, 0.0972| Residual Loss: 0.0808, 0.0926
Epoch 28/100, (Training, Validation) Trend Loss: 0.0220, 0.0252| Seasonal Loss: 0.0525, 0.0957| Residual Loss: 0.0782, 0.0911
Epoch 29/100, (Training, Validation) Trend Loss: 0.0212, 0.0233| Seasonal Loss: 0.0508, 0.0948| Residual Loss: 0.0770, 0.0912
Epoch 30/100, (Training, Validation) Trend Loss: 0.0203, 0.0217| Seasonal Loss: 0.0492, 0.0945| Residual Loss: 0.0757, 0.0912
Epoch 31/100, (Training, Validation) Trend Loss: 0.0195, 0.0213| Seasonal Loss: 0.0478, 0.0940| Residual Loss: 0.0741, 0.0906
Epoch 32/100, (Training, Validation) Trend Loss: 0.0189, 0.0205| Seasonal Loss: 0.0466, 0.0935| Residual Loss: 0.0731, 0.0906
Epoch 33/100, (Training, Validation) Trend Loss: 0.0183, 0.0196| Seasonal Loss: 0.0454, 0.0932| Residual Loss: 0.0720, 0.0905
Epoch 34/100, (Training, Validation) Trend Loss: 0.0178, 0.0192| Seasonal Loss: 0.0443, 0.0929| Residual Loss: 0.0709, 0.0902
Epoch 35/100, (Training, Validation) Trend Loss: 0.0174, 0.0186| Seasonal Loss: 0.0433, 0.0925| Residual Loss: 0.0700, 0.0902
Epoch 36/100, (Training, Validation) Trend Loss: 0.0170, 0.0181| Seasonal Loss: 0.0424, 0.0921| Residual Loss: 0.0692, 0.0901
Epoch 37/100, (Training, Validation) Trend Loss: 0.0166, 0.0177| Seasonal Loss: 0.0416, 0.0919| Residual Loss: 0.0683, 0.0899
Epoch 38/100, (Training, Validation) Trend Loss: 0.0163, 0.0173| Seasonal Loss: 0.0408, 0.0916| Residual Loss: 0.0675, 0.0898
Epoch 39/100, (Training, Validation) Trend Loss: 0.0160, 0.0169| Seasonal Loss: 0.0401, 0.0914| Residual Loss: 0.0668, 0.0897
Epoch 40/100, (Training, Validation) Trend Loss: 0.0157, 0.0166| Seasonal Loss: 0.0394, 0.0912| Residual Loss: 0.0661, 0.0896
Epoch 41/100, (Training, Validation) Trend Loss: 0.0155, 0.0163| Seasonal Loss: 0.0388, 0.0910| Residual Loss: 0.0654, 0.0895
Epoch 42/100, (Training, Validation) Trend Loss: 0.0153, 0.0160| Seasonal Loss: 0.0382, 0.0908| Residual Loss: 0.0648, 0.0894
Epoch 43/100, (Training, Validation) Trend Loss: 0.0151, 0.0158| Seasonal Loss: 0.0376, 0.0907| Residual Loss: 0.0642, 0.0894
Epoch 44/100, (Training, Validation) Trend Loss: 0.0149, 0.0155| Seasonal Loss: 0.0371, 0.0905| Residual Loss: 0.0636, 0.0893
Epoch 45/100, (Training, Validation) Trend Loss: 0.0147, 0.0153| Seasonal Loss: 0.0366, 0.0904| Residual Loss: 0.0631, 0.0893
Epoch 46/100, (Training, Validation) Trend Loss: 0.0146, 0.0151| Seasonal Loss: 0.0362, 0.0903| Residual Loss: 0.0626, 0.0893
Epoch 47/100, (Training, Validation) Trend Loss: 0.0144, 0.0149| Seasonal Loss: 0.0358, 0.0901| Residual Loss: 0.0621, 0.0893
Epoch 48/100, (Training, Validation) Trend Loss: 0.0143, 0.0148| Seasonal Loss: 0.0354, 0.0900| Residual Loss: 0.0616, 0.0892
Epoch 49/100, (Training, Validation) Trend Loss: 0.0142, 0.0146| Seasonal Loss: 0.0350, 0.0899| Residual Loss: 0.0612, 0.0892
Epoch 50/100, (Training, Validation) Trend Loss: 0.0140, 0.0145| Seasonal Loss: 0.0346, 0.0898| Residual Loss: 0.0608, 0.0892
Epoch 51/100, (Training, Validation) Trend Loss: 0.0139, 0.0143| Seasonal Loss: 0.0343, 0.0897| Residual Loss: 0.0604, 0.0892
Epoch 52/100, (Training, Validation) Trend Loss: 0.0138, 0.0142| Seasonal Loss: 0.0340, 0.0896| Residual Loss: 0.0600, 0.0893
Epoch 53/100, (Training, Validation) Trend Loss: 0.0137, 0.0141| Seasonal Loss: 0.0337, 0.0895| Residual Loss: 0.0597, 0.0893
Epoch 54/100, (Training, Validation) Trend Loss: 0.0137, 0.0139| Seasonal Loss: 0.0334, 0.0895| Residual Loss: 0.0594, 0.0893
Epoch 55/100, (Training, Validation) Trend Loss: 0.0136, 0.0138| Seasonal Loss: 0.0332, 0.0894| Residual Loss: 0.0590, 0.0893
Epoch 56/100, (Training, Validation) Trend Loss: 0.0135, 0.0137| Seasonal Loss: 0.0329, 0.0893| Residual Loss: 0.0587, 0.0893
Epoch 57/100, (Training, Validation) Trend Loss: 0.0134, 0.0137| Seasonal Loss: 0.0327, 0.0892| Residual Loss: 0.0584, 0.0893
Epoch 58/100, (Training, Validation) Trend Loss: 0.0134, 0.0136| Seasonal Loss: 0.0325, 0.0892| Residual Loss: 0.0582, 0.0894
Epoch 59/100, (Training, Validation) Trend Loss: 0.0133, 0.0135| Seasonal Loss: 0.0323, 0.0891| Residual Loss: 0.0579, 0.0894
Epoch 60/100, (Training, Validation) Trend Loss: 0.0132, 0.0134| Seasonal Loss: 0.0321, 0.0890| Residual Loss: 0.0577, 0.0894
Epoch 61/100, (Training, Validation) Trend Loss: 0.0132, 0.0133| Seasonal Loss: 0.0319, 0.0890| Residual Loss: 0.0574, 0.0895
Epoch 62/100, (Training, Validation) Trend Loss: 0.0131, 0.0133| Seasonal Loss: 0.0317, 0.0889| Residual Loss: 0.0572, 0.0895
Epoch 63/100, (Training, Validation) Trend Loss: 0.0131, 0.0132| Seasonal Loss: 0.0315, 0.0889| Residual Loss: 0.0570, 0.0895
Epoch 64/100, (Training, Validation) Trend Loss: 0.0130, 0.0131| Seasonal Loss: 0.0314, 0.0888| Residual Loss: 0.0568, 0.0895
Epoch 65/100, (Training, Validation) Trend Loss: 0.0130, 0.0131| Seasonal Loss: 0.0312, 0.0888| Residual Loss: 0.0566, 0.0896
Epoch 66/100, (Training, Validation) Trend Loss: 0.0129, 0.0130| Seasonal Loss: 0.0311, 0.0887| Residual Loss: 0.0564, 0.0896
Epoch 67/100, (Training, Validation) Trend Loss: 0.0129, 0.0130| Seasonal Loss: 0.0309, 0.0887| Residual Loss: 0.0562, 0.0896
Epoch 68/100, (Training, Validation) Trend Loss: 0.0129, 0.0129| Seasonal Loss: 0.0308, 0.0887| Residual Loss: 0.0561, 0.0897
Epoch 69/100, (Training, Validation) Trend Loss: 0.0128, 0.0129| Seasonal Loss: 0.0307, 0.0886| Residual Loss: 0.0559, 0.0897
Epoch 70/100, (Training, Validation) Trend Loss: 0.0128, 0.0128| Seasonal Loss: 0.0306, 0.0886| Residual Loss: 0.0558, 0.0897
Epoch 71/100, (Training, Validation) Trend Loss: 0.0127, 0.0128| Seasonal Loss: 0.0305, 0.0885| Residual Loss: 0.0556, 0.0897
Epoch 72/100, (Training, Validation) Trend Loss: 0.0127, 0.0128| Seasonal Loss: 0.0304, 0.0885| Residual Loss: 0.0555, 0.0898
Epoch 73/100, (Training, Validation) Trend Loss: 0.0127, 0.0127| Seasonal Loss: 0.0303, 0.0885| Residual Loss: 0.0553, 0.0898
Epoch 74/100, (Training, Validation) Trend Loss: 0.0127, 0.0127| Seasonal Loss: 0.0302, 0.0884| Residual Loss: 0.0552, 0.0898
Epoch 75/100, (Training, Validation) Trend Loss: 0.0126, 0.0127| Seasonal Loss: 0.0301, 0.0884| Residual Loss: 0.0551, 0.0898
Epoch 76/100, (Training, Validation) Trend Loss: 0.0126, 0.0126| Seasonal Loss: 0.0300, 0.0884| Residual Loss: 0.0550, 0.0899
Epoch 77/100, (Training, Validation) Trend Loss: 0.0126, 0.0126| Seasonal Loss: 0.0299, 0.0884| Residual Loss: 0.0549, 0.0899
Epoch 78/100, (Training, Validation) Trend Loss: 0.0126, 0.0126| Seasonal Loss: 0.0298, 0.0883| Residual Loss: 0.0548, 0.0899
Epoch 79/100, (Training, Validation) Trend Loss: 0.0125, 0.0126| Seasonal Loss: 0.0298, 0.0883| Residual Loss: 0.0547, 0.0899
Epoch 80/100, (Training, Validation) Trend Loss: 0.0125, 0.0125| Seasonal Loss: 0.0297, 0.0883| Residual Loss: 0.0546, 0.0900
Epoch 81/100, (Training, Validation) Trend Loss: 0.0125, 0.0125| Seasonal Loss: 0.0296, 0.0883| Residual Loss: 0.0545, 0.0900
Epoch 82/100, (Training, Validation) Trend Loss: 0.0125, 0.0125| Seasonal Loss: 0.0296, 0.0882| Residual Loss: 0.0544, 0.0900
Epoch 83/100, (Training, Validation) Trend Loss: 0.0125, 0.0125| Seasonal Loss: 0.0295, 0.0882| Residual Loss: 0.0543, 0.0900
Epoch 84/100, (Training, Validation) Trend Loss: 0.0124, 0.0124| Seasonal Loss: 0.0294, 0.0882| Residual Loss: 0.0542, 0.0900
Epoch 85/100, (Training, Validation) Trend Loss: 0.0124, 0.0124| Seasonal Loss: 0.0294, 0.0882| Residual Loss: 0.0542, 0.0901
Epoch 86/100, (Training, Validation) Trend Loss: 0.0124, 0.0124| Seasonal Loss: 0.0293, 0.0882| Residual Loss: 0.0541, 0.0901
Epoch 87/100, (Training, Validation) Trend Loss: 0.0124, 0.0124| Seasonal Loss: 0.0293, 0.0881| Residual Loss: 0.0540, 0.0901
Epoch 88/100, (Training, Validation) Trend Loss: 0.0124, 0.0124| Seasonal Loss: 0.0292, 0.0881| Residual Loss: 0.0540, 0.0901
Epoch 89/100, (Training, Validation) Trend Loss: 0.0124, 0.0124| Seasonal Loss: 0.0292, 0.0881| Residual Loss: 0.0539, 0.0901
Epoch 90/100, (Training, Validation) Trend Loss: 0.0124, 0.0123| Seasonal Loss: 0.0291, 0.0881| Residual Loss: 0.0538, 0.0901
Epoch 91/100, (Training, Validation) Trend Loss: 0.0124, 0.0123| Seasonal Loss: 0.0291, 0.0881| Residual Loss: 0.0538, 0.0902
Epoch 92/100, (Training, Validation) Trend Loss: 0.0123, 0.0123| Seasonal Loss: 0.0291, 0.0881| Residual Loss: 0.0537, 0.0902
Epoch 93/100, (Training, Validation) Trend Loss: 0.0123, 0.0123| Seasonal Loss: 0.0290, 0.0881| Residual Loss: 0.0537, 0.0902
Epoch 94/100, (Training, Validation) Trend Loss: 0.0123, 0.0123| Seasonal Loss: 0.0290, 0.0880| Residual Loss: 0.0536, 0.0902
Epoch 95/100, (Training, Validation) Trend Loss: 0.0123, 0.0123| Seasonal Loss: 0.0290, 0.0880| Residual Loss: 0.0536, 0.0902
Epoch 96/100, (Training, Validation) Trend Loss: 0.0123, 0.0123| Seasonal Loss: 0.0289, 0.0880| Residual Loss: 0.0536, 0.0902
Epoch 97/100, (Training, Validation) Trend Loss: 0.0123, 0.0123| Seasonal Loss: 0.0289, 0.0880| Residual Loss: 0.0535, 0.0902
Epoch 98/100, (Training, Validation) Trend Loss: 0.0123, 0.0122| Seasonal Loss: 0.0289, 0.0880| Residual Loss: 0.0535, 0.0902
Epoch 99/100, (Training, Validation) Trend Loss: 0.0123, 0.0122| Seasonal Loss: 0.0288, 0.0880| Residual Loss: 0.0534, 0.0902
Epoch 100/100, (Training, Validation) Trend Loss: 0.0123, 0.0122| Seasonal Loss: 0.0288, 0.0880| Residual Loss: 0.0534, 0.0903
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[169.83721102]
[-0.91131308]
[0.99881666]
[169.9247146]
actual_stock_price: [171.57913208 173.92396545 174.03323364 173.07940674 170.45639038
 170.73458862 171.87721252 174.30149841 176.1594696  176.10980225]
add_predicted_stock_price: [171.57913208 173.92396545 174.03323364 173.07940674 170.45639038
 170.73458862 171.87721252 174.30149841 176.1594696  169.9247146 ]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
