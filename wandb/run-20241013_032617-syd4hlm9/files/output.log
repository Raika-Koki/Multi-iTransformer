[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.5051, 0.1889| Seasonal Loss: 0.9371, 0.4191| Residual Loss: 0.4909, 0.4243
Epoch 2/100, (Training, Validation) Trend Loss: 0.1448, 0.1282| Seasonal Loss: 0.3655, 0.2670| Residual Loss: 0.3135, 0.3286
Epoch 3/100, (Training, Validation) Trend Loss: 0.1008, 0.1289| Seasonal Loss: 0.2701, 0.2133| Residual Loss: 0.2674, 0.3180
Epoch 4/100, (Training, Validation) Trend Loss: 0.0873, 0.1059| Seasonal Loss: 0.2078, 0.1735| Residual Loss: 0.2179, 0.1872
Epoch 5/100, (Training, Validation) Trend Loss: 0.0891, 0.0880| Seasonal Loss: 0.2197, 0.3252| Residual Loss: 0.1918, 0.1787
Epoch 6/100, (Training, Validation) Trend Loss: 0.0609, 0.0553| Seasonal Loss: 0.2392, 0.2504| Residual Loss: 0.1730, 0.1485
Epoch 7/100, (Training, Validation) Trend Loss: 0.1162, 0.2039| Seasonal Loss: 0.1569, 0.2116| Residual Loss: 0.1827, 0.1603
Epoch 8/100, (Training, Validation) Trend Loss: 0.1719, 0.1630| Seasonal Loss: 0.1298, 0.1599| Residual Loss: 0.1935, 0.1371
Epoch 9/100, (Training, Validation) Trend Loss: 0.1534, 0.2125| Seasonal Loss: 0.0955, 0.1384| Residual Loss: 0.2176, 0.1228
Epoch 10/100, (Training, Validation) Trend Loss: 0.1675, 0.1854| Seasonal Loss: 0.0819, 0.1369| Residual Loss: 0.1818, 0.1144
Epoch 11/100, (Training, Validation) Trend Loss: 0.1737, 0.3159| Seasonal Loss: 0.1363, 0.2087| Residual Loss: 0.1400, 0.1047
Epoch 12/100, (Training, Validation) Trend Loss: 0.1169, 0.1021| Seasonal Loss: 0.1832, 0.1521| Residual Loss: 0.1237, 0.1090
Epoch 13/100, (Training, Validation) Trend Loss: 0.0870, 0.0840| Seasonal Loss: 0.1067, 0.1666| Residual Loss: 0.1177, 0.1017
Epoch 14/100, (Training, Validation) Trend Loss: 0.0589, 0.0894| Seasonal Loss: 0.1098, 0.1663| Residual Loss: 0.1209, 0.1200
Epoch 15/100, (Training, Validation) Trend Loss: 0.0510, 0.0553| Seasonal Loss: 0.0709, 0.1396| Residual Loss: 0.1290, 0.1412
Epoch 16/100, (Training, Validation) Trend Loss: 0.0469, 0.0599| Seasonal Loss: 0.0708, 0.1242| Residual Loss: 0.1445, 0.2374
Epoch 17/100, (Training, Validation) Trend Loss: 0.0402, 0.0497| Seasonal Loss: 0.0624, 0.1407| Residual Loss: 0.1652, 0.2250
Epoch 18/100, (Training, Validation) Trend Loss: 0.0372, 0.0454| Seasonal Loss: 0.0530, 0.1496| Residual Loss: 0.1471, 0.1206
Epoch 19/100, (Training, Validation) Trend Loss: 0.0345, 0.0423| Seasonal Loss: 0.0598, 0.1442| Residual Loss: 0.1144, 0.1121
Epoch 20/100, (Training, Validation) Trend Loss: 0.0325, 0.0378| Seasonal Loss: 0.0724, 0.1299| Residual Loss: 0.1059, 0.1023
Epoch 21/100, (Training, Validation) Trend Loss: 0.0308, 0.0365| Seasonal Loss: 0.0585, 0.1428| Residual Loss: 0.1008, 0.0962
Epoch 22/100, (Training, Validation) Trend Loss: 0.0295, 0.0331| Seasonal Loss: 0.0480, 0.1325| Residual Loss: 0.0966, 0.0943
Epoch 23/100, (Training, Validation) Trend Loss: 0.0281, 0.0323| Seasonal Loss: 0.0608, 0.1353| Residual Loss: 0.0940, 0.0914
Epoch 24/100, (Training, Validation) Trend Loss: 0.0277, 0.0306| Seasonal Loss: 0.0593, 0.1397| Residual Loss: 0.0921, 0.0906
Epoch 25/100, (Training, Validation) Trend Loss: 0.0263, 0.0279| Seasonal Loss: 0.0482, 0.1303| Residual Loss: 0.0902, 0.0893
Epoch 26/100, (Training, Validation) Trend Loss: 0.0279, 0.0338| Seasonal Loss: 0.0498, 0.1188| Residual Loss: 0.0888, 0.0885
Epoch 27/100, (Training, Validation) Trend Loss: 0.0269, 0.0236| Seasonal Loss: 0.0468, 0.1336| Residual Loss: 0.0874, 0.0874
Epoch 28/100, (Training, Validation) Trend Loss: 0.0344, 0.0602| Seasonal Loss: 0.0451, 0.1286| Residual Loss: 0.0866, 0.0873
Epoch 29/100, (Training, Validation) Trend Loss: 0.0382, 0.0373| Seasonal Loss: 0.0440, 0.1268| Residual Loss: 0.0856, 0.0858
Epoch 30/100, (Training, Validation) Trend Loss: 0.0549, 0.0902| Seasonal Loss: 0.0377, 0.1315| Residual Loss: 0.0864, 0.0868
Epoch 31/100, (Training, Validation) Trend Loss: 0.0435, 0.0276| Seasonal Loss: 0.0402, 0.1154| Residual Loss: 0.0874, 0.0850
Epoch 32/100, (Training, Validation) Trend Loss: 0.0380, 0.0384| Seasonal Loss: 0.0397, 0.1268| Residual Loss: 0.0918, 0.0866
Epoch 33/100, (Training, Validation) Trend Loss: 0.0264, 0.0354| Seasonal Loss: 0.0398, 0.1090| Residual Loss: 0.0954, 0.0847
Epoch 34/100, (Training, Validation) Trend Loss: 0.0249, 0.0267| Seasonal Loss: 0.0383, 0.1244| Residual Loss: 0.0933, 0.0838
Epoch 35/100, (Training, Validation) Trend Loss: 0.0242, 0.0298| Seasonal Loss: 0.0424, 0.1062| Residual Loss: 0.0863, 0.0839
Epoch 36/100, (Training, Validation) Trend Loss: 0.0230, 0.0282| Seasonal Loss: 0.0415, 0.1245| Residual Loss: 0.0809, 0.0828
Epoch 37/100, (Training, Validation) Trend Loss: 0.0221, 0.0262| Seasonal Loss: 0.0507, 0.1058| Residual Loss: 0.0797, 0.0829
Epoch 38/100, (Training, Validation) Trend Loss: 0.0217, 0.0262| Seasonal Loss: 0.0441, 0.1228| Residual Loss: 0.0789, 0.0825
Epoch 39/100, (Training, Validation) Trend Loss: 0.0212, 0.0252| Seasonal Loss: 0.0475, 0.1078| Residual Loss: 0.0782, 0.0822
Epoch 40/100, (Training, Validation) Trend Loss: 0.0208, 0.0245| Seasonal Loss: 0.0381, 0.1186| Residual Loss: 0.0776, 0.0820
Epoch 41/100, (Training, Validation) Trend Loss: 0.0205, 0.0241| Seasonal Loss: 0.0361, 0.1153| Residual Loss: 0.0770, 0.0817
Epoch 42/100, (Training, Validation) Trend Loss: 0.0202, 0.0236| Seasonal Loss: 0.0336, 0.1275| Residual Loss: 0.0765, 0.0815
Epoch 43/100, (Training, Validation) Trend Loss: 0.0199, 0.0232| Seasonal Loss: 0.0352, 0.1498| Residual Loss: 0.0760, 0.0813
Epoch 44/100, (Training, Validation) Trend Loss: 0.0196, 0.0228| Seasonal Loss: 0.0428, 0.1525| Residual Loss: 0.0755, 0.0811
Epoch 45/100, (Training, Validation) Trend Loss: 0.0194, 0.0225| Seasonal Loss: 0.0405, 0.1748| Residual Loss: 0.0751, 0.0809
Epoch 46/100, (Training, Validation) Trend Loss: 0.0192, 0.0222| Seasonal Loss: 0.0451, 0.1364| Residual Loss: 0.0746, 0.0807
Epoch 47/100, (Training, Validation) Trend Loss: 0.0190, 0.0219| Seasonal Loss: 0.0330, 0.1316| Residual Loss: 0.0742, 0.0805
Epoch 48/100, (Training, Validation) Trend Loss: 0.0187, 0.0217| Seasonal Loss: 0.0296, 0.1144| Residual Loss: 0.0739, 0.0804
Epoch 49/100, (Training, Validation) Trend Loss: 0.0186, 0.0215| Seasonal Loss: 0.0255, 0.1146| Residual Loss: 0.0735, 0.0802
Epoch 50/100, (Training, Validation) Trend Loss: 0.0184, 0.0212| Seasonal Loss: 0.0240, 0.1090| Residual Loss: 0.0732, 0.0801
Epoch 51/100, (Training, Validation) Trend Loss: 0.0182, 0.0211| Seasonal Loss: 0.0231, 0.1102| Residual Loss: 0.0728, 0.0800
Epoch 52/100, (Training, Validation) Trend Loss: 0.0181, 0.0209| Seasonal Loss: 0.0225, 0.1075| Residual Loss: 0.0725, 0.0798
Epoch 53/100, (Training, Validation) Trend Loss: 0.0179, 0.0207| Seasonal Loss: 0.0221, 0.1087| Residual Loss: 0.0722, 0.0797
Epoch 54/100, (Training, Validation) Trend Loss: 0.0178, 0.0206| Seasonal Loss: 0.0218, 0.1070| Residual Loss: 0.0720, 0.0796
Epoch 55/100, (Training, Validation) Trend Loss: 0.0176, 0.0204| Seasonal Loss: 0.0214, 0.1079| Residual Loss: 0.0717, 0.0795
Epoch 56/100, (Training, Validation) Trend Loss: 0.0175, 0.0203| Seasonal Loss: 0.0212, 0.1068| Residual Loss: 0.0714, 0.0794
Epoch 57/100, (Training, Validation) Trend Loss: 0.0174, 0.0202| Seasonal Loss: 0.0207, 0.1073| Residual Loss: 0.0712, 0.0793
Epoch 58/100, (Training, Validation) Trend Loss: 0.0173, 0.0200| Seasonal Loss: 0.0206, 0.1065| Residual Loss: 0.0710, 0.0793
Epoch 59/100, (Training, Validation) Trend Loss: 0.0172, 0.0199| Seasonal Loss: 0.0201, 0.1067| Residual Loss: 0.0708, 0.0792
Epoch 60/100, (Training, Validation) Trend Loss: 0.0171, 0.0198| Seasonal Loss: 0.0200, 0.1062| Residual Loss: 0.0705, 0.0791
Epoch 61/100, (Training, Validation) Trend Loss: 0.0170, 0.0197| Seasonal Loss: 0.0196, 0.1062| Residual Loss: 0.0703, 0.0790
Epoch 62/100, (Training, Validation) Trend Loss: 0.0169, 0.0196| Seasonal Loss: 0.0195, 0.1058| Residual Loss: 0.0702, 0.0790
Epoch 63/100, (Training, Validation) Trend Loss: 0.0168, 0.0196| Seasonal Loss: 0.0193, 0.1057| Residual Loss: 0.0700, 0.0789
Epoch 64/100, (Training, Validation) Trend Loss: 0.0167, 0.0195| Seasonal Loss: 0.0192, 0.1055| Residual Loss: 0.0698, 0.0788
Epoch 65/100, (Training, Validation) Trend Loss: 0.0167, 0.0194| Seasonal Loss: 0.0190, 0.1054| Residual Loss: 0.0696, 0.0788
Epoch 66/100, (Training, Validation) Trend Loss: 0.0166, 0.0193| Seasonal Loss: 0.0189, 0.1052| Residual Loss: 0.0695, 0.0787
Epoch 67/100, (Training, Validation) Trend Loss: 0.0165, 0.0192| Seasonal Loss: 0.0188, 0.1051| Residual Loss: 0.0693, 0.0787
Epoch 68/100, (Training, Validation) Trend Loss: 0.0165, 0.0192| Seasonal Loss: 0.0187, 0.1050| Residual Loss: 0.0692, 0.0786
Epoch 69/100, (Training, Validation) Trend Loss: 0.0164, 0.0191| Seasonal Loss: 0.0185, 0.1049| Residual Loss: 0.0691, 0.0786
Epoch 70/100, (Training, Validation) Trend Loss: 0.0163, 0.0191| Seasonal Loss: 0.0185, 0.1048| Residual Loss: 0.0689, 0.0785
Epoch 71/100, (Training, Validation) Trend Loss: 0.0163, 0.0190| Seasonal Loss: 0.0184, 0.1047| Residual Loss: 0.0688, 0.0785
Epoch 72/100, (Training, Validation) Trend Loss: 0.0162, 0.0190| Seasonal Loss: 0.0183, 0.1046| Residual Loss: 0.0687, 0.0785
Epoch 73/100, (Training, Validation) Trend Loss: 0.0162, 0.0189| Seasonal Loss: 0.0182, 0.1045| Residual Loss: 0.0686, 0.0784
Epoch 74/100, (Training, Validation) Trend Loss: 0.0161, 0.0189| Seasonal Loss: 0.0181, 0.1044| Residual Loss: 0.0685, 0.0784
Epoch 75/100, (Training, Validation) Trend Loss: 0.0161, 0.0188| Seasonal Loss: 0.0181, 0.1043| Residual Loss: 0.0684, 0.0784
Epoch 76/100, (Training, Validation) Trend Loss: 0.0161, 0.0188| Seasonal Loss: 0.0180, 0.1042| Residual Loss: 0.0683, 0.0783
Epoch 77/100, (Training, Validation) Trend Loss: 0.0160, 0.0187| Seasonal Loss: 0.0179, 0.1041| Residual Loss: 0.0682, 0.0783
Epoch 78/100, (Training, Validation) Trend Loss: 0.0160, 0.0187| Seasonal Loss: 0.0179, 0.1041| Residual Loss: 0.0681, 0.0783
Epoch 79/100, (Training, Validation) Trend Loss: 0.0159, 0.0186| Seasonal Loss: 0.0178, 0.1040| Residual Loss: 0.0680, 0.0782
Epoch 80/100, (Training, Validation) Trend Loss: 0.0159, 0.0186| Seasonal Loss: 0.0178, 0.1039| Residual Loss: 0.0679, 0.0782
Epoch 81/100, (Training, Validation) Trend Loss: 0.0159, 0.0186| Seasonal Loss: 0.0177, 0.1039| Residual Loss: 0.0679, 0.0782
Epoch 82/100, (Training, Validation) Trend Loss: 0.0158, 0.0185| Seasonal Loss: 0.0177, 0.1038| Residual Loss: 0.0678, 0.0782
Epoch 83/100, (Training, Validation) Trend Loss: 0.0158, 0.0185| Seasonal Loss: 0.0176, 0.1038| Residual Loss: 0.0677, 0.0782
Epoch 84/100, (Training, Validation) Trend Loss: 0.0158, 0.0185| Seasonal Loss: 0.0176, 0.1037| Residual Loss: 0.0677, 0.0781
Epoch 85/100, (Training, Validation) Trend Loss: 0.0158, 0.0185| Seasonal Loss: 0.0175, 0.1037| Residual Loss: 0.0676, 0.0781
Epoch 86/100, (Training, Validation) Trend Loss: 0.0157, 0.0184| Seasonal Loss: 0.0175, 0.1036| Residual Loss: 0.0675, 0.0781
Epoch 87/100, (Training, Validation) Trend Loss: 0.0157, 0.0184| Seasonal Loss: 0.0174, 0.1036| Residual Loss: 0.0675, 0.0781
Epoch 88/100, (Training, Validation) Trend Loss: 0.0157, 0.0184| Seasonal Loss: 0.0174, 0.1035| Residual Loss: 0.0674, 0.0781
Epoch 89/100, (Training, Validation) Trend Loss: 0.0157, 0.0184| Seasonal Loss: 0.0174, 0.1035| Residual Loss: 0.0674, 0.0780
Epoch 90/100, (Training, Validation) Trend Loss: 0.0156, 0.0183| Seasonal Loss: 0.0173, 0.1034| Residual Loss: 0.0673, 0.0780
Epoch 91/100, (Training, Validation) Trend Loss: 0.0156, 0.0183| Seasonal Loss: 0.0173, 0.1034| Residual Loss: 0.0673, 0.0780
Epoch 92/100, (Training, Validation) Trend Loss: 0.0156, 0.0183| Seasonal Loss: 0.0173, 0.1034| Residual Loss: 0.0672, 0.0780
Epoch 93/100, (Training, Validation) Trend Loss: 0.0156, 0.0183| Seasonal Loss: 0.0172, 0.1033| Residual Loss: 0.0672, 0.0780
Epoch 94/100, (Training, Validation) Trend Loss: 0.0156, 0.0182| Seasonal Loss: 0.0172, 0.1033| Residual Loss: 0.0672, 0.0780
Epoch 95/100, (Training, Validation) Trend Loss: 0.0155, 0.0182| Seasonal Loss: 0.0172, 0.1033| Residual Loss: 0.0671, 0.0780
Epoch 96/100, (Training, Validation) Trend Loss: 0.0155, 0.0182| Seasonal Loss: 0.0172, 0.1032| Residual Loss: 0.0671, 0.0780
Epoch 97/100, (Training, Validation) Trend Loss: 0.0155, 0.0182| Seasonal Loss: 0.0171, 0.1032| Residual Loss: 0.0670, 0.0779
Epoch 98/100, (Training, Validation) Trend Loss: 0.0155, 0.0182| Seasonal Loss: 0.0171, 0.1032| Residual Loss: 0.0670, 0.0779
Epoch 99/100, (Training, Validation) Trend Loss: 0.0155, 0.0182| Seasonal Loss: 0.0171, 0.1032| Residual Loss: 0.0670, 0.0779
Epoch 100/100, (Training, Validation) Trend Loss: 0.0155, 0.0182| Seasonal Loss: 0.0171, 0.1031| Residual Loss: 0.0669, 0.0779
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[168.97079959]
[0.10762452]
[-0.16325955]
[168.91516456]
actual_stock_price: [171.57913208 173.9239502  174.0332489  173.079422   170.45640564
 170.73458862 171.87719727 174.30148315 176.1594696  176.10980225]
add_predicted_stock_price: [171.57913208 173.9239502  174.0332489  173.079422   170.45640564
 170.73458862 171.87719727 174.30148315 176.1594696  168.91516456]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
