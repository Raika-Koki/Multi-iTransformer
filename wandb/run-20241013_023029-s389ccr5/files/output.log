[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training | Validation) Trend Loss: 0.6751 | 0.2279, Seasonal Loss: 0.5366 | 0.3615, Residual Loss: 0.7540 | 0.5029
Epoch 2/100, (Training | Validation) Trend Loss: 0.1680 | 0.1969, Seasonal Loss: 0.2864 | 0.2883, Residual Loss: 0.3219 | 0.3618
Epoch 3/100, (Training | Validation) Trend Loss: 0.1354 | 0.1079, Seasonal Loss: 0.2298 | 0.2150, Residual Loss: 0.2865 | 0.2813
Epoch 4/100, (Training | Validation) Trend Loss: 0.1024 | 0.1280, Seasonal Loss: 0.1931 | 0.1659, Residual Loss: 0.2114 | 0.2150
Epoch 5/100, (Training | Validation) Trend Loss: 0.0865 | 0.0774, Seasonal Loss: 0.1708 | 0.1416, Residual Loss: 0.1953 | 0.1799
Epoch 6/100, (Training | Validation) Trend Loss: 0.0694 | 0.0744, Seasonal Loss: 0.1524 | 0.1263, Residual Loss: 0.1587 | 0.1558
Epoch 7/100, (Training | Validation) Trend Loss: 0.0606 | 0.0627, Seasonal Loss: 0.1222 | 0.1220, Residual Loss: 0.1460 | 0.1297
Epoch 8/100, (Training | Validation) Trend Loss: 0.0519 | 0.0493, Seasonal Loss: 0.1177 | 0.1232, Residual Loss: 0.1316 | 0.1173
Epoch 9/100, (Training | Validation) Trend Loss: 0.0485 | 0.0467, Seasonal Loss: 0.1319 | 0.1469, Residual Loss: 0.1270 | 0.1137
Epoch 10/100, (Training | Validation) Trend Loss: 0.0457 | 0.0502, Seasonal Loss: 0.1188 | 0.1703, Residual Loss: 0.1238 | 0.1120
Epoch 11/100, (Training | Validation) Trend Loss: 0.0349 | 0.0420, Seasonal Loss: 0.1534 | 0.1362, Residual Loss: 0.1139 | 0.1044
Epoch 12/100, (Training | Validation) Trend Loss: 0.0277 | 0.0312, Seasonal Loss: 0.1100 | 0.1390, Residual Loss: 0.1037 | 0.0978
Epoch 13/100, (Training | Validation) Trend Loss: 0.0252 | 0.0311, Seasonal Loss: 0.1054 | 0.1379, Residual Loss: 0.0998 | 0.0961
Epoch 14/100, (Training | Validation) Trend Loss: 0.0292 | 0.0481, Seasonal Loss: 0.1113 | 0.1189, Residual Loss: 0.1008 | 0.0994
Epoch 15/100, (Training | Validation) Trend Loss: 0.0434 | 0.0662, Seasonal Loss: 0.0930 | 0.1235, Residual Loss: 0.0969 | 0.0899
Epoch 16/100, (Training | Validation) Trend Loss: 0.0447 | 0.0332, Seasonal Loss: 0.0839 | 0.0999, Residual Loss: 0.0907 | 0.0861
Epoch 17/100, (Training | Validation) Trend Loss: 0.0362 | 0.0405, Seasonal Loss: 0.0693 | 0.1140, Residual Loss: 0.0897 | 0.0880
Epoch 18/100, (Training | Validation) Trend Loss: 0.0408 | 0.0521, Seasonal Loss: 0.0665 | 0.1011, Residual Loss: 0.0893 | 0.0920
Epoch 19/100, (Training | Validation) Trend Loss: 0.0341 | 0.0269, Seasonal Loss: 0.0598 | 0.1087, Residual Loss: 0.0858 | 0.0863
Epoch 20/100, (Training | Validation) Trend Loss: 0.0264 | 0.0278, Seasonal Loss: 0.0599 | 0.1002, Residual Loss: 0.0843 | 0.0859
Epoch 21/100, (Training | Validation) Trend Loss: 0.0203 | 0.0250, Seasonal Loss: 0.0547 | 0.1054, Residual Loss: 0.0827 | 0.0894
Epoch 22/100, (Training | Validation) Trend Loss: 0.0235 | 0.0426, Seasonal Loss: 0.0526 | 0.0989, Residual Loss: 0.0823 | 0.0872
Epoch 23/100, (Training | Validation) Trend Loss: 0.0373 | 0.0209, Seasonal Loss: 0.0496 | 0.1021, Residual Loss: 0.0810 | 0.0832
Epoch 24/100, (Training | Validation) Trend Loss: 0.0296 | 0.0463, Seasonal Loss: 0.0484 | 0.0984, Residual Loss: 0.0821 | 0.0862
Epoch 25/100, (Training | Validation) Trend Loss: 0.0279 | 0.0175, Seasonal Loss: 0.0456 | 0.0998, Residual Loss: 0.0817 | 0.0829
Epoch 26/100, (Training | Validation) Trend Loss: 0.0285 | 0.0632, Seasonal Loss: 0.0447 | 0.0977, Residual Loss: 0.0763 | 0.0800
Epoch 27/100, (Training | Validation) Trend Loss: 0.0467 | 0.0306, Seasonal Loss: 0.0430 | 0.0977, Residual Loss: 0.0793 | 0.0849
Epoch 28/100, (Training | Validation) Trend Loss: 0.0536 | 0.1323, Seasonal Loss: 0.0416 | 0.0972, Residual Loss: 0.0755 | 0.0854
Epoch 29/100, (Training | Validation) Trend Loss: 0.0824 | 0.0513, Seasonal Loss: 0.0406 | 0.0965, Residual Loss: 0.0732 | 0.0819
Epoch 30/100, (Training | Validation) Trend Loss: 0.0661 | 0.1080, Seasonal Loss: 0.0396 | 0.0961, Residual Loss: 0.0730 | 0.0820
Epoch 31/100, (Training | Validation) Trend Loss: 0.0757 | 0.0287, Seasonal Loss: 0.0386 | 0.0957, Residual Loss: 0.0719 | 0.0795
Epoch 32/100, (Training | Validation) Trend Loss: 0.0577 | 0.0510, Seasonal Loss: 0.0378 | 0.0953, Residual Loss: 0.0708 | 0.0809
Epoch 33/100, (Training | Validation) Trend Loss: 0.0546 | 0.0294, Seasonal Loss: 0.0370 | 0.0948, Residual Loss: 0.0699 | 0.0821
Epoch 34/100, (Training | Validation) Trend Loss: 0.0345 | 0.0304, Seasonal Loss: 0.0362 | 0.0947, Residual Loss: 0.0693 | 0.0801
Epoch 35/100, (Training | Validation) Trend Loss: 0.0296 | 0.0322, Seasonal Loss: 0.0356 | 0.0943, Residual Loss: 0.0686 | 0.0797
Epoch 36/100, (Training | Validation) Trend Loss: 0.0235 | 0.0262, Seasonal Loss: 0.0349 | 0.0940, Residual Loss: 0.0679 | 0.0802
Epoch 37/100, (Training | Validation) Trend Loss: 0.0229 | 0.0311, Seasonal Loss: 0.0343 | 0.0938, Residual Loss: 0.0674 | 0.0804
Epoch 38/100, (Training | Validation) Trend Loss: 0.0203 | 0.0238, Seasonal Loss: 0.0338 | 0.0935, Residual Loss: 0.0669 | 0.0797
Epoch 39/100, (Training | Validation) Trend Loss: 0.0205 | 0.0289, Seasonal Loss: 0.0332 | 0.0933, Residual Loss: 0.0663 | 0.0796
Epoch 40/100, (Training | Validation) Trend Loss: 0.0189 | 0.0222, Seasonal Loss: 0.0328 | 0.0931, Residual Loss: 0.0659 | 0.0798
Epoch 41/100, (Training | Validation) Trend Loss: 0.0190 | 0.0263, Seasonal Loss: 0.0323 | 0.0929, Residual Loss: 0.0655 | 0.0797
Epoch 42/100, (Training | Validation) Trend Loss: 0.0180 | 0.0213, Seasonal Loss: 0.0319 | 0.0928, Residual Loss: 0.0650 | 0.0794
Epoch 43/100, (Training | Validation) Trend Loss: 0.0180 | 0.0239, Seasonal Loss: 0.0315 | 0.0926, Residual Loss: 0.0647 | 0.0796
Epoch 44/100, (Training | Validation) Trend Loss: 0.0174 | 0.0210, Seasonal Loss: 0.0311 | 0.0925, Residual Loss: 0.0643 | 0.0794
Epoch 45/100, (Training | Validation) Trend Loss: 0.0172 | 0.0221, Seasonal Loss: 0.0308 | 0.0923, Residual Loss: 0.0640 | 0.0794
Epoch 46/100, (Training | Validation) Trend Loss: 0.0169 | 0.0207, Seasonal Loss: 0.0305 | 0.0923, Residual Loss: 0.0636 | 0.0793
Epoch 47/100, (Training | Validation) Trend Loss: 0.0167 | 0.0209, Seasonal Loss: 0.0302 | 0.0920, Residual Loss: 0.0633 | 0.0794
Epoch 48/100, (Training | Validation) Trend Loss: 0.0165 | 0.0204, Seasonal Loss: 0.0299 | 0.0921, Residual Loss: 0.0630 | 0.0792
Epoch 49/100, (Training | Validation) Trend Loss: 0.0163 | 0.0201, Seasonal Loss: 0.0297 | 0.0918, Residual Loss: 0.0628 | 0.0795
Epoch 50/100, (Training | Validation) Trend Loss: 0.0162 | 0.0200, Seasonal Loss: 0.0293 | 0.0920, Residual Loss: 0.0624 | 0.0790
Epoch 51/100, (Training | Validation) Trend Loss: 0.0160 | 0.0197, Seasonal Loss: 0.0293 | 0.0918, Residual Loss: 0.0623 | 0.0798
Epoch 52/100, (Training | Validation) Trend Loss: 0.0159 | 0.0196, Seasonal Loss: 0.0289 | 0.0920, Residual Loss: 0.0620 | 0.0787
Epoch 53/100, (Training | Validation) Trend Loss: 0.0158 | 0.0193, Seasonal Loss: 0.0291 | 0.0927, Residual Loss: 0.0621 | 0.0804
Epoch 54/100, (Training | Validation) Trend Loss: 0.0157 | 0.0192, Seasonal Loss: 0.0289 | 0.0926, Residual Loss: 0.0618 | 0.0782
Epoch 55/100, (Training | Validation) Trend Loss: 0.0156 | 0.0191, Seasonal Loss: 0.0295 | 0.0954, Residual Loss: 0.0625 | 0.0816
Epoch 56/100, (Training | Validation) Trend Loss: 0.0155 | 0.0189, Seasonal Loss: 0.0304 | 0.0940, Residual Loss: 0.0630 | 0.0777
Epoch 57/100, (Training | Validation) Trend Loss: 0.0154 | 0.0188, Seasonal Loss: 0.0324 | 0.0996, Residual Loss: 0.0655 | 0.0837
Epoch 58/100, (Training | Validation) Trend Loss: 0.0154 | 0.0187, Seasonal Loss: 0.0372 | 0.0947, Residual Loss: 0.0704 | 0.0801
Epoch 59/100, (Training | Validation) Trend Loss: 0.0153 | 0.0186, Seasonal Loss: 0.0406 | 0.0992, Residual Loss: 0.0772 | 0.0897
Epoch 60/100, (Training | Validation) Trend Loss: 0.0152 | 0.0185, Seasonal Loss: 0.0434 | 0.0937, Residual Loss: 0.0871 | 0.0960
Epoch 61/100, (Training | Validation) Trend Loss: 0.0151 | 0.0184, Seasonal Loss: 0.0364 | 0.0949, Residual Loss: 0.0797 | 0.0938
Epoch 62/100, (Training | Validation) Trend Loss: 0.0151 | 0.0184, Seasonal Loss: 0.0318 | 0.0925, Residual Loss: 0.0730 | 0.0977
Epoch 63/100, (Training | Validation) Trend Loss: 0.0150 | 0.0183, Seasonal Loss: 0.0290 | 0.0927, Residual Loss: 0.0672 | 0.0829
Epoch 64/100, (Training | Validation) Trend Loss: 0.0150 | 0.0182, Seasonal Loss: 0.0280 | 0.0919, Residual Loss: 0.0625 | 0.0829
Epoch 65/100, (Training | Validation) Trend Loss: 0.0149 | 0.0182, Seasonal Loss: 0.0277 | 0.0920, Residual Loss: 0.0611 | 0.0797
Epoch 66/100, (Training | Validation) Trend Loss: 0.0149 | 0.0181, Seasonal Loss: 0.0273 | 0.0918, Residual Loss: 0.0604 | 0.0800
Epoch 67/100, (Training | Validation) Trend Loss: 0.0148 | 0.0180, Seasonal Loss: 0.0272 | 0.0918, Residual Loss: 0.0601 | 0.0796
Epoch 68/100, (Training | Validation) Trend Loss: 0.0148 | 0.0180, Seasonal Loss: 0.0271 | 0.0918, Residual Loss: 0.0600 | 0.0796
Epoch 69/100, (Training | Validation) Trend Loss: 0.0147 | 0.0180, Seasonal Loss: 0.0270 | 0.0918, Residual Loss: 0.0599 | 0.0795
Epoch 70/100, (Training | Validation) Trend Loss: 0.0147 | 0.0179, Seasonal Loss: 0.0269 | 0.0918, Residual Loss: 0.0598 | 0.0794
Epoch 71/100, (Training | Validation) Trend Loss: 0.0147 | 0.0179, Seasonal Loss: 0.0268 | 0.0918, Residual Loss: 0.0597 | 0.0794
Epoch 72/100, (Training | Validation) Trend Loss: 0.0146 | 0.0178, Seasonal Loss: 0.0267 | 0.0918, Residual Loss: 0.0596 | 0.0794
Epoch 73/100, (Training | Validation) Trend Loss: 0.0146 | 0.0178, Seasonal Loss: 0.0267 | 0.0917, Residual Loss: 0.0595 | 0.0793
Epoch 74/100, (Training | Validation) Trend Loss: 0.0146 | 0.0177, Seasonal Loss: 0.0266 | 0.0917, Residual Loss: 0.0594 | 0.0793
Epoch 75/100, (Training | Validation) Trend Loss: 0.0145 | 0.0177, Seasonal Loss: 0.0265 | 0.0917, Residual Loss: 0.0593 | 0.0793
Epoch 76/100, (Training | Validation) Trend Loss: 0.0145 | 0.0177, Seasonal Loss: 0.0265 | 0.0917, Residual Loss: 0.0593 | 0.0793
Epoch 77/100, (Training | Validation) Trend Loss: 0.0145 | 0.0176, Seasonal Loss: 0.0264 | 0.0916, Residual Loss: 0.0592 | 0.0793
Epoch 78/100, (Training | Validation) Trend Loss: 0.0144 | 0.0176, Seasonal Loss: 0.0264 | 0.0916, Residual Loss: 0.0591 | 0.0792
Epoch 79/100, (Training | Validation) Trend Loss: 0.0144 | 0.0176, Seasonal Loss: 0.0263 | 0.0916, Residual Loss: 0.0591 | 0.0792
Epoch 80/100, (Training | Validation) Trend Loss: 0.0144 | 0.0176, Seasonal Loss: 0.0263 | 0.0916, Residual Loss: 0.0590 | 0.0792
Epoch 81/100, (Training | Validation) Trend Loss: 0.0144 | 0.0175, Seasonal Loss: 0.0262 | 0.0916, Residual Loss: 0.0590 | 0.0792
Epoch 82/100, (Training | Validation) Trend Loss: 0.0143 | 0.0175, Seasonal Loss: 0.0262 | 0.0915, Residual Loss: 0.0589 | 0.0792
Epoch 83/100, (Training | Validation) Trend Loss: 0.0143 | 0.0175, Seasonal Loss: 0.0261 | 0.0915, Residual Loss: 0.0589 | 0.0792
Epoch 84/100, (Training | Validation) Trend Loss: 0.0143 | 0.0175, Seasonal Loss: 0.0261 | 0.0915, Residual Loss: 0.0588 | 0.0792
Epoch 85/100, (Training | Validation) Trend Loss: 0.0143 | 0.0175, Seasonal Loss: 0.0261 | 0.0915, Residual Loss: 0.0588 | 0.0792
Epoch 86/100, (Training | Validation) Trend Loss: 0.0143 | 0.0174, Seasonal Loss: 0.0260 | 0.0915, Residual Loss: 0.0587 | 0.0792
Epoch 87/100, (Training | Validation) Trend Loss: 0.0142 | 0.0174, Seasonal Loss: 0.0260 | 0.0914, Residual Loss: 0.0587 | 0.0792
Epoch 88/100, (Training | Validation) Trend Loss: 0.0142 | 0.0174, Seasonal Loss: 0.0259 | 0.0914, Residual Loss: 0.0587 | 0.0792
Epoch 89/100, (Training | Validation) Trend Loss: 0.0142 | 0.0174, Seasonal Loss: 0.0259 | 0.0914, Residual Loss: 0.0586 | 0.0792
Epoch 90/100, (Training | Validation) Trend Loss: 0.0142 | 0.0174, Seasonal Loss: 0.0259 | 0.0914, Residual Loss: 0.0586 | 0.0792
Epoch 91/100, (Training | Validation) Trend Loss: 0.0142 | 0.0173, Seasonal Loss: 0.0259 | 0.0914, Residual Loss: 0.0586 | 0.0792
Epoch 92/100, (Training | Validation) Trend Loss: 0.0142 | 0.0173, Seasonal Loss: 0.0258 | 0.0914, Residual Loss: 0.0585 | 0.0792
Epoch 93/100, (Training | Validation) Trend Loss: 0.0142 | 0.0173, Seasonal Loss: 0.0258 | 0.0914, Residual Loss: 0.0585 | 0.0792
Epoch 94/100, (Training | Validation) Trend Loss: 0.0141 | 0.0173, Seasonal Loss: 0.0258 | 0.0913, Residual Loss: 0.0585 | 0.0792
Epoch 95/100, (Training | Validation) Trend Loss: 0.0141 | 0.0173, Seasonal Loss: 0.0258 | 0.0913, Residual Loss: 0.0584 | 0.0792
Epoch 96/100, (Training | Validation) Trend Loss: 0.0141 | 0.0173, Seasonal Loss: 0.0257 | 0.0913, Residual Loss: 0.0584 | 0.0792
Epoch 97/100, (Training | Validation) Trend Loss: 0.0141 | 0.0173, Seasonal Loss: 0.0257 | 0.0913, Residual Loss: 0.0584 | 0.0792
Epoch 98/100, (Training | Validation) Trend Loss: 0.0141 | 0.0173, Seasonal Loss: 0.0257 | 0.0913, Residual Loss: 0.0584 | 0.0792
Epoch 99/100, (Training | Validation) Trend Loss: 0.0141 | 0.0172, Seasonal Loss: 0.0257 | 0.0913, Residual Loss: 0.0583 | 0.0792
Epoch 100/100, (Training | Validation) Trend Loss: 0.0141 | 0.0172, Seasonal Loss: 0.0256 | 0.0913, Residual Loss: 0.0583 | 0.0791
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:189: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:190: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[167.68827206]
[-0.73387782]
[0.55201365]
[167.50640788]
actual_stock_price: [171.57913208 173.92396545 174.0332489  173.079422   170.45640564
 170.73460388 171.87719727 174.30148315 176.15948486 176.10980225]
add_predicted_stock_price: [171.57913208 173.92396545 174.0332489  173.079422   170.45640564
 170.73460388 171.87719727 174.30148315 176.15948486 167.50640788]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:236: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
