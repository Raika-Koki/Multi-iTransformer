[*********************100%%**********************]  1 of 1 completed
Date
2012-05-18     18.384155
2012-05-21     18.368320
2012-05-22     18.352496
2012-05-23     18.336682
2012-05-24     18.320880
                 ...
2023-06-13    165.192609
2023-06-14    165.257760
2023-06-15    165.322908
2023-06-16    165.388053
2023-06-20    165.453196
Name: trend, Length: 2789, dtype: float64
Date
2012-05-18    -2.020068
2012-05-21    -1.334504
2012-05-22    -1.367998
2012-05-23    -1.136503
2012-05-24    -1.130973
                ...
2023-06-13   -16.051017
2023-06-14     0.585718
2023-06-15    -0.695802
2023-06-16   -19.510956
2023-06-20     2.806882
Name: season, Length: 2789, dtype: float64
Date
2012-05-18    -0.367915
2012-05-21    -0.105710
2012-05-22    -0.186377
2012-05-23     0.007811
2012-05-24    -0.139943
                ...
2023-06-13    32.989237
2023-06-14    16.923216
2023-06-15    20.186340
2023-06-16    37.853341
2023-06-20    15.559792
Name: resid, Length: 2789, dtype: float64
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.160366, 0.436959| Seasonal Loss: 0.1620, 0.4367| Residual Loss: 2.7247, 5.6539
Epoch 2/100, (Training, Validation) Trend Loss: 0.064421, 0.135103| Seasonal Loss: 0.1243, 0.4776| Residual Loss: 1.2665, 3.7459
Epoch 3/100, (Training, Validation) Trend Loss: 0.053051, 0.165841| Seasonal Loss: 0.1134, 0.4642| Residual Loss: 0.6168, 2.5358
Epoch 4/100, (Training, Validation) Trend Loss: 0.028354, 0.111668| Seasonal Loss: 0.1104, 0.4039| Residual Loss: 0.3675, 1.8294
Epoch 5/100, (Training, Validation) Trend Loss: 0.021804, 0.068889| Seasonal Loss: 0.1094, 0.3277| Residual Loss: 0.2805, 1.4288
Epoch 6/100, (Training, Validation) Trend Loss: 0.033349, 0.145460| Seasonal Loss: 0.1151, 0.2717| Residual Loss: 0.2370, 1.1867
Epoch 7/100, (Training, Validation) Trend Loss: 0.040881, 0.074954| Seasonal Loss: 0.1029, 0.2468| Residual Loss: 0.2075, 1.0277
Epoch 8/100, (Training, Validation) Trend Loss: 0.025307, 0.098149| Seasonal Loss: 0.0971, 0.2656| Residual Loss: 0.1852, 0.9162
Epoch 9/100, (Training, Validation) Trend Loss: 0.029012, 0.084770| Seasonal Loss: 0.0761, 0.2196| Residual Loss: 0.1675, 0.8340
Epoch 10/100, (Training, Validation) Trend Loss: 0.024471, 0.103542| Seasonal Loss: 0.0675, 0.2023| Residual Loss: 0.1528, 0.7710
Epoch 11/100, (Training, Validation) Trend Loss: 0.024975, 0.082723| Seasonal Loss: 0.0611, 0.1866| Residual Loss: 0.1405, 0.7210
Epoch 12/100, (Training, Validation) Trend Loss: 0.030377, 0.120194| Seasonal Loss: 0.0566, 0.1783| Residual Loss: 0.1299, 0.6804
Epoch 13/100, (Training, Validation) Trend Loss: 0.024921, 0.066445| Seasonal Loss: 0.0530, 0.1746| Residual Loss: 0.1208, 0.6465
Epoch 14/100, (Training, Validation) Trend Loss: 0.022694, 0.110094| Seasonal Loss: 0.0502, 0.1710| Residual Loss: 0.1129, 0.6178
Epoch 15/100, (Training, Validation) Trend Loss: 0.020288, 0.149022| Seasonal Loss: 0.0477, 0.1697| Residual Loss: 0.1060, 0.5931
Epoch 16/100, (Training, Validation) Trend Loss: 0.021039, 0.191866| Seasonal Loss: 0.0456, 0.1677| Residual Loss: 0.1000, 0.5717
Epoch 17/100, (Training, Validation) Trend Loss: 0.020980, 0.232604| Seasonal Loss: 0.0438, 0.1667| Residual Loss: 0.0948, 0.5529
Epoch 18/100, (Training, Validation) Trend Loss: 0.023393, 0.298502| Seasonal Loss: 0.0423, 0.1653| Residual Loss: 0.0902, 0.5362
Epoch 19/100, (Training, Validation) Trend Loss: 0.030011, 0.478789| Seasonal Loss: 0.0413, 0.1626| Residual Loss: 0.0862, 0.5215
Epoch 20/100, (Training, Validation) Trend Loss: 0.017083, 0.204328| Seasonal Loss: 0.0407, 0.1578| Residual Loss: 0.0827, 0.5083
Epoch 21/100, (Training, Validation) Trend Loss: 0.025153, 0.380823| Seasonal Loss: 0.0400, 0.1518| Residual Loss: 0.0796, 0.4964
Epoch 22/100, (Training, Validation) Trend Loss: 0.036470, 0.098217| Seasonal Loss: 0.0383, 0.1467| Residual Loss: 0.0769, 0.4858
Epoch 23/100, (Training, Validation) Trend Loss: 0.014070, 0.199002| Seasonal Loss: 0.0359, 0.1426| Residual Loss: 0.0745, 0.4762
Epoch 24/100, (Training, Validation) Trend Loss: 0.010882, 0.191234| Seasonal Loss: 0.0336, 0.1395| Residual Loss: 0.0724, 0.4675
Epoch 25/100, (Training, Validation) Trend Loss: 0.014707, 0.072918| Seasonal Loss: 0.0318, 0.1371| Residual Loss: 0.0705, 0.4596
Epoch 26/100, (Training, Validation) Trend Loss: 0.012707, 0.036490| Seasonal Loss: 0.0305, 0.1354| Residual Loss: 0.0688, 0.4525
Epoch 27/100, (Training, Validation) Trend Loss: 0.007600, 0.040656| Seasonal Loss: 0.0295, 0.1342| Residual Loss: 0.0673, 0.4459
Epoch 28/100, (Training, Validation) Trend Loss: 0.006221, 0.029396| Seasonal Loss: 0.0285, 0.1334| Residual Loss: 0.0659, 0.4399
Epoch 29/100, (Training, Validation) Trend Loss: 0.008152, 0.024450| Seasonal Loss: 0.0276, 0.1331| Residual Loss: 0.0646, 0.4345
Epoch 30/100, (Training, Validation) Trend Loss: 0.005743, 0.021707| Seasonal Loss: 0.0268, 0.1335| Residual Loss: 0.0635, 0.4294
Epoch 31/100, (Training, Validation) Trend Loss: 0.005352, 0.018963| Seasonal Loss: 0.0259, 0.1350| Residual Loss: 0.0625, 0.4248
Epoch 32/100, (Training, Validation) Trend Loss: 0.006088, 0.017042| Seasonal Loss: 0.0251, 0.1382| Residual Loss: 0.0616, 0.4206
Epoch 33/100, (Training, Validation) Trend Loss: 0.005201, 0.014836| Seasonal Loss: 0.0243, 0.1436| Residual Loss: 0.0607, 0.4166
Epoch 34/100, (Training, Validation) Trend Loss: 0.004372, 0.013487| Seasonal Loss: 0.0236, 0.1518| Residual Loss: 0.0599, 0.4130
Epoch 35/100, (Training, Validation) Trend Loss: 0.004255, 0.012408| Seasonal Loss: 0.0230, 0.1636| Residual Loss: 0.0592, 0.4096
Epoch 36/100, (Training, Validation) Trend Loss: 0.003779, 0.011331| Seasonal Loss: 0.0225, 0.1808| Residual Loss: 0.0586, 0.4065
Epoch 37/100, (Training, Validation) Trend Loss: 0.003091, 0.010522| Seasonal Loss: 0.0224, 0.2058| Residual Loss: 0.0580, 0.4036
Epoch 38/100, (Training, Validation) Trend Loss: 0.002687, 0.009937| Seasonal Loss: 0.0227, 0.2370| Residual Loss: 0.0574, 0.4009
Epoch 39/100, (Training, Validation) Trend Loss: 0.002389, 0.009451| Seasonal Loss: 0.0239, 0.2514| Residual Loss: 0.0569, 0.3983
Epoch 40/100, (Training, Validation) Trend Loss: 0.002048, 0.009065| Seasonal Loss: 0.0271, 0.1979| Residual Loss: 0.0564, 0.3960
Epoch 41/100, (Training, Validation) Trend Loss: 0.001789, 0.008811| Seasonal Loss: 0.0318, 0.1278| Residual Loss: 0.0559, 0.3938
Epoch 42/100, (Training, Validation) Trend Loss: 0.001641, 0.008601| Seasonal Loss: 0.0294, 0.1358| Residual Loss: 0.0555, 0.3917
Epoch 43/100, (Training, Validation) Trend Loss: 0.001531, 0.008432| Seasonal Loss: 0.0210, 0.1204| Residual Loss: 0.0551, 0.3897
Epoch 44/100, (Training, Validation) Trend Loss: 0.001438, 0.008332| Seasonal Loss: 0.0200, 0.1213| Residual Loss: 0.0547, 0.3879
Epoch 45/100, (Training, Validation) Trend Loss: 0.001378, 0.008269| Seasonal Loss: 0.0190, 0.1188| Residual Loss: 0.0543, 0.3862
Epoch 46/100, (Training, Validation) Trend Loss: 0.001339, 0.008202| Seasonal Loss: 0.0187, 0.1181| Residual Loss: 0.0540, 0.3846
Epoch 47/100, (Training, Validation) Trend Loss: 0.001308, 0.008153| Seasonal Loss: 0.0183, 0.1169| Residual Loss: 0.0537, 0.3831
Epoch 48/100, (Training, Validation) Trend Loss: 0.001282, 0.008132| Seasonal Loss: 0.0181, 0.1162| Residual Loss: 0.0534, 0.3817
Epoch 49/100, (Training, Validation) Trend Loss: 0.001263, 0.008114| Seasonal Loss: 0.0179, 0.1155| Residual Loss: 0.0531, 0.3803
Epoch 50/100, (Training, Validation) Trend Loss: 0.001246, 0.008089| Seasonal Loss: 0.0178, 0.1149| Residual Loss: 0.0529, 0.3791
Epoch 51/100, (Training, Validation) Trend Loss: 0.001232, 0.008073| Seasonal Loss: 0.0176, 0.1144| Residual Loss: 0.0526, 0.3779
Epoch 52/100, (Training, Validation) Trend Loss: 0.001218, 0.008066| Seasonal Loss: 0.0175, 0.1139| Residual Loss: 0.0524, 0.3767
Epoch 53/100, (Training, Validation) Trend Loss: 0.001207, 0.008057| Seasonal Loss: 0.0173, 0.1134| Residual Loss: 0.0522, 0.3757
Epoch 54/100, (Training, Validation) Trend Loss: 0.001195, 0.008045| Seasonal Loss: 0.0172, 0.1130| Residual Loss: 0.0520, 0.3746
Epoch 55/100, (Training, Validation) Trend Loss: 0.001185, 0.008038| Seasonal Loss: 0.0171, 0.1125| Residual Loss: 0.0518, 0.3737
Epoch 56/100, (Training, Validation) Trend Loss: 0.001175, 0.008034| Seasonal Loss: 0.0170, 0.1122| Residual Loss: 0.0516, 0.3728
Epoch 57/100, (Training, Validation) Trend Loss: 0.001166, 0.008027| Seasonal Loss: 0.0169, 0.1118| Residual Loss: 0.0514, 0.3719
Epoch 58/100, (Training, Validation) Trend Loss: 0.001157, 0.008021| Seasonal Loss: 0.0168, 0.1114| Residual Loss: 0.0512, 0.3711
Epoch 59/100, (Training, Validation) Trend Loss: 0.001149, 0.008017| Seasonal Loss: 0.0167, 0.1111| Residual Loss: 0.0511, 0.3703
Epoch 60/100, (Training, Validation) Trend Loss: 0.001140, 0.008013| Seasonal Loss: 0.0166, 0.1107| Residual Loss: 0.0509, 0.3695
Epoch 61/100, (Training, Validation) Trend Loss: 0.001133, 0.008008| Seasonal Loss: 0.0165, 0.1104| Residual Loss: 0.0508, 0.3688
Epoch 62/100, (Training, Validation) Trend Loss: 0.001125, 0.008004| Seasonal Loss: 0.0164, 0.1101| Residual Loss: 0.0506, 0.3682
Epoch 63/100, (Training, Validation) Trend Loss: 0.001118, 0.008000| Seasonal Loss: 0.0163, 0.1098| Residual Loss: 0.0505, 0.3675
Epoch 64/100, (Training, Validation) Trend Loss: 0.001111, 0.007996| Seasonal Loss: 0.0162, 0.1095| Residual Loss: 0.0504, 0.3669
Epoch 65/100, (Training, Validation) Trend Loss: 0.001105, 0.007992| Seasonal Loss: 0.0161, 0.1092| Residual Loss: 0.0503, 0.3664
Epoch 66/100, (Training, Validation) Trend Loss: 0.001099, 0.007987| Seasonal Loss: 0.0161, 0.1090| Residual Loss: 0.0501, 0.3658
Epoch 67/100, (Training, Validation) Trend Loss: 0.001093, 0.007983| Seasonal Loss: 0.0160, 0.1087| Residual Loss: 0.0500, 0.3653
Epoch 68/100, (Training, Validation) Trend Loss: 0.001087, 0.007979| Seasonal Loss: 0.0159, 0.1084| Residual Loss: 0.0499, 0.3648
Epoch 69/100, (Training, Validation) Trend Loss: 0.001081, 0.007975| Seasonal Loss: 0.0158, 0.1082| Residual Loss: 0.0498, 0.3643
Epoch 70/100, (Training, Validation) Trend Loss: 0.001076, 0.007971| Seasonal Loss: 0.0158, 0.1080| Residual Loss: 0.0497, 0.3639
Epoch 71/100, (Training, Validation) Trend Loss: 0.001071, 0.007967| Seasonal Loss: 0.0157, 0.1077| Residual Loss: 0.0497, 0.3635
Epoch 72/100, (Training, Validation) Trend Loss: 0.001066, 0.007963| Seasonal Loss: 0.0157, 0.1075| Residual Loss: 0.0496, 0.3631
Epoch 73/100, (Training, Validation) Trend Loss: 0.001061, 0.007959| Seasonal Loss: 0.0156, 0.1073| Residual Loss: 0.0495, 0.3627
Epoch 74/100, (Training, Validation) Trend Loss: 0.001057, 0.007955| Seasonal Loss: 0.0156, 0.1071| Residual Loss: 0.0494, 0.3623
Epoch 75/100, (Training, Validation) Trend Loss: 0.001052, 0.007951| Seasonal Loss: 0.0155, 0.1069| Residual Loss: 0.0493, 0.3620
Epoch 76/100, (Training, Validation) Trend Loss: 0.001048, 0.007947| Seasonal Loss: 0.0155, 0.1067| Residual Loss: 0.0493, 0.3616
Epoch 77/100, (Training, Validation) Trend Loss: 0.001044, 0.007944| Seasonal Loss: 0.0154, 0.1065| Residual Loss: 0.0492, 0.3613
Epoch 78/100, (Training, Validation) Trend Loss: 0.001040, 0.007940| Seasonal Loss: 0.0154, 0.1063| Residual Loss: 0.0491, 0.3610
Epoch 79/100, (Training, Validation) Trend Loss: 0.001036, 0.007936| Seasonal Loss: 0.0153, 0.1062| Residual Loss: 0.0491, 0.3607
Epoch 80/100, (Training, Validation) Trend Loss: 0.001033, 0.007933| Seasonal Loss: 0.0153, 0.1060| Residual Loss: 0.0490, 0.3605
Epoch 81/100, (Training, Validation) Trend Loss: 0.001029, 0.007929| Seasonal Loss: 0.0153, 0.1058| Residual Loss: 0.0490, 0.3602
Epoch 82/100, (Training, Validation) Trend Loss: 0.001026, 0.007926| Seasonal Loss: 0.0152, 0.1057| Residual Loss: 0.0489, 0.3600
Epoch 83/100, (Training, Validation) Trend Loss: 0.001023, 0.007922| Seasonal Loss: 0.0152, 0.1056| Residual Loss: 0.0489, 0.3597
Epoch 84/100, (Training, Validation) Trend Loss: 0.001020, 0.007919| Seasonal Loss: 0.0152, 0.1054| Residual Loss: 0.0488, 0.3595
Epoch 85/100, (Training, Validation) Trend Loss: 0.001017, 0.007915| Seasonal Loss: 0.0151, 0.1053| Residual Loss: 0.0488, 0.3593
Epoch 86/100, (Training, Validation) Trend Loss: 0.001014, 0.007912| Seasonal Loss: 0.0151, 0.1052| Residual Loss: 0.0487, 0.3591
Epoch 87/100, (Training, Validation) Trend Loss: 0.001011, 0.007909| Seasonal Loss: 0.0151, 0.1050| Residual Loss: 0.0487, 0.3589
Epoch 88/100, (Training, Validation) Trend Loss: 0.001008, 0.007906| Seasonal Loss: 0.0150, 0.1049| Residual Loss: 0.0487, 0.3587
Epoch 89/100, (Training, Validation) Trend Loss: 0.001006, 0.007903| Seasonal Loss: 0.0150, 0.1048| Residual Loss: 0.0486, 0.3585
Epoch 90/100, (Training, Validation) Trend Loss: 0.001003, 0.007900| Seasonal Loss: 0.0150, 0.1047| Residual Loss: 0.0486, 0.3583
Epoch 91/100, (Training, Validation) Trend Loss: 0.001001, 0.007897| Seasonal Loss: 0.0150, 0.1046| Residual Loss: 0.0485, 0.3582
Epoch 92/100, (Training, Validation) Trend Loss: 0.000999, 0.007894| Seasonal Loss: 0.0149, 0.1045| Residual Loss: 0.0485, 0.3580
Epoch 93/100, (Training, Validation) Trend Loss: 0.000997, 0.007891| Seasonal Loss: 0.0149, 0.1045| Residual Loss: 0.0485, 0.3579
Epoch 94/100, (Training, Validation) Trend Loss: 0.000995, 0.007889| Seasonal Loss: 0.0149, 0.1044| Residual Loss: 0.0485, 0.3577
Epoch 95/100, (Training, Validation) Trend Loss: 0.000992, 0.007886| Seasonal Loss: 0.0149, 0.1043| Residual Loss: 0.0484, 0.3576
Epoch 96/100, (Training, Validation) Trend Loss: 0.000991, 0.007883| Seasonal Loss: 0.0148, 0.1042| Residual Loss: 0.0484, 0.3575
Epoch 97/100, (Training, Validation) Trend Loss: 0.000989, 0.007881| Seasonal Loss: 0.0148, 0.1041| Residual Loss: 0.0484, 0.3574
Epoch 98/100, (Training, Validation) Trend Loss: 0.000987, 0.007879| Seasonal Loss: 0.0148, 0.1041| Residual Loss: 0.0484, 0.3572
Epoch 99/100, (Training, Validation) Trend Loss: 0.000985, 0.007876| Seasonal Loss: 0.0148, 0.1040| Residual Loss: 0.0483, 0.3571
Epoch 100/100, (Training, Validation) Trend Loss: 0.000983, 0.007874| Seasonal Loss: 0.0148, 0.1039| Residual Loss: 0.0483, 0.3570
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:258: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:259: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:260: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[165.60184269]
[-3.52111142]
[16.50624225]
[178.58697352]
actual_stock_price: [178.05717468 176.6761322  179.40844727 179.79592896 182.60769653
 182.13082886 182.76669312 184.81344604 183.73043823 183.81987   ]
add_predicted_stock_price: [178.05717468 176.6761322  179.40844727 179.79592896 182.60769653
 182.13082886 182.76669312 184.81344604 183.73043823 178.58697352]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:306: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
