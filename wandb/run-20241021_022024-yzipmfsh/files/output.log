[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.196560, 0.362255| Seasonal Loss: 0.2501, 0.3009| Residual Loss: 1.8236, 3.4429
Epoch 2/100, (Training, Validation) Trend Loss: 0.095020, 0.564413| Seasonal Loss: 0.1256, 0.3855| Residual Loss: 0.6632, 2.1562
Epoch 3/100, (Training, Validation) Trend Loss: 0.077738, 0.493474| Seasonal Loss: 0.0983, 0.4181| Residual Loss: 0.3129, 1.4855
Epoch 4/100, (Training, Validation) Trend Loss: 0.072281, 0.296714| Seasonal Loss: 0.0883, 0.4018| Residual Loss: 0.2299, 1.1580
Epoch 5/100, (Training, Validation) Trend Loss: 0.098210, 0.230898| Seasonal Loss: 0.0829, 0.3892| Residual Loss: 0.1961, 0.9755
Epoch 6/100, (Training, Validation) Trend Loss: 0.092650, 0.217354| Seasonal Loss: 0.0812, 0.3690| Residual Loss: 0.1725, 0.8565
Epoch 7/100, (Training, Validation) Trend Loss: 0.093263, 0.133692| Seasonal Loss: 0.0780, 0.3483| Residual Loss: 0.1540, 0.7716
Epoch 8/100, (Training, Validation) Trend Loss: 0.095789, 0.139793| Seasonal Loss: 0.0795, 0.3152| Residual Loss: 0.1388, 0.7076
Epoch 9/100, (Training, Validation) Trend Loss: 0.072074, 0.094020| Seasonal Loss: 0.0934, 0.2688| Residual Loss: 0.1261, 0.6573
Epoch 10/100, (Training, Validation) Trend Loss: 0.050713, 0.057219| Seasonal Loss: 0.0765, 0.3182| Residual Loss: 0.1154, 0.6165
Epoch 11/100, (Training, Validation) Trend Loss: 0.041773, 0.038092| Seasonal Loss: 0.0869, 0.2056| Residual Loss: 0.1062, 0.5826
Epoch 12/100, (Training, Validation) Trend Loss: 0.036448, 0.030672| Seasonal Loss: 0.0999, 0.1886| Residual Loss: 0.0984, 0.5540
Epoch 13/100, (Training, Validation) Trend Loss: 0.030552, 0.020542| Seasonal Loss: 0.0739, 0.1731| Residual Loss: 0.0919, 0.5296
Epoch 14/100, (Training, Validation) Trend Loss: 0.023483, 0.011060| Seasonal Loss: 0.0711, 0.1602| Residual Loss: 0.0863, 0.5085
Epoch 15/100, (Training, Validation) Trend Loss: 0.019061, 0.010043| Seasonal Loss: 0.0615, 0.1485| Residual Loss: 0.0815, 0.4903
Epoch 16/100, (Training, Validation) Trend Loss: 0.015004, 0.008607| Seasonal Loss: 0.0531, 0.1406| Residual Loss: 0.0775, 0.4745
Epoch 17/100, (Training, Validation) Trend Loss: 0.011517, 0.007399| Seasonal Loss: 0.0457, 0.1367| Residual Loss: 0.0741, 0.4606
Epoch 18/100, (Training, Validation) Trend Loss: 0.009334, 0.006874| Seasonal Loss: 0.0422, 0.1493| Residual Loss: 0.0711, 0.4485
Epoch 19/100, (Training, Validation) Trend Loss: 0.007916, 0.006811| Seasonal Loss: 0.0415, 0.1649| Residual Loss: 0.0686, 0.4378
Epoch 20/100, (Training, Validation) Trend Loss: 0.006937, 0.007112| Seasonal Loss: 0.0407, 0.1871| Residual Loss: 0.0664, 0.4283
Epoch 21/100, (Training, Validation) Trend Loss: 0.006230, 0.007710| Seasonal Loss: 0.0400, 0.2435| Residual Loss: 0.0645, 0.4200
Epoch 22/100, (Training, Validation) Trend Loss: 0.005707, 0.008546| Seasonal Loss: 0.0402, 0.3389| Residual Loss: 0.0628, 0.4125
Epoch 23/100, (Training, Validation) Trend Loss: 0.005315, 0.009615| Seasonal Loss: 0.0422, 0.4481| Residual Loss: 0.0613, 0.4058
Epoch 24/100, (Training, Validation) Trend Loss: 0.005006, 0.011015| Seasonal Loss: 0.0499, 0.3642| Residual Loss: 0.0599, 0.3998
Epoch 25/100, (Training, Validation) Trend Loss: 0.004735, 0.012960| Seasonal Loss: 0.0683, 0.1664| Residual Loss: 0.0587, 0.3944
Epoch 26/100, (Training, Validation) Trend Loss: 0.004466, 0.015715| Seasonal Loss: 0.0617, 0.1412| Residual Loss: 0.0576, 0.3894
Epoch 27/100, (Training, Validation) Trend Loss: 0.004192, 0.019483| Seasonal Loss: 0.0432, 0.1353| Residual Loss: 0.0566, 0.3850
Epoch 28/100, (Training, Validation) Trend Loss: 0.003924, 0.024285| Seasonal Loss: 0.0375, 0.1341| Residual Loss: 0.0556, 0.3809
Epoch 29/100, (Training, Validation) Trend Loss: 0.003690, 0.029952| Seasonal Loss: 0.0349, 0.1306| Residual Loss: 0.0548, 0.3771
Epoch 30/100, (Training, Validation) Trend Loss: 0.003515, 0.036239| Seasonal Loss: 0.0337, 0.1287| Residual Loss: 0.0540, 0.3737
Epoch 31/100, (Training, Validation) Trend Loss: 0.003421, 0.043033| Seasonal Loss: 0.0327, 0.1269| Residual Loss: 0.0533, 0.3705
Epoch 32/100, (Training, Validation) Trend Loss: 0.003424, 0.050505| Seasonal Loss: 0.0319, 0.1254| Residual Loss: 0.0526, 0.3676
Epoch 33/100, (Training, Validation) Trend Loss: 0.003540, 0.059145| Seasonal Loss: 0.0312, 0.1242| Residual Loss: 0.0520, 0.3648
Epoch 34/100, (Training, Validation) Trend Loss: 0.003802, 0.069591| Seasonal Loss: 0.0306, 0.1230| Residual Loss: 0.0514, 0.3623
Epoch 35/100, (Training, Validation) Trend Loss: 0.004305, 0.082118| Seasonal Loss: 0.0300, 0.1219| Residual Loss: 0.0508, 0.3599
Epoch 36/100, (Training, Validation) Trend Loss: 0.005275, 0.094637| Seasonal Loss: 0.0294, 0.1210| Residual Loss: 0.0503, 0.3577
Epoch 37/100, (Training, Validation) Trend Loss: 0.007284, 0.094839| Seasonal Loss: 0.0289, 0.1200| Residual Loss: 0.0498, 0.3557
Epoch 38/100, (Training, Validation) Trend Loss: 0.011787, 0.049092| Seasonal Loss: 0.0284, 0.1192| Residual Loss: 0.0494, 0.3537
Epoch 39/100, (Training, Validation) Trend Loss: 0.018431, 0.006121| Seasonal Loss: 0.0279, 0.1184| Residual Loss: 0.0490, 0.3519
Epoch 40/100, (Training, Validation) Trend Loss: 0.012937, 0.026689| Seasonal Loss: 0.0274, 0.1176| Residual Loss: 0.0486, 0.3502
Epoch 41/100, (Training, Validation) Trend Loss: 0.005226, 0.015862| Seasonal Loss: 0.0269, 0.1170| Residual Loss: 0.0482, 0.3486
Epoch 42/100, (Training, Validation) Trend Loss: 0.003708, 0.012062| Seasonal Loss: 0.0264, 0.1164| Residual Loss: 0.0478, 0.3471
Epoch 43/100, (Training, Validation) Trend Loss: 0.003309, 0.011097| Seasonal Loss: 0.0259, 0.1160| Residual Loss: 0.0475, 0.3457
Epoch 44/100, (Training, Validation) Trend Loss: 0.003012, 0.010421| Seasonal Loss: 0.0255, 0.1157| Residual Loss: 0.0472, 0.3443
Epoch 45/100, (Training, Validation) Trend Loss: 0.002810, 0.009743| Seasonal Loss: 0.0250, 0.1156| Residual Loss: 0.0469, 0.3431
Epoch 46/100, (Training, Validation) Trend Loss: 0.002662, 0.009141| Seasonal Loss: 0.0244, 0.1156| Residual Loss: 0.0466, 0.3419
Epoch 47/100, (Training, Validation) Trend Loss: 0.002544, 0.008611| Seasonal Loss: 0.0238, 0.1156| Residual Loss: 0.0463, 0.3407
Epoch 48/100, (Training, Validation) Trend Loss: 0.002443, 0.008143| Seasonal Loss: 0.0232, 0.1155| Residual Loss: 0.0461, 0.3397
Epoch 49/100, (Training, Validation) Trend Loss: 0.002356, 0.007726| Seasonal Loss: 0.0225, 0.1153| Residual Loss: 0.0458, 0.3387
Epoch 50/100, (Training, Validation) Trend Loss: 0.002281, 0.007352| Seasonal Loss: 0.0218, 0.1149| Residual Loss: 0.0456, 0.3377
Epoch 51/100, (Training, Validation) Trend Loss: 0.002217, 0.007016| Seasonal Loss: 0.0212, 0.1144| Residual Loss: 0.0454, 0.3368
Epoch 52/100, (Training, Validation) Trend Loss: 0.002161, 0.006712| Seasonal Loss: 0.0206, 0.1138| Residual Loss: 0.0452, 0.3359
Epoch 53/100, (Training, Validation) Trend Loss: 0.002113, 0.006437| Seasonal Loss: 0.0201, 0.1132| Residual Loss: 0.0450, 0.3351
Epoch 54/100, (Training, Validation) Trend Loss: 0.002071, 0.006187| Seasonal Loss: 0.0196, 0.1126| Residual Loss: 0.0448, 0.3343
Epoch 55/100, (Training, Validation) Trend Loss: 0.002034, 0.005961| Seasonal Loss: 0.0192, 0.1120| Residual Loss: 0.0446, 0.3336
Epoch 56/100, (Training, Validation) Trend Loss: 0.002001, 0.005754| Seasonal Loss: 0.0188, 0.1115| Residual Loss: 0.0445, 0.3329
Epoch 57/100, (Training, Validation) Trend Loss: 0.001971, 0.005565| Seasonal Loss: 0.0184, 0.1109| Residual Loss: 0.0443, 0.3322
Epoch 58/100, (Training, Validation) Trend Loss: 0.001945, 0.005393| Seasonal Loss: 0.0181, 0.1104| Residual Loss: 0.0442, 0.3315
Epoch 59/100, (Training, Validation) Trend Loss: 0.001922, 0.005234| Seasonal Loss: 0.0178, 0.1100| Residual Loss: 0.0440, 0.3309
Epoch 60/100, (Training, Validation) Trend Loss: 0.001900, 0.005089| Seasonal Loss: 0.0175, 0.1095| Residual Loss: 0.0439, 0.3303
Epoch 61/100, (Training, Validation) Trend Loss: 0.001881, 0.004954| Seasonal Loss: 0.0173, 0.1091| Residual Loss: 0.0438, 0.3298
Epoch 62/100, (Training, Validation) Trend Loss: 0.001863, 0.004830| Seasonal Loss: 0.0171, 0.1088| Residual Loss: 0.0436, 0.3293
Epoch 63/100, (Training, Validation) Trend Loss: 0.001846, 0.004715| Seasonal Loss: 0.0169, 0.1085| Residual Loss: 0.0435, 0.3288
Epoch 64/100, (Training, Validation) Trend Loss: 0.001831, 0.004609| Seasonal Loss: 0.0167, 0.1082| Residual Loss: 0.0434, 0.3283
Epoch 65/100, (Training, Validation) Trend Loss: 0.001816, 0.004511| Seasonal Loss: 0.0165, 0.1079| Residual Loss: 0.0433, 0.3278
Epoch 66/100, (Training, Validation) Trend Loss: 0.001802, 0.004420| Seasonal Loss: 0.0164, 0.1077| Residual Loss: 0.0432, 0.3274
Epoch 67/100, (Training, Validation) Trend Loss: 0.001789, 0.004337| Seasonal Loss: 0.0162, 0.1075| Residual Loss: 0.0431, 0.3270
Epoch 68/100, (Training, Validation) Trend Loss: 0.001776, 0.004259| Seasonal Loss: 0.0161, 0.1073| Residual Loss: 0.0430, 0.3266
Epoch 69/100, (Training, Validation) Trend Loss: 0.001763, 0.004188| Seasonal Loss: 0.0159, 0.1071| Residual Loss: 0.0429, 0.3262
Epoch 70/100, (Training, Validation) Trend Loss: 0.001751, 0.004123| Seasonal Loss: 0.0158, 0.1070| Residual Loss: 0.0429, 0.3259
Epoch 71/100, (Training, Validation) Trend Loss: 0.001740, 0.004062| Seasonal Loss: 0.0157, 0.1068| Residual Loss: 0.0428, 0.3255
Epoch 72/100, (Training, Validation) Trend Loss: 0.001729, 0.004006| Seasonal Loss: 0.0156, 0.1067| Residual Loss: 0.0427, 0.3252
Epoch 73/100, (Training, Validation) Trend Loss: 0.001718, 0.003955| Seasonal Loss: 0.0155, 0.1066| Residual Loss: 0.0426, 0.3249
Epoch 74/100, (Training, Validation) Trend Loss: 0.001707, 0.003908| Seasonal Loss: 0.0154, 0.1065| Residual Loss: 0.0426, 0.3246
Epoch 75/100, (Training, Validation) Trend Loss: 0.001697, 0.003864| Seasonal Loss: 0.0153, 0.1064| Residual Loss: 0.0425, 0.3243
Epoch 76/100, (Training, Validation) Trend Loss: 0.001688, 0.003824| Seasonal Loss: 0.0152, 0.1063| Residual Loss: 0.0424, 0.3241
Epoch 77/100, (Training, Validation) Trend Loss: 0.001679, 0.003787| Seasonal Loss: 0.0152, 0.1063| Residual Loss: 0.0424, 0.3238
Epoch 78/100, (Training, Validation) Trend Loss: 0.001670, 0.003752| Seasonal Loss: 0.0151, 0.1062| Residual Loss: 0.0423, 0.3236
Epoch 79/100, (Training, Validation) Trend Loss: 0.001661, 0.003720| Seasonal Loss: 0.0150, 0.1062| Residual Loss: 0.0423, 0.3233
Epoch 80/100, (Training, Validation) Trend Loss: 0.001653, 0.003690| Seasonal Loss: 0.0150, 0.1061| Residual Loss: 0.0422, 0.3231
Epoch 81/100, (Training, Validation) Trend Loss: 0.001646, 0.003662| Seasonal Loss: 0.0149, 0.1061| Residual Loss: 0.0422, 0.3229
Epoch 82/100, (Training, Validation) Trend Loss: 0.001638, 0.003635| Seasonal Loss: 0.0148, 0.1060| Residual Loss: 0.0421, 0.3227
Epoch 83/100, (Training, Validation) Trend Loss: 0.001631, 0.003610| Seasonal Loss: 0.0148, 0.1060| Residual Loss: 0.0421, 0.3225
Epoch 84/100, (Training, Validation) Trend Loss: 0.001624, 0.003586| Seasonal Loss: 0.0147, 0.1060| Residual Loss: 0.0420, 0.3223
Epoch 85/100, (Training, Validation) Trend Loss: 0.001618, 0.003564| Seasonal Loss: 0.0147, 0.1059| Residual Loss: 0.0420, 0.3221
Epoch 86/100, (Training, Validation) Trend Loss: 0.001612, 0.003543| Seasonal Loss: 0.0146, 0.1059| Residual Loss: 0.0419, 0.3220
Epoch 87/100, (Training, Validation) Trend Loss: 0.001606, 0.003523| Seasonal Loss: 0.0146, 0.1059| Residual Loss: 0.0419, 0.3218
Epoch 88/100, (Training, Validation) Trend Loss: 0.001600, 0.003503| Seasonal Loss: 0.0145, 0.1059| Residual Loss: 0.0419, 0.3217
Epoch 89/100, (Training, Validation) Trend Loss: 0.001595, 0.003485| Seasonal Loss: 0.0145, 0.1058| Residual Loss: 0.0418, 0.3215
Epoch 90/100, (Training, Validation) Trend Loss: 0.001590, 0.003468| Seasonal Loss: 0.0145, 0.1058| Residual Loss: 0.0418, 0.3214
Epoch 91/100, (Training, Validation) Trend Loss: 0.001585, 0.003451| Seasonal Loss: 0.0144, 0.1058| Residual Loss: 0.0418, 0.3213
Epoch 92/100, (Training, Validation) Trend Loss: 0.001580, 0.003435| Seasonal Loss: 0.0144, 0.1058| Residual Loss: 0.0418, 0.3211
Epoch 93/100, (Training, Validation) Trend Loss: 0.001575, 0.003420| Seasonal Loss: 0.0144, 0.1058| Residual Loss: 0.0417, 0.3210
Epoch 94/100, (Training, Validation) Trend Loss: 0.001571, 0.003406| Seasonal Loss: 0.0143, 0.1058| Residual Loss: 0.0417, 0.3209
Epoch 95/100, (Training, Validation) Trend Loss: 0.001567, 0.003392| Seasonal Loss: 0.0143, 0.1057| Residual Loss: 0.0417, 0.3208
Epoch 96/100, (Training, Validation) Trend Loss: 0.001563, 0.003378| Seasonal Loss: 0.0143, 0.1057| Residual Loss: 0.0416, 0.3207
Epoch 97/100, (Training, Validation) Trend Loss: 0.001559, 0.003366| Seasonal Loss: 0.0142, 0.1057| Residual Loss: 0.0416, 0.3206
Epoch 98/100, (Training, Validation) Trend Loss: 0.001555, 0.003353| Seasonal Loss: 0.0142, 0.1057| Residual Loss: 0.0416, 0.3205
Epoch 99/100, (Training, Validation) Trend Loss: 0.001552, 0.003342| Seasonal Loss: 0.0142, 0.1057| Residual Loss: 0.0416, 0.3204
Epoch 100/100, (Training, Validation) Trend Loss: 0.001549, 0.003330| Seasonal Loss: 0.0142, 0.1057| Residual Loss: 0.0416, 0.3203
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:246: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:247: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:248: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[165.30520429]
[-2.45212821]
[15.25774906]
[178.11082514]
actual_stock_price: [178.05718994 176.67614746 179.40844727 179.79592896 182.60772705
 182.1308136  182.76670837 184.81344604 183.73048401 183.81988525]
add_predicted_stock_price: [178.05718994 176.67614746 179.40844727 179.79592896 182.60772705
 182.1308136  182.76670837 184.81344604 183.73048401 178.11082514]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:294: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
