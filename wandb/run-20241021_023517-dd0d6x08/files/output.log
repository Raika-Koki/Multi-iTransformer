[*********************100%%**********************]  1 of 1 completed
Date
2012-05-18     18.384155
2012-05-21     18.368320
2012-05-22     18.352495
2012-05-23     18.336682
2012-05-24     18.320879
                 ...
2023-06-13    165.192611
2023-06-14    165.257762
2023-06-15    165.322910
2023-06-16    165.388056
2023-06-20    165.453198
Name: trend, Length: 2789, dtype: float64
Date
2012-05-18    -2.020072
2012-05-21    -1.334498
2012-05-22    -1.367996
2012-05-23    -1.136496
2012-05-24    -1.130976
                ...
2023-06-13   -16.051044
2023-06-14     0.585724
2023-06-15    -0.695799
2023-06-16   -19.510939
2023-06-20     2.806959
Name: season, Length: 2789, dtype: float64
Date
2012-05-18    -0.367913
2012-05-21    -0.105707
2012-05-22    -0.186377
2012-05-23     0.007812
2012-05-24    -0.139943
                ...
2023-06-13    32.989247
2023-06-14    16.923208
2023-06-15    20.186335
2023-06-16    37.853352
2023-06-20    15.559713
Name: resid, Length: 2789, dtype: float64
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.153220, 0.599462| Seasonal Loss: 0.3315, 0.2979| Residual Loss: 0.1514, 0.7805
Epoch 2/100, (Training, Validation) Trend Loss: 0.091811, 0.386353| Seasonal Loss: 0.1262, 0.3242| Residual Loss: 0.1117, 0.5369
Epoch 3/100, (Training, Validation) Trend Loss: 0.090758, 0.273855| Seasonal Loss: 0.1019, 0.3515| Residual Loss: 0.0810, 0.4764
Epoch 4/100, (Training, Validation) Trend Loss: 0.091166, 0.176967| Seasonal Loss: 0.0905, 0.3299| Residual Loss: 0.0709, 0.4327
Epoch 5/100, (Training, Validation) Trend Loss: 0.091239, 0.122957| Seasonal Loss: 0.0820, 0.3027| Residual Loss: 0.0625, 0.4040
Epoch 6/100, (Training, Validation) Trend Loss: 0.081195, 0.115847| Seasonal Loss: 0.0738, 0.2781| Residual Loss: 0.0577, 0.3837
Epoch 7/100, (Training, Validation) Trend Loss: 0.059741, 0.082889| Seasonal Loss: 0.0664, 0.2527| Residual Loss: 0.0545, 0.3688
Epoch 8/100, (Training, Validation) Trend Loss: 0.046863, 0.066159| Seasonal Loss: 0.0607, 0.2311| Residual Loss: 0.0521, 0.3578
Epoch 9/100, (Training, Validation) Trend Loss: 0.036662, 0.142691| Seasonal Loss: 0.0571, 0.2148| Residual Loss: 0.0502, 0.3491
Epoch 10/100, (Training, Validation) Trend Loss: 0.036878, 0.192876| Seasonal Loss: 0.0547, 0.2022| Residual Loss: 0.0487, 0.3419
Epoch 11/100, (Training, Validation) Trend Loss: 0.040680, 0.336112| Seasonal Loss: 0.0526, 0.1923| Residual Loss: 0.0473, 0.3359
Epoch 12/100, (Training, Validation) Trend Loss: 0.056235, 0.209398| Seasonal Loss: 0.0507, 0.1848| Residual Loss: 0.0462, 0.3306
Epoch 13/100, (Training, Validation) Trend Loss: 0.083195, 0.030313| Seasonal Loss: 0.0488, 0.1794| Residual Loss: 0.0451, 0.3259
Epoch 14/100, (Training, Validation) Trend Loss: 0.055574, 0.024961| Seasonal Loss: 0.0469, 0.1753| Residual Loss: 0.0441, 0.3216
Epoch 15/100, (Training, Validation) Trend Loss: 0.030155, 0.031423| Seasonal Loss: 0.0450, 0.1719| Residual Loss: 0.0432, 0.3178
Epoch 16/100, (Training, Validation) Trend Loss: 0.019173, 0.025547| Seasonal Loss: 0.0432, 0.1685| Residual Loss: 0.0424, 0.3143
Epoch 17/100, (Training, Validation) Trend Loss: 0.013727, 0.021247| Seasonal Loss: 0.0415, 0.1647| Residual Loss: 0.0417, 0.3110
Epoch 18/100, (Training, Validation) Trend Loss: 0.011333, 0.019941| Seasonal Loss: 0.0398, 0.1603| Residual Loss: 0.0410, 0.3080
Epoch 19/100, (Training, Validation) Trend Loss: 0.009665, 0.019471| Seasonal Loss: 0.0382, 0.1551| Residual Loss: 0.0403, 0.3053
Epoch 20/100, (Training, Validation) Trend Loss: 0.008445, 0.018686| Seasonal Loss: 0.0365, 0.1496| Residual Loss: 0.0397, 0.3027
Epoch 21/100, (Training, Validation) Trend Loss: 0.007526, 0.016989| Seasonal Loss: 0.0345, 0.1446| Residual Loss: 0.0391, 0.3003
Epoch 22/100, (Training, Validation) Trend Loss: 0.006723, 0.014559| Seasonal Loss: 0.0325, 0.1413| Residual Loss: 0.0386, 0.2981
Epoch 23/100, (Training, Validation) Trend Loss: 0.005875, 0.012160| Seasonal Loss: 0.0308, 0.1407| Residual Loss: 0.0381, 0.2960
Epoch 24/100, (Training, Validation) Trend Loss: 0.004944, 0.010274| Seasonal Loss: 0.0295, 0.1420| Residual Loss: 0.0376, 0.2940
Epoch 25/100, (Training, Validation) Trend Loss: 0.004017, 0.008848| Seasonal Loss: 0.0272, 0.1446| Residual Loss: 0.0372, 0.2922
Epoch 26/100, (Training, Validation) Trend Loss: 0.003223, 0.007678| Seasonal Loss: 0.0262, 0.1506| Residual Loss: 0.0368, 0.2904
Epoch 27/100, (Training, Validation) Trend Loss: 0.002676, 0.006643| Seasonal Loss: 0.0261, 0.1548| Residual Loss: 0.0364, 0.2888
Epoch 28/100, (Training, Validation) Trend Loss: 0.002424, 0.005738| Seasonal Loss: 0.0258, 0.1628| Residual Loss: 0.0360, 0.2873
Epoch 29/100, (Training, Validation) Trend Loss: 0.002419, 0.005051| Seasonal Loss: 0.0257, 0.1813| Residual Loss: 0.0357, 0.2858
Epoch 30/100, (Training, Validation) Trend Loss: 0.002553, 0.004673| Seasonal Loss: 0.0252, 0.2008| Residual Loss: 0.0353, 0.2845
Epoch 31/100, (Training, Validation) Trend Loss: 0.002731, 0.004631| Seasonal Loss: 0.0258, 0.2689| Residual Loss: 0.0350, 0.2832
Epoch 32/100, (Training, Validation) Trend Loss: 0.002881, 0.004951| Seasonal Loss: 0.0269, 0.3991| Residual Loss: 0.0347, 0.2820
Epoch 33/100, (Training, Validation) Trend Loss: 0.002936, 0.005750| Seasonal Loss: 0.0292, 0.5229| Residual Loss: 0.0345, 0.2808
Epoch 34/100, (Training, Validation) Trend Loss: 0.002838, 0.007180| Seasonal Loss: 0.0347, 0.5387| Residual Loss: 0.0342, 0.2797
Epoch 35/100, (Training, Validation) Trend Loss: 0.002584, 0.009235| Seasonal Loss: 0.0503, 0.2673| Residual Loss: 0.0340, 0.2787
Epoch 36/100, (Training, Validation) Trend Loss: 0.002258, 0.011621| Seasonal Loss: 0.0610, 0.1385| Residual Loss: 0.0337, 0.2777
Epoch 37/100, (Training, Validation) Trend Loss: 0.002011, 0.013803| Seasonal Loss: 0.0468, 0.1396| Residual Loss: 0.0335, 0.2768
Epoch 38/100, (Training, Validation) Trend Loss: 0.001980, 0.014978| Seasonal Loss: 0.0307, 0.1508| Residual Loss: 0.0333, 0.2759
Epoch 39/100, (Training, Validation) Trend Loss: 0.002198, 0.014285| Seasonal Loss: 0.0233, 0.1270| Residual Loss: 0.0331, 0.2751
Epoch 40/100, (Training, Validation) Trend Loss: 0.002521, 0.011824| Seasonal Loss: 0.0227, 0.1321| Residual Loss: 0.0329, 0.2743
Epoch 41/100, (Training, Validation) Trend Loss: 0.002668, 0.009077| Seasonal Loss: 0.0210, 0.1226| Residual Loss: 0.0328, 0.2736
Epoch 42/100, (Training, Validation) Trend Loss: 0.002501, 0.007250| Seasonal Loss: 0.0207, 0.1242| Residual Loss: 0.0326, 0.2729
Epoch 43/100, (Training, Validation) Trend Loss: 0.002184, 0.006373| Seasonal Loss: 0.0201, 0.1209| Residual Loss: 0.0324, 0.2722
Epoch 44/100, (Training, Validation) Trend Loss: 0.001923, 0.006026| Seasonal Loss: 0.0200, 0.1208| Residual Loss: 0.0323, 0.2716
Epoch 45/100, (Training, Validation) Trend Loss: 0.001784, 0.005896| Seasonal Loss: 0.0197, 0.1196| Residual Loss: 0.0321, 0.2710
Epoch 46/100, (Training, Validation) Trend Loss: 0.001729, 0.005857| Seasonal Loss: 0.0195, 0.1191| Residual Loss: 0.0320, 0.2704
Epoch 47/100, (Training, Validation) Trend Loss: 0.001709, 0.005866| Seasonal Loss: 0.0193, 0.1184| Residual Loss: 0.0319, 0.2699
Epoch 48/100, (Training, Validation) Trend Loss: 0.001696, 0.005895| Seasonal Loss: 0.0192, 0.1179| Residual Loss: 0.0318, 0.2693
Epoch 49/100, (Training, Validation) Trend Loss: 0.001682, 0.005923| Seasonal Loss: 0.0190, 0.1174| Residual Loss: 0.0316, 0.2689
Epoch 50/100, (Training, Validation) Trend Loss: 0.001667, 0.005931| Seasonal Loss: 0.0188, 0.1170| Residual Loss: 0.0315, 0.2684
Epoch 51/100, (Training, Validation) Trend Loss: 0.001653, 0.005909| Seasonal Loss: 0.0187, 0.1166| Residual Loss: 0.0314, 0.2679
Epoch 52/100, (Training, Validation) Trend Loss: 0.001640, 0.005854| Seasonal Loss: 0.0185, 0.1162| Residual Loss: 0.0313, 0.2675
Epoch 53/100, (Training, Validation) Trend Loss: 0.001630, 0.005772| Seasonal Loss: 0.0184, 0.1159| Residual Loss: 0.0312, 0.2671
Epoch 54/100, (Training, Validation) Trend Loss: 0.001621, 0.005670| Seasonal Loss: 0.0182, 0.1156| Residual Loss: 0.0312, 0.2667
Epoch 55/100, (Training, Validation) Trend Loss: 0.001613, 0.005557| Seasonal Loss: 0.0181, 0.1152| Residual Loss: 0.0311, 0.2664
Epoch 56/100, (Training, Validation) Trend Loss: 0.001604, 0.005441| Seasonal Loss: 0.0180, 0.1149| Residual Loss: 0.0310, 0.2660
Epoch 57/100, (Training, Validation) Trend Loss: 0.001596, 0.005328| Seasonal Loss: 0.0178, 0.1147| Residual Loss: 0.0309, 0.2657
Epoch 58/100, (Training, Validation) Trend Loss: 0.001587, 0.005223| Seasonal Loss: 0.0177, 0.1144| Residual Loss: 0.0308, 0.2654
Epoch 59/100, (Training, Validation) Trend Loss: 0.001578, 0.005127| Seasonal Loss: 0.0176, 0.1141| Residual Loss: 0.0308, 0.2651
Epoch 60/100, (Training, Validation) Trend Loss: 0.001569, 0.005038| Seasonal Loss: 0.0175, 0.1139| Residual Loss: 0.0307, 0.2648
Epoch 61/100, (Training, Validation) Trend Loss: 0.001561, 0.004957| Seasonal Loss: 0.0174, 0.1136| Residual Loss: 0.0306, 0.2645
Epoch 62/100, (Training, Validation) Trend Loss: 0.001553, 0.004881| Seasonal Loss: 0.0173, 0.1134| Residual Loss: 0.0306, 0.2643
Epoch 63/100, (Training, Validation) Trend Loss: 0.001546, 0.004811| Seasonal Loss: 0.0172, 0.1131| Residual Loss: 0.0305, 0.2640
Epoch 64/100, (Training, Validation) Trend Loss: 0.001539, 0.004744| Seasonal Loss: 0.0171, 0.1129| Residual Loss: 0.0305, 0.2638
Epoch 65/100, (Training, Validation) Trend Loss: 0.001532, 0.004680| Seasonal Loss: 0.0170, 0.1127| Residual Loss: 0.0304, 0.2636
Epoch 66/100, (Training, Validation) Trend Loss: 0.001526, 0.004620| Seasonal Loss: 0.0170, 0.1125| Residual Loss: 0.0304, 0.2634
Epoch 67/100, (Training, Validation) Trend Loss: 0.001520, 0.004561| Seasonal Loss: 0.0169, 0.1123| Residual Loss: 0.0303, 0.2632
Epoch 68/100, (Training, Validation) Trend Loss: 0.001514, 0.004505| Seasonal Loss: 0.0168, 0.1121| Residual Loss: 0.0303, 0.2630
Epoch 69/100, (Training, Validation) Trend Loss: 0.001509, 0.004451| Seasonal Loss: 0.0167, 0.1119| Residual Loss: 0.0303, 0.2628
Epoch 70/100, (Training, Validation) Trend Loss: 0.001504, 0.004400| Seasonal Loss: 0.0167, 0.1117| Residual Loss: 0.0302, 0.2626
Epoch 71/100, (Training, Validation) Trend Loss: 0.001498, 0.004351| Seasonal Loss: 0.0166, 0.1115| Residual Loss: 0.0302, 0.2624
Epoch 72/100, (Training, Validation) Trend Loss: 0.001494, 0.004305| Seasonal Loss: 0.0166, 0.1114| Residual Loss: 0.0301, 0.2623
Epoch 73/100, (Training, Validation) Trend Loss: 0.001489, 0.004261| Seasonal Loss: 0.0165, 0.1112| Residual Loss: 0.0301, 0.2621
Epoch 74/100, (Training, Validation) Trend Loss: 0.001485, 0.004218| Seasonal Loss: 0.0165, 0.1110| Residual Loss: 0.0301, 0.2620
Epoch 75/100, (Training, Validation) Trend Loss: 0.001480, 0.004178| Seasonal Loss: 0.0164, 0.1109| Residual Loss: 0.0300, 0.2619
Epoch 76/100, (Training, Validation) Trend Loss: 0.001476, 0.004140| Seasonal Loss: 0.0164, 0.1107| Residual Loss: 0.0300, 0.2617
Epoch 77/100, (Training, Validation) Trend Loss: 0.001472, 0.004104| Seasonal Loss: 0.0163, 0.1106| Residual Loss: 0.0300, 0.2616
Epoch 78/100, (Training, Validation) Trend Loss: 0.001469, 0.004069| Seasonal Loss: 0.0163, 0.1105| Residual Loss: 0.0300, 0.2615
Epoch 79/100, (Training, Validation) Trend Loss: 0.001465, 0.004036| Seasonal Loss: 0.0162, 0.1104| Residual Loss: 0.0299, 0.2614
Epoch 80/100, (Training, Validation) Trend Loss: 0.001462, 0.004004| Seasonal Loss: 0.0162, 0.1102| Residual Loss: 0.0299, 0.2613
Epoch 81/100, (Training, Validation) Trend Loss: 0.001458, 0.003974| Seasonal Loss: 0.0161, 0.1101| Residual Loss: 0.0299, 0.2612
Epoch 82/100, (Training, Validation) Trend Loss: 0.001455, 0.003946| Seasonal Loss: 0.0161, 0.1100| Residual Loss: 0.0299, 0.2611
Epoch 83/100, (Training, Validation) Trend Loss: 0.001452, 0.003918| Seasonal Loss: 0.0161, 0.1099| Residual Loss: 0.0298, 0.2610
Epoch 84/100, (Training, Validation) Trend Loss: 0.001449, 0.003892| Seasonal Loss: 0.0160, 0.1098| Residual Loss: 0.0298, 0.2609
Epoch 85/100, (Training, Validation) Trend Loss: 0.001447, 0.003867| Seasonal Loss: 0.0160, 0.1097| Residual Loss: 0.0298, 0.2608
Epoch 86/100, (Training, Validation) Trend Loss: 0.001444, 0.003842| Seasonal Loss: 0.0160, 0.1096| Residual Loss: 0.0298, 0.2607
Epoch 87/100, (Training, Validation) Trend Loss: 0.001442, 0.003819| Seasonal Loss: 0.0159, 0.1095| Residual Loss: 0.0298, 0.2607
Epoch 88/100, (Training, Validation) Trend Loss: 0.001439, 0.003797| Seasonal Loss: 0.0159, 0.1095| Residual Loss: 0.0298, 0.2606
Epoch 89/100, (Training, Validation) Trend Loss: 0.001437, 0.003776| Seasonal Loss: 0.0159, 0.1094| Residual Loss: 0.0297, 0.2605
Epoch 90/100, (Training, Validation) Trend Loss: 0.001435, 0.003756| Seasonal Loss: 0.0158, 0.1093| Residual Loss: 0.0297, 0.2605
Epoch 91/100, (Training, Validation) Trend Loss: 0.001433, 0.003737| Seasonal Loss: 0.0158, 0.1092| Residual Loss: 0.0297, 0.2604
Epoch 92/100, (Training, Validation) Trend Loss: 0.001431, 0.003718| Seasonal Loss: 0.0158, 0.1092| Residual Loss: 0.0297, 0.2603
Epoch 93/100, (Training, Validation) Trend Loss: 0.001429, 0.003700| Seasonal Loss: 0.0158, 0.1091| Residual Loss: 0.0297, 0.2603
Epoch 94/100, (Training, Validation) Trend Loss: 0.001427, 0.003683| Seasonal Loss: 0.0157, 0.1090| Residual Loss: 0.0297, 0.2602
Epoch 95/100, (Training, Validation) Trend Loss: 0.001425, 0.003667| Seasonal Loss: 0.0157, 0.1090| Residual Loss: 0.0297, 0.2602
Epoch 96/100, (Training, Validation) Trend Loss: 0.001423, 0.003651| Seasonal Loss: 0.0157, 0.1089| Residual Loss: 0.0297, 0.2601
Epoch 97/100, (Training, Validation) Trend Loss: 0.001422, 0.003636| Seasonal Loss: 0.0157, 0.1088| Residual Loss: 0.0296, 0.2601
Epoch 98/100, (Training, Validation) Trend Loss: 0.001420, 0.003622| Seasonal Loss: 0.0157, 0.1088| Residual Loss: 0.0296, 0.2600
Epoch 99/100, (Training, Validation) Trend Loss: 0.001419, 0.003608| Seasonal Loss: 0.0156, 0.1087| Residual Loss: 0.0296, 0.2600
Epoch 100/100, (Training, Validation) Trend Loss: 0.001417, 0.003595| Seasonal Loss: 0.0156, 0.1087| Residual Loss: 0.0296, 0.2600
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:250: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:251: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:252: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[164.01474148]
[-2.62430034]
[19.40139051]
[180.79183165]
actual_stock_price: [178.05718994 176.6761322  179.40844727 179.79594421 182.60772705
 182.1308136  182.76669312 184.81344604 183.73046875 183.81987   ]
add_predicted_stock_price: [178.05718994 176.6761322  179.40844727 179.79594421 182.60772705
 182.1308136  182.76669312 184.81344604 183.73046875 180.79183165]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:298: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
