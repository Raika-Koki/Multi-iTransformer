Using device: cuda
[*********************100%***********************]  1 of 1 completed
Ticker            AAPL
Date
2012-05-18   15.978593
2012-05-21   16.909506
2012-05-22   16.779663
2012-05-23   17.189077
2012-05-24   17.031214
...                ...
2023-05-24  170.546951
2023-05-25  171.688278
2023-05-26  174.109940
2023-05-30  175.965881
2023-05-31  175.916260

[2776 rows x 1 columns]
/data/student/k2110261/Multi-iTransformer/optunademo.py:104: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df = df.fillna(method='ffill')  # ÂâçÊó•„ÅÆ„Éá„Éº„Çø„Çí‰ΩøÁî®
{'AAPL': Date
2012-05-18     18.353259
2012-05-21     18.337501
2012-05-22     18.321753
2012-05-23     18.306016
2012-05-24     18.290289
                 ...
2023-05-24    161.245420
2023-05-25    161.302991
2023-05-26    161.360559
2023-05-30    161.418123
2023-05-31    161.475683
Name: trend, Length: 2776, dtype: float64, 'DTWEXBGS': Date
2012-05-18     93.1395
2012-05-21     93.0945
2012-05-22     93.1113
2012-05-23     93.8855
2012-05-24     93.8027
                ...
2023-05-24    120.6481
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
Length: 2776, dtype: float64, 'VIXCLS': Date
2012-05-18    25.10
2012-05-21    22.01
2012-05-22    22.48
2012-05-23    22.33
2012-05-24    21.54
              ...
2023-05-24    20.03
2023-05-25    19.14
2023-05-26    17.95
2023-05-30    17.46
2023-05-31    17.94
Length: 2776, dtype: float64, 'DFII10': Date
2012-05-18   -0.39
2012-05-21   -0.41
2012-05-22   -0.38
2012-05-23   -0.41
2012-05-24   -0.37
              ...
2023-05-24    1.48
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
Length: 2776, dtype: float64, 'T10Y2Y': Date
2012-05-18    1.39
2012-05-21    1.45
2012-05-22    1.49
2012-05-23    1.45
2012-05-24    1.48
              ...
2023-05-24   -0.58
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
Length: 2776, dtype: float64}
AAPL„Å´„ÅÇ„Çã„Åå‰ªñ„ÅÆ„Éá„Éº„Çø1„Å´„ÅØ„Å™„ÅÑÊó•‰ªò: DatetimeIndex([], dtype='datetime64[ns]', name='Date', freq=None)
‰ªñ„ÅÆ„Éá„Éº„Çø1„Å´„ÅÇ„Çã„ÅåAAPL„Å´„ÅØ„Å™„ÅÑÊó•‰ªò: DatetimeIndex([], dtype='datetime64[ns]', name='Date', freq=None)
Price        BB_Upper   BB_Lower  BB_Middle      MACD MACD_Signal MACD_Diff        RSI     SMA_50    SMA_200
Ticker
Date
2012-05-18        NaN        NaN        NaN       NaN         NaN       NaN        NaN        NaN        NaN
2012-05-21        NaN        NaN        NaN       NaN         NaN       NaN        NaN        NaN        NaN
2012-05-22        NaN        NaN        NaN       NaN         NaN       NaN        NaN        NaN        NaN
2012-05-23        NaN        NaN        NaN       NaN         NaN       NaN        NaN        NaN        NaN
2012-05-24        NaN        NaN        NaN       NaN         NaN       NaN        NaN        NaN        NaN
...               ...        ...        ...       ...         ...       ...        ...        ...        ...
2013-03-01  14.677093  13.140850  13.908971 -0.369112   -0.353563 -0.015549  33.353632  14.770322        NaN
2013-03-04  14.759453  12.963896  13.861675 -0.410699   -0.364990 -0.045709  29.978426  14.702602        NaN
2013-03-05  14.777593  12.919414  13.848503 -0.411555   -0.374303 -0.037252  37.255836  14.646277        NaN
2013-03-06  14.800248  12.806489  13.803369 -0.420901   -0.383623 -0.037278  35.303288  14.589385        NaN
2013-03-07  14.800104  12.732895  13.766500 -0.411427   -0.389184 -0.022244  38.423641  14.536961  17.349991

[200 rows x 9 columns]
{'AAPL': Date
2012-05-18     18.353259
2012-05-21     18.337501
2012-05-22     18.321753
2012-05-23     18.306016
2012-05-24     18.290289
                 ...
2023-05-24    161.245420
2023-05-25    161.302991
2023-05-26    161.360559
2023-05-30    161.418123
2023-05-31    161.475683
Name: trend, Length: 2776, dtype: float64, 'DTWEXBGS': Date
2012-05-18     93.1395
2012-05-21     93.0945
2012-05-22     93.1113
2012-05-23     93.8855
2012-05-24     93.8027
                ...
2023-05-24    120.6481
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
Length: 2776, dtype: float64, 'VIXCLS': Date
2012-05-18    25.10
2012-05-21    22.01
2012-05-22    22.48
2012-05-23    22.33
2012-05-24    21.54
              ...
2023-05-24    20.03
2023-05-25    19.14
2023-05-26    17.95
2023-05-30    17.46
2023-05-31    17.94
Length: 2776, dtype: float64, 'DFII10': Date
2012-05-18   -0.39
2012-05-21   -0.41
2012-05-22   -0.38
2012-05-23   -0.41
2012-05-24   -0.37
              ...
2023-05-24    1.48
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
Length: 2776, dtype: float64, 'T10Y2Y': Date
2012-05-18    1.39
2012-05-21    1.45
2012-05-22    1.49
2012-05-23    1.45
2012-05-24    1.48
              ...
2023-05-24   -0.58
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
Length: 2776, dtype: float64, 'BB_Upper': Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    175.360195
2023-05-25    175.401880
2023-05-26    175.825119
2023-05-30    176.541929
2023-05-31    177.020399
Name: BB_Upper, Length: 2776, dtype: float64, 'BB_Lower': Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    165.081596
2023-05-25    165.517549
2023-05-26    165.688244
2023-05-30    165.759884
2023-05-31    166.168966
Name: BB_Lower, Length: 2776, dtype: float64, 'BB_Middle': Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    170.220895
2023-05-25    170.459715
2023-05-26    170.756682
2023-05-30    171.150906
2023-05-31    171.594682
Name: BB_Middle, Length: 2776, dtype: float64, 'MACD': Date
2012-05-18         NaN
2012-05-21         NaN
2012-05-22         NaN
2012-05-23         NaN
2012-05-24         NaN
                ...
2023-05-24    2.332938
2023-05-25    2.209839
2023-05-26    2.281391
2023-05-30    2.459504
2023-05-31    2.567065
Name: MACD, Length: 2776, dtype: float64, 'MACD_Signal': Date
2012-05-18         NaN
2012-05-21         NaN
2012-05-22         NaN
2012-05-23         NaN
2012-05-24         NaN
                ...
2023-05-24    2.724339
2023-05-25    2.621439
2023-05-26    2.553429
2023-05-30    2.534644
2023-05-31    2.541128
Name: MACD_Signal, Length: 2776, dtype: float64, 'MACD_Diff': Date
2012-05-18         NaN
2012-05-21         NaN
2012-05-22         NaN
2012-05-23         NaN
2012-05-24         NaN
                ...
2023-05-24   -0.391401
2023-05-25   -0.411600
2023-05-26   -0.272038
2023-05-30   -0.075140
2023-05-31    0.025936
Name: MACD_Diff, Length: 2776, dtype: float64, 'RSI': Date
2012-05-18          NaN
2012-05-21          NaN
2012-05-22          NaN
2012-05-23          NaN
2012-05-24          NaN
                ...
2023-05-24    55.867146
2023-05-25    58.637704
2023-05-26    63.826680
2023-05-30    67.220685
2023-05-31    67.039574
Name: RSI, Length: 2776, dtype: float64, 'SMA_50': Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    164.409242
2023-05-25    164.810426
2023-05-26    165.203353
2023-05-30    165.650247
2023-05-31    166.048575
Name: SMA_50, Length: 2776, dtype: float64, 'SMA_200': Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    150.685264
2023-05-25    150.729038
2023-05-26    150.763580
2023-05-30    150.811107
2023-05-31    150.840554
Name: SMA_200, Length: 2776, dtype: float64}
[32m[I 2024-11-17 02:53:26,019][0m A new study created in memory with name: no-name-03386007-50ad-4aa0-b84f-57c3849b74f2[0m
/data/student/k2110261/Multi-iTransformer/optunademo.py:199: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  learning_rate = trial.suggest_loguniform('learning_rate', 1e-6, 1e-3)
Non-A100 GPU detected, using math or mem efficient attention if input tensor is on cuda
[33m[W 2024-11-17 02:53:27,962][0m Trial 0 failed with parameters: {'learning_rate': 0.0004191349227088764, 'batch_size': 247, 'step_size': 11, 'gamma': 0.7806156071002791, 'depth': 4, 'dim': 103} because of the following error: AssertionError().[0m
Traceback (most recent call last):
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/optunademo.py", line 242, in <lambda>
    study_trend.optimize(lambda trial: objective(trial, "trend"), n_trials=1)
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/optunademo.py", line 230, in objective
    model, train_loss, valid_loss = train(
                                    ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 32, in train
    output = model(data)
             ^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<@beartype(src.model.iTransformer.forward) at 0x7fb703de1440>", line 66, in forward
  File "/data/student/k2110261/Multi-iTransformer/src/model.py", line 167, in forward
    assert x.shape[1:] == (self.lookback_len, self.num_variates)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError
[33m[W 2024-11-17 02:53:27,967][0m Trial 0 failed with value None.[0m
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/optunademo.py", line 242, in <module>
    study_trend.optimize(lambda trial: objective(trial, "trend"), n_trials=1)
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/optunademo.py", line 242, in <lambda>
    study_trend.optimize(lambda trial: objective(trial, "trend"), n_trials=1)
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/optunademo.py", line 230, in objective
    model, train_loss, valid_loss = train(
                                    ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 32, in train
    output = model(data)
             ^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<@beartype(src.model.iTransformer.forward) at 0x7fb703de1440>", line 66, in forward
  File "/data/student/k2110261/Multi-iTransformer/src/model.py", line 167, in forward
    assert x.shape[1:] == (self.lookback_len, self.num_variates)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError
