[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 3.1326, 0.3372| Seasonal Loss: 2.3622, 0.4182| Residual Loss: 0.8454, 0.2965
Epoch 2/100, (Training, Validation) Trend Loss: 0.7020, 0.6626| Seasonal Loss: 0.5811, 0.3347| Residual Loss: 0.3850, 0.1725
Epoch 3/100, (Training, Validation) Trend Loss: 0.6768, 0.4492| Seasonal Loss: 0.4095, 0.4653| Residual Loss: 0.2908, 0.2061
Epoch 4/100, (Training, Validation) Trend Loss: 0.5123, 0.3371| Seasonal Loss: 0.3654, 0.6434| Residual Loss: 0.2081, 0.0943
Epoch 5/100, (Training, Validation) Trend Loss: 0.4971, 0.1424| Seasonal Loss: 0.3974, 0.3776| Residual Loss: 0.1951, 0.1603
Epoch 6/100, (Training, Validation) Trend Loss: 0.1672, 0.1594| Seasonal Loss: 0.2275, 0.3078| Residual Loss: 0.1633, 0.0719
Epoch 7/100, (Training, Validation) Trend Loss: 0.1656, 0.1432| Seasonal Loss: 0.2491, 0.2175| Residual Loss: 0.1649, 0.1249
Epoch 8/100, (Training, Validation) Trend Loss: 0.1406, 0.0895| Seasonal Loss: 0.2131, 0.1469| Residual Loss: 0.1427, 0.0615
Epoch 9/100, (Training, Validation) Trend Loss: 0.1419, 0.2162| Seasonal Loss: 0.1453, 0.1525| Residual Loss: 0.1549, 0.1543
Epoch 10/100, (Training, Validation) Trend Loss: 0.1304, 0.2346| Seasonal Loss: 0.0949, 0.1074| Residual Loss: 0.1613, 0.0721
Epoch 11/100, (Training, Validation) Trend Loss: 0.1576, 0.1825| Seasonal Loss: 0.0742, 0.0978| Residual Loss: 0.1822, 0.1228
Epoch 12/100, (Training, Validation) Trend Loss: 0.0993, 0.1162| Seasonal Loss: 0.0624, 0.1067| Residual Loss: 0.1863, 0.0392
Epoch 13/100, (Training, Validation) Trend Loss: 0.0650, 0.0706| Seasonal Loss: 0.0520, 0.1004| Residual Loss: 0.1479, 0.0600
Epoch 14/100, (Training, Validation) Trend Loss: 0.0728, 0.0760| Seasonal Loss: 0.0464, 0.0887| Residual Loss: 0.1170, 0.0466
Epoch 15/100, (Training, Validation) Trend Loss: 0.0560, 0.0981| Seasonal Loss: 0.0443, 0.0825| Residual Loss: 0.1034, 0.0532
Epoch 16/100, (Training, Validation) Trend Loss: 0.1055, 0.0485| Seasonal Loss: 0.0404, 0.0899| Residual Loss: 0.0993, 0.0488
Epoch 17/100, (Training, Validation) Trend Loss: 0.0908, 0.0528| Seasonal Loss: 0.0650, 0.1771| Residual Loss: 0.0950, 0.0452
Epoch 18/100, (Training, Validation) Trend Loss: 0.0475, 0.0653| Seasonal Loss: 0.1284, 0.2676| Residual Loss: 0.0898, 0.0462
Epoch 19/100, (Training, Validation) Trend Loss: 0.0472, 0.0710| Seasonal Loss: 0.1143, 0.1284| Residual Loss: 0.0871, 0.0412
Epoch 20/100, (Training, Validation) Trend Loss: 0.0518, 0.0538| Seasonal Loss: 0.1085, 0.1079| Residual Loss: 0.0840, 0.0394
Epoch 21/100, (Training, Validation) Trend Loss: 0.0928, 0.1645| Seasonal Loss: 0.0629, 0.1262| Residual Loss: 0.0819, 0.0405
Epoch 22/100, (Training, Validation) Trend Loss: 0.0887, 0.0849| Seasonal Loss: 0.0531, 0.1074| Residual Loss: 0.0795, 0.0359
Epoch 23/100, (Training, Validation) Trend Loss: 0.0603, 0.0509| Seasonal Loss: 0.0466, 0.0923| Residual Loss: 0.0773, 0.0396
Epoch 24/100, (Training, Validation) Trend Loss: 0.0468, 0.0639| Seasonal Loss: 0.0377, 0.0817| Residual Loss: 0.0755, 0.0325
Epoch 25/100, (Training, Validation) Trend Loss: 0.0388, 0.0601| Seasonal Loss: 0.0349, 0.0805| Residual Loss: 0.0741, 0.0421
Epoch 26/100, (Training, Validation) Trend Loss: 0.0310, 0.0371| Seasonal Loss: 0.0308, 0.0801| Residual Loss: 0.0736, 0.0281
Epoch 27/100, (Training, Validation) Trend Loss: 0.0303, 0.0377| Seasonal Loss: 0.0278, 0.0730| Residual Loss: 0.0749, 0.0569
Epoch 28/100, (Training, Validation) Trend Loss: 0.0268, 0.0419| Seasonal Loss: 0.0263, 0.0697| Residual Loss: 0.0820, 0.0288
Epoch 29/100, (Training, Validation) Trend Loss: 0.0237, 0.0328| Seasonal Loss: 0.0245, 0.0702| Residual Loss: 0.0935, 0.0760
Epoch 30/100, (Training, Validation) Trend Loss: 0.0220, 0.0278| Seasonal Loss: 0.0232, 0.0698| Residual Loss: 0.1090, 0.0334
Epoch 31/100, (Training, Validation) Trend Loss: 0.0213, 0.0285| Seasonal Loss: 0.0223, 0.0689| Residual Loss: 0.0891, 0.0393
Epoch 32/100, (Training, Validation) Trend Loss: 0.0201, 0.0271| Seasonal Loss: 0.0212, 0.0679| Residual Loss: 0.0781, 0.0452
Epoch 33/100, (Training, Validation) Trend Loss: 0.0192, 0.0238| Seasonal Loss: 0.0204, 0.0675| Residual Loss: 0.0791, 0.0375
Epoch 34/100, (Training, Validation) Trend Loss: 0.0185, 0.0230| Seasonal Loss: 0.0197, 0.0672| Residual Loss: 0.0902, 0.0502
Epoch 35/100, (Training, Validation) Trend Loss: 0.0178, 0.0228| Seasonal Loss: 0.0191, 0.0667| Residual Loss: 0.0915, 0.0577
Epoch 36/100, (Training, Validation) Trend Loss: 0.0173, 0.0215| Seasonal Loss: 0.0185, 0.0663| Residual Loss: 0.0871, 0.0506
Epoch 37/100, (Training, Validation) Trend Loss: 0.0168, 0.0207| Seasonal Loss: 0.0181, 0.0661| Residual Loss: 0.0761, 0.0447
Epoch 38/100, (Training, Validation) Trend Loss: 0.0164, 0.0203| Seasonal Loss: 0.0176, 0.0659| Residual Loss: 0.0684, 0.0356
Epoch 39/100, (Training, Validation) Trend Loss: 0.0160, 0.0197| Seasonal Loss: 0.0172, 0.0657| Residual Loss: 0.0641, 0.0351
Epoch 40/100, (Training, Validation) Trend Loss: 0.0157, 0.0191| Seasonal Loss: 0.0169, 0.0654| Residual Loss: 0.0627, 0.0341
Epoch 41/100, (Training, Validation) Trend Loss: 0.0155, 0.0187| Seasonal Loss: 0.0165, 0.0653| Residual Loss: 0.0620, 0.0337
Epoch 42/100, (Training, Validation) Trend Loss: 0.0152, 0.0184| Seasonal Loss: 0.0163, 0.0651| Residual Loss: 0.0611, 0.0331
Epoch 43/100, (Training, Validation) Trend Loss: 0.0150, 0.0180| Seasonal Loss: 0.0160, 0.0650| Residual Loss: 0.0604, 0.0327
Epoch 44/100, (Training, Validation) Trend Loss: 0.0148, 0.0177| Seasonal Loss: 0.0158, 0.0649| Residual Loss: 0.0598, 0.0326
Epoch 45/100, (Training, Validation) Trend Loss: 0.0146, 0.0174| Seasonal Loss: 0.0155, 0.0648| Residual Loss: 0.0592, 0.0324
Epoch 46/100, (Training, Validation) Trend Loss: 0.0144, 0.0172| Seasonal Loss: 0.0153, 0.0647| Residual Loss: 0.0586, 0.0323
Epoch 47/100, (Training, Validation) Trend Loss: 0.0142, 0.0170| Seasonal Loss: 0.0152, 0.0646| Residual Loss: 0.0580, 0.0323
Epoch 48/100, (Training, Validation) Trend Loss: 0.0141, 0.0168| Seasonal Loss: 0.0150, 0.0645| Residual Loss: 0.0575, 0.0322
Epoch 49/100, (Training, Validation) Trend Loss: 0.0140, 0.0166| Seasonal Loss: 0.0148, 0.0645| Residual Loss: 0.0570, 0.0322
Epoch 50/100, (Training, Validation) Trend Loss: 0.0139, 0.0164| Seasonal Loss: 0.0147, 0.0644| Residual Loss: 0.0566, 0.0321
Epoch 51/100, (Training, Validation) Trend Loss: 0.0137, 0.0163| Seasonal Loss: 0.0146, 0.0643| Residual Loss: 0.0562, 0.0321
Epoch 52/100, (Training, Validation) Trend Loss: 0.0136, 0.0161| Seasonal Loss: 0.0144, 0.0643| Residual Loss: 0.0557, 0.0321
Epoch 53/100, (Training, Validation) Trend Loss: 0.0135, 0.0160| Seasonal Loss: 0.0143, 0.0642| Residual Loss: 0.0553, 0.0320
Epoch 54/100, (Training, Validation) Trend Loss: 0.0135, 0.0159| Seasonal Loss: 0.0142, 0.0642| Residual Loss: 0.0550, 0.0320
Epoch 55/100, (Training, Validation) Trend Loss: 0.0134, 0.0158| Seasonal Loss: 0.0141, 0.0642| Residual Loss: 0.0546, 0.0320
Epoch 56/100, (Training, Validation) Trend Loss: 0.0133, 0.0157| Seasonal Loss: 0.0140, 0.0641| Residual Loss: 0.0543, 0.0320
Epoch 57/100, (Training, Validation) Trend Loss: 0.0132, 0.0156| Seasonal Loss: 0.0139, 0.0641| Residual Loss: 0.0540, 0.0320
Epoch 58/100, (Training, Validation) Trend Loss: 0.0132, 0.0155| Seasonal Loss: 0.0138, 0.0640| Residual Loss: 0.0537, 0.0319
Epoch 59/100, (Training, Validation) Trend Loss: 0.0131, 0.0154| Seasonal Loss: 0.0137, 0.0640| Residual Loss: 0.0534, 0.0319
Epoch 60/100, (Training, Validation) Trend Loss: 0.0130, 0.0153| Seasonal Loss: 0.0137, 0.0640| Residual Loss: 0.0531, 0.0319
Epoch 61/100, (Training, Validation) Trend Loss: 0.0130, 0.0152| Seasonal Loss: 0.0136, 0.0640| Residual Loss: 0.0528, 0.0319
Epoch 62/100, (Training, Validation) Trend Loss: 0.0129, 0.0152| Seasonal Loss: 0.0135, 0.0639| Residual Loss: 0.0526, 0.0319
Epoch 63/100, (Training, Validation) Trend Loss: 0.0129, 0.0151| Seasonal Loss: 0.0135, 0.0639| Residual Loss: 0.0523, 0.0319
Epoch 64/100, (Training, Validation) Trend Loss: 0.0128, 0.0151| Seasonal Loss: 0.0134, 0.0639| Residual Loss: 0.0521, 0.0319
Epoch 65/100, (Training, Validation) Trend Loss: 0.0128, 0.0150| Seasonal Loss: 0.0133, 0.0639| Residual Loss: 0.0519, 0.0318
Epoch 66/100, (Training, Validation) Trend Loss: 0.0127, 0.0149| Seasonal Loss: 0.0133, 0.0639| Residual Loss: 0.0517, 0.0318
Epoch 67/100, (Training, Validation) Trend Loss: 0.0127, 0.0149| Seasonal Loss: 0.0132, 0.0638| Residual Loss: 0.0515, 0.0318
Epoch 68/100, (Training, Validation) Trend Loss: 0.0127, 0.0148| Seasonal Loss: 0.0132, 0.0638| Residual Loss: 0.0513, 0.0318
Epoch 69/100, (Training, Validation) Trend Loss: 0.0126, 0.0148| Seasonal Loss: 0.0132, 0.0638| Residual Loss: 0.0511, 0.0318
Epoch 70/100, (Training, Validation) Trend Loss: 0.0126, 0.0148| Seasonal Loss: 0.0131, 0.0638| Residual Loss: 0.0510, 0.0318
Epoch 71/100, (Training, Validation) Trend Loss: 0.0126, 0.0147| Seasonal Loss: 0.0131, 0.0638| Residual Loss: 0.0508, 0.0318
Epoch 72/100, (Training, Validation) Trend Loss: 0.0125, 0.0147| Seasonal Loss: 0.0130, 0.0638| Residual Loss: 0.0507, 0.0318
Epoch 73/100, (Training, Validation) Trend Loss: 0.0125, 0.0146| Seasonal Loss: 0.0130, 0.0637| Residual Loss: 0.0505, 0.0318
Epoch 74/100, (Training, Validation) Trend Loss: 0.0125, 0.0146| Seasonal Loss: 0.0130, 0.0637| Residual Loss: 0.0504, 0.0318
Epoch 75/100, (Training, Validation) Trend Loss: 0.0124, 0.0146| Seasonal Loss: 0.0129, 0.0637| Residual Loss: 0.0502, 0.0318
Epoch 76/100, (Training, Validation) Trend Loss: 0.0124, 0.0145| Seasonal Loss: 0.0129, 0.0637| Residual Loss: 0.0501, 0.0318
Epoch 77/100, (Training, Validation) Trend Loss: 0.0124, 0.0145| Seasonal Loss: 0.0129, 0.0637| Residual Loss: 0.0500, 0.0317
Epoch 78/100, (Training, Validation) Trend Loss: 0.0124, 0.0145| Seasonal Loss: 0.0128, 0.0637| Residual Loss: 0.0499, 0.0317
Epoch 79/100, (Training, Validation) Trend Loss: 0.0123, 0.0145| Seasonal Loss: 0.0128, 0.0637| Residual Loss: 0.0498, 0.0317
Epoch 80/100, (Training, Validation) Trend Loss: 0.0123, 0.0144| Seasonal Loss: 0.0128, 0.0637| Residual Loss: 0.0497, 0.0317
Epoch 81/100, (Training, Validation) Trend Loss: 0.0123, 0.0144| Seasonal Loss: 0.0128, 0.0637| Residual Loss: 0.0496, 0.0317
Epoch 82/100, (Training, Validation) Trend Loss: 0.0123, 0.0144| Seasonal Loss: 0.0127, 0.0637| Residual Loss: 0.0495, 0.0317
Epoch 83/100, (Training, Validation) Trend Loss: 0.0123, 0.0144| Seasonal Loss: 0.0127, 0.0637| Residual Loss: 0.0494, 0.0317
Epoch 84/100, (Training, Validation) Trend Loss: 0.0123, 0.0143| Seasonal Loss: 0.0127, 0.0636| Residual Loss: 0.0493, 0.0317
Epoch 85/100, (Training, Validation) Trend Loss: 0.0122, 0.0143| Seasonal Loss: 0.0127, 0.0636| Residual Loss: 0.0492, 0.0317
Epoch 86/100, (Training, Validation) Trend Loss: 0.0122, 0.0143| Seasonal Loss: 0.0127, 0.0636| Residual Loss: 0.0492, 0.0317
Epoch 87/100, (Training, Validation) Trend Loss: 0.0122, 0.0143| Seasonal Loss: 0.0126, 0.0636| Residual Loss: 0.0491, 0.0317
Epoch 88/100, (Training, Validation) Trend Loss: 0.0122, 0.0143| Seasonal Loss: 0.0126, 0.0636| Residual Loss: 0.0490, 0.0317
Epoch 89/100, (Training, Validation) Trend Loss: 0.0122, 0.0143| Seasonal Loss: 0.0126, 0.0636| Residual Loss: 0.0489, 0.0317
Epoch 90/100, (Training, Validation) Trend Loss: 0.0122, 0.0142| Seasonal Loss: 0.0126, 0.0636| Residual Loss: 0.0489, 0.0317
Epoch 91/100, (Training, Validation) Trend Loss: 0.0122, 0.0142| Seasonal Loss: 0.0126, 0.0636| Residual Loss: 0.0488, 0.0317
Epoch 92/100, (Training, Validation) Trend Loss: 0.0122, 0.0142| Seasonal Loss: 0.0126, 0.0636| Residual Loss: 0.0488, 0.0317
Epoch 93/100, (Training, Validation) Trend Loss: 0.0121, 0.0142| Seasonal Loss: 0.0125, 0.0636| Residual Loss: 0.0487, 0.0317
Epoch 94/100, (Training, Validation) Trend Loss: 0.0121, 0.0142| Seasonal Loss: 0.0125, 0.0636| Residual Loss: 0.0487, 0.0317
Epoch 95/100, (Training, Validation) Trend Loss: 0.0121, 0.0142| Seasonal Loss: 0.0125, 0.0636| Residual Loss: 0.0486, 0.0317
Epoch 96/100, (Training, Validation) Trend Loss: 0.0121, 0.0142| Seasonal Loss: 0.0125, 0.0636| Residual Loss: 0.0486, 0.0317
Epoch 97/100, (Training, Validation) Trend Loss: 0.0121, 0.0141| Seasonal Loss: 0.0125, 0.0636| Residual Loss: 0.0485, 0.0317
Epoch 98/100, (Training, Validation) Trend Loss: 0.0121, 0.0141| Seasonal Loss: 0.0125, 0.0636| Residual Loss: 0.0485, 0.0317
Epoch 99/100, (Training, Validation) Trend Loss: 0.0121, 0.0141| Seasonal Loss: 0.0125, 0.0636| Residual Loss: 0.0484, 0.0317
Epoch 100/100, (Training, Validation) Trend Loss: 0.0121, 0.0141| Seasonal Loss: 0.0125, 0.0636| Residual Loss: 0.0484, 0.0316
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[167.92057845]
[-0.85266105]
[-0.36598911]
[166.70192829]
actual_stock_price: [171.57913208 173.92396545 174.0332489  173.079422   170.45640564
 170.73460388 171.87721252 174.30149841 176.1594696  176.10978699]
add_predicted_stock_price: [171.57913208 173.92396545 174.0332489  173.079422   170.45640564
 170.73460388 171.87721252 174.30149841 176.1594696  166.70192829]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
