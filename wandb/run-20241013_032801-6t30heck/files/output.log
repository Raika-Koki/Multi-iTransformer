[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.6204, 0.2721| Seasonal Loss: 0.9209, 0.5588| Residual Loss: 1.1475, 1.1000
Epoch 2/100, (Training, Validation) Trend Loss: 0.1824, 0.1227| Seasonal Loss: 0.5047, 0.2962| Residual Loss: 0.6117, 0.3757
Epoch 3/100, (Training, Validation) Trend Loss: 0.2207, 0.1886| Seasonal Loss: 0.3487, 0.2742| Residual Loss: 0.4302, 0.2987
Epoch 4/100, (Training, Validation) Trend Loss: 0.1259, 0.0931| Seasonal Loss: 0.2913, 0.2079| Residual Loss: 0.3099, 0.2617
Epoch 5/100, (Training, Validation) Trend Loss: 0.1019, 0.2474| Seasonal Loss: 0.2445, 0.1981| Residual Loss: 0.2516, 0.2299
Epoch 6/100, (Training, Validation) Trend Loss: 0.1218, 0.0959| Seasonal Loss: 0.2144, 0.1792| Residual Loss: 0.2202, 0.2012
Epoch 7/100, (Training, Validation) Trend Loss: 0.1246, 0.1590| Seasonal Loss: 0.1865, 0.1677| Residual Loss: 0.2004, 0.1834
Epoch 8/100, (Training, Validation) Trend Loss: 0.1046, 0.1199| Seasonal Loss: 0.1670, 0.1418| Residual Loss: 0.1783, 0.1626
Epoch 9/100, (Training, Validation) Trend Loss: 0.0946, 0.1463| Seasonal Loss: 0.1505, 0.1338| Residual Loss: 0.1635, 0.1533
Epoch 10/100, (Training, Validation) Trend Loss: 0.0627, 0.0666| Seasonal Loss: 0.1364, 0.1246| Residual Loss: 0.1490, 0.1393
Epoch 11/100, (Training, Validation) Trend Loss: 0.0616, 0.1484| Seasonal Loss: 0.1241, 0.1189| Residual Loss: 0.1434, 0.1421
Epoch 12/100, (Training, Validation) Trend Loss: 0.0701, 0.0519| Seasonal Loss: 0.1204, 0.1233| Residual Loss: 0.1347, 0.1351
Epoch 13/100, (Training, Validation) Trend Loss: 0.0773, 0.1208| Seasonal Loss: 0.1142, 0.1409| Residual Loss: 0.1353, 0.1393
Epoch 14/100, (Training, Validation) Trend Loss: 0.0479, 0.0366| Seasonal Loss: 0.1242, 0.1403| Residual Loss: 0.1305, 0.1466
Epoch 15/100, (Training, Validation) Trend Loss: 0.0395, 0.0682| Seasonal Loss: 0.1093, 0.1119| Residual Loss: 0.1332, 0.1561
Epoch 16/100, (Training, Validation) Trend Loss: 0.0409, 0.0353| Seasonal Loss: 0.1073, 0.1040| Residual Loss: 0.1356, 0.1771
Epoch 17/100, (Training, Validation) Trend Loss: 0.0392, 0.0629| Seasonal Loss: 0.1097, 0.1093| Residual Loss: 0.1364, 0.1732
Epoch 18/100, (Training, Validation) Trend Loss: 0.0668, 0.0806| Seasonal Loss: 0.1393, 0.1106| Residual Loss: 0.1343, 0.1533
Epoch 19/100, (Training, Validation) Trend Loss: 0.0940, 0.1153| Seasonal Loss: 0.1384, 0.0938| Residual Loss: 0.1287, 0.1343
Epoch 20/100, (Training, Validation) Trend Loss: 0.2087, 0.1513| Seasonal Loss: 0.1056, 0.0948| Residual Loss: 0.1312, 0.1272
Epoch 21/100, (Training, Validation) Trend Loss: 0.0871, 0.0551| Seasonal Loss: 0.0914, 0.1002| Residual Loss: 0.1624, 0.1297
Epoch 22/100, (Training, Validation) Trend Loss: 0.0771, 0.0850| Seasonal Loss: 0.0900, 0.0987| Residual Loss: 0.2136, 0.1236
Epoch 23/100, (Training, Validation) Trend Loss: 0.0531, 0.0412| Seasonal Loss: 0.0807, 0.0914| Residual Loss: 0.1766, 0.1149
Epoch 24/100, (Training, Validation) Trend Loss: 0.0427, 0.0459| Seasonal Loss: 0.0791, 0.0889| Residual Loss: 0.1199, 0.1148
Epoch 25/100, (Training, Validation) Trend Loss: 0.0352, 0.0343| Seasonal Loss: 0.0749, 0.0901| Residual Loss: 0.1132, 0.1080
Epoch 26/100, (Training, Validation) Trend Loss: 0.0300, 0.0364| Seasonal Loss: 0.0732, 0.0884| Residual Loss: 0.1086, 0.1048
Epoch 27/100, (Training, Validation) Trend Loss: 0.0264, 0.0274| Seasonal Loss: 0.0705, 0.0858| Residual Loss: 0.1041, 0.1044
Epoch 28/100, (Training, Validation) Trend Loss: 0.0248, 0.0338| Seasonal Loss: 0.0686, 0.0854| Residual Loss: 0.1017, 0.1026
Epoch 29/100, (Training, Validation) Trend Loss: 0.0229, 0.0228| Seasonal Loss: 0.0670, 0.0848| Residual Loss: 0.0997, 0.1016
Epoch 30/100, (Training, Validation) Trend Loss: 0.0235, 0.0364| Seasonal Loss: 0.0652, 0.0836| Residual Loss: 0.0980, 0.1011
Epoch 31/100, (Training, Validation) Trend Loss: 0.0221, 0.0205| Seasonal Loss: 0.0637, 0.0827| Residual Loss: 0.0966, 0.1004
Epoch 32/100, (Training, Validation) Trend Loss: 0.0246, 0.0422| Seasonal Loss: 0.0624, 0.0822| Residual Loss: 0.0954, 0.0998
Epoch 33/100, (Training, Validation) Trend Loss: 0.0227, 0.0201| Seasonal Loss: 0.0611, 0.0815| Residual Loss: 0.0943, 0.0994
Epoch 34/100, (Training, Validation) Trend Loss: 0.0250, 0.0401| Seasonal Loss: 0.0599, 0.0809| Residual Loss: 0.0933, 0.0989
Epoch 35/100, (Training, Validation) Trend Loss: 0.0208, 0.0194| Seasonal Loss: 0.0589, 0.0803| Residual Loss: 0.0924, 0.0985
Epoch 36/100, (Training, Validation) Trend Loss: 0.0205, 0.0292| Seasonal Loss: 0.0578, 0.0798| Residual Loss: 0.0916, 0.0982
Epoch 37/100, (Training, Validation) Trend Loss: 0.0181, 0.0215| Seasonal Loss: 0.0569, 0.0794| Residual Loss: 0.0908, 0.0978
Epoch 38/100, (Training, Validation) Trend Loss: 0.0176, 0.0231| Seasonal Loss: 0.0560, 0.0789| Residual Loss: 0.0901, 0.0974
Epoch 39/100, (Training, Validation) Trend Loss: 0.0172, 0.0225| Seasonal Loss: 0.0551, 0.0785| Residual Loss: 0.0895, 0.0971
Epoch 40/100, (Training, Validation) Trend Loss: 0.0168, 0.0212| Seasonal Loss: 0.0543, 0.0781| Residual Loss: 0.0889, 0.0968
Epoch 41/100, (Training, Validation) Trend Loss: 0.0168, 0.0220| Seasonal Loss: 0.0536, 0.0777| Residual Loss: 0.0883, 0.0965
Epoch 42/100, (Training, Validation) Trend Loss: 0.0163, 0.0206| Seasonal Loss: 0.0529, 0.0774| Residual Loss: 0.0878, 0.0963
Epoch 43/100, (Training, Validation) Trend Loss: 0.0163, 0.0213| Seasonal Loss: 0.0522, 0.0771| Residual Loss: 0.0872, 0.0960
Epoch 44/100, (Training, Validation) Trend Loss: 0.0159, 0.0202| Seasonal Loss: 0.0516, 0.0768| Residual Loss: 0.0868, 0.0957
Epoch 45/100, (Training, Validation) Trend Loss: 0.0158, 0.0206| Seasonal Loss: 0.0510, 0.0765| Residual Loss: 0.0863, 0.0955
Epoch 46/100, (Training, Validation) Trend Loss: 0.0155, 0.0199| Seasonal Loss: 0.0505, 0.0763| Residual Loss: 0.0859, 0.0953
Epoch 47/100, (Training, Validation) Trend Loss: 0.0154, 0.0201| Seasonal Loss: 0.0500, 0.0760| Residual Loss: 0.0855, 0.0951
Epoch 48/100, (Training, Validation) Trend Loss: 0.0151, 0.0196| Seasonal Loss: 0.0495, 0.0758| Residual Loss: 0.0851, 0.0949
Epoch 49/100, (Training, Validation) Trend Loss: 0.0149, 0.0196| Seasonal Loss: 0.0490, 0.0756| Residual Loss: 0.0847, 0.0947
Epoch 50/100, (Training, Validation) Trend Loss: 0.0148, 0.0194| Seasonal Loss: 0.0486, 0.0754| Residual Loss: 0.0844, 0.0945
Epoch 51/100, (Training, Validation) Trend Loss: 0.0146, 0.0193| Seasonal Loss: 0.0482, 0.0752| Residual Loss: 0.0840, 0.0943
Epoch 52/100, (Training, Validation) Trend Loss: 0.0145, 0.0191| Seasonal Loss: 0.0478, 0.0750| Residual Loss: 0.0837, 0.0942
Epoch 53/100, (Training, Validation) Trend Loss: 0.0144, 0.0190| Seasonal Loss: 0.0474, 0.0749| Residual Loss: 0.0834, 0.0940
Epoch 54/100, (Training, Validation) Trend Loss: 0.0143, 0.0188| Seasonal Loss: 0.0471, 0.0747| Residual Loss: 0.0832, 0.0939
Epoch 55/100, (Training, Validation) Trend Loss: 0.0142, 0.0187| Seasonal Loss: 0.0468, 0.0746| Residual Loss: 0.0829, 0.0937
Epoch 56/100, (Training, Validation) Trend Loss: 0.0141, 0.0186| Seasonal Loss: 0.0465, 0.0744| Residual Loss: 0.0826, 0.0936
Epoch 57/100, (Training, Validation) Trend Loss: 0.0140, 0.0185| Seasonal Loss: 0.0462, 0.0743| Residual Loss: 0.0824, 0.0935
Epoch 58/100, (Training, Validation) Trend Loss: 0.0140, 0.0184| Seasonal Loss: 0.0459, 0.0742| Residual Loss: 0.0822, 0.0934
Epoch 59/100, (Training, Validation) Trend Loss: 0.0139, 0.0183| Seasonal Loss: 0.0456, 0.0740| Residual Loss: 0.0820, 0.0933
Epoch 60/100, (Training, Validation) Trend Loss: 0.0138, 0.0182| Seasonal Loss: 0.0454, 0.0739| Residual Loss: 0.0818, 0.0931
Epoch 61/100, (Training, Validation) Trend Loss: 0.0137, 0.0181| Seasonal Loss: 0.0451, 0.0738| Residual Loss: 0.0816, 0.0930
Epoch 62/100, (Training, Validation) Trend Loss: 0.0137, 0.0181| Seasonal Loss: 0.0449, 0.0737| Residual Loss: 0.0814, 0.0929
Epoch 63/100, (Training, Validation) Trend Loss: 0.0136, 0.0180| Seasonal Loss: 0.0447, 0.0736| Residual Loss: 0.0812, 0.0929
Epoch 64/100, (Training, Validation) Trend Loss: 0.0136, 0.0179| Seasonal Loss: 0.0445, 0.0735| Residual Loss: 0.0810, 0.0928
Epoch 65/100, (Training, Validation) Trend Loss: 0.0135, 0.0179| Seasonal Loss: 0.0443, 0.0735| Residual Loss: 0.0809, 0.0927
Epoch 66/100, (Training, Validation) Trend Loss: 0.0135, 0.0178| Seasonal Loss: 0.0441, 0.0734| Residual Loss: 0.0807, 0.0926
Epoch 67/100, (Training, Validation) Trend Loss: 0.0134, 0.0177| Seasonal Loss: 0.0440, 0.0733| Residual Loss: 0.0806, 0.0925
Epoch 68/100, (Training, Validation) Trend Loss: 0.0134, 0.0177| Seasonal Loss: 0.0438, 0.0732| Residual Loss: 0.0804, 0.0925
Epoch 69/100, (Training, Validation) Trend Loss: 0.0133, 0.0176| Seasonal Loss: 0.0437, 0.0732| Residual Loss: 0.0803, 0.0924
Epoch 70/100, (Training, Validation) Trend Loss: 0.0133, 0.0176| Seasonal Loss: 0.0435, 0.0731| Residual Loss: 0.0802, 0.0923
Epoch 71/100, (Training, Validation) Trend Loss: 0.0132, 0.0175| Seasonal Loss: 0.0434, 0.0730| Residual Loss: 0.0801, 0.0923
Epoch 72/100, (Training, Validation) Trend Loss: 0.0132, 0.0175| Seasonal Loss: 0.0432, 0.0730| Residual Loss: 0.0799, 0.0922
Epoch 73/100, (Training, Validation) Trend Loss: 0.0132, 0.0174| Seasonal Loss: 0.0431, 0.0729| Residual Loss: 0.0798, 0.0921
Epoch 74/100, (Training, Validation) Trend Loss: 0.0131, 0.0174| Seasonal Loss: 0.0430, 0.0729| Residual Loss: 0.0797, 0.0921
Epoch 75/100, (Training, Validation) Trend Loss: 0.0131, 0.0173| Seasonal Loss: 0.0429, 0.0728| Residual Loss: 0.0796, 0.0920
Epoch 76/100, (Training, Validation) Trend Loss: 0.0131, 0.0173| Seasonal Loss: 0.0428, 0.0728| Residual Loss: 0.0795, 0.0920
Epoch 77/100, (Training, Validation) Trend Loss: 0.0130, 0.0173| Seasonal Loss: 0.0427, 0.0727| Residual Loss: 0.0794, 0.0919
Epoch 78/100, (Training, Validation) Trend Loss: 0.0130, 0.0172| Seasonal Loss: 0.0426, 0.0727| Residual Loss: 0.0794, 0.0919
Epoch 79/100, (Training, Validation) Trend Loss: 0.0130, 0.0172| Seasonal Loss: 0.0425, 0.0726| Residual Loss: 0.0793, 0.0918
Epoch 80/100, (Training, Validation) Trend Loss: 0.0130, 0.0172| Seasonal Loss: 0.0424, 0.0726| Residual Loss: 0.0792, 0.0918
Epoch 81/100, (Training, Validation) Trend Loss: 0.0129, 0.0171| Seasonal Loss: 0.0423, 0.0726| Residual Loss: 0.0791, 0.0918
Epoch 82/100, (Training, Validation) Trend Loss: 0.0129, 0.0171| Seasonal Loss: 0.0422, 0.0725| Residual Loss: 0.0791, 0.0917
Epoch 83/100, (Training, Validation) Trend Loss: 0.0129, 0.0171| Seasonal Loss: 0.0421, 0.0725| Residual Loss: 0.0790, 0.0917
Epoch 84/100, (Training, Validation) Trend Loss: 0.0129, 0.0171| Seasonal Loss: 0.0421, 0.0724| Residual Loss: 0.0789, 0.0917
Epoch 85/100, (Training, Validation) Trend Loss: 0.0129, 0.0170| Seasonal Loss: 0.0420, 0.0724| Residual Loss: 0.0789, 0.0916
Epoch 86/100, (Training, Validation) Trend Loss: 0.0128, 0.0170| Seasonal Loss: 0.0419, 0.0724| Residual Loss: 0.0788, 0.0916
Epoch 87/100, (Training, Validation) Trend Loss: 0.0128, 0.0170| Seasonal Loss: 0.0419, 0.0724| Residual Loss: 0.0787, 0.0916
Epoch 88/100, (Training, Validation) Trend Loss: 0.0128, 0.0170| Seasonal Loss: 0.0418, 0.0723| Residual Loss: 0.0787, 0.0915
Epoch 89/100, (Training, Validation) Trend Loss: 0.0128, 0.0169| Seasonal Loss: 0.0418, 0.0723| Residual Loss: 0.0786, 0.0915
Epoch 90/100, (Training, Validation) Trend Loss: 0.0128, 0.0169| Seasonal Loss: 0.0417, 0.0723| Residual Loss: 0.0786, 0.0915
Epoch 91/100, (Training, Validation) Trend Loss: 0.0128, 0.0169| Seasonal Loss: 0.0416, 0.0723| Residual Loss: 0.0786, 0.0915
Epoch 92/100, (Training, Validation) Trend Loss: 0.0128, 0.0169| Seasonal Loss: 0.0416, 0.0722| Residual Loss: 0.0785, 0.0914
Epoch 93/100, (Training, Validation) Trend Loss: 0.0127, 0.0169| Seasonal Loss: 0.0416, 0.0722| Residual Loss: 0.0785, 0.0914
Epoch 94/100, (Training, Validation) Trend Loss: 0.0127, 0.0169| Seasonal Loss: 0.0415, 0.0722| Residual Loss: 0.0784, 0.0914
Epoch 95/100, (Training, Validation) Trend Loss: 0.0127, 0.0168| Seasonal Loss: 0.0415, 0.0722| Residual Loss: 0.0784, 0.0914
Epoch 96/100, (Training, Validation) Trend Loss: 0.0127, 0.0168| Seasonal Loss: 0.0414, 0.0722| Residual Loss: 0.0784, 0.0914
Epoch 97/100, (Training, Validation) Trend Loss: 0.0127, 0.0168| Seasonal Loss: 0.0414, 0.0721| Residual Loss: 0.0783, 0.0913
Epoch 98/100, (Training, Validation) Trend Loss: 0.0127, 0.0168| Seasonal Loss: 0.0413, 0.0721| Residual Loss: 0.0783, 0.0913
Epoch 99/100, (Training, Validation) Trend Loss: 0.0127, 0.0168| Seasonal Loss: 0.0413, 0.0721| Residual Loss: 0.0783, 0.0913
Epoch 100/100, (Training, Validation) Trend Loss: 0.0127, 0.0168| Seasonal Loss: 0.0413, 0.0721| Residual Loss: 0.0782, 0.0913
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[169.11741425]
[-1.26771302]
[-0.03776022]
[167.81194101]
actual_stock_price: [171.57914734 173.92393494 174.0332489  173.07940674 170.45640564
 170.73460388 171.87721252 174.30151367 176.1594696  176.10980225]
add_predicted_stock_price: [171.57914734 173.92393494 174.0332489  173.07940674 170.45640564
 170.73460388 171.87721252 174.30151367 176.1594696  167.81194101]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
