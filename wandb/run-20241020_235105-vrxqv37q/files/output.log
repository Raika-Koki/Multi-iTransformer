[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.7168, 0.1546| Seasonal Loss: 0.6296, 0.1248| Residual Loss: 1.1887, 0.9408
Epoch 2/100, (Training, Validation) Trend Loss: 0.1046, 0.0511| Seasonal Loss: 0.0762, 0.0244| Residual Loss: 0.7872, 0.6045
Epoch 3/100, (Training, Validation) Trend Loss: 0.0407, 0.0329| Seasonal Loss: 0.0298, 0.0227| Residual Loss: 0.4874, 0.3520
Epoch 4/100, (Training, Validation) Trend Loss: 0.0226, 0.0105| Seasonal Loss: 0.0136, 0.0123| Residual Loss: 0.2690, 0.1780
Epoch 5/100, (Training, Validation) Trend Loss: 0.0106, 0.0050| Seasonal Loss: 0.0080, 0.0038| Residual Loss: 0.1278, 0.0771
Epoch 6/100, (Training, Validation) Trend Loss: 0.0045, 0.0047| Seasonal Loss: 0.0040, 0.0027| Residual Loss: 0.0535, 0.0317
Epoch 7/100, (Training, Validation) Trend Loss: 0.0026, 0.0019| Seasonal Loss: 0.0016, 0.0018| Residual Loss: 0.0228, 0.0146
Epoch 8/100, (Training, Validation) Trend Loss: 0.0018, 0.0006| Seasonal Loss: 0.0013, 0.0004| Residual Loss: 0.0111, 0.0075
Epoch 9/100, (Training, Validation) Trend Loss: 0.0007, 0.0007| Seasonal Loss: 0.0006, 0.0005| Residual Loss: 0.0060, 0.0043
Epoch 10/100, (Training, Validation) Trend Loss: 0.0004, 0.0003| Seasonal Loss: 0.0003, 0.0003| Residual Loss: 0.0038, 0.0031
Epoch 11/100, (Training, Validation) Trend Loss: 0.0003, 0.0002| Seasonal Loss: 0.0002, 0.0001| Residual Loss: 0.0029, 0.0026
Epoch 12/100, (Training, Validation) Trend Loss: 0.0001, 0.0001| Seasonal Loss: 0.0001, 0.0001| Residual Loss: 0.0025, 0.0023
Epoch 13/100, (Training, Validation) Trend Loss: 0.0001, 0.0001| Seasonal Loss: 0.0001, 0.0001| Residual Loss: 0.0022, 0.0020
Epoch 14/100, (Training, Validation) Trend Loss: 0.0001, 0.0000| Seasonal Loss: 0.0001, 0.0000| Residual Loss: 0.0019, 0.0018
Epoch 15/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0018, 0.0017
Epoch 16/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0016, 0.0015
Epoch 17/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0015, 0.0014
Epoch 18/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0014, 0.0013
Epoch 19/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0013, 0.0012
Epoch 20/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0012, 0.0012
Epoch 21/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0011, 0.0011
Epoch 22/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0011, 0.0010
Epoch 23/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0010, 0.0010
Epoch 24/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0010, 0.0009
Epoch 25/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0009, 0.0009
Epoch 26/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0009, 0.0009
Epoch 27/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0009, 0.0008
Epoch 28/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0008, 0.0008
Epoch 29/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0008, 0.0008
Epoch 30/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0008, 0.0008
Epoch 31/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0008, 0.0007
Epoch 32/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0007, 0.0007
Epoch 33/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0007, 0.0007
Epoch 34/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0007, 0.0007
Epoch 35/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0007, 0.0007
Epoch 36/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0007, 0.0006
Epoch 37/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0006, 0.0006
Epoch 38/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0006, 0.0006
Epoch 39/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0006, 0.0006
Epoch 40/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0006, 0.0006
Epoch 41/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0006, 0.0006
Epoch 42/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0006, 0.0006
Epoch 43/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0006, 0.0006
Epoch 44/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0006, 0.0006
Epoch 45/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0006, 0.0005
Epoch 46/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0006, 0.0005
Epoch 47/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 48/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 49/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 50/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 51/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 52/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 53/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 54/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 55/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 56/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 57/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 58/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 59/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 60/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 61/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 62/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 63/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 64/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 65/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 66/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0005
Epoch 67/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0004
Epoch 68/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0004
Epoch 69/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0005, 0.0004
Epoch 70/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 71/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 72/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 73/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 74/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 75/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 76/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 77/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 78/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 79/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 80/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 81/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 82/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 83/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 84/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 85/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 86/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 87/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 88/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 89/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 90/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 91/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 92/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 93/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 94/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 95/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 96/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 97/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 98/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 99/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
Epoch 100/100, (Training, Validation) Trend Loss: 0.0000, 0.0000| Seasonal Loss: 0.0000, 0.0000| Residual Loss: 0.0004, 0.0004
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:244: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:245: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:246: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[0.00071803]
[0.00228549]
[0.01167547]
[0.01467899]
actual_stock_price: [178.0572052  176.6761322  179.40844727 179.79594421 182.60772705
 182.1308136  182.76669312 184.81344604 183.73046875 183.81987   ]
add_predicted_stock_price: [1.78057205e+02 1.76676132e+02 1.79408447e+02 1.79795944e+02
 1.82607727e+02 1.82130814e+02 1.82766693e+02 1.84813446e+02
 1.83730469e+02 1.46789875e-02]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:292: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
