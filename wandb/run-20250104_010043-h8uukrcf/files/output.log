ÊúÄÈÅ©ÂåñÂØæË±°: trend
[32m[I 2025-01-04 01:00:45,695][0m A new study created in memory with name: no-name-fc3bf19e-b897-4f2b-b46e-5e3b21dc158a[0m
Non-A100 GPU detected, using math or mem efficient attention if input tensor is on cuda
[32m[I 2025-01-04 01:03:41,478][0m Trial 0 finished with value: 0.36655687369864204 and parameters: {'observation_period_num': 109, 'train_rates': 0.7656571656012771, 'learning_rate': 4.9247657948436745e-06, 'batch_size': 27, 'step_size': 7, 'gamma': 0.7701406706265338}. Best is trial 0 with value: 0.36655687369864204.[0m
[32m[I 2025-01-04 01:04:18,068][0m Trial 1 finished with value: 0.9343963077077192 and parameters: {'observation_period_num': 251, 'train_rates': 0.8008005881828029, 'learning_rate': 1.292147609627021e-06, 'batch_size': 144, 'step_size': 6, 'gamma': 0.7534116226724739}. Best is trial 0 with value: 0.36655687369864204.[0m
[32m[I 2025-01-04 01:04:38,735][0m Trial 2 finished with value: 0.7640379660764698 and parameters: {'observation_period_num': 182, 'train_rates': 0.6367463362611704, 'learning_rate': 6.607613036108436e-06, 'batch_size': 246, 'step_size': 2, 'gamma': 0.8848898494914526}. Best is trial 0 with value: 0.36655687369864204.[0m
[32m[I 2025-01-04 01:05:14,769][0m Trial 3 finished with value: 1.0111829003188835 and parameters: {'observation_period_num': 188, 'train_rates': 0.8243070987111526, 'learning_rate': 1.3567730989852873e-06, 'batch_size': 143, 'step_size': 6, 'gamma': 0.9474064733850072}. Best is trial 0 with value: 0.36655687369864204.[0m
[32m[I 2025-01-04 01:06:03,889][0m Trial 4 finished with value: 0.8566692707502297 and parameters: {'observation_period_num': 84, 'train_rates': 0.9314422950186271, 'learning_rate': 1.1602230935776133e-06, 'batch_size': 120, 'step_size': 1, 'gamma': 0.9743604240178025}. Best is trial 0 with value: 0.36655687369864204.[0m
[32m[I 2025-01-04 01:06:36,364][0m Trial 5 finished with value: 2.948014736175537 and parameters: {'observation_period_num': 17, 'train_rates': 0.9479981560842758, 'learning_rate': 2.4566824027866632e-06, 'batch_size': 193, 'step_size': 4, 'gamma': 0.7846830578520589}. Best is trial 0 with value: 0.36655687369864204.[0m
[32m[I 2025-01-04 01:07:45,657][0m Trial 6 finished with value: 0.6216165869824799 and parameters: {'observation_period_num': 175, 'train_rates': 0.6441949788164631, 'learning_rate': 5.21268455511309e-06, 'batch_size': 60, 'step_size': 5, 'gamma': 0.8066157929398569}. Best is trial 0 with value: 0.36655687369864204.[0m
[32m[I 2025-01-04 01:08:21,503][0m Trial 7 finished with value: 1.6677274283938384 and parameters: {'observation_period_num': 10, 'train_rates': 0.6753734478733449, 'learning_rate': 1.5945633181052128e-06, 'batch_size': 139, 'step_size': 3, 'gamma': 0.7902824277991998}. Best is trial 0 with value: 0.36655687369864204.[0m
[32m[I 2025-01-04 01:09:00,933][0m Trial 8 finished with value: 0.12758488953113556 and parameters: {'observation_period_num': 246, 'train_rates': 0.9676363120723792, 'learning_rate': 0.00035478718937988126, 'batch_size': 149, 'step_size': 13, 'gamma': 0.7818567557994653}. Best is trial 8 with value: 0.12758488953113556.[0m
[32m[I 2025-01-04 01:09:24,128][0m Trial 9 finished with value: 0.1442180309332494 and parameters: {'observation_period_num': 238, 'train_rates': 0.7676926766614102, 'learning_rate': 0.0004931302104497326, 'batch_size': 215, 'step_size': 13, 'gamma': 0.7797786563758657}. Best is trial 8 with value: 0.12758488953113556.[0m
[32m[I 2025-01-04 01:10:29,181][0m Trial 10 finished with value: 0.13117896020412445 and parameters: {'observation_period_num': 135, 'train_rates': 0.9891184940458597, 'learning_rate': 0.00045332440440352045, 'batch_size': 90, 'step_size': 15, 'gamma': 0.8447666854304335}. Best is trial 8 with value: 0.12758488953113556.[0m
[32m[I 2025-01-04 01:11:35,011][0m Trial 11 finished with value: 0.1092720627784729 and parameters: {'observation_period_num': 73, 'train_rates': 0.9848756347807754, 'learning_rate': 0.0005101140926416965, 'batch_size': 89, 'step_size': 15, 'gamma': 0.847368081412436}. Best is trial 11 with value: 0.1092720627784729.[0m
[32m[I 2025-01-04 01:12:34,783][0m Trial 12 finished with value: 0.04196465484907522 and parameters: {'observation_period_num': 65, 'train_rates': 0.8822328579001669, 'learning_rate': 0.0001368818878513181, 'batch_size': 91, 'step_size': 11, 'gamma': 0.8593893999657832}. Best is trial 12 with value: 0.04196465484907522.[0m
[32m[I 2025-01-04 01:13:40,962][0m Trial 13 finished with value: 0.044218462243886064 and parameters: {'observation_period_num': 61, 'train_rates': 0.8771645571145453, 'learning_rate': 0.00010608443699241695, 'batch_size': 83, 'step_size': 10, 'gamma': 0.8869661768012765}. Best is trial 12 with value: 0.04196465484907522.[0m
[32m[I 2025-01-04 01:16:11,907][0m Trial 14 finished with value: 0.07023381594776058 and parameters: {'observation_period_num': 53, 'train_rates': 0.8823553274629395, 'learning_rate': 9.925258429608078e-05, 'batch_size': 36, 'step_size': 10, 'gamma': 0.8967278741089221}. Best is trial 12 with value: 0.04196465484907522.[0m
[33m[W 2025-01-04 01:16:29,426][0m Trial 15 failed with parameters: {'observation_period_num': 45, 'train_rates': 0.8721193861990487, 'learning_rate': 6.18011720196926e-05, 'batch_size': 96, 'step_size': 9, 'gamma': 0.9171931273385119} because of the following error: KeyboardInterrupt().[0m
Traceback (most recent call last):
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna.py", line 550, in <lambda>
    study.optimize(lambda trial: objective(trial, component, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna.py", line 113, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 29, in train
    optimizer.zero_grad()
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/optim/optimizer.py", line 456, in zero_grad
    with torch.autograd.profiler.record_function(self._zero_grad_profile_name):
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/autograd/profiler.py", line 492, in __enter__
    self.record = torch.ops.profiler._record_function_enter_new(self.name, self.args)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/_ops.py", line 502, in __call__
    return self._op(*args, **kwargs or {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
[33m[W 2025-01-04 01:16:29,481][0m Trial 15 failed with value None.[0m
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna.py", line 550, in <module>
    study.optimize(lambda trial: objective(trial, component, depth, dim), n_trials=50) #check
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna.py", line 550, in <lambda>
    study.optimize(lambda trial: objective(trial, component, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna.py", line 113, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 29, in train
    optimizer.zero_grad()
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/optim/optimizer.py", line 456, in zero_grad
    with torch.autograd.profiler.record_function(self._zero_grad_profile_name):
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/autograd/profiler.py", line 492, in __enter__
    self.record = torch.ops.profiler._record_function_enter_new(self.name, self.args)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/_ops.py", line 502, in __call__
    return self._op(*args, **kwargs or {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
