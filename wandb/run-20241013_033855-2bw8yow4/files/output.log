[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 2.5438, 0.5338| Seasonal Loss: 2.5120, 0.5150| Residual Loss: 2.7839, 0.3878
Epoch 2/100, (Training, Validation) Trend Loss: 0.7592, 0.6918| Seasonal Loss: 0.7773, 0.3646| Residual Loss: 0.7722, 0.3206
Epoch 3/100, (Training, Validation) Trend Loss: 0.5977, 0.5377| Seasonal Loss: 0.4636, 0.4932| Residual Loss: 0.5004, 0.2906
Epoch 4/100, (Training, Validation) Trend Loss: 0.3201, 0.4907| Seasonal Loss: 0.4548, 0.4726| Residual Loss: 0.3774, 0.3266
Epoch 5/100, (Training, Validation) Trend Loss: 0.3778, 0.2564| Seasonal Loss: 0.3715, 0.3872| Residual Loss: 0.3319, 0.0986
Epoch 6/100, (Training, Validation) Trend Loss: 0.2434, 0.1759| Seasonal Loss: 0.2443, 0.3024| Residual Loss: 0.2266, 0.0701
Epoch 7/100, (Training, Validation) Trend Loss: 0.1636, 0.1654| Seasonal Loss: 0.2091, 0.2454| Residual Loss: 0.1897, 0.0506
Epoch 8/100, (Training, Validation) Trend Loss: 0.1148, 0.0728| Seasonal Loss: 0.1514, 0.1614| Residual Loss: 0.2037, 0.0833
Epoch 9/100, (Training, Validation) Trend Loss: 0.1160, 0.1647| Seasonal Loss: 0.1048, 0.1621| Residual Loss: 0.1759, 0.0812
Epoch 10/100, (Training, Validation) Trend Loss: 0.0974, 0.1063| Seasonal Loss: 0.0870, 0.1397| Residual Loss: 0.1456, 0.0469
Epoch 11/100, (Training, Validation) Trend Loss: 0.1031, 0.0828| Seasonal Loss: 0.0777, 0.1372| Residual Loss: 0.1345, 0.0551
Epoch 12/100, (Training, Validation) Trend Loss: 0.0839, 0.0937| Seasonal Loss: 0.0730, 0.1494| Residual Loss: 0.1394, 0.0549
Epoch 13/100, (Training, Validation) Trend Loss: 0.0912, 0.1026| Seasonal Loss: 0.0902, 0.1700| Residual Loss: 0.1375, 0.0922
Epoch 14/100, (Training, Validation) Trend Loss: 0.1371, 0.0999| Seasonal Loss: 0.0962, 0.2203| Residual Loss: 0.1394, 0.0827
Epoch 15/100, (Training, Validation) Trend Loss: 0.0965, 0.0506| Seasonal Loss: 0.1023, 0.1318| Residual Loss: 0.1294, 0.0654
Epoch 16/100, (Training, Validation) Trend Loss: 0.0683, 0.0806| Seasonal Loss: 0.0691, 0.1346| Residual Loss: 0.0958, 0.0413
Epoch 17/100, (Training, Validation) Trend Loss: 0.0496, 0.0469| Seasonal Loss: 0.0520, 0.1249| Residual Loss: 0.0850, 0.0340
Epoch 18/100, (Training, Validation) Trend Loss: 0.0445, 0.0371| Seasonal Loss: 0.0486, 0.1120| Residual Loss: 0.0855, 0.0804
Epoch 19/100, (Training, Validation) Trend Loss: 0.0435, 0.0638| Seasonal Loss: 0.0412, 0.1059| Residual Loss: 0.1089, 0.0538
Epoch 20/100, (Training, Validation) Trend Loss: 0.0399, 0.0379| Seasonal Loss: 0.0381, 0.0994| Residual Loss: 0.1074, 0.0479
Epoch 21/100, (Training, Validation) Trend Loss: 0.0445, 0.0596| Seasonal Loss: 0.0373, 0.0928| Residual Loss: 0.0791, 0.0509
Epoch 22/100, (Training, Validation) Trend Loss: 0.0381, 0.0318| Seasonal Loss: 0.0364, 0.0918| Residual Loss: 0.0656, 0.0339
Epoch 23/100, (Training, Validation) Trend Loss: 0.0414, 0.0414| Seasonal Loss: 0.0447, 0.0868| Residual Loss: 0.0625, 0.0372
Epoch 24/100, (Training, Validation) Trend Loss: 0.0274, 0.0295| Seasonal Loss: 0.0402, 0.0860| Residual Loss: 0.0538, 0.0398
Epoch 25/100, (Training, Validation) Trend Loss: 0.0243, 0.0241| Seasonal Loss: 0.0345, 0.0888| Residual Loss: 0.0513, 0.0347
Epoch 26/100, (Training, Validation) Trend Loss: 0.0233, 0.0290| Seasonal Loss: 0.0268, 0.0842| Residual Loss: 0.0469, 0.0350
Epoch 27/100, (Training, Validation) Trend Loss: 0.0209, 0.0201| Seasonal Loss: 0.0264, 0.0869| Residual Loss: 0.0448, 0.0345
Epoch 28/100, (Training, Validation) Trend Loss: 0.0205, 0.0233| Seasonal Loss: 0.0248, 0.0838| Residual Loss: 0.0413, 0.0340
Epoch 29/100, (Training, Validation) Trend Loss: 0.0190, 0.0172| Seasonal Loss: 0.0239, 0.0839| Residual Loss: 0.0399, 0.0339
Epoch 30/100, (Training, Validation) Trend Loss: 0.0186, 0.0210| Seasonal Loss: 0.0223, 0.0821| Residual Loss: 0.0371, 0.0334
Epoch 31/100, (Training, Validation) Trend Loss: 0.0191, 0.0151| Seasonal Loss: 0.0213, 0.0819| Residual Loss: 0.0361, 0.0340
Epoch 32/100, (Training, Validation) Trend Loss: 0.0208, 0.0218| Seasonal Loss: 0.0203, 0.0806| Residual Loss: 0.0341, 0.0332
Epoch 33/100, (Training, Validation) Trend Loss: 0.0261, 0.0204| Seasonal Loss: 0.0197, 0.0803| Residual Loss: 0.0332, 0.0346
Epoch 34/100, (Training, Validation) Trend Loss: 0.0303, 0.0364| Seasonal Loss: 0.0195, 0.0789| Residual Loss: 0.0317, 0.0331
Epoch 35/100, (Training, Validation) Trend Loss: 0.0394, 0.0509| Seasonal Loss: 0.0197, 0.0798| Residual Loss: 0.0311, 0.0356
Epoch 36/100, (Training, Validation) Trend Loss: 0.0380, 0.0284| Seasonal Loss: 0.0221, 0.0796| Residual Loss: 0.0302, 0.0330
Epoch 37/100, (Training, Validation) Trend Loss: 0.0280, 0.0212| Seasonal Loss: 0.0227, 0.0820| Residual Loss: 0.0297, 0.0368
Epoch 38/100, (Training, Validation) Trend Loss: 0.0186, 0.0324| Seasonal Loss: 0.0272, 0.0854| Residual Loss: 0.0295, 0.0333
Epoch 39/100, (Training, Validation) Trend Loss: 0.0190, 0.0200| Seasonal Loss: 0.0223, 0.0818| Residual Loss: 0.0286, 0.0372
Epoch 40/100, (Training, Validation) Trend Loss: 0.0168, 0.0176| Seasonal Loss: 0.0207, 0.0801| Residual Loss: 0.0283, 0.0342
Epoch 41/100, (Training, Validation) Trend Loss: 0.0169, 0.0208| Seasonal Loss: 0.0177, 0.0772| Residual Loss: 0.0268, 0.0366
Epoch 42/100, (Training, Validation) Trend Loss: 0.0156, 0.0191| Seasonal Loss: 0.0169, 0.0772| Residual Loss: 0.0262, 0.0353
Epoch 43/100, (Training, Validation) Trend Loss: 0.0150, 0.0164| Seasonal Loss: 0.0170, 0.0775| Residual Loss: 0.0251, 0.0364
Epoch 44/100, (Training, Validation) Trend Loss: 0.0149, 0.0167| Seasonal Loss: 0.0163, 0.0763| Residual Loss: 0.0248, 0.0359
Epoch 45/100, (Training, Validation) Trend Loss: 0.0145, 0.0169| Seasonal Loss: 0.0160, 0.0760| Residual Loss: 0.0240, 0.0367
Epoch 46/100, (Training, Validation) Trend Loss: 0.0142, 0.0160| Seasonal Loss: 0.0158, 0.0760| Residual Loss: 0.0238, 0.0364
Epoch 47/100, (Training, Validation) Trend Loss: 0.0139, 0.0157| Seasonal Loss: 0.0155, 0.0754| Residual Loss: 0.0232, 0.0371
Epoch 48/100, (Training, Validation) Trend Loss: 0.0138, 0.0157| Seasonal Loss: 0.0153, 0.0751| Residual Loss: 0.0229, 0.0370
Epoch 49/100, (Training, Validation) Trend Loss: 0.0136, 0.0155| Seasonal Loss: 0.0152, 0.0749| Residual Loss: 0.0225, 0.0376
Epoch 50/100, (Training, Validation) Trend Loss: 0.0134, 0.0153| Seasonal Loss: 0.0150, 0.0747| Residual Loss: 0.0222, 0.0377
Epoch 51/100, (Training, Validation) Trend Loss: 0.0132, 0.0151| Seasonal Loss: 0.0149, 0.0746| Residual Loss: 0.0218, 0.0382
Epoch 52/100, (Training, Validation) Trend Loss: 0.0131, 0.0151| Seasonal Loss: 0.0148, 0.0745| Residual Loss: 0.0216, 0.0385
Epoch 53/100, (Training, Validation) Trend Loss: 0.0130, 0.0149| Seasonal Loss: 0.0146, 0.0744| Residual Loss: 0.0213, 0.0387
Epoch 54/100, (Training, Validation) Trend Loss: 0.0129, 0.0148| Seasonal Loss: 0.0145, 0.0743| Residual Loss: 0.0210, 0.0391
Epoch 55/100, (Training, Validation) Trend Loss: 0.0128, 0.0147| Seasonal Loss: 0.0144, 0.0741| Residual Loss: 0.0208, 0.0394
Epoch 56/100, (Training, Validation) Trend Loss: 0.0127, 0.0147| Seasonal Loss: 0.0143, 0.0740| Residual Loss: 0.0205, 0.0396
Epoch 57/100, (Training, Validation) Trend Loss: 0.0126, 0.0146| Seasonal Loss: 0.0142, 0.0739| Residual Loss: 0.0203, 0.0399
Epoch 58/100, (Training, Validation) Trend Loss: 0.0125, 0.0145| Seasonal Loss: 0.0142, 0.0738| Residual Loss: 0.0201, 0.0401
Epoch 59/100, (Training, Validation) Trend Loss: 0.0124, 0.0144| Seasonal Loss: 0.0141, 0.0738| Residual Loss: 0.0199, 0.0403
Epoch 60/100, (Training, Validation) Trend Loss: 0.0124, 0.0144| Seasonal Loss: 0.0140, 0.0737| Residual Loss: 0.0197, 0.0405
Epoch 61/100, (Training, Validation) Trend Loss: 0.0123, 0.0143| Seasonal Loss: 0.0139, 0.0736| Residual Loss: 0.0196, 0.0406
Epoch 62/100, (Training, Validation) Trend Loss: 0.0123, 0.0143| Seasonal Loss: 0.0139, 0.0735| Residual Loss: 0.0194, 0.0407
Epoch 63/100, (Training, Validation) Trend Loss: 0.0122, 0.0142| Seasonal Loss: 0.0138, 0.0735| Residual Loss: 0.0193, 0.0408
Epoch 64/100, (Training, Validation) Trend Loss: 0.0121, 0.0142| Seasonal Loss: 0.0137, 0.0734| Residual Loss: 0.0191, 0.0409
Epoch 65/100, (Training, Validation) Trend Loss: 0.0121, 0.0141| Seasonal Loss: 0.0137, 0.0734| Residual Loss: 0.0190, 0.0409
Epoch 66/100, (Training, Validation) Trend Loss: 0.0121, 0.0141| Seasonal Loss: 0.0136, 0.0733| Residual Loss: 0.0189, 0.0410
Epoch 67/100, (Training, Validation) Trend Loss: 0.0120, 0.0141| Seasonal Loss: 0.0136, 0.0733| Residual Loss: 0.0187, 0.0410
Epoch 68/100, (Training, Validation) Trend Loss: 0.0120, 0.0140| Seasonal Loss: 0.0135, 0.0732| Residual Loss: 0.0186, 0.0411
Epoch 69/100, (Training, Validation) Trend Loss: 0.0119, 0.0140| Seasonal Loss: 0.0135, 0.0732| Residual Loss: 0.0185, 0.0411
Epoch 70/100, (Training, Validation) Trend Loss: 0.0119, 0.0140| Seasonal Loss: 0.0134, 0.0731| Residual Loss: 0.0184, 0.0411
Epoch 71/100, (Training, Validation) Trend Loss: 0.0119, 0.0139| Seasonal Loss: 0.0134, 0.0731| Residual Loss: 0.0183, 0.0411
Epoch 72/100, (Training, Validation) Trend Loss: 0.0118, 0.0139| Seasonal Loss: 0.0134, 0.0730| Residual Loss: 0.0182, 0.0411
Epoch 73/100, (Training, Validation) Trend Loss: 0.0118, 0.0139| Seasonal Loss: 0.0133, 0.0730| Residual Loss: 0.0182, 0.0411
Epoch 74/100, (Training, Validation) Trend Loss: 0.0118, 0.0138| Seasonal Loss: 0.0133, 0.0730| Residual Loss: 0.0181, 0.0411
Epoch 75/100, (Training, Validation) Trend Loss: 0.0118, 0.0138| Seasonal Loss: 0.0133, 0.0729| Residual Loss: 0.0180, 0.0411
Epoch 76/100, (Training, Validation) Trend Loss: 0.0117, 0.0138| Seasonal Loss: 0.0132, 0.0729| Residual Loss: 0.0179, 0.0411
Epoch 77/100, (Training, Validation) Trend Loss: 0.0117, 0.0138| Seasonal Loss: 0.0132, 0.0729| Residual Loss: 0.0179, 0.0411
Epoch 78/100, (Training, Validation) Trend Loss: 0.0117, 0.0138| Seasonal Loss: 0.0132, 0.0729| Residual Loss: 0.0178, 0.0410
Epoch 79/100, (Training, Validation) Trend Loss: 0.0117, 0.0137| Seasonal Loss: 0.0131, 0.0728| Residual Loss: 0.0177, 0.0410
Epoch 80/100, (Training, Validation) Trend Loss: 0.0116, 0.0137| Seasonal Loss: 0.0131, 0.0728| Residual Loss: 0.0177, 0.0410
Epoch 81/100, (Training, Validation) Trend Loss: 0.0116, 0.0137| Seasonal Loss: 0.0131, 0.0728| Residual Loss: 0.0176, 0.0410
Epoch 82/100, (Training, Validation) Trend Loss: 0.0116, 0.0137| Seasonal Loss: 0.0131, 0.0728| Residual Loss: 0.0176, 0.0410
Epoch 83/100, (Training, Validation) Trend Loss: 0.0116, 0.0137| Seasonal Loss: 0.0130, 0.0728| Residual Loss: 0.0175, 0.0410
Epoch 84/100, (Training, Validation) Trend Loss: 0.0116, 0.0137| Seasonal Loss: 0.0130, 0.0727| Residual Loss: 0.0175, 0.0410
Epoch 85/100, (Training, Validation) Trend Loss: 0.0116, 0.0136| Seasonal Loss: 0.0130, 0.0727| Residual Loss: 0.0174, 0.0410
Epoch 86/100, (Training, Validation) Trend Loss: 0.0115, 0.0136| Seasonal Loss: 0.0130, 0.0727| Residual Loss: 0.0174, 0.0410
Epoch 87/100, (Training, Validation) Trend Loss: 0.0115, 0.0136| Seasonal Loss: 0.0130, 0.0727| Residual Loss: 0.0174, 0.0409
Epoch 88/100, (Training, Validation) Trend Loss: 0.0115, 0.0136| Seasonal Loss: 0.0130, 0.0727| Residual Loss: 0.0173, 0.0409
Epoch 89/100, (Training, Validation) Trend Loss: 0.0115, 0.0136| Seasonal Loss: 0.0129, 0.0727| Residual Loss: 0.0173, 0.0409
Epoch 90/100, (Training, Validation) Trend Loss: 0.0115, 0.0136| Seasonal Loss: 0.0129, 0.0726| Residual Loss: 0.0172, 0.0409
Epoch 91/100, (Training, Validation) Trend Loss: 0.0115, 0.0136| Seasonal Loss: 0.0129, 0.0726| Residual Loss: 0.0172, 0.0409
Epoch 92/100, (Training, Validation) Trend Loss: 0.0115, 0.0136| Seasonal Loss: 0.0129, 0.0726| Residual Loss: 0.0172, 0.0409
Epoch 93/100, (Training, Validation) Trend Loss: 0.0115, 0.0135| Seasonal Loss: 0.0129, 0.0726| Residual Loss: 0.0172, 0.0409
Epoch 94/100, (Training, Validation) Trend Loss: 0.0114, 0.0135| Seasonal Loss: 0.0129, 0.0726| Residual Loss: 0.0171, 0.0409
Epoch 95/100, (Training, Validation) Trend Loss: 0.0114, 0.0135| Seasonal Loss: 0.0129, 0.0726| Residual Loss: 0.0171, 0.0409
Epoch 96/100, (Training, Validation) Trend Loss: 0.0114, 0.0135| Seasonal Loss: 0.0128, 0.0726| Residual Loss: 0.0171, 0.0409
Epoch 97/100, (Training, Validation) Trend Loss: 0.0114, 0.0135| Seasonal Loss: 0.0128, 0.0726| Residual Loss: 0.0170, 0.0409
Epoch 98/100, (Training, Validation) Trend Loss: 0.0114, 0.0135| Seasonal Loss: 0.0128, 0.0725| Residual Loss: 0.0170, 0.0409
Epoch 99/100, (Training, Validation) Trend Loss: 0.0114, 0.0135| Seasonal Loss: 0.0128, 0.0725| Residual Loss: 0.0170, 0.0408
Epoch 100/100, (Training, Validation) Trend Loss: 0.0114, 0.0135| Seasonal Loss: 0.0128, 0.0725| Residual Loss: 0.0170, 0.0408
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[168.78414025]
[-0.91230352]
[-0.158823]
[167.71301373]
actual_stock_price: [171.57913208 173.9239502  174.03323364 173.07940674 170.45640564
 170.73458862 171.87721252 174.30151367 176.1594696  176.10980225]
add_predicted_stock_price: [171.57913208 173.9239502  174.03323364 173.07940674 170.45640564
 170.73458862 171.87721252 174.30151367 176.1594696  167.71301373]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
