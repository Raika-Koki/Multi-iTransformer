[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.3679, 0.1496| Seasonal Loss: 0.5294, 0.2607| Residual Loss: 0.5382, 0.3418
Epoch 2/100, (Training, Validation) Trend Loss: 0.1826, 0.1734| Seasonal Loss: 0.3675, 0.2175| Residual Loss: 0.3325, 0.3110
Epoch 3/100, (Training, Validation) Trend Loss: 0.1498, 0.1759| Seasonal Loss: 0.3363, 0.2967| Residual Loss: 0.3004, 0.2413
Epoch 4/100, (Training, Validation) Trend Loss: 0.1652, 0.1499| Seasonal Loss: 0.3820, 0.1651| Residual Loss: 0.2267, 0.1960
Epoch 5/100, (Training, Validation) Trend Loss: 0.1555, 0.0968| Seasonal Loss: 0.2466, 0.1667| Residual Loss: 0.1845, 0.1603
Epoch 6/100, (Training, Validation) Trend Loss: 0.1353, 0.1446| Seasonal Loss: 0.1883, 0.2058| Residual Loss: 0.1550, 0.1405
Epoch 7/100, (Training, Validation) Trend Loss: 0.0976, 0.0757| Seasonal Loss: 0.1681, 0.2139| Residual Loss: 0.1420, 0.1318
Epoch 8/100, (Training, Validation) Trend Loss: 0.0894, 0.1476| Seasonal Loss: 0.1690, 0.2761| Residual Loss: 0.1299, 0.1152
Epoch 9/100, (Training, Validation) Trend Loss: 0.0815, 0.0768| Seasonal Loss: 0.1732, 0.2239| Residual Loss: 0.1266, 0.1228
Epoch 10/100, (Training, Validation) Trend Loss: 0.0836, 0.1382| Seasonal Loss: 0.1460, 0.1664| Residual Loss: 0.1245, 0.1096
Epoch 11/100, (Training, Validation) Trend Loss: 0.0715, 0.0640| Seasonal Loss: 0.1208, 0.1166| Residual Loss: 0.1633, 0.1789
Epoch 12/100, (Training, Validation) Trend Loss: 0.0705, 0.1014| Seasonal Loss: 0.1017, 0.1152| Residual Loss: 0.2329, 0.2001
Epoch 13/100, (Training, Validation) Trend Loss: 0.0540, 0.0429| Seasonal Loss: 0.0959, 0.1006| Residual Loss: 0.2024, 0.2319
Epoch 14/100, (Training, Validation) Trend Loss: 0.0496, 0.0682| Seasonal Loss: 0.0984, 0.1138| Residual Loss: 0.1603, 0.1403
Epoch 15/100, (Training, Validation) Trend Loss: 0.0434, 0.0349| Seasonal Loss: 0.1016, 0.0995| Residual Loss: 0.1297, 0.1169
Epoch 16/100, (Training, Validation) Trend Loss: 0.0422, 0.0586| Seasonal Loss: 0.1033, 0.1051| Residual Loss: 0.1155, 0.1135
Epoch 17/100, (Training, Validation) Trend Loss: 0.0529, 0.0372| Seasonal Loss: 0.0842, 0.1009| Residual Loss: 0.1097, 0.1028
Epoch 18/100, (Training, Validation) Trend Loss: 0.0629, 0.0463| Seasonal Loss: 0.0726, 0.1030| Residual Loss: 0.1039, 0.0974
Epoch 19/100, (Training, Validation) Trend Loss: 0.0816, 0.0486| Seasonal Loss: 0.0662, 0.1066| Residual Loss: 0.1000, 0.0946
Epoch 20/100, (Training, Validation) Trend Loss: 0.0622, 0.0275| Seasonal Loss: 0.0666, 0.1200| Residual Loss: 0.0967, 0.0909
Epoch 21/100, (Training, Validation) Trend Loss: 0.0426, 0.0650| Seasonal Loss: 0.0676, 0.1347| Residual Loss: 0.0944, 0.0892
Epoch 22/100, (Training, Validation) Trend Loss: 0.0370, 0.0290| Seasonal Loss: 0.0742, 0.1332| Residual Loss: 0.0922, 0.0876
Epoch 23/100, (Training, Validation) Trend Loss: 0.0392, 0.0592| Seasonal Loss: 0.0660, 0.1148| Residual Loss: 0.0905, 0.0863
Epoch 24/100, (Training, Validation) Trend Loss: 0.0345, 0.0301| Seasonal Loss: 0.0610, 0.0970| Residual Loss: 0.0890, 0.0854
Epoch 25/100, (Training, Validation) Trend Loss: 0.0371, 0.0553| Seasonal Loss: 0.0515, 0.0906| Residual Loss: 0.0877, 0.0846
Epoch 26/100, (Training, Validation) Trend Loss: 0.0319, 0.0269| Seasonal Loss: 0.0483, 0.0902| Residual Loss: 0.0865, 0.0839
Epoch 27/100, (Training, Validation) Trend Loss: 0.0325, 0.0436| Seasonal Loss: 0.0464, 0.0893| Residual Loss: 0.0855, 0.0835
Epoch 28/100, (Training, Validation) Trend Loss: 0.0277, 0.0257| Seasonal Loss: 0.0448, 0.0886| Residual Loss: 0.0845, 0.0829
Epoch 29/100, (Training, Validation) Trend Loss: 0.0271, 0.0330| Seasonal Loss: 0.0436, 0.0870| Residual Loss: 0.0837, 0.0826
Epoch 30/100, (Training, Validation) Trend Loss: 0.0248, 0.0266| Seasonal Loss: 0.0423, 0.0868| Residual Loss: 0.0829, 0.0822
Epoch 31/100, (Training, Validation) Trend Loss: 0.0243, 0.0281| Seasonal Loss: 0.0414, 0.0850| Residual Loss: 0.0822, 0.0820
Epoch 32/100, (Training, Validation) Trend Loss: 0.0234, 0.0264| Seasonal Loss: 0.0404, 0.0854| Residual Loss: 0.0816, 0.0816
Epoch 33/100, (Training, Validation) Trend Loss: 0.0230, 0.0260| Seasonal Loss: 0.0398, 0.0836| Residual Loss: 0.0811, 0.0814
Epoch 34/100, (Training, Validation) Trend Loss: 0.0225, 0.0254| Seasonal Loss: 0.0390, 0.0842| Residual Loss: 0.0806, 0.0813
Epoch 35/100, (Training, Validation) Trend Loss: 0.0220, 0.0248| Seasonal Loss: 0.0385, 0.0824| Residual Loss: 0.0801, 0.0810
Epoch 36/100, (Training, Validation) Trend Loss: 0.0216, 0.0244| Seasonal Loss: 0.0378, 0.0831| Residual Loss: 0.0797, 0.0809
Epoch 37/100, (Training, Validation) Trend Loss: 0.0212, 0.0239| Seasonal Loss: 0.0373, 0.0815| Residual Loss: 0.0791, 0.0806
Epoch 38/100, (Training, Validation) Trend Loss: 0.0209, 0.0236| Seasonal Loss: 0.0365, 0.0819| Residual Loss: 0.0784, 0.0806
Epoch 39/100, (Training, Validation) Trend Loss: 0.0205, 0.0232| Seasonal Loss: 0.0358, 0.0808| Residual Loss: 0.0778, 0.0803
Epoch 40/100, (Training, Validation) Trend Loss: 0.0202, 0.0229| Seasonal Loss: 0.0349, 0.0809| Residual Loss: 0.0772, 0.0803
Epoch 41/100, (Training, Validation) Trend Loss: 0.0200, 0.0226| Seasonal Loss: 0.0342, 0.0802| Residual Loss: 0.0767, 0.0801
Epoch 42/100, (Training, Validation) Trend Loss: 0.0197, 0.0223| Seasonal Loss: 0.0335, 0.0800| Residual Loss: 0.0762, 0.0800
Epoch 43/100, (Training, Validation) Trend Loss: 0.0195, 0.0220| Seasonal Loss: 0.0329, 0.0796| Residual Loss: 0.0758, 0.0799
Epoch 44/100, (Training, Validation) Trend Loss: 0.0192, 0.0217| Seasonal Loss: 0.0324, 0.0792| Residual Loss: 0.0754, 0.0798
Epoch 45/100, (Training, Validation) Trend Loss: 0.0190, 0.0215| Seasonal Loss: 0.0319, 0.0790| Residual Loss: 0.0751, 0.0798
Epoch 46/100, (Training, Validation) Trend Loss: 0.0188, 0.0213| Seasonal Loss: 0.0316, 0.0786| Residual Loss: 0.0747, 0.0797
Epoch 47/100, (Training, Validation) Trend Loss: 0.0186, 0.0211| Seasonal Loss: 0.0312, 0.0784| Residual Loss: 0.0744, 0.0796
Epoch 48/100, (Training, Validation) Trend Loss: 0.0184, 0.0209| Seasonal Loss: 0.0309, 0.0781| Residual Loss: 0.0741, 0.0796
Epoch 49/100, (Training, Validation) Trend Loss: 0.0183, 0.0207| Seasonal Loss: 0.0305, 0.0778| Residual Loss: 0.0738, 0.0795
Epoch 50/100, (Training, Validation) Trend Loss: 0.0181, 0.0206| Seasonal Loss: 0.0302, 0.0775| Residual Loss: 0.0736, 0.0794
Epoch 51/100, (Training, Validation) Trend Loss: 0.0180, 0.0204| Seasonal Loss: 0.0300, 0.0773| Residual Loss: 0.0733, 0.0794
Epoch 52/100, (Training, Validation) Trend Loss: 0.0178, 0.0202| Seasonal Loss: 0.0297, 0.0771| Residual Loss: 0.0731, 0.0793
Epoch 53/100, (Training, Validation) Trend Loss: 0.0177, 0.0201| Seasonal Loss: 0.0294, 0.0769| Residual Loss: 0.0728, 0.0793
Epoch 54/100, (Training, Validation) Trend Loss: 0.0176, 0.0200| Seasonal Loss: 0.0292, 0.0767| Residual Loss: 0.0726, 0.0792
Epoch 55/100, (Training, Validation) Trend Loss: 0.0175, 0.0198| Seasonal Loss: 0.0290, 0.0765| Residual Loss: 0.0724, 0.0792
Epoch 56/100, (Training, Validation) Trend Loss: 0.0173, 0.0197| Seasonal Loss: 0.0287, 0.0763| Residual Loss: 0.0722, 0.0792
Epoch 57/100, (Training, Validation) Trend Loss: 0.0172, 0.0196| Seasonal Loss: 0.0285, 0.0761| Residual Loss: 0.0720, 0.0791
Epoch 58/100, (Training, Validation) Trend Loss: 0.0171, 0.0195| Seasonal Loss: 0.0284, 0.0759| Residual Loss: 0.0718, 0.0791
Epoch 59/100, (Training, Validation) Trend Loss: 0.0170, 0.0194| Seasonal Loss: 0.0282, 0.0758| Residual Loss: 0.0716, 0.0791
Epoch 60/100, (Training, Validation) Trend Loss: 0.0170, 0.0193| Seasonal Loss: 0.0280, 0.0756| Residual Loss: 0.0715, 0.0790
Epoch 61/100, (Training, Validation) Trend Loss: 0.0169, 0.0192| Seasonal Loss: 0.0278, 0.0755| Residual Loss: 0.0713, 0.0790
Epoch 62/100, (Training, Validation) Trend Loss: 0.0168, 0.0191| Seasonal Loss: 0.0277, 0.0754| Residual Loss: 0.0711, 0.0790
Epoch 63/100, (Training, Validation) Trend Loss: 0.0167, 0.0190| Seasonal Loss: 0.0275, 0.0752| Residual Loss: 0.0710, 0.0789
Epoch 64/100, (Training, Validation) Trend Loss: 0.0166, 0.0190| Seasonal Loss: 0.0274, 0.0751| Residual Loss: 0.0709, 0.0789
Epoch 65/100, (Training, Validation) Trend Loss: 0.0166, 0.0189| Seasonal Loss: 0.0273, 0.0750| Residual Loss: 0.0707, 0.0789
Epoch 66/100, (Training, Validation) Trend Loss: 0.0165, 0.0188| Seasonal Loss: 0.0271, 0.0749| Residual Loss: 0.0706, 0.0789
Epoch 67/100, (Training, Validation) Trend Loss: 0.0164, 0.0187| Seasonal Loss: 0.0270, 0.0748| Residual Loss: 0.0705, 0.0789
Epoch 68/100, (Training, Validation) Trend Loss: 0.0164, 0.0187| Seasonal Loss: 0.0269, 0.0747| Residual Loss: 0.0704, 0.0788
Epoch 69/100, (Training, Validation) Trend Loss: 0.0163, 0.0186| Seasonal Loss: 0.0268, 0.0746| Residual Loss: 0.0702, 0.0788
Epoch 70/100, (Training, Validation) Trend Loss: 0.0163, 0.0186| Seasonal Loss: 0.0267, 0.0745| Residual Loss: 0.0701, 0.0788
Epoch 71/100, (Training, Validation) Trend Loss: 0.0162, 0.0185| Seasonal Loss: 0.0266, 0.0744| Residual Loss: 0.0700, 0.0788
Epoch 72/100, (Training, Validation) Trend Loss: 0.0162, 0.0185| Seasonal Loss: 0.0265, 0.0744| Residual Loss: 0.0699, 0.0788
Epoch 73/100, (Training, Validation) Trend Loss: 0.0161, 0.0184| Seasonal Loss: 0.0264, 0.0743| Residual Loss: 0.0699, 0.0788
Epoch 74/100, (Training, Validation) Trend Loss: 0.0161, 0.0184| Seasonal Loss: 0.0263, 0.0742| Residual Loss: 0.0698, 0.0787
Epoch 75/100, (Training, Validation) Trend Loss: 0.0161, 0.0183| Seasonal Loss: 0.0262, 0.0741| Residual Loss: 0.0697, 0.0787
Epoch 76/100, (Training, Validation) Trend Loss: 0.0160, 0.0183| Seasonal Loss: 0.0262, 0.0741| Residual Loss: 0.0696, 0.0787
Epoch 77/100, (Training, Validation) Trend Loss: 0.0160, 0.0182| Seasonal Loss: 0.0261, 0.0740| Residual Loss: 0.0695, 0.0787
Epoch 78/100, (Training, Validation) Trend Loss: 0.0159, 0.0182| Seasonal Loss: 0.0260, 0.0739| Residual Loss: 0.0694, 0.0787
Epoch 79/100, (Training, Validation) Trend Loss: 0.0159, 0.0182| Seasonal Loss: 0.0260, 0.0739| Residual Loss: 0.0694, 0.0787
Epoch 80/100, (Training, Validation) Trend Loss: 0.0159, 0.0181| Seasonal Loss: 0.0259, 0.0738| Residual Loss: 0.0693, 0.0787
Epoch 81/100, (Training, Validation) Trend Loss: 0.0158, 0.0181| Seasonal Loss: 0.0258, 0.0738| Residual Loss: 0.0692, 0.0787
Epoch 82/100, (Training, Validation) Trend Loss: 0.0158, 0.0180| Seasonal Loss: 0.0258, 0.0737| Residual Loss: 0.0692, 0.0786
Epoch 83/100, (Training, Validation) Trend Loss: 0.0158, 0.0180| Seasonal Loss: 0.0257, 0.0737| Residual Loss: 0.0691, 0.0786
Epoch 84/100, (Training, Validation) Trend Loss: 0.0158, 0.0180| Seasonal Loss: 0.0257, 0.0736| Residual Loss: 0.0691, 0.0786
Epoch 85/100, (Training, Validation) Trend Loss: 0.0157, 0.0180| Seasonal Loss: 0.0256, 0.0736| Residual Loss: 0.0690, 0.0786
Epoch 86/100, (Training, Validation) Trend Loss: 0.0157, 0.0179| Seasonal Loss: 0.0256, 0.0736| Residual Loss: 0.0690, 0.0786
Epoch 87/100, (Training, Validation) Trend Loss: 0.0157, 0.0179| Seasonal Loss: 0.0255, 0.0735| Residual Loss: 0.0689, 0.0786
Epoch 88/100, (Training, Validation) Trend Loss: 0.0157, 0.0179| Seasonal Loss: 0.0255, 0.0735| Residual Loss: 0.0689, 0.0786
Epoch 89/100, (Training, Validation) Trend Loss: 0.0156, 0.0179| Seasonal Loss: 0.0255, 0.0734| Residual Loss: 0.0688, 0.0786
Epoch 90/100, (Training, Validation) Trend Loss: 0.0156, 0.0178| Seasonal Loss: 0.0254, 0.0734| Residual Loss: 0.0688, 0.0786
Epoch 91/100, (Training, Validation) Trend Loss: 0.0156, 0.0178| Seasonal Loss: 0.0254, 0.0734| Residual Loss: 0.0688, 0.0786
Epoch 92/100, (Training, Validation) Trend Loss: 0.0156, 0.0178| Seasonal Loss: 0.0253, 0.0733| Residual Loss: 0.0687, 0.0786
Epoch 93/100, (Training, Validation) Trend Loss: 0.0156, 0.0178| Seasonal Loss: 0.0253, 0.0733| Residual Loss: 0.0687, 0.0786
Epoch 94/100, (Training, Validation) Trend Loss: 0.0156, 0.0178| Seasonal Loss: 0.0253, 0.0733| Residual Loss: 0.0686, 0.0786
Epoch 95/100, (Training, Validation) Trend Loss: 0.0155, 0.0177| Seasonal Loss: 0.0252, 0.0733| Residual Loss: 0.0686, 0.0786
Epoch 96/100, (Training, Validation) Trend Loss: 0.0155, 0.0177| Seasonal Loss: 0.0252, 0.0732| Residual Loss: 0.0686, 0.0785
Epoch 97/100, (Training, Validation) Trend Loss: 0.0155, 0.0177| Seasonal Loss: 0.0252, 0.0732| Residual Loss: 0.0686, 0.0785
Epoch 98/100, (Training, Validation) Trend Loss: 0.0155, 0.0177| Seasonal Loss: 0.0252, 0.0732| Residual Loss: 0.0685, 0.0785
Epoch 99/100, (Training, Validation) Trend Loss: 0.0155, 0.0177| Seasonal Loss: 0.0251, 0.0732| Residual Loss: 0.0685, 0.0785
Epoch 100/100, (Training, Validation) Trend Loss: 0.0155, 0.0177| Seasonal Loss: 0.0251, 0.0731| Residual Loss: 0.0685, 0.0785
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[168.38543989]
[-1.30275292]
[0.59725542]
[167.67994238]
stock_trend: Date
2019-12-31     78.597273
2020-01-02     78.442342
2020-01-03     78.286210
2020-01-06     78.128781
2020-01-07     77.969964
                 ...
2023-05-24    173.117857
2023-05-25    173.456806
2023-05-26    173.795653
2023-05-30    174.134458
2023-05-31    174.473272
Name: trend, Length: 860, dtype: float64
actual_stock_price: [171.57913208 173.9239502  174.0332489  173.07940674 170.45640564
 170.73460388 171.87719727 174.30149841 176.1594696  176.10980225]
add_predicted_stock_price: [171.57913208 173.9239502  174.0332489  173.07940674 170.45640564
 170.73460388 171.87719727 174.30149841 176.1594696  167.67994238]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
