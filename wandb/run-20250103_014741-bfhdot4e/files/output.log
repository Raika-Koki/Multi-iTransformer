最適化対象: trend
[32m[I 2025-01-03 01:47:41,875][0m A new study created in memory with name: no-name-8b7689ef-ed20-494e-8cdd-13b09e3d24df[0m
[32m[I 2025-01-03 01:47:49,103][0m Trial 0 finished with value: 1.4787727577098901 and parameters: {'observation_period_num': 125, 'train_rates': 0.8040817914625393, 'learning_rate': 0.0009224700350350259, 'batch_size': 214, 'step_size': 1, 'gamma': 0.8848194123567109}. Best is trial 0 with value: 1.4787727577098901.[0m
trend の最適ハイパーパラメータが見つかりました
最適化対象: seasonal_0
[32m[I 2025-01-03 01:47:49,104][0m A new study created in memory with name: no-name-6ad84734-c3ea-4c70-ac9b-20c999d1e949[0m
[32m[I 2025-01-03 01:47:56,074][0m Trial 0 finished with value: 0.7276991946652981 and parameters: {'observation_period_num': 155, 'train_rates': 0.6905472046041378, 'learning_rate': 2.4038741872668202e-05, 'batch_size': 110, 'step_size': 8, 'gamma': 0.9274867819751618}. Best is trial 0 with value: 0.7276991946652981.[0m
seasonal_0 の最適ハイパーパラメータが見つかりました
最適化対象: seasonal_1
[32m[I 2025-01-03 01:47:56,075][0m A new study created in memory with name: no-name-e3fab82b-94d5-41da-a579-60172d6eefeb[0m
[32m[I 2025-01-03 01:48:04,058][0m Trial 0 finished with value: 1.326410859823227 and parameters: {'observation_period_num': 224, 'train_rates': 0.7203774841951801, 'learning_rate': 1.756814484055352e-06, 'batch_size': 68, 'step_size': 7, 'gamma': 0.8220702892715742}. Best is trial 0 with value: 1.326410859823227.[0m
seasonal_1 の最適ハイパーパラメータが見つかりました
最適化対象: seasonal_2
[32m[I 2025-01-03 01:48:04,059][0m A new study created in memory with name: no-name-22be906f-a83a-4e37-b8e9-9f43fdb0d66d[0m
[32m[I 2025-01-03 01:48:11,942][0m Trial 0 finished with value: 0.3896161649800554 and parameters: {'observation_period_num': 172, 'train_rates': 0.8858350658698463, 'learning_rate': 2.0351932421756165e-05, 'batch_size': 120, 'step_size': 5, 'gamma': 0.9297011382828203}. Best is trial 0 with value: 0.3896161649800554.[0m
seasonal_2 の最適ハイパーパラメータが見つかりました
最適化対象: seasonal_3
[32m[I 2025-01-03 01:48:11,943][0m A new study created in memory with name: no-name-2d1b5042-46a1-4c79-8be2-57b33d4d3296[0m
[32m[I 2025-01-03 01:48:19,944][0m Trial 0 finished with value: 0.6867642998695374 and parameters: {'observation_period_num': 139, 'train_rates': 0.971893635776476, 'learning_rate': 6.038545066085288e-06, 'batch_size': 177, 'step_size': 11, 'gamma': 0.7667835232213369}. Best is trial 0 with value: 0.6867642998695374.[0m
seasonal_3 の最適ハイパーパラメータが見つかりました
最適化対象: resid
[32m[I 2025-01-03 01:48:19,945][0m A new study created in memory with name: no-name-61e9e43c-f121-4e43-b13f-45053b2f464f[0m
[32m[I 2025-01-03 01:48:27,259][0m Trial 0 finished with value: 0.6395612812970386 and parameters: {'observation_period_num': 188, 'train_rates': 0.8509614278877433, 'learning_rate': 4.652390790580968e-06, 'batch_size': 211, 'step_size': 11, 'gamma': 0.8120317091915052}. Best is trial 0 with value: 0.6395612812970386.[0m
resid の最適ハイパーパラメータが見つかりました
最適ハイパーパラメータが best_hyperparameters_AMZN_iTransformer.json に保存されました
Training trend component with params: {'observation_period_num': 125, 'train_rates': 0.8040817914625393, 'learning_rate': 0.0009224700350350259, 'batch_size': 214, 'step_size': 1, 'gamma': 0.8848194123567109}
Epoch 1/1, trend Loss: 4.3425 | 1.2375
Training seasonal_0 component with params: {'observation_period_num': 155, 'train_rates': 0.6905472046041378, 'learning_rate': 2.4038741872668202e-05, 'batch_size': 110, 'step_size': 8, 'gamma': 0.9274867819751618}
Epoch 1/1, seasonal_0 Loss: 0.5992 | 0.6838
Training seasonal_1 component with params: {'observation_period_num': 224, 'train_rates': 0.7203774841951801, 'learning_rate': 1.756814484055352e-06, 'batch_size': 68, 'step_size': 7, 'gamma': 0.8220702892715742}
Epoch 1/1, seasonal_1 Loss: 0.6429 | 1.1007
Training seasonal_2 component with params: {'observation_period_num': 172, 'train_rates': 0.8858350658698463, 'learning_rate': 2.0351932421756165e-05, 'batch_size': 120, 'step_size': 5, 'gamma': 0.9297011382828203}
Epoch 1/1, seasonal_2 Loss: 0.8109 | 0.4352
Training seasonal_3 component with params: {'observation_period_num': 139, 'train_rates': 0.971893635776476, 'learning_rate': 6.038545066085288e-06, 'batch_size': 177, 'step_size': 11, 'gamma': 0.7667835232213369}
Epoch 1/1, seasonal_3 Loss: 1.4316 | 0.9466
Training resid component with params: {'observation_period_num': 188, 'train_rates': 0.8509614278877433, 'learning_rate': 4.652390790580968e-06, 'batch_size': 211, 'step_size': 11, 'gamma': 0.8120317091915052}
Epoch 1/1, resid Loss: 1.0737 | 1.2865
Runtime (seconds): 51.02420616149902
0.0009224700350350259
[109.29703]
[-0.16176307]
[1.2995429]
[14.891354]
[2.8623362]
[10.772069]
/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/sklearn/metrics/_regression.py:1266: UndefinedMetricWarning: R^2 score is not well-defined with less than two samples.
  warnings.warn(msg, UndefinedMetricWarning)
MSE: 5053.709477820434
RMSE: 71.08944702148438
MAE: 71.08944702148438
R-squared: nan
[138.96056]
File amzn_stock_price_prediction_by_iTransformer.png exists. Logging to WandB.
