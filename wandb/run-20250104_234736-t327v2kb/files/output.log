[32m[I 2025-01-04 23:47:38,250][0m A new study created in memory with name: no-name-643d7da0-5d47-4652-89f9-5dddcd64c90e[0m
[32m[I 2025-01-04 23:48:27,752][0m Trial 0 finished with value: 0.7410345854384176 and parameters: {'observation_period_num': 127, 'train_rates': 0.90573925239647, 'learning_rate': 2.3089838440543775e-06, 'batch_size': 159, 'step_size': 6, 'gamma': 0.902336550169569}. Best is trial 0 with value: 0.7410345854384176.[0m
[32m[I 2025-01-04 23:51:36,101][0m Trial 1 finished with value: 0.035478079460326814 and parameters: {'observation_period_num': 22, 'train_rates': 0.8053059769707414, 'learning_rate': 0.0002364490664423663, 'batch_size': 21, 'step_size': 14, 'gamma': 0.8105150423276337}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-04 23:52:13,369][0m Trial 2 finished with value: 0.13963699715954442 and parameters: {'observation_period_num': 165, 'train_rates': 0.8463126762489028, 'learning_rate': 0.00012828390669727168, 'batch_size': 222, 'step_size': 4, 'gamma': 0.9067324988475204}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-04 23:52:49,026][0m Trial 3 finished with value: 0.2502048675599228 and parameters: {'observation_period_num': 65, 'train_rates': 0.6555763772941118, 'learning_rate': 7.90159301288632e-06, 'batch_size': 119, 'step_size': 11, 'gamma': 0.9249067643084111}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-04 23:53:27,166][0m Trial 4 finished with value: 0.41644638612514406 and parameters: {'observation_period_num': 90, 'train_rates': 0.6457085336463175, 'learning_rate': 9.994259074427521e-06, 'batch_size': 107, 'step_size': 10, 'gamma': 0.7533603368737289}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-04 23:54:00,582][0m Trial 5 finished with value: 0.06247269114742808 and parameters: {'observation_period_num': 12, 'train_rates': 0.666204241966953, 'learning_rate': 3.8300016025647154e-05, 'batch_size': 234, 'step_size': 10, 'gamma': 0.8738943477300785}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-04 23:55:06,817][0m Trial 6 finished with value: 0.5898815989494324 and parameters: {'observation_period_num': 130, 'train_rates': 0.9874387202160505, 'learning_rate': 2.049504993518278e-06, 'batch_size': 88, 'step_size': 12, 'gamma': 0.8402984783711215}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-04 23:55:52,581][0m Trial 7 finished with value: 0.14385537803173065 and parameters: {'observation_period_num': 128, 'train_rates': 0.9811639425226862, 'learning_rate': 0.0002849692345913148, 'batch_size': 242, 'step_size': 9, 'gamma': 0.8535673182082112}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-04 23:56:34,194][0m Trial 8 finished with value: 0.5584776919344905 and parameters: {'observation_period_num': 18, 'train_rates': 0.611029777171176, 'learning_rate': 1.2459256548335627e-06, 'batch_size': 147, 'step_size': 4, 'gamma': 0.8689678060087846}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-04 23:57:18,626][0m Trial 9 finished with value: 0.05440441146492958 and parameters: {'observation_period_num': 30, 'train_rates': 0.9781422197190643, 'learning_rate': 0.0001485876948871957, 'batch_size': 235, 'step_size': 14, 'gamma': 0.8904252439092534}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-05 00:00:51,857][0m Trial 10 finished with value: 0.1868418544662543 and parameters: {'observation_period_num': 249, 'train_rates': 0.7492189837756462, 'learning_rate': 0.0008625254013453224, 'batch_size': 16, 'step_size': 15, 'gamma': 0.791212313506989}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-05 00:04:18,394][0m Trial 11 finished with value: 0.08640182018819145 and parameters: {'observation_period_num': 53, 'train_rates': 0.762235590023256, 'learning_rate': 0.00012040076927206686, 'batch_size': 18, 'step_size': 15, 'gamma': 0.9616614167910262}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-05 00:04:58,115][0m Trial 12 finished with value: 0.0366082307308504 and parameters: {'observation_period_num': 38, 'train_rates': 0.8750341400976, 'learning_rate': 0.0005405071633560252, 'batch_size': 190, 'step_size': 13, 'gamma': 0.809406833871613}. Best is trial 1 with value: 0.035478079460326814.[0m
Early stopping at epoch 71
[32m[I 2025-01-05 00:05:25,936][0m Trial 13 finished with value: 0.20349636206713814 and parameters: {'observation_period_num': 85, 'train_rates': 0.8328244244551991, 'learning_rate': 0.0009181384026518092, 'batch_size': 191, 'step_size': 1, 'gamma': 0.8077414380248318}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-05 00:06:50,402][0m Trial 14 finished with value: 0.0818869024515152 and parameters: {'observation_period_num': 49, 'train_rates': 0.8661135819283904, 'learning_rate': 0.00038267655854759384, 'batch_size': 60, 'step_size': 13, 'gamma': 0.8149427841329916}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-05 00:07:43,138][0m Trial 15 finished with value: 0.27835910263740027 and parameters: {'observation_period_num': 192, 'train_rates': 0.9087110758203861, 'learning_rate': 3.505201385639224e-05, 'batch_size': 182, 'step_size': 7, 'gamma': 0.7653345413787652}. Best is trial 1 with value: 0.035478079460326814.[0m
[32m[I 2025-01-05 00:08:45,591][0m Trial 16 finished with value: 0.023320790321152557 and parameters: {'observation_period_num': 5, 'train_rates': 0.7759750006177292, 'learning_rate': 0.0003381469629457436, 'batch_size': 69, 'step_size': 13, 'gamma': 0.8260333642121555}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:09:51,858][0m Trial 17 finished with value: 0.03048222613031581 and parameters: {'observation_period_num': 6, 'train_rates': 0.7800419451758268, 'learning_rate': 9.471386175496121e-05, 'batch_size': 64, 'step_size': 12, 'gamma': 0.8350380039787771}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:11:02,831][0m Trial 18 finished with value: 0.027033798137318085 and parameters: {'observation_period_num': 9, 'train_rates': 0.7222294125011939, 'learning_rate': 6.876342135474789e-05, 'batch_size': 61, 'step_size': 8, 'gamma': 0.9862096936518006}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:12:16,694][0m Trial 19 finished with value: 0.07274482548139834 and parameters: {'observation_period_num': 85, 'train_rates': 0.7326458656109089, 'learning_rate': 5.443472357664122e-05, 'batch_size': 53, 'step_size': 8, 'gamma': 0.9839472038944174}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:13:08,507][0m Trial 20 finished with value: 0.3810669735074043 and parameters: {'observation_period_num': 247, 'train_rates': 0.7120847820591668, 'learning_rate': 9.541766397943462e-06, 'batch_size': 87, 'step_size': 5, 'gamma': 0.9500508720897546}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:14:56,497][0m Trial 21 finished with value: 0.029521903728846437 and parameters: {'observation_period_num': 7, 'train_rates': 0.7818793099439209, 'learning_rate': 7.368836614156747e-05, 'batch_size': 48, 'step_size': 11, 'gamma': 0.8399729339465672}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:16:20,323][0m Trial 22 finished with value: 0.13869593670957436 and parameters: {'observation_period_num': 61, 'train_rates': 0.6975046815221044, 'learning_rate': 1.6781706459528156e-05, 'batch_size': 47, 'step_size': 9, 'gamma': 0.7804916914534017}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:17:13,544][0m Trial 23 finished with value: 0.034366089216980734 and parameters: {'observation_period_num': 5, 'train_rates': 0.8029887104872737, 'learning_rate': 6.9912459735859e-05, 'batch_size': 87, 'step_size': 11, 'gamma': 0.8354905824412524}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:18:40,442][0m Trial 24 finished with value: 0.0599612468374627 and parameters: {'observation_period_num': 38, 'train_rates': 0.7004373607314365, 'learning_rate': 0.00018452247838648744, 'batch_size': 43, 'step_size': 8, 'gamma': 0.8643488630176811}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:20:00,340][0m Trial 25 finished with value: 0.08554298128537868 and parameters: {'observation_period_num': 71, 'train_rates': 0.7743542092366954, 'learning_rate': 2.0835481981335353e-05, 'batch_size': 78, 'step_size': 11, 'gamma': 0.9372495959376188}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:20:58,924][0m Trial 26 finished with value: 0.0832879855793896 and parameters: {'observation_period_num': 102, 'train_rates': 0.7242426399064609, 'learning_rate': 6.33073635326505e-05, 'batch_size': 111, 'step_size': 7, 'gamma': 0.9880373135580027}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:23:31,695][0m Trial 27 finished with value: 0.08400603959275152 and parameters: {'observation_period_num': 36, 'train_rates': 0.8244571974234796, 'learning_rate': 0.0004382521489951242, 'batch_size': 37, 'step_size': 10, 'gamma': 0.8844576209547413}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:25:03,409][0m Trial 28 finished with value: 0.07286581175713071 and parameters: {'observation_period_num': 28, 'train_rates': 0.7426903949750795, 'learning_rate': 1.9881822259080897e-05, 'batch_size': 75, 'step_size': 13, 'gamma': 0.8492612093516257}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:25:40,504][0m Trial 29 finished with value: 0.7759533392058479 and parameters: {'observation_period_num': 178, 'train_rates': 0.6825793592301792, 'learning_rate': 4.221987683489868e-06, 'batch_size': 127, 'step_size': 2, 'gamma': 0.9057586344881873}. Best is trial 16 with value: 0.023320790321152557.[0m
[32m[I 2025-01-05 00:27:50,586][0m Trial 30 finished with value: 0.10074061089301412 and parameters: {'observation_period_num': 217, 'train_rates': 0.9136321218558429, 'learning_rate': 9.637048833861992e-05, 'batch_size': 33, 'step_size': 6, 'gamma': 0.823880373049987}. Best is trial 16 with value: 0.023320790321152557.[0m
[33m[W 2025-01-05 00:28:46,803][0m Trial 31 failed with parameters: {'observation_period_num': 10, 'train_rates': 0.7789531521611723, 'learning_rate': 7.712279372144658e-05, 'batch_size': 66, 'step_size': 12, 'gamma': 0.7897294657752856} because of the following error: KeyboardInterrupt().[0m
Traceback (most recent call last):
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 412, in <lambda>
    study.optimize(lambda trial: objective(trial, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 83, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 40, in train
    loss.backward()  # ÈÄÜ‰ºùÊí≠
    ^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
[33m[W 2025-01-05 00:28:46,812][0m Trial 31 failed with value None.[0m
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 412, in <module>
    study.optimize(lambda trial: objective(trial, depth, dim), n_trials=50) #check
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 412, in <lambda>
    study.optimize(lambda trial: objective(trial, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 83, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 40, in train
    loss.backward()  # ÈÄÜ‰ºùÊí≠
    ^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
