Using device: cuda
[*********************100%***********************]  1 of 1 completed
Ticker            AAPL
Date
2012-05-18   15.978597
2012-05-21   16.909508
2012-05-22   16.779659
2012-05-23   17.189081
2012-05-24   17.031219
...                ...
2023-05-24  170.546951
2023-05-25  171.688324
2023-05-26  174.109955
2023-05-30  175.965881
2023-05-31  175.916245

[2776 rows x 1 columns]
/data/student/k2110261/Multi-iTransformer/optunademo.py:104: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df = df.fillna(method='ffill')  # 前日のデータを使用
{'AAPL': Date
2012-05-18     18.353258
2012-05-21     18.337499
2012-05-22     18.321751
2012-05-23     18.306014
2012-05-24     18.290288
                 ...
2023-05-24    161.245451
2023-05-25    161.303022
2023-05-26    161.360590
2023-05-30    161.418154
2023-05-31    161.475714
Name: trend, Length: 2776, dtype: float64, 'DTWEXBGS': Date
2012-05-18     93.1395
2012-05-21     93.0945
2012-05-22     93.1113
2012-05-23     93.8855
2012-05-24     93.8027
                ...
2023-05-24    120.6481
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
Length: 2776, dtype: float64, 'VIXCLS': Date
2012-05-18    25.10
2012-05-21    22.01
2012-05-22    22.48
2012-05-23    22.33
2012-05-24    21.54
              ...
2023-05-24    20.03
2023-05-25    19.14
2023-05-26    17.95
2023-05-30    17.46
2023-05-31    17.94
Length: 2776, dtype: float64, 'DFII10': Date
2012-05-18   -0.39
2012-05-21   -0.41
2012-05-22   -0.38
2012-05-23   -0.41
2012-05-24   -0.37
              ...
2023-05-24    1.48
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
Length: 2776, dtype: float64, 'T10Y2Y': Date
2012-05-18    1.39
2012-05-21    1.45
2012-05-22    1.49
2012-05-23    1.45
2012-05-24    1.48
              ...
2023-05-24   -0.58
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
Length: 2776, dtype: float64}
AAPLにあるが他のデータ1にはない日付: DatetimeIndex([], dtype='datetime64[ns]', name='Date', freq=None)
他のデータ1にあるがAAPLにはない日付: DatetimeIndex([], dtype='datetime64[ns]', name='Date', freq=None)
Ticker           AAPL
Date
2012-05-18  732292400
2012-05-21  631106000
2012-05-22  694870400
2012-05-23  584897600
2012-05-24  496230000
...               ...
2023-05-24   45143500
2023-05-25   56058300
2023-05-26   54835000
2023-05-30   55964400
2023-05-31   99625300

[2776 rows x 1 columns]
Price      BB_Upper BB_Lower BB_Middle MACD MACD_Signal MACD_Diff RSI SMA_50 SMA_200
Ticker
Date
2012-05-18      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
2012-05-21      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
2012-05-22      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
2012-05-23      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
2012-05-24      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
['AAPL', 'DTWEXBGS', 'VIXCLS', 'DFII10', 'T10Y2Y', 'Volume', 'BB_Upper', 'BB_Lower', 'BB_Middle', 'MACD', 'MACD_Signal', 'MACD_Diff', 'RSI', 'SMA_50', 'SMA_200']
dataframes_trend: dict_items([('AAPL', Date
2012-05-18     18.353258
2012-05-21     18.337499
2012-05-22     18.321751
2012-05-23     18.306014
2012-05-24     18.290288
                 ...
2023-05-24    161.245451
2023-05-25    161.303022
2023-05-26    161.360590
2023-05-30    161.418154
2023-05-31    161.475714
Name: trend, Length: 2776, dtype: float64), ('DTWEXBGS', Date
2012-05-18     93.1395
2012-05-21     93.0945
2012-05-22     93.1113
2012-05-23     93.8855
2012-05-24     93.8027
                ...
2023-05-24    120.6481
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
Length: 2776, dtype: float64), ('VIXCLS', Date
2012-05-18    25.10
2012-05-21    22.01
2012-05-22    22.48
2012-05-23    22.33
2012-05-24    21.54
              ...
2023-05-24    20.03
2023-05-25    19.14
2023-05-26    17.95
2023-05-30    17.46
2023-05-31    17.94
Length: 2776, dtype: float64), ('DFII10', Date
2012-05-18   -0.39
2012-05-21   -0.41
2012-05-22   -0.38
2012-05-23   -0.41
2012-05-24   -0.37
              ...
2023-05-24    1.48
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
Length: 2776, dtype: float64), ('T10Y2Y', Date
2012-05-18    1.39
2012-05-21    1.45
2012-05-22    1.49
2012-05-23    1.45
2012-05-24    1.48
              ...
2023-05-24   -0.58
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
Length: 2776, dtype: float64), ('Volume', Ticker           AAPL
Date
2012-05-18  732292400
2012-05-21  631106000
2012-05-22  694870400
2012-05-23  584897600
2012-05-24  496230000
...               ...
2023-05-24   45143500
2023-05-25   56058300
2023-05-26   54835000
2023-05-30   55964400
2023-05-31   99625300

[2776 rows x 1 columns]), ('BB_Upper', Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    175.360194
2023-05-25    175.401886
2023-05-26    175.825127
2023-05-30    176.541935
2023-05-31    177.020401
Name: BB_Upper, Length: 2776, dtype: float64), ('BB_Lower', Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    165.081598
2023-05-25    165.517548
2023-05-26    165.688243
2023-05-30    165.759884
2023-05-31    166.168968
Name: BB_Lower, Length: 2776, dtype: float64), ('BB_Middle', Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    170.220896
2023-05-25    170.459717
2023-05-26    170.756685
2023-05-30    171.150909
2023-05-31    171.594685
Name: BB_Middle, Length: 2776, dtype: float64), ('MACD', Date
2012-05-18         NaN
2012-05-21         NaN
2012-05-22         NaN
2012-05-23         NaN
2012-05-24         NaN
                ...
2023-05-24    2.332937
2023-05-25    2.209842
2023-05-26    2.281394
2023-05-30    2.459507
2023-05-31    2.567065
Name: MACD, Length: 2776, dtype: float64), ('MACD_Signal', Date
2012-05-18         NaN
2012-05-21         NaN
2012-05-22         NaN
2012-05-23         NaN
2012-05-24         NaN
                ...
2023-05-24    2.724338
2023-05-25    2.621439
2023-05-26    2.553430
2023-05-30    2.534645
2023-05-31    2.541129
Name: MACD_Signal, Length: 2776, dtype: float64), ('MACD_Diff', Date
2012-05-18         NaN
2012-05-21         NaN
2012-05-22         NaN
2012-05-23         NaN
2012-05-24         NaN
                ...
2023-05-24   -0.391401
2023-05-25   -0.411597
2023-05-26   -0.272036
2023-05-30   -0.075139
2023-05-31    0.025936
Name: MACD_Diff, Length: 2776, dtype: float64), ('RSI', Date
2012-05-18          NaN
2012-05-21          NaN
2012-05-22          NaN
2012-05-23          NaN
2012-05-24          NaN
                ...
2023-05-24    55.867138
2023-05-25    58.637798
2023-05-26    63.826690
2023-05-30    67.220664
2023-05-31    67.039497
Name: RSI, Length: 2776, dtype: float64), ('SMA_50', Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    164.409243
2023-05-25    164.810428
2023-05-26    165.203355
2023-05-30    165.650249
2023-05-31    166.048577
Name: SMA_50, Length: 2776, dtype: float64), ('SMA_200', Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    150.685262
2023-05-25    150.729037
2023-05-26    150.763579
2023-05-30    150.811106
2023-05-31    150.840552
Name: SMA_200, Length: 2776, dtype: float64)])
dataframes_trend: dict_items([('AAPL', Date
2013-03-07     15.555098
2013-03-08     15.542718
2013-03-11     15.530341
2013-03-12     15.517967
2013-03-13     15.505595
                 ...
2023-05-24    161.245451
2023-05-25    161.303022
2023-05-26    161.360590
2023-05-30    161.418154
2023-05-31    161.475714
Name: trend, Length: 2577, dtype: float64), ('DTWEXBGS', Date
2013-03-07     92.5462
2013-03-08     92.6252
2013-03-11     92.5351
2013-03-12     92.3853
2013-03-13     92.4709
                ...
2023-05-24    120.6481
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
Length: 2577, dtype: float64), ('VIXCLS', Date
2013-03-07    13.06
2013-03-08    12.59
2013-03-11    11.56
2013-03-12    12.27
2013-03-13    11.83
              ...
2023-05-24    20.03
2023-05-25    19.14
2023-05-26    17.95
2023-05-30    17.46
2023-05-31    17.94
Length: 2577, dtype: float64), ('DFII10', Date
2013-03-07   -0.56
2013-03-08   -0.50
2013-03-11   -0.50
2013-03-12   -0.52
2013-03-13   -0.52
              ...
2023-05-24    1.48
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
Length: 2577, dtype: float64), ('T10Y2Y', Date
2013-03-07    1.75
2013-03-08    1.79
2013-03-11    1.80
2013-03-12    1.76
2013-03-13    1.77
              ...
2023-05-24   -0.58
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
Length: 2577, dtype: float64), ('Volume', Ticker           AAPL
Date
2013-03-07  468473600
2013-03-08  391482000
2013-03-11  474236000
2013-03-12  465911600
2013-03-13  405549200
...               ...
2023-05-24   45143500
2023-05-25   56058300
2023-05-26   54835000
2023-05-30   55964400
2023-05-31   99625300

[2577 rows x 1 columns]), ('BB_Upper', Date
2013-03-07     14.800105
2013-03-08     14.740507
2013-03-11     14.622186
2013-03-12     14.451163
2013-03-13     14.346885
                 ...
2023-05-24    175.360194
2023-05-25    175.401886
2023-05-26    175.825127
2023-05-30    176.541935
2023-05-31    177.020401
Name: BB_Upper, Length: 2577, dtype: float64), ('BB_Lower', Date
2013-03-07     12.732895
2013-03-08     12.680908
2013-03-11     12.685777
2013-03-12     12.699359
2013-03-13     12.682726
                 ...
2023-05-24    165.081598
2023-05-25    165.517548
2023-05-26    165.688243
2023-05-30    165.759884
2023-05-31    166.168968
Name: BB_Lower, Length: 2577, dtype: float64), ('BB_Middle', Date
2013-03-07     13.766500
2013-03-08     13.710707
2013-03-11     13.653982
2013-03-12     13.575261
2013-03-13     13.514806
                 ...
2023-05-24    170.220896
2023-05-25    170.459717
2023-05-26    170.756685
2023-05-30    171.150909
2023-05-31    171.594685
Name: BB_Middle, Length: 2577, dtype: float64), ('MACD', Date
2013-03-07   -0.411427
2013-03-08   -0.396536
2013-03-11   -0.365352
2013-03-12   -0.359778
2013-03-13   -0.351506
                ...
2023-05-24    2.332937
2023-05-25    2.209842
2023-05-26    2.281394
2023-05-30    2.459507
2023-05-31    2.567065
Name: MACD, Length: 2577, dtype: float64), ('MACD_Signal', Date
2013-03-07   -0.389184
2013-03-08   -0.390654
2013-03-11   -0.385594
2013-03-12   -0.380431
2013-03-13   -0.374646
                ...
2023-05-24    2.724338
2023-05-25    2.621439
2023-05-26    2.553430
2023-05-30    2.534645
2023-05-31    2.541129
Name: MACD_Signal, Length: 2577, dtype: float64), ('MACD_Diff', Date
2013-03-07   -0.022244
2013-03-08   -0.005882
2013-03-11    0.020241
2013-03-12    0.020652
2013-03-13    0.023139
                ...
2023-05-24   -0.391401
2023-05-25   -0.411597
2023-05-26   -0.272036
2023-05-30   -0.075139
2023-05-31    0.025936
Name: MACD_Diff, Length: 2577, dtype: float64), ('RSI', Date
2013-03-07    38.423584
2013-03-08    39.155826
2013-03-11    43.087630
2013-03-12    38.929222
2013-03-13    38.894970
                ...
2023-05-24    55.867138
2023-05-25    58.637798
2023-05-26    63.826690
2023-05-30    67.220664
2023-05-31    67.039497
Name: RSI, Length: 2577, dtype: float64), ('SMA_50', Date
2013-03-07     14.536962
2013-03-08     14.484724
2013-03-11     14.440605
2013-03-12     14.389461
2013-03-13     14.341595
                 ...
2023-05-24    164.409243
2023-05-25    164.810428
2023-05-26    165.203355
2023-05-30    165.650249
2023-05-31    166.048577
Name: SMA_50, Length: 2577, dtype: float64), ('SMA_200', Date
2013-03-07     17.349991
2013-03-08     17.336089
2013-03-11     17.318473
2013-03-12     17.300063
2013-03-13     17.279594
                 ...
2023-05-24    150.685262
2023-05-25    150.729037
2023-05-26    150.763579
2023-05-30    150.811106
2023-05-31    150.840552
Name: SMA_200, Length: 2577, dtype: float64)])
AAPL null values:
0
DTWEXBGS null values:
0
VIXCLS null values:
0
DFII10 null values:
0
T10Y2Y null values:
0
Volume null values:
Ticker
AAPL    0
dtype: int64
BB_Upper null values:
0
BB_Lower null values:
0
BB_Middle null values:
0
MACD null values:
0
MACD_Signal null values:
0
MACD_Diff null values:
0
RSI null values:
0
SMA_50 null values:
0
SMA_200 null values:
0
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/optunademo.py", line 194, in <module>
    combined_df_trend = pd.DataFrame(dataframes_trend)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
           ^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (2577, 1) instead
