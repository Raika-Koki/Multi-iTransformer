[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 2.6571, 0.2065| Seasonal Loss: 2.1188, 0.4438| Residual Loss: 0.5507, 0.4334
Epoch 2/100, (Training, Validation) Trend Loss: 0.5098, 0.3420| Seasonal Loss: 0.6946, 0.3114| Residual Loss: 0.3028, 0.3213
Epoch 3/100, (Training, Validation) Trend Loss: 0.3859, 0.3181| Seasonal Loss: 0.5249, 0.3224| Residual Loss: 0.2926, 0.3697
Epoch 4/100, (Training, Validation) Trend Loss: 0.2686, 0.5163| Seasonal Loss: 0.3725, 0.5539| Residual Loss: 0.2643, 0.2382
Epoch 5/100, (Training, Validation) Trend Loss: 0.3118, 0.2283| Seasonal Loss: 0.3293, 0.4011| Residual Loss: 0.2263, 0.2150
Epoch 6/100, (Training, Validation) Trend Loss: 0.2307, 0.2109| Seasonal Loss: 0.1833, 0.1943| Residual Loss: 0.1801, 0.1914
Epoch 7/100, (Training, Validation) Trend Loss: 0.2324, 0.1880| Seasonal Loss: 0.1418, 0.1693| Residual Loss: 0.1562, 0.1728
Epoch 8/100, (Training, Validation) Trend Loss: 0.1208, 0.1025| Seasonal Loss: 0.1023, 0.1296| Residual Loss: 0.1328, 0.1576
Epoch 9/100, (Training, Validation) Trend Loss: 0.1179, 0.1145| Seasonal Loss: 0.0897, 0.1464| Residual Loss: 0.1222, 0.1480
Epoch 10/100, (Training, Validation) Trend Loss: 0.0815, 0.0817| Seasonal Loss: 0.0805, 0.1312| Residual Loss: 0.1122, 0.1362
Epoch 11/100, (Training, Validation) Trend Loss: 0.0614, 0.0672| Seasonal Loss: 0.0883, 0.1615| Residual Loss: 0.1134, 0.1534
Epoch 12/100, (Training, Validation) Trend Loss: 0.0620, 0.1063| Seasonal Loss: 0.0949, 0.2015| Residual Loss: 0.1149, 0.1478
Epoch 13/100, (Training, Validation) Trend Loss: 0.1051, 0.1410| Seasonal Loss: 0.1197, 0.2241| Residual Loss: 0.1259, 0.2071
Epoch 14/100, (Training, Validation) Trend Loss: 0.1460, 0.2076| Seasonal Loss: 0.1829, 0.2832| Residual Loss: 0.1421, 0.2320
Epoch 15/100, (Training, Validation) Trend Loss: 0.1357, 0.0928| Seasonal Loss: 0.2134, 0.1666| Residual Loss: 0.1556, 0.2497
Epoch 16/100, (Training, Validation) Trend Loss: 0.1838, 0.1282| Seasonal Loss: 0.1528, 0.1725| Residual Loss: 0.1480, 0.1738
Epoch 17/100, (Training, Validation) Trend Loss: 0.1800, 0.1044| Seasonal Loss: 0.0886, 0.1302| Residual Loss: 0.1282, 0.1379
Epoch 18/100, (Training, Validation) Trend Loss: 0.1157, 0.1186| Seasonal Loss: 0.0731, 0.1305| Residual Loss: 0.1085, 0.1292
Epoch 19/100, (Training, Validation) Trend Loss: 0.0836, 0.0733| Seasonal Loss: 0.0646, 0.1239| Residual Loss: 0.1043, 0.1264
Epoch 20/100, (Training, Validation) Trend Loss: 0.0776, 0.0825| Seasonal Loss: 0.0521, 0.1128| Residual Loss: 0.0966, 0.1215
Epoch 21/100, (Training, Validation) Trend Loss: 0.0594, 0.0790| Seasonal Loss: 0.0446, 0.1057| Residual Loss: 0.0917, 0.1194
Epoch 22/100, (Training, Validation) Trend Loss: 0.0507, 0.0553| Seasonal Loss: 0.0405, 0.1039| Residual Loss: 0.0851, 0.1168
Epoch 23/100, (Training, Validation) Trend Loss: 0.0469, 0.0488| Seasonal Loss: 0.0375, 0.1027| Residual Loss: 0.0817, 0.1162
Epoch 24/100, (Training, Validation) Trend Loss: 0.0403, 0.0460| Seasonal Loss: 0.0343, 0.1008| Residual Loss: 0.0777, 0.1145
Epoch 25/100, (Training, Validation) Trend Loss: 0.0356, 0.0360| Seasonal Loss: 0.0332, 0.1015| Residual Loss: 0.0757, 0.1141
Epoch 26/100, (Training, Validation) Trend Loss: 0.0334, 0.0335| Seasonal Loss: 0.0332, 0.0976| Residual Loss: 0.0731, 0.1132
Epoch 27/100, (Training, Validation) Trend Loss: 0.0305, 0.0298| Seasonal Loss: 0.0333, 0.0918| Residual Loss: 0.0718, 0.1127
Epoch 28/100, (Training, Validation) Trend Loss: 0.0287, 0.0259| Seasonal Loss: 0.0404, 0.0932| Residual Loss: 0.0699, 0.1122
Epoch 29/100, (Training, Validation) Trend Loss: 0.0271, 0.0255| Seasonal Loss: 0.0696, 0.0917| Residual Loss: 0.0689, 0.1116
Epoch 30/100, (Training, Validation) Trend Loss: 0.0256, 0.0238| Seasonal Loss: 0.0382, 0.0908| Residual Loss: 0.0673, 0.1113
Epoch 31/100, (Training, Validation) Trend Loss: 0.0243, 0.0225| Seasonal Loss: 0.0339, 0.0927| Residual Loss: 0.0664, 0.1108
Epoch 32/100, (Training, Validation) Trend Loss: 0.0233, 0.0216| Seasonal Loss: 0.0296, 0.0943| Residual Loss: 0.0651, 0.1105
Epoch 33/100, (Training, Validation) Trend Loss: 0.0221, 0.0206| Seasonal Loss: 0.0256, 0.0918| Residual Loss: 0.0642, 0.1101
Epoch 34/100, (Training, Validation) Trend Loss: 0.0215, 0.0200| Seasonal Loss: 0.0257, 0.0854| Residual Loss: 0.0629, 0.1098
Epoch 35/100, (Training, Validation) Trend Loss: 0.0205, 0.0197| Seasonal Loss: 0.0234, 0.0862| Residual Loss: 0.0619, 0.1096
Epoch 36/100, (Training, Validation) Trend Loss: 0.0202, 0.0188| Seasonal Loss: 0.0224, 0.0873| Residual Loss: 0.0606, 0.1093
Epoch 37/100, (Training, Validation) Trend Loss: 0.0194, 0.0188| Seasonal Loss: 0.0215, 0.0889| Residual Loss: 0.0596, 0.1091
Epoch 38/100, (Training, Validation) Trend Loss: 0.0197, 0.0180| Seasonal Loss: 0.0205, 0.0869| Residual Loss: 0.0584, 0.1089
Epoch 39/100, (Training, Validation) Trend Loss: 0.0192, 0.0184| Seasonal Loss: 0.0198, 0.0856| Residual Loss: 0.0575, 0.1088
Epoch 40/100, (Training, Validation) Trend Loss: 0.0202, 0.0179| Seasonal Loss: 0.0191, 0.0845| Residual Loss: 0.0565, 0.1086
Epoch 41/100, (Training, Validation) Trend Loss: 0.0202, 0.0182| Seasonal Loss: 0.0185, 0.0841| Residual Loss: 0.0557, 0.1085
Epoch 42/100, (Training, Validation) Trend Loss: 0.0210, 0.0182| Seasonal Loss: 0.0181, 0.0836| Residual Loss: 0.0549, 0.1084
Epoch 43/100, (Training, Validation) Trend Loss: 0.0203, 0.0171| Seasonal Loss: 0.0176, 0.0832| Residual Loss: 0.0542, 0.1084
Epoch 44/100, (Training, Validation) Trend Loss: 0.0192, 0.0178| Seasonal Loss: 0.0172, 0.0829| Residual Loss: 0.0536, 0.1083
Epoch 45/100, (Training, Validation) Trend Loss: 0.0172, 0.0164| Seasonal Loss: 0.0169, 0.0826| Residual Loss: 0.0530, 0.1082
Epoch 46/100, (Training, Validation) Trend Loss: 0.0162, 0.0167| Seasonal Loss: 0.0166, 0.0823| Residual Loss: 0.0524, 0.1082
Epoch 47/100, (Training, Validation) Trend Loss: 0.0157, 0.0163| Seasonal Loss: 0.0163, 0.0820| Residual Loss: 0.0519, 0.1081
Epoch 48/100, (Training, Validation) Trend Loss: 0.0153, 0.0158| Seasonal Loss: 0.0160, 0.0817| Residual Loss: 0.0514, 0.1081
Epoch 49/100, (Training, Validation) Trend Loss: 0.0153, 0.0156| Seasonal Loss: 0.0158, 0.0815| Residual Loss: 0.0509, 0.1081
Epoch 50/100, (Training, Validation) Trend Loss: 0.0149, 0.0153| Seasonal Loss: 0.0156, 0.0813| Residual Loss: 0.0504, 0.1080
Epoch 51/100, (Training, Validation) Trend Loss: 0.0147, 0.0151| Seasonal Loss: 0.0154, 0.0811| Residual Loss: 0.0500, 0.1080
Epoch 52/100, (Training, Validation) Trend Loss: 0.0145, 0.0149| Seasonal Loss: 0.0152, 0.0809| Residual Loss: 0.0496, 0.1080
Epoch 53/100, (Training, Validation) Trend Loss: 0.0143, 0.0148| Seasonal Loss: 0.0151, 0.0807| Residual Loss: 0.0492, 0.1080
Epoch 54/100, (Training, Validation) Trend Loss: 0.0142, 0.0147| Seasonal Loss: 0.0149, 0.0806| Residual Loss: 0.0489, 0.1080
Epoch 55/100, (Training, Validation) Trend Loss: 0.0140, 0.0146| Seasonal Loss: 0.0148, 0.0804| Residual Loss: 0.0486, 0.1080
Epoch 56/100, (Training, Validation) Trend Loss: 0.0139, 0.0145| Seasonal Loss: 0.0147, 0.0803| Residual Loss: 0.0482, 0.1080
Epoch 57/100, (Training, Validation) Trend Loss: 0.0137, 0.0144| Seasonal Loss: 0.0146, 0.0802| Residual Loss: 0.0479, 0.1080
Epoch 58/100, (Training, Validation) Trend Loss: 0.0136, 0.0143| Seasonal Loss: 0.0144, 0.0801| Residual Loss: 0.0476, 0.1080
Epoch 59/100, (Training, Validation) Trend Loss: 0.0135, 0.0143| Seasonal Loss: 0.0143, 0.0800| Residual Loss: 0.0474, 0.1080
Epoch 60/100, (Training, Validation) Trend Loss: 0.0134, 0.0142| Seasonal Loss: 0.0142, 0.0799| Residual Loss: 0.0471, 0.1080
Epoch 61/100, (Training, Validation) Trend Loss: 0.0133, 0.0141| Seasonal Loss: 0.0141, 0.0798| Residual Loss: 0.0469, 0.1080
Epoch 62/100, (Training, Validation) Trend Loss: 0.0132, 0.0141| Seasonal Loss: 0.0141, 0.0797| Residual Loss: 0.0466, 0.1080
Epoch 63/100, (Training, Validation) Trend Loss: 0.0131, 0.0140| Seasonal Loss: 0.0140, 0.0796| Residual Loss: 0.0464, 0.1080
Epoch 64/100, (Training, Validation) Trend Loss: 0.0130, 0.0139| Seasonal Loss: 0.0139, 0.0795| Residual Loss: 0.0462, 0.1080
Epoch 65/100, (Training, Validation) Trend Loss: 0.0129, 0.0139| Seasonal Loss: 0.0138, 0.0795| Residual Loss: 0.0460, 0.1080
Epoch 66/100, (Training, Validation) Trend Loss: 0.0129, 0.0138| Seasonal Loss: 0.0138, 0.0794| Residual Loss: 0.0458, 0.1080
Epoch 67/100, (Training, Validation) Trend Loss: 0.0128, 0.0138| Seasonal Loss: 0.0137, 0.0793| Residual Loss: 0.0456, 0.1081
Epoch 68/100, (Training, Validation) Trend Loss: 0.0127, 0.0138| Seasonal Loss: 0.0136, 0.0793| Residual Loss: 0.0455, 0.1081
Epoch 69/100, (Training, Validation) Trend Loss: 0.0127, 0.0137| Seasonal Loss: 0.0136, 0.0792| Residual Loss: 0.0453, 0.1081
Epoch 70/100, (Training, Validation) Trend Loss: 0.0126, 0.0137| Seasonal Loss: 0.0135, 0.0792| Residual Loss: 0.0451, 0.1081
Epoch 71/100, (Training, Validation) Trend Loss: 0.0126, 0.0136| Seasonal Loss: 0.0135, 0.0791| Residual Loss: 0.0450, 0.1081
Epoch 72/100, (Training, Validation) Trend Loss: 0.0125, 0.0136| Seasonal Loss: 0.0134, 0.0791| Residual Loss: 0.0449, 0.1081
Epoch 73/100, (Training, Validation) Trend Loss: 0.0125, 0.0136| Seasonal Loss: 0.0134, 0.0790| Residual Loss: 0.0447, 0.1081
Epoch 74/100, (Training, Validation) Trend Loss: 0.0124, 0.0135| Seasonal Loss: 0.0133, 0.0790| Residual Loss: 0.0446, 0.1081
Epoch 75/100, (Training, Validation) Trend Loss: 0.0124, 0.0135| Seasonal Loss: 0.0133, 0.0790| Residual Loss: 0.0445, 0.1081
Epoch 76/100, (Training, Validation) Trend Loss: 0.0123, 0.0135| Seasonal Loss: 0.0133, 0.0789| Residual Loss: 0.0444, 0.1081
Epoch 77/100, (Training, Validation) Trend Loss: 0.0123, 0.0135| Seasonal Loss: 0.0132, 0.0789| Residual Loss: 0.0443, 0.1081
Epoch 78/100, (Training, Validation) Trend Loss: 0.0123, 0.0134| Seasonal Loss: 0.0132, 0.0789| Residual Loss: 0.0442, 0.1082
Epoch 79/100, (Training, Validation) Trend Loss: 0.0122, 0.0134| Seasonal Loss: 0.0132, 0.0788| Residual Loss: 0.0441, 0.1082
Epoch 80/100, (Training, Validation) Trend Loss: 0.0122, 0.0134| Seasonal Loss: 0.0131, 0.0788| Residual Loss: 0.0440, 0.1082
Epoch 81/100, (Training, Validation) Trend Loss: 0.0122, 0.0134| Seasonal Loss: 0.0131, 0.0788| Residual Loss: 0.0439, 0.1082
Epoch 82/100, (Training, Validation) Trend Loss: 0.0121, 0.0133| Seasonal Loss: 0.0131, 0.0787| Residual Loss: 0.0438, 0.1082
Epoch 83/100, (Training, Validation) Trend Loss: 0.0121, 0.0133| Seasonal Loss: 0.0130, 0.0787| Residual Loss: 0.0437, 0.1082
Epoch 84/100, (Training, Validation) Trend Loss: 0.0121, 0.0133| Seasonal Loss: 0.0130, 0.0787| Residual Loss: 0.0436, 0.1082
Epoch 85/100, (Training, Validation) Trend Loss: 0.0121, 0.0133| Seasonal Loss: 0.0130, 0.0787| Residual Loss: 0.0436, 0.1082
Epoch 86/100, (Training, Validation) Trend Loss: 0.0120, 0.0133| Seasonal Loss: 0.0130, 0.0787| Residual Loss: 0.0435, 0.1082
Epoch 87/100, (Training, Validation) Trend Loss: 0.0120, 0.0132| Seasonal Loss: 0.0129, 0.0786| Residual Loss: 0.0434, 0.1082
Epoch 88/100, (Training, Validation) Trend Loss: 0.0120, 0.0132| Seasonal Loss: 0.0129, 0.0786| Residual Loss: 0.0434, 0.1082
Epoch 89/100, (Training, Validation) Trend Loss: 0.0120, 0.0132| Seasonal Loss: 0.0129, 0.0786| Residual Loss: 0.0433, 0.1082
Epoch 90/100, (Training, Validation) Trend Loss: 0.0119, 0.0132| Seasonal Loss: 0.0129, 0.0786| Residual Loss: 0.0433, 0.1082
Epoch 91/100, (Training, Validation) Trend Loss: 0.0119, 0.0132| Seasonal Loss: 0.0129, 0.0786| Residual Loss: 0.0432, 0.1082
Epoch 92/100, (Training, Validation) Trend Loss: 0.0119, 0.0132| Seasonal Loss: 0.0128, 0.0785| Residual Loss: 0.0432, 0.1082
Epoch 93/100, (Training, Validation) Trend Loss: 0.0119, 0.0132| Seasonal Loss: 0.0128, 0.0785| Residual Loss: 0.0431, 0.1082
Epoch 94/100, (Training, Validation) Trend Loss: 0.0119, 0.0131| Seasonal Loss: 0.0128, 0.0785| Residual Loss: 0.0431, 0.1082
Epoch 95/100, (Training, Validation) Trend Loss: 0.0119, 0.0131| Seasonal Loss: 0.0128, 0.0785| Residual Loss: 0.0430, 0.1083
Epoch 96/100, (Training, Validation) Trend Loss: 0.0118, 0.0131| Seasonal Loss: 0.0128, 0.0785| Residual Loss: 0.0430, 0.1083
Epoch 97/100, (Training, Validation) Trend Loss: 0.0118, 0.0131| Seasonal Loss: 0.0128, 0.0785| Residual Loss: 0.0429, 0.1083
Epoch 98/100, (Training, Validation) Trend Loss: 0.0118, 0.0131| Seasonal Loss: 0.0127, 0.0785| Residual Loss: 0.0429, 0.1083
Epoch 99/100, (Training, Validation) Trend Loss: 0.0118, 0.0131| Seasonal Loss: 0.0127, 0.0785| Residual Loss: 0.0429, 0.1083
Epoch 100/100, (Training, Validation) Trend Loss: 0.0118, 0.0131| Seasonal Loss: 0.0127, 0.0784| Residual Loss: 0.0428, 0.1083
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[167.1296422]
[-0.89521068]
[-0.80095337]
[165.43347815]
actual_stock_price: [171.57913208 173.9239502  174.03323364 173.07940674 170.45640564
 170.73460388 171.87721252 174.30151367 176.15948486 176.10980225]
add_predicted_stock_price: [171.57913208 173.9239502  174.03323364 173.07940674 170.45640564
 170.73460388 171.87721252 174.30151367 176.15948486 165.43347815]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
