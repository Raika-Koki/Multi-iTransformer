[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.2993, 0.1883| Seasonal Loss: 0.4250, 0.2449| Residual Loss: 0.5010, 0.2927
Epoch 2/100, (Training, Validation) Trend Loss: 0.1309, 0.1368| Seasonal Loss: 0.2343, 0.2454| Residual Loss: 0.2485, 0.2234
Epoch 3/100, (Training, Validation) Trend Loss: 0.1611, 0.1189| Seasonal Loss: 0.1972, 0.1780| Residual Loss: 0.2046, 0.1909
Epoch 4/100, (Training, Validation) Trend Loss: 0.1081, 0.0782| Seasonal Loss: 0.1681, 0.1429| Residual Loss: 0.1701, 0.1579
Epoch 5/100, (Training, Validation) Trend Loss: 0.0939, 0.1403| Seasonal Loss: 0.1559, 0.1409| Residual Loss: 0.1449, 0.1397
Epoch 6/100, (Training, Validation) Trend Loss: 0.0760, 0.0925| Seasonal Loss: 0.1398, 0.1233| Residual Loss: 0.1346, 0.1319
Epoch 7/100, (Training, Validation) Trend Loss: 0.0819, 0.0621| Seasonal Loss: 0.1098, 0.1006| Residual Loss: 0.1308, 0.1314
Epoch 8/100, (Training, Validation) Trend Loss: 0.0510, 0.0457| Seasonal Loss: 0.0981, 0.1034| Residual Loss: 0.1353, 0.1273
Epoch 9/100, (Training, Validation) Trend Loss: 0.0507, 0.0819| Seasonal Loss: 0.0889, 0.1001| Residual Loss: 0.1468, 0.1245
Epoch 10/100, (Training, Validation) Trend Loss: 0.0414, 0.0488| Seasonal Loss: 0.1055, 0.1296| Residual Loss: 0.1208, 0.1097
Epoch 11/100, (Training, Validation) Trend Loss: 0.0518, 0.0536| Seasonal Loss: 0.1284, 0.1471| Residual Loss: 0.1341, 0.1124
Epoch 12/100, (Training, Validation) Trend Loss: 0.0375, 0.0388| Seasonal Loss: 0.0841, 0.0955| Residual Loss: 0.1188, 0.1152
Epoch 13/100, (Training, Validation) Trend Loss: 0.0306, 0.0439| Seasonal Loss: 0.0828, 0.0951| Residual Loss: 0.1169, 0.1061
Epoch 14/100, (Training, Validation) Trend Loss: 0.0325, 0.0431| Seasonal Loss: 0.0708, 0.1013| Residual Loss: 0.1146, 0.1080
Epoch 15/100, (Training, Validation) Trend Loss: 0.0584, 0.0768| Seasonal Loss: 0.0636, 0.1059| Residual Loss: 0.1062, 0.1055
Epoch 16/100, (Training, Validation) Trend Loss: 0.0371, 0.0303| Seasonal Loss: 0.0773, 0.0906| Residual Loss: 0.1021, 0.0943
Epoch 17/100, (Training, Validation) Trend Loss: 0.0652, 0.1408| Seasonal Loss: 0.0634, 0.1004| Residual Loss: 0.0978, 0.0972
Epoch 18/100, (Training, Validation) Trend Loss: 0.1020, 0.0466| Seasonal Loss: 0.0590, 0.1050| Residual Loss: 0.0962, 0.0993
Epoch 19/100, (Training, Validation) Trend Loss: 0.0549, 0.1389| Seasonal Loss: 0.0692, 0.0886| Residual Loss: 0.0915, 0.0877
Epoch 20/100, (Training, Validation) Trend Loss: 0.0748, 0.0875| Seasonal Loss: 0.0556, 0.0848| Residual Loss: 0.0886, 0.0893
Epoch 21/100, (Training, Validation) Trend Loss: 0.0732, 0.1452| Seasonal Loss: 0.0456, 0.0855| Residual Loss: 0.0862, 0.0903
Epoch 22/100, (Training, Validation) Trend Loss: 0.0644, 0.0528| Seasonal Loss: 0.0480, 0.0837| Residual Loss: 0.0844, 0.0849
Epoch 23/100, (Training, Validation) Trend Loss: 0.0487, 0.0820| Seasonal Loss: 0.0444, 0.0764| Residual Loss: 0.0821, 0.0851
Epoch 24/100, (Training, Validation) Trend Loss: 0.0352, 0.0337| Seasonal Loss: 0.0401, 0.0777| Residual Loss: 0.0807, 0.0854
Epoch 25/100, (Training, Validation) Trend Loss: 0.0323, 0.0530| Seasonal Loss: 0.0389, 0.0751| Residual Loss: 0.0795, 0.0836
Epoch 26/100, (Training, Validation) Trend Loss: 0.0254, 0.0283| Seasonal Loss: 0.0371, 0.0736| Residual Loss: 0.0780, 0.0829
Epoch 27/100, (Training, Validation) Trend Loss: 0.0252, 0.0418| Seasonal Loss: 0.0361, 0.0750| Residual Loss: 0.0768, 0.0832
Epoch 28/100, (Training, Validation) Trend Loss: 0.0221, 0.0257| Seasonal Loss: 0.0359, 0.0730| Residual Loss: 0.0758, 0.0824
Epoch 29/100, (Training, Validation) Trend Loss: 0.0220, 0.0356| Seasonal Loss: 0.0344, 0.0728| Residual Loss: 0.0747, 0.0818
Epoch 30/100, (Training, Validation) Trend Loss: 0.0203, 0.0243| Seasonal Loss: 0.0335, 0.0730| Residual Loss: 0.0736, 0.0819
Epoch 31/100, (Training, Validation) Trend Loss: 0.0201, 0.0316| Seasonal Loss: 0.0332, 0.0718| Residual Loss: 0.0727, 0.0816
Epoch 32/100, (Training, Validation) Trend Loss: 0.0190, 0.0233| Seasonal Loss: 0.0322, 0.0722| Residual Loss: 0.0719, 0.0811
Epoch 33/100, (Training, Validation) Trend Loss: 0.0188, 0.0288| Seasonal Loss: 0.0317, 0.0718| Residual Loss: 0.0710, 0.0812
Epoch 34/100, (Training, Validation) Trend Loss: 0.0181, 0.0226| Seasonal Loss: 0.0311, 0.0713| Residual Loss: 0.0702, 0.0811
Epoch 35/100, (Training, Validation) Trend Loss: 0.0178, 0.0267| Seasonal Loss: 0.0306, 0.0716| Residual Loss: 0.0695, 0.0807
Epoch 36/100, (Training, Validation) Trend Loss: 0.0173, 0.0221| Seasonal Loss: 0.0302, 0.0709| Residual Loss: 0.0688, 0.0807
Epoch 37/100, (Training, Validation) Trend Loss: 0.0169, 0.0250| Seasonal Loss: 0.0296, 0.0713| Residual Loss: 0.0682, 0.0807
Epoch 38/100, (Training, Validation) Trend Loss: 0.0167, 0.0217| Seasonal Loss: 0.0293, 0.0707| Residual Loss: 0.0675, 0.0804
Epoch 39/100, (Training, Validation) Trend Loss: 0.0163, 0.0236| Seasonal Loss: 0.0288, 0.0710| Residual Loss: 0.0669, 0.0806
Epoch 40/100, (Training, Validation) Trend Loss: 0.0163, 0.0216| Seasonal Loss: 0.0286, 0.0705| Residual Loss: 0.0664, 0.0805
Epoch 41/100, (Training, Validation) Trend Loss: 0.0157, 0.0225| Seasonal Loss: 0.0281, 0.0708| Residual Loss: 0.0658, 0.0804
Epoch 42/100, (Training, Validation) Trend Loss: 0.0161, 0.0215| Seasonal Loss: 0.0280, 0.0704| Residual Loss: 0.0653, 0.0805
Epoch 43/100, (Training, Validation) Trend Loss: 0.0154, 0.0216| Seasonal Loss: 0.0275, 0.0707| Residual Loss: 0.0648, 0.0804
Epoch 44/100, (Training, Validation) Trend Loss: 0.0160, 0.0216| Seasonal Loss: 0.0275, 0.0705| Residual Loss: 0.0644, 0.0805
Epoch 45/100, (Training, Validation) Trend Loss: 0.0152, 0.0212| Seasonal Loss: 0.0271, 0.0709| Residual Loss: 0.0640, 0.0804
Epoch 46/100, (Training, Validation) Trend Loss: 0.0163, 0.0217| Seasonal Loss: 0.0273, 0.0713| Residual Loss: 0.0636, 0.0805
Epoch 47/100, (Training, Validation) Trend Loss: 0.0155, 0.0214| Seasonal Loss: 0.0270, 0.0720| Residual Loss: 0.0632, 0.0804
Epoch 48/100, (Training, Validation) Trend Loss: 0.0175, 0.0221| Seasonal Loss: 0.0276, 0.0741| Residual Loss: 0.0628, 0.0805
Epoch 49/100, (Training, Validation) Trend Loss: 0.0168, 0.0222| Seasonal Loss: 0.0276, 0.0753| Residual Loss: 0.0625, 0.0805
Epoch 50/100, (Training, Validation) Trend Loss: 0.0203, 0.0230| Seasonal Loss: 0.0288, 0.0801| Residual Loss: 0.0621, 0.0805
Epoch 51/100, (Training, Validation) Trend Loss: 0.0200, 0.0229| Seasonal Loss: 0.0292, 0.0798| Residual Loss: 0.0618, 0.0807
Epoch 52/100, (Training, Validation) Trend Loss: 0.0245, 0.0233| Seasonal Loss: 0.0300, 0.0840| Residual Loss: 0.0615, 0.0804
Epoch 53/100, (Training, Validation) Trend Loss: 0.0226, 0.0216| Seasonal Loss: 0.0300, 0.0778| Residual Loss: 0.0613, 0.0810
Epoch 54/100, (Training, Validation) Trend Loss: 0.0240, 0.0219| Seasonal Loss: 0.0295, 0.0783| Residual Loss: 0.0609, 0.0803
Epoch 55/100, (Training, Validation) Trend Loss: 0.0193, 0.0202| Seasonal Loss: 0.0304, 0.0711| Residual Loss: 0.0610, 0.0819
Epoch 56/100, (Training, Validation) Trend Loss: 0.0180, 0.0205| Seasonal Loss: 0.0313, 0.0729| Residual Loss: 0.0606, 0.0800
Epoch 57/100, (Training, Validation) Trend Loss: 0.0153, 0.0199| Seasonal Loss: 0.0351, 0.0696| Residual Loss: 0.0611, 0.0837
Epoch 58/100, (Training, Validation) Trend Loss: 0.0148, 0.0199| Seasonal Loss: 0.0337, 0.0719| Residual Loss: 0.0611, 0.0797
Epoch 59/100, (Training, Validation) Trend Loss: 0.0141, 0.0197| Seasonal Loss: 0.0324, 0.0708| Residual Loss: 0.0630, 0.0862
Epoch 60/100, (Training, Validation) Trend Loss: 0.0140, 0.0196| Seasonal Loss: 0.0278, 0.0710| Residual Loss: 0.0659, 0.0795
Epoch 61/100, (Training, Validation) Trend Loss: 0.0138, 0.0194| Seasonal Loss: 0.0261, 0.0709| Residual Loss: 0.0705, 0.0861
Epoch 62/100, (Training, Validation) Trend Loss: 0.0138, 0.0193| Seasonal Loss: 0.0249, 0.0708| Residual Loss: 0.0755, 0.0801
Epoch 63/100, (Training, Validation) Trend Loss: 0.0137, 0.0191| Seasonal Loss: 0.0247, 0.0708| Residual Loss: 0.0694, 0.0822
Epoch 64/100, (Training, Validation) Trend Loss: 0.0136, 0.0190| Seasonal Loss: 0.0245, 0.0707| Residual Loss: 0.0648, 0.0811
Epoch 65/100, (Training, Validation) Trend Loss: 0.0136, 0.0189| Seasonal Loss: 0.0244, 0.0707| Residual Loss: 0.0606, 0.0810
Epoch 66/100, (Training, Validation) Trend Loss: 0.0135, 0.0188| Seasonal Loss: 0.0243, 0.0707| Residual Loss: 0.0594, 0.0815
Epoch 67/100, (Training, Validation) Trend Loss: 0.0135, 0.0187| Seasonal Loss: 0.0242, 0.0707| Residual Loss: 0.0589, 0.0810
Epoch 68/100, (Training, Validation) Trend Loss: 0.0134, 0.0186| Seasonal Loss: 0.0241, 0.0706| Residual Loss: 0.0587, 0.0814
Epoch 69/100, (Training, Validation) Trend Loss: 0.0134, 0.0186| Seasonal Loss: 0.0241, 0.0706| Residual Loss: 0.0585, 0.0812
Epoch 70/100, (Training, Validation) Trend Loss: 0.0134, 0.0185| Seasonal Loss: 0.0240, 0.0706| Residual Loss: 0.0584, 0.0813
Epoch 71/100, (Training, Validation) Trend Loss: 0.0133, 0.0184| Seasonal Loss: 0.0239, 0.0706| Residual Loss: 0.0583, 0.0812
Epoch 72/100, (Training, Validation) Trend Loss: 0.0133, 0.0184| Seasonal Loss: 0.0239, 0.0705| Residual Loss: 0.0582, 0.0813
Epoch 73/100, (Training, Validation) Trend Loss: 0.0133, 0.0183| Seasonal Loss: 0.0238, 0.0705| Residual Loss: 0.0581, 0.0813
Epoch 74/100, (Training, Validation) Trend Loss: 0.0132, 0.0182| Seasonal Loss: 0.0238, 0.0705| Residual Loss: 0.0580, 0.0813
Epoch 75/100, (Training, Validation) Trend Loss: 0.0132, 0.0182| Seasonal Loss: 0.0237, 0.0705| Residual Loss: 0.0579, 0.0813
Epoch 76/100, (Training, Validation) Trend Loss: 0.0132, 0.0181| Seasonal Loss: 0.0237, 0.0705| Residual Loss: 0.0578, 0.0813
Epoch 77/100, (Training, Validation) Trend Loss: 0.0131, 0.0181| Seasonal Loss: 0.0236, 0.0704| Residual Loss: 0.0577, 0.0813
Epoch 78/100, (Training, Validation) Trend Loss: 0.0131, 0.0180| Seasonal Loss: 0.0236, 0.0704| Residual Loss: 0.0576, 0.0813
Epoch 79/100, (Training, Validation) Trend Loss: 0.0131, 0.0180| Seasonal Loss: 0.0235, 0.0704| Residual Loss: 0.0576, 0.0813
Epoch 80/100, (Training, Validation) Trend Loss: 0.0131, 0.0180| Seasonal Loss: 0.0235, 0.0704| Residual Loss: 0.0575, 0.0813
Epoch 81/100, (Training, Validation) Trend Loss: 0.0131, 0.0179| Seasonal Loss: 0.0234, 0.0704| Residual Loss: 0.0574, 0.0813
Epoch 82/100, (Training, Validation) Trend Loss: 0.0130, 0.0179| Seasonal Loss: 0.0234, 0.0704| Residual Loss: 0.0574, 0.0813
Epoch 83/100, (Training, Validation) Trend Loss: 0.0130, 0.0179| Seasonal Loss: 0.0234, 0.0704| Residual Loss: 0.0573, 0.0813
Epoch 84/100, (Training, Validation) Trend Loss: 0.0130, 0.0178| Seasonal Loss: 0.0233, 0.0703| Residual Loss: 0.0573, 0.0814
Epoch 85/100, (Training, Validation) Trend Loss: 0.0130, 0.0178| Seasonal Loss: 0.0233, 0.0703| Residual Loss: 0.0572, 0.0814
Epoch 86/100, (Training, Validation) Trend Loss: 0.0130, 0.0178| Seasonal Loss: 0.0233, 0.0703| Residual Loss: 0.0571, 0.0814
Epoch 87/100, (Training, Validation) Trend Loss: 0.0129, 0.0177| Seasonal Loss: 0.0232, 0.0703| Residual Loss: 0.0571, 0.0814
Epoch 88/100, (Training, Validation) Trend Loss: 0.0129, 0.0177| Seasonal Loss: 0.0232, 0.0703| Residual Loss: 0.0571, 0.0814
Epoch 89/100, (Training, Validation) Trend Loss: 0.0129, 0.0177| Seasonal Loss: 0.0232, 0.0703| Residual Loss: 0.0570, 0.0814
Epoch 90/100, (Training, Validation) Trend Loss: 0.0129, 0.0177| Seasonal Loss: 0.0232, 0.0703| Residual Loss: 0.0570, 0.0814
Epoch 91/100, (Training, Validation) Trend Loss: 0.0129, 0.0176| Seasonal Loss: 0.0231, 0.0703| Residual Loss: 0.0569, 0.0814
Epoch 92/100, (Training, Validation) Trend Loss: 0.0129, 0.0176| Seasonal Loss: 0.0231, 0.0703| Residual Loss: 0.0569, 0.0814
Epoch 93/100, (Training, Validation) Trend Loss: 0.0129, 0.0176| Seasonal Loss: 0.0231, 0.0703| Residual Loss: 0.0568, 0.0814
Epoch 94/100, (Training, Validation) Trend Loss: 0.0128, 0.0176| Seasonal Loss: 0.0231, 0.0703| Residual Loss: 0.0568, 0.0814
Epoch 95/100, (Training, Validation) Trend Loss: 0.0128, 0.0176| Seasonal Loss: 0.0231, 0.0703| Residual Loss: 0.0568, 0.0814
Epoch 96/100, (Training, Validation) Trend Loss: 0.0128, 0.0175| Seasonal Loss: 0.0230, 0.0703| Residual Loss: 0.0567, 0.0814
Epoch 97/100, (Training, Validation) Trend Loss: 0.0128, 0.0175| Seasonal Loss: 0.0230, 0.0703| Residual Loss: 0.0567, 0.0814
Epoch 98/100, (Training, Validation) Trend Loss: 0.0128, 0.0175| Seasonal Loss: 0.0230, 0.0702| Residual Loss: 0.0567, 0.0814
Epoch 99/100, (Training, Validation) Trend Loss: 0.0128, 0.0175| Seasonal Loss: 0.0230, 0.0702| Residual Loss: 0.0567, 0.0814
Epoch 100/100, (Training, Validation) Trend Loss: 0.0128, 0.0175| Seasonal Loss: 0.0230, 0.0702| Residual Loss: 0.0566, 0.0814
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:189: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:190: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[168.6668636]
[-1.18216214]
[-0.96105081]
[166.52365065]
stock_trend: Date
2019-12-31     78.597282
2020-01-02     78.442351
2020-01-03     78.286219
2020-01-06     78.128790
2020-01-07     77.969972
                 ...
2023-05-24    173.117856
2023-05-25    173.456806
2023-05-26    173.795653
2023-05-30    174.134458
2023-05-31    174.473272
Name: trend, Length: 860, dtype: float64
actual_stock_price: [171.57913208 173.92396545 174.03323364 173.079422   170.45640564
 170.73460388 171.87721252 174.30148315 176.1594696  176.10978699]
add_predicted_stock_price: [171.57913208 173.92396545 174.03323364 173.079422   170.45640564
 170.73460388 171.87721252 174.30148315 176.1594696  166.52365065]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:237: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
