[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.111243, 0.630045| Seasonal Loss: 0.2584, 0.2910| Residual Loss: 0.2640, 1.0661
Epoch 2/100, (Training, Validation) Trend Loss: 0.079475, 0.344916| Seasonal Loss: 0.1168, 0.2422| Residual Loss: 0.1646, 0.7838
Epoch 3/100, (Training, Validation) Trend Loss: 0.097198, 0.216513| Seasonal Loss: 0.0924, 0.2452| Residual Loss: 0.1359, 0.6772
Epoch 4/100, (Training, Validation) Trend Loss: 0.079454, 0.191896| Seasonal Loss: 0.0798, 0.2422| Residual Loss: 0.1184, 0.6018
Epoch 5/100, (Training, Validation) Trend Loss: 0.077211, 0.122157| Seasonal Loss: 0.0718, 0.2344| Residual Loss: 0.1043, 0.5489
Epoch 6/100, (Training, Validation) Trend Loss: 0.067313, 0.127947| Seasonal Loss: 0.0656, 0.2164| Residual Loss: 0.0927, 0.5080
Epoch 7/100, (Training, Validation) Trend Loss: 0.044016, 0.071173| Seasonal Loss: 0.0627, 0.1939| Residual Loss: 0.0834, 0.4752
Epoch 8/100, (Training, Validation) Trend Loss: 0.032378, 0.061877| Seasonal Loss: 0.0660, 0.1824| Residual Loss: 0.0761, 0.4485
Epoch 9/100, (Training, Validation) Trend Loss: 0.025461, 0.034692| Seasonal Loss: 0.0674, 0.1728| Residual Loss: 0.0704, 0.4268
Epoch 10/100, (Training, Validation) Trend Loss: 0.022596, 0.053516| Seasonal Loss: 0.0629, 0.1669| Residual Loss: 0.0660, 0.4091
Epoch 11/100, (Training, Validation) Trend Loss: 0.018934, 0.076416| Seasonal Loss: 0.0590, 0.1656| Residual Loss: 0.0625, 0.3946
Epoch 12/100, (Training, Validation) Trend Loss: 0.018103, 0.109220| Seasonal Loss: 0.0549, 0.1656| Residual Loss: 0.0597, 0.3827
Epoch 13/100, (Training, Validation) Trend Loss: 0.020351, 0.156274| Seasonal Loss: 0.0511, 0.1640| Residual Loss: 0.0574, 0.3728
Epoch 14/100, (Training, Validation) Trend Loss: 0.028104, 0.187206| Seasonal Loss: 0.0477, 0.1629| Residual Loss: 0.0555, 0.3643
Epoch 15/100, (Training, Validation) Trend Loss: 0.052886, 0.067011| Seasonal Loss: 0.0448, 0.1613| Residual Loss: 0.0539, 0.3571
Epoch 16/100, (Training, Validation) Trend Loss: 0.058390, 0.028026| Seasonal Loss: 0.0423, 0.1598| Residual Loss: 0.0525, 0.3508
Epoch 17/100, (Training, Validation) Trend Loss: 0.025466, 0.030393| Seasonal Loss: 0.0402, 0.1583| Residual Loss: 0.0512, 0.3452
Epoch 18/100, (Training, Validation) Trend Loss: 0.012577, 0.019319| Seasonal Loss: 0.0383, 0.1568| Residual Loss: 0.0501, 0.3403
Epoch 19/100, (Training, Validation) Trend Loss: 0.009454, 0.014775| Seasonal Loss: 0.0367, 0.1556| Residual Loss: 0.0491, 0.3359
Epoch 20/100, (Training, Validation) Trend Loss: 0.007803, 0.013598| Seasonal Loss: 0.0353, 0.1546| Residual Loss: 0.0482, 0.3319
Epoch 21/100, (Training, Validation) Trend Loss: 0.006697, 0.013469| Seasonal Loss: 0.0342, 0.1540| Residual Loss: 0.0474, 0.3282
Epoch 22/100, (Training, Validation) Trend Loss: 0.005916, 0.013476| Seasonal Loss: 0.0332, 0.1539| Residual Loss: 0.0467, 0.3249
Epoch 23/100, (Training, Validation) Trend Loss: 0.005311, 0.013148| Seasonal Loss: 0.0324, 0.1542| Residual Loss: 0.0460, 0.3218
Epoch 24/100, (Training, Validation) Trend Loss: 0.004802, 0.012351| Seasonal Loss: 0.0317, 0.1537| Residual Loss: 0.0453, 0.3189
Epoch 25/100, (Training, Validation) Trend Loss: 0.004342, 0.011241| Seasonal Loss: 0.0306, 0.1507| Residual Loss: 0.0448, 0.3163
Epoch 26/100, (Training, Validation) Trend Loss: 0.003900, 0.010021| Seasonal Loss: 0.0289, 0.1447| Residual Loss: 0.0442, 0.3138
Epoch 27/100, (Training, Validation) Trend Loss: 0.003478, 0.008876| Seasonal Loss: 0.0269, 0.1394| Residual Loss: 0.0437, 0.3115
Epoch 28/100, (Training, Validation) Trend Loss: 0.003095, 0.007904| Seasonal Loss: 0.0258, 0.1389| Residual Loss: 0.0432, 0.3094
Epoch 29/100, (Training, Validation) Trend Loss: 0.002776, 0.007112| Seasonal Loss: 0.0252, 0.1389| Residual Loss: 0.0427, 0.3074
Epoch 30/100, (Training, Validation) Trend Loss: 0.002527, 0.006480| Seasonal Loss: 0.0234, 0.1378| Residual Loss: 0.0423, 0.3055
Epoch 31/100, (Training, Validation) Trend Loss: 0.002343, 0.005983| Seasonal Loss: 0.0225, 0.1386| Residual Loss: 0.0419, 0.3038
Epoch 32/100, (Training, Validation) Trend Loss: 0.002209, 0.005595| Seasonal Loss: 0.0220, 0.1405| Residual Loss: 0.0415, 0.3021
Epoch 33/100, (Training, Validation) Trend Loss: 0.002108, 0.005292| Seasonal Loss: 0.0216, 0.1435| Residual Loss: 0.0412, 0.3006
Epoch 34/100, (Training, Validation) Trend Loss: 0.002029, 0.005050| Seasonal Loss: 0.0212, 0.1490| Residual Loss: 0.0408, 0.2991
Epoch 35/100, (Training, Validation) Trend Loss: 0.001966, 0.004855| Seasonal Loss: 0.0210, 0.1610| Residual Loss: 0.0405, 0.2977
Epoch 36/100, (Training, Validation) Trend Loss: 0.001913, 0.004695| Seasonal Loss: 0.0210, 0.1866| Residual Loss: 0.0402, 0.2964
Epoch 37/100, (Training, Validation) Trend Loss: 0.001868, 0.004564| Seasonal Loss: 0.0213, 0.2339| Residual Loss: 0.0399, 0.2952
Epoch 38/100, (Training, Validation) Trend Loss: 0.001828, 0.004459| Seasonal Loss: 0.0222, 0.3057| Residual Loss: 0.0397, 0.2940
Epoch 39/100, (Training, Validation) Trend Loss: 0.001793, 0.004378| Seasonal Loss: 0.0243, 0.3773| Residual Loss: 0.0394, 0.2929
Epoch 40/100, (Training, Validation) Trend Loss: 0.001762, 0.004319| Seasonal Loss: 0.0298, 0.3382| Residual Loss: 0.0392, 0.2918
Epoch 41/100, (Training, Validation) Trend Loss: 0.001735, 0.004282| Seasonal Loss: 0.0443, 0.1538| Residual Loss: 0.0389, 0.2909
Epoch 42/100, (Training, Validation) Trend Loss: 0.001711, 0.004265| Seasonal Loss: 0.0469, 0.1606| Residual Loss: 0.0387, 0.2899
Epoch 43/100, (Training, Validation) Trend Loss: 0.001691, 0.004267| Seasonal Loss: 0.0242, 0.1323| Residual Loss: 0.0385, 0.2890
Epoch 44/100, (Training, Validation) Trend Loss: 0.001674, 0.004284| Seasonal Loss: 0.0213, 0.1317| Residual Loss: 0.0383, 0.2882
Epoch 45/100, (Training, Validation) Trend Loss: 0.001661, 0.004312| Seasonal Loss: 0.0191, 0.1226| Residual Loss: 0.0381, 0.2874
Epoch 46/100, (Training, Validation) Trend Loss: 0.001651, 0.004342| Seasonal Loss: 0.0184, 0.1226| Residual Loss: 0.0380, 0.2866
Epoch 47/100, (Training, Validation) Trend Loss: 0.001644, 0.004362| Seasonal Loss: 0.0178, 0.1196| Residual Loss: 0.0378, 0.2859
Epoch 48/100, (Training, Validation) Trend Loss: 0.001640, 0.004356| Seasonal Loss: 0.0176, 0.1189| Residual Loss: 0.0376, 0.2852
Epoch 49/100, (Training, Validation) Trend Loss: 0.001639, 0.004305| Seasonal Loss: 0.0174, 0.1174| Residual Loss: 0.0375, 0.2846
Epoch 50/100, (Training, Validation) Trend Loss: 0.001638, 0.004194| Seasonal Loss: 0.0172, 0.1166| Residual Loss: 0.0373, 0.2840
Epoch 51/100, (Training, Validation) Trend Loss: 0.001636, 0.004016| Seasonal Loss: 0.0170, 0.1156| Residual Loss: 0.0372, 0.2834
Epoch 52/100, (Training, Validation) Trend Loss: 0.001629, 0.003779| Seasonal Loss: 0.0169, 0.1148| Residual Loss: 0.0371, 0.2828
Epoch 53/100, (Training, Validation) Trend Loss: 0.001616, 0.003512| Seasonal Loss: 0.0167, 0.1141| Residual Loss: 0.0370, 0.2823
Epoch 54/100, (Training, Validation) Trend Loss: 0.001595, 0.003250| Seasonal Loss: 0.0166, 0.1134| Residual Loss: 0.0368, 0.2818
Epoch 55/100, (Training, Validation) Trend Loss: 0.001570, 0.003023| Seasonal Loss: 0.0164, 0.1127| Residual Loss: 0.0367, 0.2813
Epoch 56/100, (Training, Validation) Trend Loss: 0.001545, 0.002846| Seasonal Loss: 0.0162, 0.1121| Residual Loss: 0.0366, 0.2809
Epoch 57/100, (Training, Validation) Trend Loss: 0.001523, 0.002722| Seasonal Loss: 0.0161, 0.1115| Residual Loss: 0.0365, 0.2804
Epoch 58/100, (Training, Validation) Trend Loss: 0.001506, 0.002643| Seasonal Loss: 0.0159, 0.1109| Residual Loss: 0.0364, 0.2800
Epoch 59/100, (Training, Validation) Trend Loss: 0.001495, 0.002598| Seasonal Loss: 0.0157, 0.1103| Residual Loss: 0.0363, 0.2796
Epoch 60/100, (Training, Validation) Trend Loss: 0.001488, 0.002577| Seasonal Loss: 0.0156, 0.1097| Residual Loss: 0.0363, 0.2793
Epoch 61/100, (Training, Validation) Trend Loss: 0.001484, 0.002573| Seasonal Loss: 0.0154, 0.1091| Residual Loss: 0.0362, 0.2789
Epoch 62/100, (Training, Validation) Trend Loss: 0.001479, 0.002581| Seasonal Loss: 0.0152, 0.1085| Residual Loss: 0.0361, 0.2786
Epoch 63/100, (Training, Validation) Trend Loss: 0.001475, 0.002597| Seasonal Loss: 0.0151, 0.1080| Residual Loss: 0.0360, 0.2782
Epoch 64/100, (Training, Validation) Trend Loss: 0.001470, 0.002616| Seasonal Loss: 0.0150, 0.1074| Residual Loss: 0.0360, 0.2779
Epoch 65/100, (Training, Validation) Trend Loss: 0.001464, 0.002636| Seasonal Loss: 0.0148, 0.1069| Residual Loss: 0.0359, 0.2776
Epoch 66/100, (Training, Validation) Trend Loss: 0.001458, 0.002651| Seasonal Loss: 0.0147, 0.1064| Residual Loss: 0.0358, 0.2774
Epoch 67/100, (Training, Validation) Trend Loss: 0.001452, 0.002661| Seasonal Loss: 0.0146, 0.1059| Residual Loss: 0.0358, 0.2771
Epoch 68/100, (Training, Validation) Trend Loss: 0.001446, 0.002664| Seasonal Loss: 0.0145, 0.1054| Residual Loss: 0.0357, 0.2768
Epoch 69/100, (Training, Validation) Trend Loss: 0.001441, 0.002660| Seasonal Loss: 0.0144, 0.1049| Residual Loss: 0.0357, 0.2766
Epoch 70/100, (Training, Validation) Trend Loss: 0.001436, 0.002651| Seasonal Loss: 0.0143, 0.1045| Residual Loss: 0.0356, 0.2764
Epoch 71/100, (Training, Validation) Trend Loss: 0.001432, 0.002640| Seasonal Loss: 0.0142, 0.1041| Residual Loss: 0.0356, 0.2762
Epoch 72/100, (Training, Validation) Trend Loss: 0.001428, 0.002628| Seasonal Loss: 0.0141, 0.1037| Residual Loss: 0.0355, 0.2760
Epoch 73/100, (Training, Validation) Trend Loss: 0.001424, 0.002617| Seasonal Loss: 0.0140, 0.1033| Residual Loss: 0.0355, 0.2758
Epoch 74/100, (Training, Validation) Trend Loss: 0.001420, 0.002609| Seasonal Loss: 0.0140, 0.1030| Residual Loss: 0.0354, 0.2756
Epoch 75/100, (Training, Validation) Trend Loss: 0.001416, 0.002602| Seasonal Loss: 0.0139, 0.1027| Residual Loss: 0.0354, 0.2754
Epoch 76/100, (Training, Validation) Trend Loss: 0.001413, 0.002596| Seasonal Loss: 0.0138, 0.1024| Residual Loss: 0.0353, 0.2752
Epoch 77/100, (Training, Validation) Trend Loss: 0.001409, 0.002591| Seasonal Loss: 0.0138, 0.1021| Residual Loss: 0.0353, 0.2751
Epoch 78/100, (Training, Validation) Trend Loss: 0.001406, 0.002586| Seasonal Loss: 0.0137, 0.1019| Residual Loss: 0.0353, 0.2749
Epoch 79/100, (Training, Validation) Trend Loss: 0.001403, 0.002581| Seasonal Loss: 0.0136, 0.1016| Residual Loss: 0.0352, 0.2748
Epoch 80/100, (Training, Validation) Trend Loss: 0.001400, 0.002576| Seasonal Loss: 0.0136, 0.1014| Residual Loss: 0.0352, 0.2746
Epoch 81/100, (Training, Validation) Trend Loss: 0.001397, 0.002571| Seasonal Loss: 0.0135, 0.1012| Residual Loss: 0.0352, 0.2745
Epoch 82/100, (Training, Validation) Trend Loss: 0.001395, 0.002565| Seasonal Loss: 0.0135, 0.1010| Residual Loss: 0.0351, 0.2744
Epoch 83/100, (Training, Validation) Trend Loss: 0.001392, 0.002560| Seasonal Loss: 0.0134, 0.1009| Residual Loss: 0.0351, 0.2743
Epoch 84/100, (Training, Validation) Trend Loss: 0.001389, 0.002555| Seasonal Loss: 0.0134, 0.1007| Residual Loss: 0.0351, 0.2741
Epoch 85/100, (Training, Validation) Trend Loss: 0.001387, 0.002551| Seasonal Loss: 0.0133, 0.1005| Residual Loss: 0.0351, 0.2740
Epoch 86/100, (Training, Validation) Trend Loss: 0.001385, 0.002546| Seasonal Loss: 0.0133, 0.1004| Residual Loss: 0.0350, 0.2739
Epoch 87/100, (Training, Validation) Trend Loss: 0.001383, 0.002542| Seasonal Loss: 0.0132, 0.1003| Residual Loss: 0.0350, 0.2738
Epoch 88/100, (Training, Validation) Trend Loss: 0.001381, 0.002538| Seasonal Loss: 0.0132, 0.1002| Residual Loss: 0.0350, 0.2737
Epoch 89/100, (Training, Validation) Trend Loss: 0.001379, 0.002533| Seasonal Loss: 0.0132, 0.1001| Residual Loss: 0.0350, 0.2736
Epoch 90/100, (Training, Validation) Trend Loss: 0.001377, 0.002530| Seasonal Loss: 0.0131, 0.1000| Residual Loss: 0.0350, 0.2736
Epoch 91/100, (Training, Validation) Trend Loss: 0.001375, 0.002526| Seasonal Loss: 0.0131, 0.0999| Residual Loss: 0.0349, 0.2735
Epoch 92/100, (Training, Validation) Trend Loss: 0.001373, 0.002522| Seasonal Loss: 0.0131, 0.0998| Residual Loss: 0.0349, 0.2734
Epoch 93/100, (Training, Validation) Trend Loss: 0.001372, 0.002519| Seasonal Loss: 0.0130, 0.0997| Residual Loss: 0.0349, 0.2733
Epoch 94/100, (Training, Validation) Trend Loss: 0.001370, 0.002515| Seasonal Loss: 0.0130, 0.0996| Residual Loss: 0.0349, 0.2733
Epoch 95/100, (Training, Validation) Trend Loss: 0.001369, 0.002512| Seasonal Loss: 0.0130, 0.0996| Residual Loss: 0.0349, 0.2732
Epoch 96/100, (Training, Validation) Trend Loss: 0.001367, 0.002509| Seasonal Loss: 0.0129, 0.0995| Residual Loss: 0.0349, 0.2731
Epoch 97/100, (Training, Validation) Trend Loss: 0.001366, 0.002506| Seasonal Loss: 0.0129, 0.0994| Residual Loss: 0.0348, 0.2731
Epoch 98/100, (Training, Validation) Trend Loss: 0.001365, 0.002503| Seasonal Loss: 0.0129, 0.0994| Residual Loss: 0.0348, 0.2730
Epoch 99/100, (Training, Validation) Trend Loss: 0.001363, 0.002500| Seasonal Loss: 0.0129, 0.0993| Residual Loss: 0.0348, 0.2730
Epoch 100/100, (Training, Validation) Trend Loss: 0.001362, 0.002497| Seasonal Loss: 0.0128, 0.0993| Residual Loss: 0.0348, 0.2729
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:246: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:247: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:248: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[165.27553441]
[-0.02820894]
[16.91306566]
[182.16039113]
actual_stock_price: [178.0572052  176.6761322  179.40844727 179.79592896 182.60771179
 182.13079834 182.76670837 184.81344604 183.73045349 183.81985474]
add_predicted_stock_price: [178.0572052  176.6761322  179.40844727 179.79592896 182.60771179
 182.13079834 182.76670837 184.81344604 183.73045349 182.16039113]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:294: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
