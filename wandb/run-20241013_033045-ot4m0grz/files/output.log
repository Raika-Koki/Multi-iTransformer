[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.4807, 0.2724| Seasonal Loss: 0.9696, 0.4631| Residual Loss: 0.3658, 0.2796
Epoch 2/100, (Training, Validation) Trend Loss: 0.3978, 0.6809| Seasonal Loss: 0.4269, 0.4588| Residual Loss: 0.2771, 0.2712
Epoch 3/100, (Training, Validation) Trend Loss: 0.3708, 0.1131| Seasonal Loss: 0.3285, 0.4156| Residual Loss: 0.2299, 0.1935
Epoch 4/100, (Training, Validation) Trend Loss: 0.1366, 0.1836| Seasonal Loss: 0.2791, 0.3331| Residual Loss: 0.2372, 0.1567
Epoch 5/100, (Training, Validation) Trend Loss: 0.1712, 0.1706| Seasonal Loss: 0.2231, 0.2133| Residual Loss: 0.2372, 0.1441
Epoch 6/100, (Training, Validation) Trend Loss: 0.1449, 0.1146| Seasonal Loss: 0.1984, 0.1766| Residual Loss: 0.2002, 0.1352
Epoch 7/100, (Training, Validation) Trend Loss: 0.0997, 0.1151| Seasonal Loss: 0.1683, 0.1631| Residual Loss: 0.1569, 0.1247
Epoch 8/100, (Training, Validation) Trend Loss: 0.1033, 0.1147| Seasonal Loss: 0.1522, 0.1446| Residual Loss: 0.1383, 0.1214
Epoch 9/100, (Training, Validation) Trend Loss: 0.0889, 0.0890| Seasonal Loss: 0.1394, 0.1125| Residual Loss: 0.1324, 0.1129
Epoch 10/100, (Training, Validation) Trend Loss: 0.0712, 0.0746| Seasonal Loss: 0.1420, 0.1436| Residual Loss: 0.1316, 0.1370
Epoch 11/100, (Training, Validation) Trend Loss: 0.0655, 0.0594| Seasonal Loss: 0.1634, 0.1478| Residual Loss: 0.1433, 0.1455
Epoch 12/100, (Training, Validation) Trend Loss: 0.0656, 0.0528| Seasonal Loss: 0.1487, 0.1822| Residual Loss: 0.1557, 0.2826
Epoch 13/100, (Training, Validation) Trend Loss: 0.0539, 0.0595| Seasonal Loss: 0.1341, 0.1347| Residual Loss: 0.1962, 0.2316
Epoch 14/100, (Training, Validation) Trend Loss: 0.0503, 0.0630| Seasonal Loss: 0.1068, 0.1147| Residual Loss: 0.1874, 0.1603
Epoch 15/100, (Training, Validation) Trend Loss: 0.0463, 0.0538| Seasonal Loss: 0.0938, 0.1161| Residual Loss: 0.1505, 0.1222
Epoch 16/100, (Training, Validation) Trend Loss: 0.0411, 0.0452| Seasonal Loss: 0.0902, 0.1046| Residual Loss: 0.1195, 0.1155
Epoch 17/100, (Training, Validation) Trend Loss: 0.0398, 0.0386| Seasonal Loss: 0.0801, 0.1046| Residual Loss: 0.1115, 0.1074
Epoch 18/100, (Training, Validation) Trend Loss: 0.0385, 0.0361| Seasonal Loss: 0.0738, 0.1023| Residual Loss: 0.1056, 0.1031
Epoch 19/100, (Training, Validation) Trend Loss: 0.0355, 0.0387| Seasonal Loss: 0.0716, 0.1018| Residual Loss: 0.1006, 0.0987
Epoch 20/100, (Training, Validation) Trend Loss: 0.0341, 0.0384| Seasonal Loss: 0.0663, 0.0989| Residual Loss: 0.0973, 0.0976
Epoch 21/100, (Training, Validation) Trend Loss: 0.0321, 0.0342| Seasonal Loss: 0.0628, 0.0981| Residual Loss: 0.0944, 0.0959
Epoch 22/100, (Training, Validation) Trend Loss: 0.0303, 0.0313| Seasonal Loss: 0.0601, 0.0983| Residual Loss: 0.0922, 0.0948
Epoch 23/100, (Training, Validation) Trend Loss: 0.0297, 0.0298| Seasonal Loss: 0.0573, 0.0972| Residual Loss: 0.0903, 0.0939
Epoch 24/100, (Training, Validation) Trend Loss: 0.0288, 0.0305| Seasonal Loss: 0.0554, 0.0973| Residual Loss: 0.0887, 0.0931
Epoch 25/100, (Training, Validation) Trend Loss: 0.0275, 0.0313| Seasonal Loss: 0.0531, 0.0963| Residual Loss: 0.0871, 0.0922
Epoch 26/100, (Training, Validation) Trend Loss: 0.0266, 0.0294| Seasonal Loss: 0.0514, 0.0965| Residual Loss: 0.0858, 0.0921
Epoch 27/100, (Training, Validation) Trend Loss: 0.0257, 0.0272| Seasonal Loss: 0.0498, 0.0953| Residual Loss: 0.0846, 0.0908
Epoch 28/100, (Training, Validation) Trend Loss: 0.0250, 0.0263| Seasonal Loss: 0.0485, 0.0965| Residual Loss: 0.0841, 0.0917
Epoch 29/100, (Training, Validation) Trend Loss: 0.0245, 0.0260| Seasonal Loss: 0.0481, 0.0948| Residual Loss: 0.0843, 0.0897
Epoch 30/100, (Training, Validation) Trend Loss: 0.0238, 0.0263| Seasonal Loss: 0.0484, 0.0989| Residual Loss: 0.0879, 0.0925
Epoch 31/100, (Training, Validation) Trend Loss: 0.0232, 0.0260| Seasonal Loss: 0.0524, 0.0972| Residual Loss: 0.0956, 0.0896
Epoch 32/100, (Training, Validation) Trend Loss: 0.0226, 0.0250| Seasonal Loss: 0.0561, 0.1029| Residual Loss: 0.0996, 0.0903
Epoch 33/100, (Training, Validation) Trend Loss: 0.0222, 0.0243| Seasonal Loss: 0.0605, 0.0977| Residual Loss: 0.0916, 0.0902
Epoch 34/100, (Training, Validation) Trend Loss: 0.0217, 0.0241| Seasonal Loss: 0.0504, 0.0928| Residual Loss: 0.0808, 0.0890
Epoch 35/100, (Training, Validation) Trend Loss: 0.0213, 0.0240| Seasonal Loss: 0.0435, 0.0944| Residual Loss: 0.0792, 0.0894
Epoch 36/100, (Training, Validation) Trend Loss: 0.0209, 0.0238| Seasonal Loss: 0.0422, 0.0940| Residual Loss: 0.0781, 0.0891
Epoch 37/100, (Training, Validation) Trend Loss: 0.0206, 0.0234| Seasonal Loss: 0.0415, 0.0930| Residual Loss: 0.0770, 0.0888
Epoch 38/100, (Training, Validation) Trend Loss: 0.0202, 0.0228| Seasonal Loss: 0.0404, 0.0921| Residual Loss: 0.0761, 0.0888
Epoch 39/100, (Training, Validation) Trend Loss: 0.0199, 0.0225| Seasonal Loss: 0.0393, 0.0917| Residual Loss: 0.0753, 0.0885
Epoch 40/100, (Training, Validation) Trend Loss: 0.0197, 0.0224| Seasonal Loss: 0.0385, 0.0915| Residual Loss: 0.0747, 0.0883
Epoch 41/100, (Training, Validation) Trend Loss: 0.0194, 0.0222| Seasonal Loss: 0.0380, 0.0910| Residual Loss: 0.0740, 0.0881
Epoch 42/100, (Training, Validation) Trend Loss: 0.0191, 0.0219| Seasonal Loss: 0.0373, 0.0908| Residual Loss: 0.0734, 0.0878
Epoch 43/100, (Training, Validation) Trend Loss: 0.0189, 0.0217| Seasonal Loss: 0.0367, 0.0906| Residual Loss: 0.0729, 0.0877
Epoch 44/100, (Training, Validation) Trend Loss: 0.0187, 0.0214| Seasonal Loss: 0.0363, 0.0903| Residual Loss: 0.0723, 0.0875
Epoch 45/100, (Training, Validation) Trend Loss: 0.0185, 0.0212| Seasonal Loss: 0.0358, 0.0900| Residual Loss: 0.0718, 0.0873
Epoch 46/100, (Training, Validation) Trend Loss: 0.0183, 0.0211| Seasonal Loss: 0.0353, 0.0898| Residual Loss: 0.0714, 0.0872
Epoch 47/100, (Training, Validation) Trend Loss: 0.0181, 0.0210| Seasonal Loss: 0.0349, 0.0895| Residual Loss: 0.0709, 0.0870
Epoch 48/100, (Training, Validation) Trend Loss: 0.0179, 0.0208| Seasonal Loss: 0.0345, 0.0893| Residual Loss: 0.0705, 0.0869
Epoch 49/100, (Training, Validation) Trend Loss: 0.0178, 0.0206| Seasonal Loss: 0.0342, 0.0891| Residual Loss: 0.0701, 0.0868
Epoch 50/100, (Training, Validation) Trend Loss: 0.0176, 0.0205| Seasonal Loss: 0.0338, 0.0889| Residual Loss: 0.0697, 0.0867
Epoch 51/100, (Training, Validation) Trend Loss: 0.0175, 0.0204| Seasonal Loss: 0.0335, 0.0887| Residual Loss: 0.0693, 0.0866
Epoch 52/100, (Training, Validation) Trend Loss: 0.0174, 0.0202| Seasonal Loss: 0.0332, 0.0885| Residual Loss: 0.0690, 0.0865
Epoch 53/100, (Training, Validation) Trend Loss: 0.0173, 0.0201| Seasonal Loss: 0.0330, 0.0883| Residual Loss: 0.0686, 0.0864
Epoch 54/100, (Training, Validation) Trend Loss: 0.0171, 0.0200| Seasonal Loss: 0.0327, 0.0881| Residual Loss: 0.0683, 0.0863
Epoch 55/100, (Training, Validation) Trend Loss: 0.0170, 0.0199| Seasonal Loss: 0.0324, 0.0880| Residual Loss: 0.0680, 0.0862
Epoch 56/100, (Training, Validation) Trend Loss: 0.0169, 0.0198| Seasonal Loss: 0.0322, 0.0878| Residual Loss: 0.0677, 0.0862
Epoch 57/100, (Training, Validation) Trend Loss: 0.0168, 0.0197| Seasonal Loss: 0.0320, 0.0877| Residual Loss: 0.0675, 0.0861
Epoch 58/100, (Training, Validation) Trend Loss: 0.0168, 0.0197| Seasonal Loss: 0.0318, 0.0875| Residual Loss: 0.0672, 0.0860
Epoch 59/100, (Training, Validation) Trend Loss: 0.0167, 0.0196| Seasonal Loss: 0.0316, 0.0874| Residual Loss: 0.0670, 0.0860
Epoch 60/100, (Training, Validation) Trend Loss: 0.0166, 0.0195| Seasonal Loss: 0.0314, 0.0873| Residual Loss: 0.0667, 0.0859
Epoch 61/100, (Training, Validation) Trend Loss: 0.0165, 0.0194| Seasonal Loss: 0.0312, 0.0872| Residual Loss: 0.0665, 0.0859
Epoch 62/100, (Training, Validation) Trend Loss: 0.0165, 0.0194| Seasonal Loss: 0.0311, 0.0870| Residual Loss: 0.0663, 0.0858
Epoch 63/100, (Training, Validation) Trend Loss: 0.0164, 0.0193| Seasonal Loss: 0.0309, 0.0869| Residual Loss: 0.0661, 0.0858
Epoch 64/100, (Training, Validation) Trend Loss: 0.0163, 0.0192| Seasonal Loss: 0.0307, 0.0868| Residual Loss: 0.0659, 0.0857
Epoch 65/100, (Training, Validation) Trend Loss: 0.0163, 0.0192| Seasonal Loss: 0.0306, 0.0867| Residual Loss: 0.0657, 0.0857
Epoch 66/100, (Training, Validation) Trend Loss: 0.0162, 0.0191| Seasonal Loss: 0.0305, 0.0867| Residual Loss: 0.0656, 0.0857
Epoch 67/100, (Training, Validation) Trend Loss: 0.0162, 0.0191| Seasonal Loss: 0.0303, 0.0866| Residual Loss: 0.0654, 0.0856
Epoch 68/100, (Training, Validation) Trend Loss: 0.0161, 0.0190| Seasonal Loss: 0.0302, 0.0865| Residual Loss: 0.0652, 0.0856
Epoch 69/100, (Training, Validation) Trend Loss: 0.0161, 0.0190| Seasonal Loss: 0.0301, 0.0864| Residual Loss: 0.0651, 0.0856
Epoch 70/100, (Training, Validation) Trend Loss: 0.0160, 0.0189| Seasonal Loss: 0.0300, 0.0863| Residual Loss: 0.0650, 0.0855
Epoch 71/100, (Training, Validation) Trend Loss: 0.0160, 0.0189| Seasonal Loss: 0.0299, 0.0863| Residual Loss: 0.0648, 0.0855
Epoch 72/100, (Training, Validation) Trend Loss: 0.0159, 0.0188| Seasonal Loss: 0.0298, 0.0862| Residual Loss: 0.0647, 0.0855
Epoch 73/100, (Training, Validation) Trend Loss: 0.0159, 0.0188| Seasonal Loss: 0.0297, 0.0861| Residual Loss: 0.0646, 0.0855
Epoch 74/100, (Training, Validation) Trend Loss: 0.0159, 0.0188| Seasonal Loss: 0.0296, 0.0861| Residual Loss: 0.0645, 0.0854
Epoch 75/100, (Training, Validation) Trend Loss: 0.0158, 0.0187| Seasonal Loss: 0.0295, 0.0860| Residual Loss: 0.0643, 0.0854
Epoch 76/100, (Training, Validation) Trend Loss: 0.0158, 0.0187| Seasonal Loss: 0.0295, 0.0860| Residual Loss: 0.0642, 0.0854
Epoch 77/100, (Training, Validation) Trend Loss: 0.0158, 0.0187| Seasonal Loss: 0.0294, 0.0859| Residual Loss: 0.0641, 0.0854
Epoch 78/100, (Training, Validation) Trend Loss: 0.0157, 0.0186| Seasonal Loss: 0.0293, 0.0859| Residual Loss: 0.0640, 0.0854
Epoch 79/100, (Training, Validation) Trend Loss: 0.0157, 0.0186| Seasonal Loss: 0.0292, 0.0858| Residual Loss: 0.0640, 0.0853
Epoch 80/100, (Training, Validation) Trend Loss: 0.0157, 0.0186| Seasonal Loss: 0.0292, 0.0858| Residual Loss: 0.0639, 0.0853
Epoch 81/100, (Training, Validation) Trend Loss: 0.0157, 0.0186| Seasonal Loss: 0.0291, 0.0857| Residual Loss: 0.0638, 0.0853
Epoch 82/100, (Training, Validation) Trend Loss: 0.0156, 0.0185| Seasonal Loss: 0.0290, 0.0857| Residual Loss: 0.0637, 0.0853
Epoch 83/100, (Training, Validation) Trend Loss: 0.0156, 0.0185| Seasonal Loss: 0.0290, 0.0856| Residual Loss: 0.0636, 0.0853
Epoch 84/100, (Training, Validation) Trend Loss: 0.0156, 0.0185| Seasonal Loss: 0.0289, 0.0856| Residual Loss: 0.0636, 0.0853
Epoch 85/100, (Training, Validation) Trend Loss: 0.0156, 0.0185| Seasonal Loss: 0.0289, 0.0856| Residual Loss: 0.0635, 0.0852
Epoch 86/100, (Training, Validation) Trend Loss: 0.0155, 0.0184| Seasonal Loss: 0.0288, 0.0855| Residual Loss: 0.0634, 0.0852
Epoch 87/100, (Training, Validation) Trend Loss: 0.0155, 0.0184| Seasonal Loss: 0.0288, 0.0855| Residual Loss: 0.0634, 0.0852
Epoch 88/100, (Training, Validation) Trend Loss: 0.0155, 0.0184| Seasonal Loss: 0.0287, 0.0855| Residual Loss: 0.0633, 0.0852
Epoch 89/100, (Training, Validation) Trend Loss: 0.0155, 0.0184| Seasonal Loss: 0.0287, 0.0855| Residual Loss: 0.0632, 0.0852
Epoch 90/100, (Training, Validation) Trend Loss: 0.0155, 0.0184| Seasonal Loss: 0.0287, 0.0854| Residual Loss: 0.0632, 0.0852
Epoch 91/100, (Training, Validation) Trend Loss: 0.0155, 0.0184| Seasonal Loss: 0.0286, 0.0854| Residual Loss: 0.0631, 0.0852
Epoch 92/100, (Training, Validation) Trend Loss: 0.0154, 0.0183| Seasonal Loss: 0.0286, 0.0854| Residual Loss: 0.0631, 0.0852
Epoch 93/100, (Training, Validation) Trend Loss: 0.0154, 0.0183| Seasonal Loss: 0.0286, 0.0854| Residual Loss: 0.0630, 0.0852
Epoch 94/100, (Training, Validation) Trend Loss: 0.0154, 0.0183| Seasonal Loss: 0.0285, 0.0853| Residual Loss: 0.0630, 0.0852
Epoch 95/100, (Training, Validation) Trend Loss: 0.0154, 0.0183| Seasonal Loss: 0.0285, 0.0853| Residual Loss: 0.0630, 0.0851
Epoch 96/100, (Training, Validation) Trend Loss: 0.0154, 0.0183| Seasonal Loss: 0.0285, 0.0853| Residual Loss: 0.0629, 0.0851
Epoch 97/100, (Training, Validation) Trend Loss: 0.0154, 0.0183| Seasonal Loss: 0.0284, 0.0853| Residual Loss: 0.0629, 0.0851
Epoch 98/100, (Training, Validation) Trend Loss: 0.0154, 0.0183| Seasonal Loss: 0.0284, 0.0853| Residual Loss: 0.0628, 0.0851
Epoch 99/100, (Training, Validation) Trend Loss: 0.0154, 0.0182| Seasonal Loss: 0.0284, 0.0852| Residual Loss: 0.0628, 0.0851
Epoch 100/100, (Training, Validation) Trend Loss: 0.0154, 0.0182| Seasonal Loss: 0.0284, 0.0852| Residual Loss: 0.0628, 0.0851
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[165.85219596]
[-0.81294953]
[0.8634322]
[165.90267863]
actual_stock_price: [171.57913208 173.9239502  174.03323364 173.079422   170.45639038
 170.73458862 171.87721252 174.30149841 176.1594696  176.10978699]
add_predicted_stock_price: [171.57913208 173.9239502  174.03323364 173.079422   170.45639038
 170.73458862 171.87721252 174.30149841 176.1594696  165.90267863]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
