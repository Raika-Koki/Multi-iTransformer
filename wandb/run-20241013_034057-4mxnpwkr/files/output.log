[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 3.0267, 0.2324| Seasonal Loss: 2.3101, 0.4379| Residual Loss: 2.6333, 0.6011
Epoch 2/100, (Training, Validation) Trend Loss: 0.7326, 0.3045| Seasonal Loss: 0.7063, 0.3190| Residual Loss: 0.4825, 0.8934
Epoch 3/100, (Training, Validation) Trend Loss: 0.2112, 0.1806| Seasonal Loss: 0.4129, 0.4783| Residual Loss: 0.4741, 0.6457
Epoch 4/100, (Training, Validation) Trend Loss: 0.1756, 0.2655| Seasonal Loss: 0.3437, 0.4330| Residual Loss: 0.3295, 0.4709
Epoch 5/100, (Training, Validation) Trend Loss: 0.1463, 0.1288| Seasonal Loss: 0.2909, 0.4396| Residual Loss: 0.2388, 0.3299
Epoch 6/100, (Training, Validation) Trend Loss: 0.1393, 0.2199| Seasonal Loss: 0.1951, 0.2998| Residual Loss: 0.1707, 0.2796
Epoch 7/100, (Training, Validation) Trend Loss: 0.1655, 0.2294| Seasonal Loss: 0.1849, 0.2888| Residual Loss: 0.1211, 0.2820
Epoch 8/100, (Training, Validation) Trend Loss: 0.2770, 0.2365| Seasonal Loss: 0.2040, 0.1787| Residual Loss: 0.1136, 0.2608
Epoch 9/100, (Training, Validation) Trend Loss: 0.1653, 0.1225| Seasonal Loss: 0.1485, 0.1630| Residual Loss: 0.0951, 0.2164
Epoch 10/100, (Training, Validation) Trend Loss: 0.1872, 0.0790| Seasonal Loss: 0.1077, 0.1675| Residual Loss: 0.0801, 0.2012
Epoch 11/100, (Training, Validation) Trend Loss: 0.1173, 0.0849| Seasonal Loss: 0.0867, 0.1352| Residual Loss: 0.0734, 0.2080
Epoch 12/100, (Training, Validation) Trend Loss: 0.0778, 0.0622| Seasonal Loss: 0.0671, 0.1083| Residual Loss: 0.0663, 0.1915
Epoch 13/100, (Training, Validation) Trend Loss: 0.0995, 0.1463| Seasonal Loss: 0.0570, 0.0981| Residual Loss: 0.0703, 0.2848
Epoch 14/100, (Training, Validation) Trend Loss: 0.1649, 0.1797| Seasonal Loss: 0.0547, 0.1352| Residual Loss: 0.1078, 0.2898
Epoch 15/100, (Training, Validation) Trend Loss: 0.1454, 0.0863| Seasonal Loss: 0.0913, 0.1585| Residual Loss: 0.1235, 0.2292
Epoch 16/100, (Training, Validation) Trend Loss: 0.0884, 0.1349| Seasonal Loss: 0.1018, 0.2179| Residual Loss: 0.0860, 0.2688
Epoch 17/100, (Training, Validation) Trend Loss: 0.0764, 0.0671| Seasonal Loss: 0.0858, 0.1437| Residual Loss: 0.1101, 0.2561
Epoch 18/100, (Training, Validation) Trend Loss: 0.0628, 0.0519| Seasonal Loss: 0.0681, 0.1459| Residual Loss: 0.1098, 0.2306
Epoch 19/100, (Training, Validation) Trend Loss: 0.0556, 0.0574| Seasonal Loss: 0.0823, 0.1118| Residual Loss: 0.1438, 0.2227
Epoch 20/100, (Training, Validation) Trend Loss: 0.0429, 0.0478| Seasonal Loss: 0.1262, 0.1047| Residual Loss: 0.1771, 0.2292
Epoch 21/100, (Training, Validation) Trend Loss: 0.0349, 0.0334| Seasonal Loss: 0.1339, 0.0969| Residual Loss: 0.0971, 0.2414
Epoch 22/100, (Training, Validation) Trend Loss: 0.0345, 0.0324| Seasonal Loss: 0.0663, 0.0823| Residual Loss: 0.1031, 0.2243
Epoch 23/100, (Training, Validation) Trend Loss: 0.0333, 0.0342| Seasonal Loss: 0.0631, 0.0815| Residual Loss: 0.0811, 0.2290
Epoch 24/100, (Training, Validation) Trend Loss: 0.0467, 0.0312| Seasonal Loss: 0.0486, 0.0839| Residual Loss: 0.0737, 0.2163
Epoch 25/100, (Training, Validation) Trend Loss: 0.0629, 0.0288| Seasonal Loss: 0.0424, 0.0803| Residual Loss: 0.0628, 0.2037
Epoch 26/100, (Training, Validation) Trend Loss: 0.0607, 0.0373| Seasonal Loss: 0.0381, 0.0724| Residual Loss: 0.0561, 0.2033
Epoch 27/100, (Training, Validation) Trend Loss: 0.0381, 0.0193| Seasonal Loss: 0.0356, 0.0750| Residual Loss: 0.0529, 0.2010
Epoch 28/100, (Training, Validation) Trend Loss: 0.0318, 0.0313| Seasonal Loss: 0.0341, 0.0835| Residual Loss: 0.0485, 0.1966
Epoch 29/100, (Training, Validation) Trend Loss: 0.0295, 0.0248| Seasonal Loss: 0.0386, 0.1051| Residual Loss: 0.0465, 0.1923
Epoch 30/100, (Training, Validation) Trend Loss: 0.0250, 0.0188| Seasonal Loss: 0.0448, 0.1327| Residual Loss: 0.0441, 0.1922
Epoch 31/100, (Training, Validation) Trend Loss: 0.0239, 0.0210| Seasonal Loss: 0.0573, 0.0805| Residual Loss: 0.0422, 0.1932
Epoch 32/100, (Training, Validation) Trend Loss: 0.0224, 0.0206| Seasonal Loss: 0.0348, 0.0800| Residual Loss: 0.0404, 0.1925
Epoch 33/100, (Training, Validation) Trend Loss: 0.0212, 0.0178| Seasonal Loss: 0.0311, 0.0742| Residual Loss: 0.0389, 0.1914
Epoch 34/100, (Training, Validation) Trend Loss: 0.0201, 0.0177| Seasonal Loss: 0.0306, 0.0710| Residual Loss: 0.0376, 0.1912
Epoch 35/100, (Training, Validation) Trend Loss: 0.0199, 0.0185| Seasonal Loss: 0.0273, 0.0726| Residual Loss: 0.0364, 0.1915
Epoch 36/100, (Training, Validation) Trend Loss: 0.0193, 0.0191| Seasonal Loss: 0.0256, 0.0673| Residual Loss: 0.0353, 0.1910
Epoch 37/100, (Training, Validation) Trend Loss: 0.0210, 0.0207| Seasonal Loss: 0.0239, 0.0649| Residual Loss: 0.0342, 0.1904
Epoch 38/100, (Training, Validation) Trend Loss: 0.0216, 0.0251| Seasonal Loss: 0.0232, 0.0643| Residual Loss: 0.0333, 0.1903
Epoch 39/100, (Training, Validation) Trend Loss: 0.0257, 0.0249| Seasonal Loss: 0.0220, 0.0635| Residual Loss: 0.0324, 0.1905
Epoch 40/100, (Training, Validation) Trend Loss: 0.0225, 0.0189| Seasonal Loss: 0.0212, 0.0617| Residual Loss: 0.0317, 0.1905
Epoch 41/100, (Training, Validation) Trend Loss: 0.0199, 0.0158| Seasonal Loss: 0.0206, 0.0607| Residual Loss: 0.0309, 0.1905
Epoch 42/100, (Training, Validation) Trend Loss: 0.0165, 0.0164| Seasonal Loss: 0.0199, 0.0602| Residual Loss: 0.0303, 0.1907
Epoch 43/100, (Training, Validation) Trend Loss: 0.0161, 0.0162| Seasonal Loss: 0.0193, 0.0594| Residual Loss: 0.0297, 0.1909
Epoch 44/100, (Training, Validation) Trend Loss: 0.0163, 0.0151| Seasonal Loss: 0.0188, 0.0588| Residual Loss: 0.0291, 0.1912
Epoch 45/100, (Training, Validation) Trend Loss: 0.0154, 0.0150| Seasonal Loss: 0.0184, 0.0584| Residual Loss: 0.0286, 0.1914
Epoch 46/100, (Training, Validation) Trend Loss: 0.0151, 0.0151| Seasonal Loss: 0.0179, 0.0579| Residual Loss: 0.0281, 0.1916
Epoch 47/100, (Training, Validation) Trend Loss: 0.0150, 0.0145| Seasonal Loss: 0.0175, 0.0575| Residual Loss: 0.0276, 0.1918
Epoch 48/100, (Training, Validation) Trend Loss: 0.0146, 0.0145| Seasonal Loss: 0.0172, 0.0571| Residual Loss: 0.0272, 0.1921
Epoch 49/100, (Training, Validation) Trend Loss: 0.0144, 0.0146| Seasonal Loss: 0.0169, 0.0567| Residual Loss: 0.0268, 0.1923
Epoch 50/100, (Training, Validation) Trend Loss: 0.0142, 0.0143| Seasonal Loss: 0.0166, 0.0564| Residual Loss: 0.0264, 0.1926
Epoch 51/100, (Training, Validation) Trend Loss: 0.0140, 0.0144| Seasonal Loss: 0.0163, 0.0561| Residual Loss: 0.0261, 0.1928
Epoch 52/100, (Training, Validation) Trend Loss: 0.0139, 0.0144| Seasonal Loss: 0.0160, 0.0558| Residual Loss: 0.0257, 0.1930
Epoch 53/100, (Training, Validation) Trend Loss: 0.0137, 0.0143| Seasonal Loss: 0.0158, 0.0556| Residual Loss: 0.0254, 0.1933
Epoch 54/100, (Training, Validation) Trend Loss: 0.0136, 0.0143| Seasonal Loss: 0.0156, 0.0554| Residual Loss: 0.0251, 0.1935
Epoch 55/100, (Training, Validation) Trend Loss: 0.0135, 0.0143| Seasonal Loss: 0.0154, 0.0552| Residual Loss: 0.0249, 0.1937
Epoch 56/100, (Training, Validation) Trend Loss: 0.0133, 0.0143| Seasonal Loss: 0.0152, 0.0550| Residual Loss: 0.0246, 0.1939
Epoch 57/100, (Training, Validation) Trend Loss: 0.0132, 0.0143| Seasonal Loss: 0.0150, 0.0548| Residual Loss: 0.0244, 0.1941
Epoch 58/100, (Training, Validation) Trend Loss: 0.0131, 0.0143| Seasonal Loss: 0.0149, 0.0546| Residual Loss: 0.0242, 0.1943
Epoch 59/100, (Training, Validation) Trend Loss: 0.0130, 0.0142| Seasonal Loss: 0.0147, 0.0545| Residual Loss: 0.0240, 0.1945
Epoch 60/100, (Training, Validation) Trend Loss: 0.0130, 0.0142| Seasonal Loss: 0.0146, 0.0543| Residual Loss: 0.0238, 0.1946
Epoch 61/100, (Training, Validation) Trend Loss: 0.0129, 0.0142| Seasonal Loss: 0.0144, 0.0542| Residual Loss: 0.0236, 0.1948
Epoch 62/100, (Training, Validation) Trend Loss: 0.0128, 0.0142| Seasonal Loss: 0.0143, 0.0541| Residual Loss: 0.0234, 0.1950
Epoch 63/100, (Training, Validation) Trend Loss: 0.0127, 0.0142| Seasonal Loss: 0.0142, 0.0540| Residual Loss: 0.0233, 0.1951
Epoch 64/100, (Training, Validation) Trend Loss: 0.0127, 0.0142| Seasonal Loss: 0.0141, 0.0539| Residual Loss: 0.0231, 0.1953
Epoch 65/100, (Training, Validation) Trend Loss: 0.0126, 0.0142| Seasonal Loss: 0.0140, 0.0538| Residual Loss: 0.0230, 0.1954
Epoch 66/100, (Training, Validation) Trend Loss: 0.0126, 0.0142| Seasonal Loss: 0.0139, 0.0537| Residual Loss: 0.0228, 0.1955
Epoch 67/100, (Training, Validation) Trend Loss: 0.0125, 0.0141| Seasonal Loss: 0.0138, 0.0536| Residual Loss: 0.0227, 0.1957
Epoch 68/100, (Training, Validation) Trend Loss: 0.0125, 0.0141| Seasonal Loss: 0.0137, 0.0536| Residual Loss: 0.0226, 0.1958
Epoch 69/100, (Training, Validation) Trend Loss: 0.0124, 0.0141| Seasonal Loss: 0.0137, 0.0535| Residual Loss: 0.0225, 0.1959
Epoch 70/100, (Training, Validation) Trend Loss: 0.0124, 0.0141| Seasonal Loss: 0.0136, 0.0534| Residual Loss: 0.0224, 0.1960
Epoch 71/100, (Training, Validation) Trend Loss: 0.0123, 0.0141| Seasonal Loss: 0.0135, 0.0534| Residual Loss: 0.0223, 0.1961
Epoch 72/100, (Training, Validation) Trend Loss: 0.0123, 0.0141| Seasonal Loss: 0.0135, 0.0533| Residual Loss: 0.0222, 0.1962
Epoch 73/100, (Training, Validation) Trend Loss: 0.0123, 0.0141| Seasonal Loss: 0.0134, 0.0533| Residual Loss: 0.0221, 0.1963
Epoch 74/100, (Training, Validation) Trend Loss: 0.0122, 0.0141| Seasonal Loss: 0.0133, 0.0532| Residual Loss: 0.0220, 0.1964
Epoch 75/100, (Training, Validation) Trend Loss: 0.0122, 0.0141| Seasonal Loss: 0.0133, 0.0532| Residual Loss: 0.0219, 0.1965
Epoch 76/100, (Training, Validation) Trend Loss: 0.0122, 0.0141| Seasonal Loss: 0.0132, 0.0531| Residual Loss: 0.0218, 0.1965
Epoch 77/100, (Training, Validation) Trend Loss: 0.0121, 0.0141| Seasonal Loss: 0.0132, 0.0531| Residual Loss: 0.0217, 0.1966
Epoch 78/100, (Training, Validation) Trend Loss: 0.0121, 0.0141| Seasonal Loss: 0.0131, 0.0531| Residual Loss: 0.0217, 0.1967
Epoch 79/100, (Training, Validation) Trend Loss: 0.0121, 0.0141| Seasonal Loss: 0.0131, 0.0530| Residual Loss: 0.0216, 0.1968
Epoch 80/100, (Training, Validation) Trend Loss: 0.0121, 0.0141| Seasonal Loss: 0.0131, 0.0530| Residual Loss: 0.0215, 0.1968
Epoch 81/100, (Training, Validation) Trend Loss: 0.0120, 0.0140| Seasonal Loss: 0.0130, 0.0530| Residual Loss: 0.0215, 0.1969
Epoch 82/100, (Training, Validation) Trend Loss: 0.0120, 0.0140| Seasonal Loss: 0.0130, 0.0529| Residual Loss: 0.0214, 0.1969
Epoch 83/100, (Training, Validation) Trend Loss: 0.0120, 0.0140| Seasonal Loss: 0.0129, 0.0529| Residual Loss: 0.0214, 0.1970
Epoch 84/100, (Training, Validation) Trend Loss: 0.0120, 0.0140| Seasonal Loss: 0.0129, 0.0529| Residual Loss: 0.0213, 0.1971
Epoch 85/100, (Training, Validation) Trend Loss: 0.0119, 0.0140| Seasonal Loss: 0.0129, 0.0529| Residual Loss: 0.0213, 0.1971
Epoch 86/100, (Training, Validation) Trend Loss: 0.0119, 0.0140| Seasonal Loss: 0.0128, 0.0528| Residual Loss: 0.0212, 0.1972
Epoch 87/100, (Training, Validation) Trend Loss: 0.0119, 0.0140| Seasonal Loss: 0.0128, 0.0528| Residual Loss: 0.0212, 0.1972
Epoch 88/100, (Training, Validation) Trend Loss: 0.0119, 0.0140| Seasonal Loss: 0.0128, 0.0528| Residual Loss: 0.0211, 0.1972
Epoch 89/100, (Training, Validation) Trend Loss: 0.0119, 0.0140| Seasonal Loss: 0.0128, 0.0528| Residual Loss: 0.0211, 0.1973
Epoch 90/100, (Training, Validation) Trend Loss: 0.0119, 0.0140| Seasonal Loss: 0.0127, 0.0528| Residual Loss: 0.0211, 0.1973
Epoch 91/100, (Training, Validation) Trend Loss: 0.0118, 0.0140| Seasonal Loss: 0.0127, 0.0527| Residual Loss: 0.0210, 0.1974
Epoch 92/100, (Training, Validation) Trend Loss: 0.0118, 0.0140| Seasonal Loss: 0.0127, 0.0527| Residual Loss: 0.0210, 0.1974
Epoch 93/100, (Training, Validation) Trend Loss: 0.0118, 0.0140| Seasonal Loss: 0.0127, 0.0527| Residual Loss: 0.0210, 0.1974
Epoch 94/100, (Training, Validation) Trend Loss: 0.0118, 0.0140| Seasonal Loss: 0.0127, 0.0527| Residual Loss: 0.0209, 0.1975
Epoch 95/100, (Training, Validation) Trend Loss: 0.0118, 0.0140| Seasonal Loss: 0.0126, 0.0527| Residual Loss: 0.0209, 0.1975
Epoch 96/100, (Training, Validation) Trend Loss: 0.0118, 0.0140| Seasonal Loss: 0.0126, 0.0527| Residual Loss: 0.0209, 0.1975
Epoch 97/100, (Training, Validation) Trend Loss: 0.0118, 0.0140| Seasonal Loss: 0.0126, 0.0526| Residual Loss: 0.0208, 0.1975
Epoch 98/100, (Training, Validation) Trend Loss: 0.0118, 0.0140| Seasonal Loss: 0.0126, 0.0526| Residual Loss: 0.0208, 0.1976
Epoch 99/100, (Training, Validation) Trend Loss: 0.0118, 0.0140| Seasonal Loss: 0.0126, 0.0526| Residual Loss: 0.0208, 0.1976
Epoch 100/100, (Training, Validation) Trend Loss: 0.0117, 0.0140| Seasonal Loss: 0.0126, 0.0526| Residual Loss: 0.0208, 0.1976
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[169.02653561]
[0.10062833]
[-0.14783527]
[168.97932867]
actual_stock_price: [171.57913208 173.92396545 174.03323364 173.07940674 170.45640564
 170.73460388 171.87721252 174.30149841 176.1594696  176.1098175 ]
add_predicted_stock_price: [171.57913208 173.92396545 174.03323364 173.07940674 170.45640564
 170.73460388 171.87721252 174.30149841 176.1594696  168.97932867]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
