[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 2.7462, 0.2491| Seasonal Loss: 2.2928, 0.4487| Residual Loss: 0.3972, 0.4457
Epoch 2/100, (Training, Validation) Trend Loss: 0.6149, 0.3046| Seasonal Loss: 0.7992, 0.3752| Residual Loss: 0.3274, 0.4107
Epoch 3/100, (Training, Validation) Trend Loss: 0.3894, 0.2202| Seasonal Loss: 0.3846, 0.3306| Residual Loss: 0.2969, 0.3872
Epoch 4/100, (Training, Validation) Trend Loss: 0.2880, 0.3254| Seasonal Loss: 0.2355, 0.2450| Residual Loss: 0.2756, 0.3674
Epoch 5/100, (Training, Validation) Trend Loss: 0.2990, 0.1187| Seasonal Loss: 0.2312, 0.2205| Residual Loss: 0.2574, 0.3492
Epoch 6/100, (Training, Validation) Trend Loss: 0.1522, 0.0905| Seasonal Loss: 0.1731, 0.2088| Residual Loss: 0.2426, 0.3319
Epoch 7/100, (Training, Validation) Trend Loss: 0.1028, 0.0975| Seasonal Loss: 0.2090, 0.3465| Residual Loss: 0.2304, 0.3157
Epoch 8/100, (Training, Validation) Trend Loss: 0.0769, 0.0537| Seasonal Loss: 0.2286, 0.3189| Residual Loss: 0.2197, 0.3011
Epoch 9/100, (Training, Validation) Trend Loss: 0.0726, 0.0681| Seasonal Loss: 0.1997, 0.1951| Residual Loss: 0.2104, 0.2880
Epoch 10/100, (Training, Validation) Trend Loss: 0.1067, 0.1183| Seasonal Loss: 0.1270, 0.1535| Residual Loss: 0.2023, 0.2763
Epoch 11/100, (Training, Validation) Trend Loss: 0.1983, 0.2644| Seasonal Loss: 0.0916, 0.1397| Residual Loss: 0.1950, 0.2657
Epoch 12/100, (Training, Validation) Trend Loss: 0.1595, 0.1632| Seasonal Loss: 0.0765, 0.1382| Residual Loss: 0.1886, 0.2562
Epoch 13/100, (Training, Validation) Trend Loss: 0.1250, 0.0938| Seasonal Loss: 0.0741, 0.1349| Residual Loss: 0.1829, 0.2478
Epoch 14/100, (Training, Validation) Trend Loss: 0.0916, 0.0965| Seasonal Loss: 0.0655, 0.1462| Residual Loss: 0.1778, 0.2403
Epoch 15/100, (Training, Validation) Trend Loss: 0.0718, 0.0749| Seasonal Loss: 0.0700, 0.1192| Residual Loss: 0.1733, 0.2335
Epoch 16/100, (Training, Validation) Trend Loss: 0.0553, 0.0518| Seasonal Loss: 0.0528, 0.1028| Residual Loss: 0.1692, 0.2275
Epoch 17/100, (Training, Validation) Trend Loss: 0.0500, 0.0448| Seasonal Loss: 0.0481, 0.0941| Residual Loss: 0.1656, 0.2222
Epoch 18/100, (Training, Validation) Trend Loss: 0.0978, 0.0871| Seasonal Loss: 0.0407, 0.0828| Residual Loss: 0.1623, 0.2174
Epoch 19/100, (Training, Validation) Trend Loss: 0.1290, 0.0860| Seasonal Loss: 0.0513, 0.1013| Residual Loss: 0.1593, 0.2131
Epoch 20/100, (Training, Validation) Trend Loss: 0.0884, 0.0533| Seasonal Loss: 0.1103, 0.0993| Residual Loss: 0.1566, 0.2092
Epoch 21/100, (Training, Validation) Trend Loss: 0.0674, 0.0823| Seasonal Loss: 0.1087, 0.0958| Residual Loss: 0.1541, 0.2058
Epoch 22/100, (Training, Validation) Trend Loss: 0.0594, 0.0605| Seasonal Loss: 0.0590, 0.1111| Residual Loss: 0.1519, 0.2026
Epoch 23/100, (Training, Validation) Trend Loss: 0.0463, 0.0463| Seasonal Loss: 0.0602, 0.0922| Residual Loss: 0.1498, 0.1998
Epoch 24/100, (Training, Validation) Trend Loss: 0.0433, 0.0367| Seasonal Loss: 0.0435, 0.0778| Residual Loss: 0.1480, 0.1972
Epoch 25/100, (Training, Validation) Trend Loss: 0.0371, 0.0427| Seasonal Loss: 0.0397, 0.0804| Residual Loss: 0.1462, 0.1949
Epoch 26/100, (Training, Validation) Trend Loss: 0.0340, 0.0377| Seasonal Loss: 0.0355, 0.0832| Residual Loss: 0.1446, 0.1927
Epoch 27/100, (Training, Validation) Trend Loss: 0.0306, 0.0287| Seasonal Loss: 0.0331, 0.0796| Residual Loss: 0.1431, 0.1908
Epoch 28/100, (Training, Validation) Trend Loss: 0.0284, 0.0278| Seasonal Loss: 0.0312, 0.0742| Residual Loss: 0.1418, 0.1890
Epoch 29/100, (Training, Validation) Trend Loss: 0.0259, 0.0250| Seasonal Loss: 0.0300, 0.0773| Residual Loss: 0.1405, 0.1874
Epoch 30/100, (Training, Validation) Trend Loss: 0.0252, 0.0298| Seasonal Loss: 0.0293, 0.0783| Residual Loss: 0.1393, 0.1859
Epoch 31/100, (Training, Validation) Trend Loss: 0.0261, 0.0302| Seasonal Loss: 0.0308, 0.0851| Residual Loss: 0.1382, 0.1845
Epoch 32/100, (Training, Validation) Trend Loss: 0.0348, 0.0593| Seasonal Loss: 0.0312, 0.0884| Residual Loss: 0.1372, 0.1832
Epoch 33/100, (Training, Validation) Trend Loss: 0.0443, 0.0502| Seasonal Loss: 0.0334, 0.0829| Residual Loss: 0.1362, 0.1820
Epoch 34/100, (Training, Validation) Trend Loss: 0.0455, 0.0340| Seasonal Loss: 0.0279, 0.0728| Residual Loss: 0.1353, 0.1809
Epoch 35/100, (Training, Validation) Trend Loss: 0.0248, 0.0322| Seasonal Loss: 0.0249, 0.0714| Residual Loss: 0.1345, 0.1799
Epoch 36/100, (Training, Validation) Trend Loss: 0.0217, 0.0237| Seasonal Loss: 0.0236, 0.0724| Residual Loss: 0.1337, 0.1789
Epoch 37/100, (Training, Validation) Trend Loss: 0.0225, 0.0229| Seasonal Loss: 0.0225, 0.0697| Residual Loss: 0.1330, 0.1780
Epoch 38/100, (Training, Validation) Trend Loss: 0.0195, 0.0260| Seasonal Loss: 0.0218, 0.0689| Residual Loss: 0.1323, 0.1772
Epoch 39/100, (Training, Validation) Trend Loss: 0.0186, 0.0213| Seasonal Loss: 0.0209, 0.0689| Residual Loss: 0.1316, 0.1764
Epoch 40/100, (Training, Validation) Trend Loss: 0.0181, 0.0198| Seasonal Loss: 0.0203, 0.0681| Residual Loss: 0.1310, 0.1757
Epoch 41/100, (Training, Validation) Trend Loss: 0.0175, 0.0205| Seasonal Loss: 0.0198, 0.0678| Residual Loss: 0.1304, 0.1750
Epoch 42/100, (Training, Validation) Trend Loss: 0.0168, 0.0196| Seasonal Loss: 0.0193, 0.0674| Residual Loss: 0.1299, 0.1744
Epoch 43/100, (Training, Validation) Trend Loss: 0.0165, 0.0185| Seasonal Loss: 0.0189, 0.0671| Residual Loss: 0.1294, 0.1738
Epoch 44/100, (Training, Validation) Trend Loss: 0.0161, 0.0183| Seasonal Loss: 0.0185, 0.0669| Residual Loss: 0.1289, 0.1733
Epoch 45/100, (Training, Validation) Trend Loss: 0.0157, 0.0181| Seasonal Loss: 0.0181, 0.0666| Residual Loss: 0.1284, 0.1727
Epoch 46/100, (Training, Validation) Trend Loss: 0.0154, 0.0176| Seasonal Loss: 0.0178, 0.0663| Residual Loss: 0.1280, 0.1722
Epoch 47/100, (Training, Validation) Trend Loss: 0.0152, 0.0172| Seasonal Loss: 0.0175, 0.0661| Residual Loss: 0.1276, 0.1718
Epoch 48/100, (Training, Validation) Trend Loss: 0.0149, 0.0170| Seasonal Loss: 0.0172, 0.0659| Residual Loss: 0.1272, 0.1713
Epoch 49/100, (Training, Validation) Trend Loss: 0.0147, 0.0168| Seasonal Loss: 0.0170, 0.0656| Residual Loss: 0.1268, 0.1709
Epoch 50/100, (Training, Validation) Trend Loss: 0.0145, 0.0165| Seasonal Loss: 0.0168, 0.0654| Residual Loss: 0.1265, 0.1705
Epoch 51/100, (Training, Validation) Trend Loss: 0.0143, 0.0163| Seasonal Loss: 0.0166, 0.0653| Residual Loss: 0.1261, 0.1702
Epoch 52/100, (Training, Validation) Trend Loss: 0.0141, 0.0161| Seasonal Loss: 0.0164, 0.0651| Residual Loss: 0.1258, 0.1698
Epoch 53/100, (Training, Validation) Trend Loss: 0.0139, 0.0159| Seasonal Loss: 0.0162, 0.0649| Residual Loss: 0.1255, 0.1695
Epoch 54/100, (Training, Validation) Trend Loss: 0.0138, 0.0157| Seasonal Loss: 0.0160, 0.0647| Residual Loss: 0.1253, 0.1692
Epoch 55/100, (Training, Validation) Trend Loss: 0.0137, 0.0156| Seasonal Loss: 0.0158, 0.0646| Residual Loss: 0.1250, 0.1689
Epoch 56/100, (Training, Validation) Trend Loss: 0.0135, 0.0154| Seasonal Loss: 0.0157, 0.0645| Residual Loss: 0.1247, 0.1686
Epoch 57/100, (Training, Validation) Trend Loss: 0.0134, 0.0153| Seasonal Loss: 0.0155, 0.0643| Residual Loss: 0.1245, 0.1684
Epoch 58/100, (Training, Validation) Trend Loss: 0.0133, 0.0151| Seasonal Loss: 0.0154, 0.0642| Residual Loss: 0.1243, 0.1681
Epoch 59/100, (Training, Validation) Trend Loss: 0.0132, 0.0150| Seasonal Loss: 0.0153, 0.0641| Residual Loss: 0.1241, 0.1679
Epoch 60/100, (Training, Validation) Trend Loss: 0.0131, 0.0149| Seasonal Loss: 0.0151, 0.0640| Residual Loss: 0.1239, 0.1677
Epoch 61/100, (Training, Validation) Trend Loss: 0.0130, 0.0148| Seasonal Loss: 0.0150, 0.0639| Residual Loss: 0.1237, 0.1675
Epoch 62/100, (Training, Validation) Trend Loss: 0.0129, 0.0147| Seasonal Loss: 0.0149, 0.0638| Residual Loss: 0.1235, 0.1673
Epoch 63/100, (Training, Validation) Trend Loss: 0.0129, 0.0146| Seasonal Loss: 0.0148, 0.0637| Residual Loss: 0.1233, 0.1671
Epoch 64/100, (Training, Validation) Trend Loss: 0.0128, 0.0145| Seasonal Loss: 0.0147, 0.0636| Residual Loss: 0.1231, 0.1669
Epoch 65/100, (Training, Validation) Trend Loss: 0.0127, 0.0144| Seasonal Loss: 0.0146, 0.0635| Residual Loss: 0.1230, 0.1667
Epoch 66/100, (Training, Validation) Trend Loss: 0.0127, 0.0143| Seasonal Loss: 0.0146, 0.0634| Residual Loss: 0.1228, 0.1666
Epoch 67/100, (Training, Validation) Trend Loss: 0.0126, 0.0143| Seasonal Loss: 0.0145, 0.0634| Residual Loss: 0.1227, 0.1664
Epoch 68/100, (Training, Validation) Trend Loss: 0.0125, 0.0142| Seasonal Loss: 0.0144, 0.0633| Residual Loss: 0.1226, 0.1663
Epoch 69/100, (Training, Validation) Trend Loss: 0.0125, 0.0141| Seasonal Loss: 0.0143, 0.0632| Residual Loss: 0.1224, 0.1661
Epoch 70/100, (Training, Validation) Trend Loss: 0.0124, 0.0141| Seasonal Loss: 0.0143, 0.0631| Residual Loss: 0.1223, 0.1660
Epoch 71/100, (Training, Validation) Trend Loss: 0.0124, 0.0140| Seasonal Loss: 0.0142, 0.0631| Residual Loss: 0.1222, 0.1659
Epoch 72/100, (Training, Validation) Trend Loss: 0.0123, 0.0139| Seasonal Loss: 0.0141, 0.0630| Residual Loss: 0.1221, 0.1658
Epoch 73/100, (Training, Validation) Trend Loss: 0.0123, 0.0139| Seasonal Loss: 0.0141, 0.0630| Residual Loss: 0.1220, 0.1656
Epoch 74/100, (Training, Validation) Trend Loss: 0.0123, 0.0138| Seasonal Loss: 0.0140, 0.0629| Residual Loss: 0.1219, 0.1655
Epoch 75/100, (Training, Validation) Trend Loss: 0.0122, 0.0138| Seasonal Loss: 0.0140, 0.0629| Residual Loss: 0.1218, 0.1654
Epoch 76/100, (Training, Validation) Trend Loss: 0.0122, 0.0137| Seasonal Loss: 0.0139, 0.0628| Residual Loss: 0.1217, 0.1653
Epoch 77/100, (Training, Validation) Trend Loss: 0.0122, 0.0137| Seasonal Loss: 0.0139, 0.0628| Residual Loss: 0.1216, 0.1653
Epoch 78/100, (Training, Validation) Trend Loss: 0.0121, 0.0137| Seasonal Loss: 0.0138, 0.0627| Residual Loss: 0.1215, 0.1652
Epoch 79/100, (Training, Validation) Trend Loss: 0.0121, 0.0136| Seasonal Loss: 0.0138, 0.0627| Residual Loss: 0.1215, 0.1651
Epoch 80/100, (Training, Validation) Trend Loss: 0.0121, 0.0136| Seasonal Loss: 0.0137, 0.0627| Residual Loss: 0.1214, 0.1650
Epoch 81/100, (Training, Validation) Trend Loss: 0.0120, 0.0135| Seasonal Loss: 0.0137, 0.0626| Residual Loss: 0.1213, 0.1649
Epoch 82/100, (Training, Validation) Trend Loss: 0.0120, 0.0135| Seasonal Loss: 0.0137, 0.0626| Residual Loss: 0.1213, 0.1649
Epoch 83/100, (Training, Validation) Trend Loss: 0.0120, 0.0135| Seasonal Loss: 0.0136, 0.0626| Residual Loss: 0.1212, 0.1648
Epoch 84/100, (Training, Validation) Trend Loss: 0.0120, 0.0135| Seasonal Loss: 0.0136, 0.0625| Residual Loss: 0.1211, 0.1647
Epoch 85/100, (Training, Validation) Trend Loss: 0.0120, 0.0134| Seasonal Loss: 0.0136, 0.0625| Residual Loss: 0.1211, 0.1647
Epoch 86/100, (Training, Validation) Trend Loss: 0.0119, 0.0134| Seasonal Loss: 0.0135, 0.0625| Residual Loss: 0.1210, 0.1646
Epoch 87/100, (Training, Validation) Trend Loss: 0.0119, 0.0134| Seasonal Loss: 0.0135, 0.0624| Residual Loss: 0.1210, 0.1646
Epoch 88/100, (Training, Validation) Trend Loss: 0.0119, 0.0133| Seasonal Loss: 0.0135, 0.0624| Residual Loss: 0.1209, 0.1645
Epoch 89/100, (Training, Validation) Trend Loss: 0.0119, 0.0133| Seasonal Loss: 0.0135, 0.0624| Residual Loss: 0.1209, 0.1645
Epoch 90/100, (Training, Validation) Trend Loss: 0.0119, 0.0133| Seasonal Loss: 0.0134, 0.0624| Residual Loss: 0.1208, 0.1644
Epoch 91/100, (Training, Validation) Trend Loss: 0.0118, 0.0133| Seasonal Loss: 0.0134, 0.0623| Residual Loss: 0.1208, 0.1644
Epoch 92/100, (Training, Validation) Trend Loss: 0.0118, 0.0133| Seasonal Loss: 0.0134, 0.0623| Residual Loss: 0.1208, 0.1643
Epoch 93/100, (Training, Validation) Trend Loss: 0.0118, 0.0132| Seasonal Loss: 0.0134, 0.0623| Residual Loss: 0.1207, 0.1643
Epoch 94/100, (Training, Validation) Trend Loss: 0.0118, 0.0132| Seasonal Loss: 0.0133, 0.0623| Residual Loss: 0.1207, 0.1643
Epoch 95/100, (Training, Validation) Trend Loss: 0.0118, 0.0132| Seasonal Loss: 0.0133, 0.0623| Residual Loss: 0.1206, 0.1642
Epoch 96/100, (Training, Validation) Trend Loss: 0.0118, 0.0132| Seasonal Loss: 0.0133, 0.0622| Residual Loss: 0.1206, 0.1642
Epoch 97/100, (Training, Validation) Trend Loss: 0.0118, 0.0132| Seasonal Loss: 0.0133, 0.0622| Residual Loss: 0.1206, 0.1642
Epoch 98/100, (Training, Validation) Trend Loss: 0.0118, 0.0132| Seasonal Loss: 0.0133, 0.0622| Residual Loss: 0.1206, 0.1641
Epoch 99/100, (Training, Validation) Trend Loss: 0.0117, 0.0132| Seasonal Loss: 0.0133, 0.0622| Residual Loss: 0.1205, 0.1641
Epoch 100/100, (Training, Validation) Trend Loss: 0.0117, 0.0131| Seasonal Loss: 0.0132, 0.0622| Residual Loss: 0.1205, 0.1641
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[167.59617122]
[-1.17545819]
[0.84295423]
[167.26366726]
actual_stock_price: [171.57913208 173.92396545 174.03323364 173.07940674 170.45640564
 170.73458862 171.87719727 174.30149841 176.1594696  176.10980225]
add_predicted_stock_price: [171.57913208 173.92396545 174.03323364 173.07940674 170.45640564
 170.73458862 171.87719727 174.30149841 176.1594696  167.26366726]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
