[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 1.0917, 0.6591| Seasonal Loss: 0.6344, 0.3140| Residual Loss: 0.4124, 0.4559
Epoch 2/100, (Training, Validation) Trend Loss: 0.5217, 0.3530| Seasonal Loss: 0.4365, 0.3718| Residual Loss: 0.4247, 0.5149
Epoch 3/100, (Training, Validation) Trend Loss: 0.3356, 0.2570| Seasonal Loss: 0.3870, 0.5136| Residual Loss: 0.3741, 0.2303
Epoch 4/100, (Training, Validation) Trend Loss: 0.2713, 0.2240| Seasonal Loss: 0.3096, 0.2660| Residual Loss: 0.2662, 0.2009
Epoch 5/100, (Training, Validation) Trend Loss: 0.2420, 0.2054| Seasonal Loss: 0.2419, 0.2330| Residual Loss: 0.2042, 0.1738
Epoch 6/100, (Training, Validation) Trend Loss: 0.2224, 0.1902| Seasonal Loss: 0.2008, 0.2442| Residual Loss: 0.1797, 0.1578
Epoch 7/100, (Training, Validation) Trend Loss: 0.2063, 0.1769| Seasonal Loss: 0.1835, 0.1888| Residual Loss: 0.1617, 0.1441
Epoch 8/100, (Training, Validation) Trend Loss: 0.1924, 0.1657| Seasonal Loss: 0.1580, 0.1484| Residual Loss: 0.1478, 0.1319
Epoch 9/100, (Training, Validation) Trend Loss: 0.1804, 0.1562| Seasonal Loss: 0.1384, 0.1229| Residual Loss: 0.1363, 0.1220
Epoch 10/100, (Training, Validation) Trend Loss: 0.1700, 0.1482| Seasonal Loss: 0.1252, 0.1222| Residual Loss: 0.1276, 0.1131
Epoch 11/100, (Training, Validation) Trend Loss: 0.1610, 0.1414| Seasonal Loss: 0.1256, 0.1168| Residual Loss: 0.1197, 0.1089
Epoch 12/100, (Training, Validation) Trend Loss: 0.1531, 0.1356| Seasonal Loss: 0.1387, 0.1506| Residual Loss: 0.1145, 0.1042
Epoch 13/100, (Training, Validation) Trend Loss: 0.1462, 0.1306| Seasonal Loss: 0.1515, 0.1778| Residual Loss: 0.1113, 0.1099
Epoch 14/100, (Training, Validation) Trend Loss: 0.1402, 0.1262| Seasonal Loss: 0.1199, 0.1626| Residual Loss: 0.1123, 0.1176
Epoch 15/100, (Training, Validation) Trend Loss: 0.1348, 0.1223| Seasonal Loss: 0.1167, 0.1088| Residual Loss: 0.1224, 0.1707
Epoch 16/100, (Training, Validation) Trend Loss: 0.1299, 0.1188| Seasonal Loss: 0.0918, 0.1160| Residual Loss: 0.1371, 0.1814
Epoch 17/100, (Training, Validation) Trend Loss: 0.1256, 0.1157| Seasonal Loss: 0.0841, 0.0994| Residual Loss: 0.1322, 0.1475
Epoch 18/100, (Training, Validation) Trend Loss: 0.1216, 0.1128| Seasonal Loss: 0.0764, 0.0950| Residual Loss: 0.1140, 0.1058
Epoch 19/100, (Training, Validation) Trend Loss: 0.1180, 0.1102| Seasonal Loss: 0.0705, 0.0950| Residual Loss: 0.1009, 0.1020
Epoch 20/100, (Training, Validation) Trend Loss: 0.1147, 0.1078| Seasonal Loss: 0.0653, 0.0878| Residual Loss: 0.0999, 0.1039
Epoch 21/100, (Training, Validation) Trend Loss: 0.1117, 0.1055| Seasonal Loss: 0.0611, 0.0854| Residual Loss: 0.1089, 0.1045
Epoch 22/100, (Training, Validation) Trend Loss: 0.1089, 0.1034| Seasonal Loss: 0.0582, 0.0847| Residual Loss: 0.1407, 0.1069
Epoch 23/100, (Training, Validation) Trend Loss: 0.1063, 0.1015| Seasonal Loss: 0.0551, 0.0812| Residual Loss: 0.1734, 0.0973
Epoch 24/100, (Training, Validation) Trend Loss: 0.1039, 0.0997| Seasonal Loss: 0.0527, 0.0797| Residual Loss: 0.1141, 0.1010
Epoch 25/100, (Training, Validation) Trend Loss: 0.1016, 0.0980| Seasonal Loss: 0.0504, 0.0788| Residual Loss: 0.0995, 0.0959
Epoch 26/100, (Training, Validation) Trend Loss: 0.0995, 0.0964| Seasonal Loss: 0.0483, 0.0775| Residual Loss: 0.0972, 0.0933
Epoch 27/100, (Training, Validation) Trend Loss: 0.0976, 0.0949| Seasonal Loss: 0.0466, 0.0768| Residual Loss: 0.0929, 0.0922
Epoch 28/100, (Training, Validation) Trend Loss: 0.0957, 0.0935| Seasonal Loss: 0.0449, 0.0761| Residual Loss: 0.0907, 0.0907
Epoch 29/100, (Training, Validation) Trend Loss: 0.0940, 0.0922| Seasonal Loss: 0.0434, 0.0754| Residual Loss: 0.0889, 0.0896
Epoch 30/100, (Training, Validation) Trend Loss: 0.0924, 0.0910| Seasonal Loss: 0.0421, 0.0749| Residual Loss: 0.0876, 0.0891
Epoch 31/100, (Training, Validation) Trend Loss: 0.0909, 0.0898| Seasonal Loss: 0.0408, 0.0742| Residual Loss: 0.0864, 0.0886
Epoch 32/100, (Training, Validation) Trend Loss: 0.0895, 0.0887| Seasonal Loss: 0.0397, 0.0737| Residual Loss: 0.0853, 0.0882
Epoch 33/100, (Training, Validation) Trend Loss: 0.0882, 0.0877| Seasonal Loss: 0.0386, 0.0732| Residual Loss: 0.0844, 0.0878
Epoch 34/100, (Training, Validation) Trend Loss: 0.0870, 0.0867| Seasonal Loss: 0.0376, 0.0727| Residual Loss: 0.0836, 0.0875
Epoch 35/100, (Training, Validation) Trend Loss: 0.0858, 0.0858| Seasonal Loss: 0.0367, 0.0723| Residual Loss: 0.0828, 0.0872
Epoch 36/100, (Training, Validation) Trend Loss: 0.0847, 0.0849| Seasonal Loss: 0.0359, 0.0720| Residual Loss: 0.0821, 0.0870
Epoch 37/100, (Training, Validation) Trend Loss: 0.0837, 0.0841| Seasonal Loss: 0.0351, 0.0716| Residual Loss: 0.0814, 0.0867
Epoch 38/100, (Training, Validation) Trend Loss: 0.0827, 0.0833| Seasonal Loss: 0.0344, 0.0713| Residual Loss: 0.0808, 0.0865
Epoch 39/100, (Training, Validation) Trend Loss: 0.0818, 0.0825| Seasonal Loss: 0.0337, 0.0711| Residual Loss: 0.0802, 0.0863
Epoch 40/100, (Training, Validation) Trend Loss: 0.0809, 0.0818| Seasonal Loss: 0.0331, 0.0708| Residual Loss: 0.0797, 0.0861
Epoch 41/100, (Training, Validation) Trend Loss: 0.0801, 0.0812| Seasonal Loss: 0.0325, 0.0706| Residual Loss: 0.0792, 0.0860
Epoch 42/100, (Training, Validation) Trend Loss: 0.0794, 0.0806| Seasonal Loss: 0.0319, 0.0704| Residual Loss: 0.0787, 0.0858
Epoch 43/100, (Training, Validation) Trend Loss: 0.0786, 0.0800| Seasonal Loss: 0.0314, 0.0702| Residual Loss: 0.0782, 0.0857
Epoch 44/100, (Training, Validation) Trend Loss: 0.0779, 0.0794| Seasonal Loss: 0.0309, 0.0700| Residual Loss: 0.0778, 0.0856
Epoch 45/100, (Training, Validation) Trend Loss: 0.0773, 0.0789| Seasonal Loss: 0.0305, 0.0698| Residual Loss: 0.0774, 0.0855
Epoch 46/100, (Training, Validation) Trend Loss: 0.0767, 0.0784| Seasonal Loss: 0.0301, 0.0697| Residual Loss: 0.0770, 0.0854
Epoch 47/100, (Training, Validation) Trend Loss: 0.0761, 0.0779| Seasonal Loss: 0.0297, 0.0696| Residual Loss: 0.0766, 0.0853
Epoch 48/100, (Training, Validation) Trend Loss: 0.0756, 0.0774| Seasonal Loss: 0.0293, 0.0695| Residual Loss: 0.0763, 0.0852
Epoch 49/100, (Training, Validation) Trend Loss: 0.0750, 0.0770| Seasonal Loss: 0.0290, 0.0693| Residual Loss: 0.0759, 0.0851
Epoch 50/100, (Training, Validation) Trend Loss: 0.0746, 0.0766| Seasonal Loss: 0.0287, 0.0692| Residual Loss: 0.0756, 0.0850
Epoch 51/100, (Training, Validation) Trend Loss: 0.0741, 0.0762| Seasonal Loss: 0.0284, 0.0692| Residual Loss: 0.0753, 0.0849
Epoch 52/100, (Training, Validation) Trend Loss: 0.0737, 0.0758| Seasonal Loss: 0.0281, 0.0691| Residual Loss: 0.0750, 0.0849
Epoch 53/100, (Training, Validation) Trend Loss: 0.0732, 0.0755| Seasonal Loss: 0.0278, 0.0690| Residual Loss: 0.0748, 0.0848
Epoch 54/100, (Training, Validation) Trend Loss: 0.0728, 0.0752| Seasonal Loss: 0.0276, 0.0689| Residual Loss: 0.0745, 0.0847
Epoch 55/100, (Training, Validation) Trend Loss: 0.0725, 0.0748| Seasonal Loss: 0.0273, 0.0689| Residual Loss: 0.0743, 0.0847
Epoch 56/100, (Training, Validation) Trend Loss: 0.0721, 0.0745| Seasonal Loss: 0.0271, 0.0688| Residual Loss: 0.0740, 0.0846
Epoch 57/100, (Training, Validation) Trend Loss: 0.0718, 0.0743| Seasonal Loss: 0.0269, 0.0687| Residual Loss: 0.0738, 0.0846
Epoch 58/100, (Training, Validation) Trend Loss: 0.0715, 0.0740| Seasonal Loss: 0.0267, 0.0687| Residual Loss: 0.0736, 0.0845
Epoch 59/100, (Training, Validation) Trend Loss: 0.0712, 0.0737| Seasonal Loss: 0.0265, 0.0686| Residual Loss: 0.0734, 0.0845
Epoch 60/100, (Training, Validation) Trend Loss: 0.0709, 0.0735| Seasonal Loss: 0.0264, 0.0686| Residual Loss: 0.0732, 0.0844
Epoch 61/100, (Training, Validation) Trend Loss: 0.0706, 0.0732| Seasonal Loss: 0.0262, 0.0685| Residual Loss: 0.0730, 0.0844
Epoch 62/100, (Training, Validation) Trend Loss: 0.0703, 0.0730| Seasonal Loss: 0.0260, 0.0685| Residual Loss: 0.0729, 0.0844
Epoch 63/100, (Training, Validation) Trend Loss: 0.0701, 0.0728| Seasonal Loss: 0.0259, 0.0685| Residual Loss: 0.0727, 0.0843
Epoch 64/100, (Training, Validation) Trend Loss: 0.0699, 0.0726| Seasonal Loss: 0.0257, 0.0684| Residual Loss: 0.0725, 0.0843
Epoch 65/100, (Training, Validation) Trend Loss: 0.0696, 0.0724| Seasonal Loss: 0.0256, 0.0684| Residual Loss: 0.0724, 0.0843
Epoch 66/100, (Training, Validation) Trend Loss: 0.0694, 0.0722| Seasonal Loss: 0.0255, 0.0684| Residual Loss: 0.0723, 0.0842
Epoch 67/100, (Training, Validation) Trend Loss: 0.0692, 0.0720| Seasonal Loss: 0.0254, 0.0684| Residual Loss: 0.0721, 0.0842
Epoch 68/100, (Training, Validation) Trend Loss: 0.0690, 0.0719| Seasonal Loss: 0.0253, 0.0683| Residual Loss: 0.0720, 0.0842
Epoch 69/100, (Training, Validation) Trend Loss: 0.0689, 0.0717| Seasonal Loss: 0.0252, 0.0683| Residual Loss: 0.0719, 0.0842
Epoch 70/100, (Training, Validation) Trend Loss: 0.0687, 0.0716| Seasonal Loss: 0.0251, 0.0683| Residual Loss: 0.0717, 0.0841
Epoch 71/100, (Training, Validation) Trend Loss: 0.0685, 0.0714| Seasonal Loss: 0.0250, 0.0683| Residual Loss: 0.0716, 0.0841
Epoch 72/100, (Training, Validation) Trend Loss: 0.0684, 0.0713| Seasonal Loss: 0.0249, 0.0682| Residual Loss: 0.0715, 0.0841
Epoch 73/100, (Training, Validation) Trend Loss: 0.0682, 0.0711| Seasonal Loss: 0.0248, 0.0682| Residual Loss: 0.0714, 0.0841
Epoch 74/100, (Training, Validation) Trend Loss: 0.0681, 0.0710| Seasonal Loss: 0.0247, 0.0682| Residual Loss: 0.0713, 0.0840
Epoch 75/100, (Training, Validation) Trend Loss: 0.0679, 0.0709| Seasonal Loss: 0.0246, 0.0682| Residual Loss: 0.0712, 0.0840
Epoch 76/100, (Training, Validation) Trend Loss: 0.0678, 0.0708| Seasonal Loss: 0.0246, 0.0682| Residual Loss: 0.0712, 0.0840
Epoch 77/100, (Training, Validation) Trend Loss: 0.0677, 0.0707| Seasonal Loss: 0.0245, 0.0682| Residual Loss: 0.0711, 0.0840
Epoch 78/100, (Training, Validation) Trend Loss: 0.0676, 0.0706| Seasonal Loss: 0.0244, 0.0682| Residual Loss: 0.0710, 0.0840
Epoch 79/100, (Training, Validation) Trend Loss: 0.0675, 0.0705| Seasonal Loss: 0.0244, 0.0681| Residual Loss: 0.0709, 0.0840
Epoch 80/100, (Training, Validation) Trend Loss: 0.0673, 0.0704| Seasonal Loss: 0.0243, 0.0681| Residual Loss: 0.0708, 0.0839
Epoch 81/100, (Training, Validation) Trend Loss: 0.0672, 0.0703| Seasonal Loss: 0.0242, 0.0681| Residual Loss: 0.0708, 0.0839
Epoch 82/100, (Training, Validation) Trend Loss: 0.0671, 0.0702| Seasonal Loss: 0.0242, 0.0681| Residual Loss: 0.0707, 0.0839
Epoch 83/100, (Training, Validation) Trend Loss: 0.0671, 0.0701| Seasonal Loss: 0.0241, 0.0681| Residual Loss: 0.0706, 0.0839
Epoch 84/100, (Training, Validation) Trend Loss: 0.0670, 0.0700| Seasonal Loss: 0.0241, 0.0681| Residual Loss: 0.0706, 0.0839
Epoch 85/100, (Training, Validation) Trend Loss: 0.0669, 0.0700| Seasonal Loss: 0.0240, 0.0681| Residual Loss: 0.0705, 0.0839
Epoch 86/100, (Training, Validation) Trend Loss: 0.0668, 0.0699| Seasonal Loss: 0.0240, 0.0681| Residual Loss: 0.0705, 0.0839
Epoch 87/100, (Training, Validation) Trend Loss: 0.0667, 0.0698| Seasonal Loss: 0.0240, 0.0681| Residual Loss: 0.0704, 0.0839
Epoch 88/100, (Training, Validation) Trend Loss: 0.0667, 0.0698| Seasonal Loss: 0.0239, 0.0681| Residual Loss: 0.0704, 0.0838
Epoch 89/100, (Training, Validation) Trend Loss: 0.0666, 0.0697| Seasonal Loss: 0.0239, 0.0681| Residual Loss: 0.0703, 0.0838
Epoch 90/100, (Training, Validation) Trend Loss: 0.0665, 0.0696| Seasonal Loss: 0.0238, 0.0681| Residual Loss: 0.0703, 0.0838
Epoch 91/100, (Training, Validation) Trend Loss: 0.0665, 0.0696| Seasonal Loss: 0.0238, 0.0681| Residual Loss: 0.0702, 0.0838
Epoch 92/100, (Training, Validation) Trend Loss: 0.0664, 0.0695| Seasonal Loss: 0.0238, 0.0680| Residual Loss: 0.0702, 0.0838
Epoch 93/100, (Training, Validation) Trend Loss: 0.0664, 0.0695| Seasonal Loss: 0.0238, 0.0680| Residual Loss: 0.0702, 0.0838
Epoch 94/100, (Training, Validation) Trend Loss: 0.0663, 0.0694| Seasonal Loss: 0.0237, 0.0680| Residual Loss: 0.0701, 0.0838
Epoch 95/100, (Training, Validation) Trend Loss: 0.0662, 0.0694| Seasonal Loss: 0.0237, 0.0680| Residual Loss: 0.0701, 0.0838
Epoch 96/100, (Training, Validation) Trend Loss: 0.0662, 0.0693| Seasonal Loss: 0.0237, 0.0680| Residual Loss: 0.0700, 0.0838
Epoch 97/100, (Training, Validation) Trend Loss: 0.0662, 0.0693| Seasonal Loss: 0.0236, 0.0680| Residual Loss: 0.0700, 0.0838
Epoch 98/100, (Training, Validation) Trend Loss: 0.0661, 0.0692| Seasonal Loss: 0.0236, 0.0680| Residual Loss: 0.0700, 0.0838
Epoch 99/100, (Training, Validation) Trend Loss: 0.0661, 0.0692| Seasonal Loss: 0.0236, 0.0680| Residual Loss: 0.0700, 0.0838
Epoch 100/100, (Training, Validation) Trend Loss: 0.0660, 0.0692| Seasonal Loss: 0.0236, 0.0680| Residual Loss: 0.0699, 0.0838
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[166.03659046]
[-0.08380835]
[0.86684478]
[166.81962689]
actual_stock_price: [171.57913208 173.9239502  174.03326416 173.079422   170.45640564
 170.73460388 171.87722778 174.30149841 176.15948486 176.10980225]
add_predicted_stock_price: [171.57913208 173.9239502  174.03326416 173.079422   170.45640564
 170.73460388 171.87722778 174.30149841 176.15948486 166.81962689]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
