[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 3.1131, 0.1811| Seasonal Loss: 2.1499, 0.3981| Residual Loss: 0.6834, 0.5624
Epoch 2/100, (Training, Validation) Trend Loss: 0.7164, 0.3167| Seasonal Loss: 0.6643, 0.2512| Residual Loss: 0.4995, 0.4873
Epoch 3/100, (Training, Validation) Trend Loss: 0.2748, 0.2375| Seasonal Loss: 0.3112, 0.2193| Residual Loss: 0.4325, 0.4379
Epoch 4/100, (Training, Validation) Trend Loss: 0.3223, 0.5724| Seasonal Loss: 0.3179, 0.4374| Residual Loss: 0.3832, 0.4010
Epoch 5/100, (Training, Validation) Trend Loss: 0.4835, 0.2317| Seasonal Loss: 0.3418, 0.4141| Residual Loss: 0.3473, 0.3737
Epoch 6/100, (Training, Validation) Trend Loss: 0.2750, 0.1558| Seasonal Loss: 0.2276, 0.2540| Residual Loss: 0.3191, 0.3519
Epoch 7/100, (Training, Validation) Trend Loss: 0.1888, 0.1779| Seasonal Loss: 0.1641, 0.1819| Residual Loss: 0.2961, 0.3339
Epoch 8/100, (Training, Validation) Trend Loss: 0.1224, 0.0893| Seasonal Loss: 0.1036, 0.1396| Residual Loss: 0.2775, 0.3187
Epoch 9/100, (Training, Validation) Trend Loss: 0.1053, 0.1380| Seasonal Loss: 0.0841, 0.1261| Residual Loss: 0.2618, 0.3053
Epoch 10/100, (Training, Validation) Trend Loss: 0.0835, 0.0709| Seasonal Loss: 0.0668, 0.1154| Residual Loss: 0.2483, 0.2936
Epoch 11/100, (Training, Validation) Trend Loss: 0.0708, 0.0555| Seasonal Loss: 0.0734, 0.1478| Residual Loss: 0.2367, 0.2831
Epoch 12/100, (Training, Validation) Trend Loss: 0.0542, 0.0651| Seasonal Loss: 0.1251, 0.2584| Residual Loss: 0.2267, 0.2739
Epoch 13/100, (Training, Validation) Trend Loss: 0.0452, 0.0348| Seasonal Loss: 0.1336, 0.1866| Residual Loss: 0.2179, 0.2658
Epoch 14/100, (Training, Validation) Trend Loss: 0.0517, 0.0916| Seasonal Loss: 0.0974, 0.1654| Residual Loss: 0.2102, 0.2585
Epoch 15/100, (Training, Validation) Trend Loss: 0.0834, 0.1144| Seasonal Loss: 0.0750, 0.1543| Residual Loss: 0.2035, 0.2520
Epoch 16/100, (Training, Validation) Trend Loss: 0.1407, 0.2043| Seasonal Loss: 0.0636, 0.1206| Residual Loss: 0.1976, 0.2461
Epoch 17/100, (Training, Validation) Trend Loss: 0.1134, 0.0924| Seasonal Loss: 0.0495, 0.1027| Residual Loss: 0.1923, 0.2408
Epoch 18/100, (Training, Validation) Trend Loss: 0.0751, 0.0732| Seasonal Loss: 0.0409, 0.1073| Residual Loss: 0.1877, 0.2360
Epoch 19/100, (Training, Validation) Trend Loss: 0.0600, 0.0720| Seasonal Loss: 0.0376, 0.0964| Residual Loss: 0.1835, 0.2317
Epoch 20/100, (Training, Validation) Trend Loss: 0.0483, 0.0764| Seasonal Loss: 0.0334, 0.0950| Residual Loss: 0.1797, 0.2277
Epoch 21/100, (Training, Validation) Trend Loss: 0.0406, 0.0588| Seasonal Loss: 0.0373, 0.0935| Residual Loss: 0.1764, 0.2241
Epoch 22/100, (Training, Validation) Trend Loss: 0.0372, 0.0470| Seasonal Loss: 0.0483, 0.1109| Residual Loss: 0.1733, 0.2207
Epoch 23/100, (Training, Validation) Trend Loss: 0.0348, 0.0530| Seasonal Loss: 0.0896, 0.1070| Residual Loss: 0.1706, 0.2177
Epoch 24/100, (Training, Validation) Trend Loss: 0.0402, 0.0409| Seasonal Loss: 0.0545, 0.1168| Residual Loss: 0.1680, 0.2148
Epoch 25/100, (Training, Validation) Trend Loss: 0.0424, 0.0390| Seasonal Loss: 0.0517, 0.0980| Residual Loss: 0.1657, 0.2122
Epoch 26/100, (Training, Validation) Trend Loss: 0.0563, 0.0387| Seasonal Loss: 0.0382, 0.0952| Residual Loss: 0.1636, 0.2098
Epoch 27/100, (Training, Validation) Trend Loss: 0.0375, 0.0316| Seasonal Loss: 0.0297, 0.0919| Residual Loss: 0.1617, 0.2076
Epoch 28/100, (Training, Validation) Trend Loss: 0.0266, 0.0348| Seasonal Loss: 0.0301, 0.0897| Residual Loss: 0.1599, 0.2056
Epoch 29/100, (Training, Validation) Trend Loss: 0.0271, 0.0354| Seasonal Loss: 0.0264, 0.0906| Residual Loss: 0.1583, 0.2037
Epoch 30/100, (Training, Validation) Trend Loss: 0.0251, 0.0271| Seasonal Loss: 0.0251, 0.0889| Residual Loss: 0.1567, 0.2019
Epoch 31/100, (Training, Validation) Trend Loss: 0.0225, 0.0290| Seasonal Loss: 0.0235, 0.0853| Residual Loss: 0.1553, 0.2003
Epoch 32/100, (Training, Validation) Trend Loss: 0.0212, 0.0293| Seasonal Loss: 0.0222, 0.0837| Residual Loss: 0.1540, 0.1987
Epoch 33/100, (Training, Validation) Trend Loss: 0.0200, 0.0250| Seasonal Loss: 0.0214, 0.0834| Residual Loss: 0.1528, 0.1973
Epoch 34/100, (Training, Validation) Trend Loss: 0.0194, 0.0250| Seasonal Loss: 0.0204, 0.0829| Residual Loss: 0.1517, 0.1960
Epoch 35/100, (Training, Validation) Trend Loss: 0.0184, 0.0242| Seasonal Loss: 0.0197, 0.0819| Residual Loss: 0.1506, 0.1948
Epoch 36/100, (Training, Validation) Trend Loss: 0.0175, 0.0223| Seasonal Loss: 0.0190, 0.0813| Residual Loss: 0.1496, 0.1936
Epoch 37/100, (Training, Validation) Trend Loss: 0.0171, 0.0222| Seasonal Loss: 0.0184, 0.0810| Residual Loss: 0.1487, 0.1925
Epoch 38/100, (Training, Validation) Trend Loss: 0.0165, 0.0214| Seasonal Loss: 0.0179, 0.0804| Residual Loss: 0.1478, 0.1915
Epoch 39/100, (Training, Validation) Trend Loss: 0.0160, 0.0205| Seasonal Loss: 0.0174, 0.0797| Residual Loss: 0.1470, 0.1906
Epoch 40/100, (Training, Validation) Trend Loss: 0.0156, 0.0202| Seasonal Loss: 0.0170, 0.0792| Residual Loss: 0.1463, 0.1897
Epoch 41/100, (Training, Validation) Trend Loss: 0.0152, 0.0196| Seasonal Loss: 0.0167, 0.0788| Residual Loss: 0.1456, 0.1888
Epoch 42/100, (Training, Validation) Trend Loss: 0.0149, 0.0191| Seasonal Loss: 0.0164, 0.0784| Residual Loss: 0.1449, 0.1881
Epoch 43/100, (Training, Validation) Trend Loss: 0.0146, 0.0188| Seasonal Loss: 0.0161, 0.0780| Residual Loss: 0.1443, 0.1873
Epoch 44/100, (Training, Validation) Trend Loss: 0.0144, 0.0184| Seasonal Loss: 0.0158, 0.0777| Residual Loss: 0.1437, 0.1866
Epoch 45/100, (Training, Validation) Trend Loss: 0.0141, 0.0181| Seasonal Loss: 0.0155, 0.0774| Residual Loss: 0.1431, 0.1860
Epoch 46/100, (Training, Validation) Trend Loss: 0.0139, 0.0178| Seasonal Loss: 0.0153, 0.0771| Residual Loss: 0.1426, 0.1853
Epoch 47/100, (Training, Validation) Trend Loss: 0.0137, 0.0175| Seasonal Loss: 0.0151, 0.0769| Residual Loss: 0.1421, 0.1848
Epoch 48/100, (Training, Validation) Trend Loss: 0.0136, 0.0173| Seasonal Loss: 0.0149, 0.0766| Residual Loss: 0.1416, 0.1842
Epoch 49/100, (Training, Validation) Trend Loss: 0.0134, 0.0170| Seasonal Loss: 0.0147, 0.0764| Residual Loss: 0.1412, 0.1837
Epoch 50/100, (Training, Validation) Trend Loss: 0.0133, 0.0168| Seasonal Loss: 0.0146, 0.0761| Residual Loss: 0.1408, 0.1832
Epoch 51/100, (Training, Validation) Trend Loss: 0.0131, 0.0166| Seasonal Loss: 0.0144, 0.0760| Residual Loss: 0.1404, 0.1828
Epoch 52/100, (Training, Validation) Trend Loss: 0.0130, 0.0165| Seasonal Loss: 0.0143, 0.0758| Residual Loss: 0.1400, 0.1823
Epoch 53/100, (Training, Validation) Trend Loss: 0.0129, 0.0163| Seasonal Loss: 0.0142, 0.0756| Residual Loss: 0.1397, 0.1819
Epoch 54/100, (Training, Validation) Trend Loss: 0.0128, 0.0162| Seasonal Loss: 0.0140, 0.0754| Residual Loss: 0.1393, 0.1815
Epoch 55/100, (Training, Validation) Trend Loss: 0.0127, 0.0161| Seasonal Loss: 0.0139, 0.0753| Residual Loss: 0.1390, 0.1811
Epoch 56/100, (Training, Validation) Trend Loss: 0.0126, 0.0159| Seasonal Loss: 0.0138, 0.0751| Residual Loss: 0.1387, 0.1808
Epoch 57/100, (Training, Validation) Trend Loss: 0.0125, 0.0158| Seasonal Loss: 0.0137, 0.0750| Residual Loss: 0.1384, 0.1805
Epoch 58/100, (Training, Validation) Trend Loss: 0.0125, 0.0157| Seasonal Loss: 0.0136, 0.0749| Residual Loss: 0.1382, 0.1802
Epoch 59/100, (Training, Validation) Trend Loss: 0.0124, 0.0156| Seasonal Loss: 0.0136, 0.0748| Residual Loss: 0.1379, 0.1799
Epoch 60/100, (Training, Validation) Trend Loss: 0.0123, 0.0155| Seasonal Loss: 0.0135, 0.0747| Residual Loss: 0.1377, 0.1796
Epoch 61/100, (Training, Validation) Trend Loss: 0.0123, 0.0154| Seasonal Loss: 0.0134, 0.0746| Residual Loss: 0.1375, 0.1793
Epoch 62/100, (Training, Validation) Trend Loss: 0.0122, 0.0154| Seasonal Loss: 0.0133, 0.0745| Residual Loss: 0.1372, 0.1791
Epoch 63/100, (Training, Validation) Trend Loss: 0.0121, 0.0153| Seasonal Loss: 0.0133, 0.0744| Residual Loss: 0.1370, 0.1788
Epoch 64/100, (Training, Validation) Trend Loss: 0.0121, 0.0152| Seasonal Loss: 0.0132, 0.0743| Residual Loss: 0.1369, 0.1786
Epoch 65/100, (Training, Validation) Trend Loss: 0.0121, 0.0152| Seasonal Loss: 0.0131, 0.0742| Residual Loss: 0.1367, 0.1784
Epoch 66/100, (Training, Validation) Trend Loss: 0.0120, 0.0151| Seasonal Loss: 0.0131, 0.0741| Residual Loss: 0.1365, 0.1782
Epoch 67/100, (Training, Validation) Trend Loss: 0.0120, 0.0150| Seasonal Loss: 0.0130, 0.0741| Residual Loss: 0.1363, 0.1780
Epoch 68/100, (Training, Validation) Trend Loss: 0.0119, 0.0150| Seasonal Loss: 0.0130, 0.0740| Residual Loss: 0.1362, 0.1778
Epoch 69/100, (Training, Validation) Trend Loss: 0.0119, 0.0149| Seasonal Loss: 0.0129, 0.0739| Residual Loss: 0.1360, 0.1776
Epoch 70/100, (Training, Validation) Trend Loss: 0.0119, 0.0149| Seasonal Loss: 0.0129, 0.0739| Residual Loss: 0.1359, 0.1775
Epoch 71/100, (Training, Validation) Trend Loss: 0.0118, 0.0148| Seasonal Loss: 0.0128, 0.0738| Residual Loss: 0.1357, 0.1773
Epoch 72/100, (Training, Validation) Trend Loss: 0.0118, 0.0148| Seasonal Loss: 0.0128, 0.0738| Residual Loss: 0.1356, 0.1772
Epoch 73/100, (Training, Validation) Trend Loss: 0.0118, 0.0148| Seasonal Loss: 0.0128, 0.0737| Residual Loss: 0.1355, 0.1770
Epoch 74/100, (Training, Validation) Trend Loss: 0.0117, 0.0147| Seasonal Loss: 0.0127, 0.0737| Residual Loss: 0.1354, 0.1769
Epoch 75/100, (Training, Validation) Trend Loss: 0.0117, 0.0147| Seasonal Loss: 0.0127, 0.0736| Residual Loss: 0.1353, 0.1767
Epoch 76/100, (Training, Validation) Trend Loss: 0.0117, 0.0147| Seasonal Loss: 0.0127, 0.0736| Residual Loss: 0.1352, 0.1766
Epoch 77/100, (Training, Validation) Trend Loss: 0.0117, 0.0146| Seasonal Loss: 0.0126, 0.0736| Residual Loss: 0.1351, 0.1765
Epoch 78/100, (Training, Validation) Trend Loss: 0.0116, 0.0146| Seasonal Loss: 0.0126, 0.0735| Residual Loss: 0.1350, 0.1764
Epoch 79/100, (Training, Validation) Trend Loss: 0.0116, 0.0146| Seasonal Loss: 0.0126, 0.0735| Residual Loss: 0.1349, 0.1763
Epoch 80/100, (Training, Validation) Trend Loss: 0.0116, 0.0145| Seasonal Loss: 0.0125, 0.0735| Residual Loss: 0.1348, 0.1762
Epoch 81/100, (Training, Validation) Trend Loss: 0.0116, 0.0145| Seasonal Loss: 0.0125, 0.0734| Residual Loss: 0.1347, 0.1761
Epoch 82/100, (Training, Validation) Trend Loss: 0.0116, 0.0145| Seasonal Loss: 0.0125, 0.0734| Residual Loss: 0.1346, 0.1760
Epoch 83/100, (Training, Validation) Trend Loss: 0.0115, 0.0145| Seasonal Loss: 0.0125, 0.0734| Residual Loss: 0.1346, 0.1759
Epoch 84/100, (Training, Validation) Trend Loss: 0.0115, 0.0145| Seasonal Loss: 0.0124, 0.0733| Residual Loss: 0.1345, 0.1758
Epoch 85/100, (Training, Validation) Trend Loss: 0.0115, 0.0144| Seasonal Loss: 0.0124, 0.0733| Residual Loss: 0.1344, 0.1758
Epoch 86/100, (Training, Validation) Trend Loss: 0.0115, 0.0144| Seasonal Loss: 0.0124, 0.0733| Residual Loss: 0.1344, 0.1757
Epoch 87/100, (Training, Validation) Trend Loss: 0.0115, 0.0144| Seasonal Loss: 0.0124, 0.0733| Residual Loss: 0.1343, 0.1756
Epoch 88/100, (Training, Validation) Trend Loss: 0.0115, 0.0144| Seasonal Loss: 0.0124, 0.0732| Residual Loss: 0.1343, 0.1756
Epoch 89/100, (Training, Validation) Trend Loss: 0.0115, 0.0144| Seasonal Loss: 0.0124, 0.0732| Residual Loss: 0.1342, 0.1755
Epoch 90/100, (Training, Validation) Trend Loss: 0.0114, 0.0143| Seasonal Loss: 0.0123, 0.0732| Residual Loss: 0.1342, 0.1754
Epoch 91/100, (Training, Validation) Trend Loss: 0.0114, 0.0143| Seasonal Loss: 0.0123, 0.0732| Residual Loss: 0.1341, 0.1754
Epoch 92/100, (Training, Validation) Trend Loss: 0.0114, 0.0143| Seasonal Loss: 0.0123, 0.0732| Residual Loss: 0.1341, 0.1753
Epoch 93/100, (Training, Validation) Trend Loss: 0.0114, 0.0143| Seasonal Loss: 0.0123, 0.0732| Residual Loss: 0.1340, 0.1753
Epoch 94/100, (Training, Validation) Trend Loss: 0.0114, 0.0143| Seasonal Loss: 0.0123, 0.0731| Residual Loss: 0.1340, 0.1752
Epoch 95/100, (Training, Validation) Trend Loss: 0.0114, 0.0143| Seasonal Loss: 0.0123, 0.0731| Residual Loss: 0.1339, 0.1752
Epoch 96/100, (Training, Validation) Trend Loss: 0.0114, 0.0143| Seasonal Loss: 0.0123, 0.0731| Residual Loss: 0.1339, 0.1751
Epoch 97/100, (Training, Validation) Trend Loss: 0.0114, 0.0143| Seasonal Loss: 0.0122, 0.0731| Residual Loss: 0.1339, 0.1751
Epoch 98/100, (Training, Validation) Trend Loss: 0.0114, 0.0142| Seasonal Loss: 0.0122, 0.0731| Residual Loss: 0.1338, 0.1750
Epoch 99/100, (Training, Validation) Trend Loss: 0.0114, 0.0142| Seasonal Loss: 0.0122, 0.0731| Residual Loss: 0.1338, 0.1750
Epoch 100/100, (Training, Validation) Trend Loss: 0.0113, 0.0142| Seasonal Loss: 0.0122, 0.0731| Residual Loss: 0.1338, 0.1750
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[168.14406967]
[-0.62111454]
[3.70934258]
[171.23229772]
actual_stock_price: [171.57913208 173.9239502  174.0332489  173.079422   170.45640564
 170.73460388 171.87721252 174.30151367 176.1594696  176.10980225]
add_predicted_stock_price: [171.57913208 173.9239502  174.0332489  173.079422   170.45640564
 170.73460388 171.87721252 174.30151367 176.1594696  171.23229772]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
