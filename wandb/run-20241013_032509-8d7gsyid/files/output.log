[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.3667, 0.2471| Seasonal Loss: 0.6697, 0.3305| Residual Loss: 0.5042, 0.4660
Epoch 2/100, (Training, Validation) Trend Loss: 0.1398, 0.1673| Seasonal Loss: 0.4278, 0.3680| Residual Loss: 0.3881, 0.3645
Epoch 3/100, (Training, Validation) Trend Loss: 0.1444, 0.2534| Seasonal Loss: 0.3974, 0.4773| Residual Loss: 0.3300, 0.2375
Epoch 4/100, (Training, Validation) Trend Loss: 0.1449, 0.2816| Seasonal Loss: 0.3550, 0.2599| Residual Loss: 0.2756, 0.1897
Epoch 5/100, (Training, Validation) Trend Loss: 0.1622, 0.1391| Seasonal Loss: 0.2558, 0.2527| Residual Loss: 0.2021, 0.1774
Epoch 6/100, (Training, Validation) Trend Loss: 0.0922, 0.0788| Seasonal Loss: 0.2021, 0.1830| Residual Loss: 0.1810, 0.1530
Epoch 7/100, (Training, Validation) Trend Loss: 0.0642, 0.0831| Seasonal Loss: 0.1636, 0.1532| Residual Loss: 0.1636, 0.1397
Epoch 8/100, (Training, Validation) Trend Loss: 0.0549, 0.0728| Seasonal Loss: 0.1382, 0.1284| Residual Loss: 0.1487, 0.1247
Epoch 9/100, (Training, Validation) Trend Loss: 0.0475, 0.0485| Seasonal Loss: 0.1192, 0.1186| Residual Loss: 0.1375, 0.1200
Epoch 10/100, (Training, Validation) Trend Loss: 0.0412, 0.0602| Seasonal Loss: 0.1051, 0.1048| Residual Loss: 0.1291, 0.1085
Epoch 11/100, (Training, Validation) Trend Loss: 0.0357, 0.0404| Seasonal Loss: 0.0955, 0.1076| Residual Loss: 0.1277, 0.1277
Epoch 12/100, (Training, Validation) Trend Loss: 0.0433, 0.0772| Seasonal Loss: 0.0854, 0.1004| Residual Loss: 0.1278, 0.1364
Epoch 13/100, (Training, Validation) Trend Loss: 0.0436, 0.0440| Seasonal Loss: 0.0831, 0.1023| Residual Loss: 0.1493, 0.2150
Epoch 14/100, (Training, Validation) Trend Loss: 0.0746, 0.1758| Seasonal Loss: 0.0844, 0.1090| Residual Loss: 0.1571, 0.1958
Epoch 15/100, (Training, Validation) Trend Loss: 0.0789, 0.0807| Seasonal Loss: 0.0934, 0.1469| Residual Loss: 0.1639, 0.1449
Epoch 16/100, (Training, Validation) Trend Loss: 0.0792, 0.0873| Seasonal Loss: 0.1535, 0.1555| Residual Loss: 0.1516, 0.1113
Epoch 17/100, (Training, Validation) Trend Loss: 0.0475, 0.0628| Seasonal Loss: 0.1826, 0.2146| Residual Loss: 0.1646, 0.1083
Epoch 18/100, (Training, Validation) Trend Loss: 0.0412, 0.0415| Seasonal Loss: 0.1998, 0.1742| Residual Loss: 0.1371, 0.1052
Epoch 19/100, (Training, Validation) Trend Loss: 0.0334, 0.0567| Seasonal Loss: 0.1261, 0.1245| Residual Loss: 0.1126, 0.0973
Epoch 20/100, (Training, Validation) Trend Loss: 0.0338, 0.0395| Seasonal Loss: 0.0884, 0.1193| Residual Loss: 0.1076, 0.0945
Epoch 21/100, (Training, Validation) Trend Loss: 0.0313, 0.0524| Seasonal Loss: 0.0763, 0.1070| Residual Loss: 0.1030, 0.0913
Epoch 22/100, (Training, Validation) Trend Loss: 0.0482, 0.0531| Seasonal Loss: 0.0678, 0.1022| Residual Loss: 0.0996, 0.0890
Epoch 23/100, (Training, Validation) Trend Loss: 0.0694, 0.0845| Seasonal Loss: 0.0617, 0.0999| Residual Loss: 0.0971, 0.0879
Epoch 24/100, (Training, Validation) Trend Loss: 0.1763, 0.0700| Seasonal Loss: 0.0581, 0.0996| Residual Loss: 0.0952, 0.0866
Epoch 25/100, (Training, Validation) Trend Loss: 0.1014, 0.0629| Seasonal Loss: 0.0553, 0.0962| Residual Loss: 0.0935, 0.0856
Epoch 26/100, (Training, Validation) Trend Loss: 0.0473, 0.0584| Seasonal Loss: 0.0536, 0.0992| Residual Loss: 0.0920, 0.0847
Epoch 27/100, (Training, Validation) Trend Loss: 0.0400, 0.0471| Seasonal Loss: 0.0523, 0.0969| Residual Loss: 0.0906, 0.0839
Epoch 28/100, (Training, Validation) Trend Loss: 0.0319, 0.0394| Seasonal Loss: 0.0532, 0.1047| Residual Loss: 0.0893, 0.0832
Epoch 29/100, (Training, Validation) Trend Loss: 0.0274, 0.0372| Seasonal Loss: 0.0538, 0.1021| Residual Loss: 0.0881, 0.0826
Epoch 30/100, (Training, Validation) Trend Loss: 0.0256, 0.0324| Seasonal Loss: 0.0571, 0.1064| Residual Loss: 0.0870, 0.0821
Epoch 31/100, (Training, Validation) Trend Loss: 0.0242, 0.0302| Seasonal Loss: 0.0568, 0.0960| Residual Loss: 0.0859, 0.0817
Epoch 32/100, (Training, Validation) Trend Loss: 0.0233, 0.0286| Seasonal Loss: 0.0552, 0.0928| Residual Loss: 0.0849, 0.0813
Epoch 33/100, (Training, Validation) Trend Loss: 0.0226, 0.0271| Seasonal Loss: 0.0496, 0.0876| Residual Loss: 0.0839, 0.0809
Epoch 34/100, (Training, Validation) Trend Loss: 0.0220, 0.0263| Seasonal Loss: 0.0452, 0.0869| Residual Loss: 0.0830, 0.0806
Epoch 35/100, (Training, Validation) Trend Loss: 0.0215, 0.0255| Seasonal Loss: 0.0425, 0.0865| Residual Loss: 0.0822, 0.0803
Epoch 36/100, (Training, Validation) Trend Loss: 0.0210, 0.0249| Seasonal Loss: 0.0412, 0.0859| Residual Loss: 0.0814, 0.0800
Epoch 37/100, (Training, Validation) Trend Loss: 0.0206, 0.0243| Seasonal Loss: 0.0402, 0.0855| Residual Loss: 0.0807, 0.0798
Epoch 38/100, (Training, Validation) Trend Loss: 0.0202, 0.0239| Seasonal Loss: 0.0395, 0.0850| Residual Loss: 0.0799, 0.0796
Epoch 39/100, (Training, Validation) Trend Loss: 0.0199, 0.0234| Seasonal Loss: 0.0387, 0.0844| Residual Loss: 0.0793, 0.0794
Epoch 40/100, (Training, Validation) Trend Loss: 0.0195, 0.0231| Seasonal Loss: 0.0381, 0.0839| Residual Loss: 0.0786, 0.0792
Epoch 41/100, (Training, Validation) Trend Loss: 0.0193, 0.0227| Seasonal Loss: 0.0375, 0.0834| Residual Loss: 0.0780, 0.0791
Epoch 42/100, (Training, Validation) Trend Loss: 0.0190, 0.0224| Seasonal Loss: 0.0369, 0.0830| Residual Loss: 0.0775, 0.0789
Epoch 43/100, (Training, Validation) Trend Loss: 0.0187, 0.0222| Seasonal Loss: 0.0364, 0.0826| Residual Loss: 0.0769, 0.0788
Epoch 44/100, (Training, Validation) Trend Loss: 0.0185, 0.0219| Seasonal Loss: 0.0359, 0.0822| Residual Loss: 0.0764, 0.0787
Epoch 45/100, (Training, Validation) Trend Loss: 0.0182, 0.0217| Seasonal Loss: 0.0355, 0.0818| Residual Loss: 0.0759, 0.0786
Epoch 46/100, (Training, Validation) Trend Loss: 0.0180, 0.0215| Seasonal Loss: 0.0351, 0.0815| Residual Loss: 0.0754, 0.0785
Epoch 47/100, (Training, Validation) Trend Loss: 0.0178, 0.0213| Seasonal Loss: 0.0347, 0.0812| Residual Loss: 0.0750, 0.0784
Epoch 48/100, (Training, Validation) Trend Loss: 0.0176, 0.0211| Seasonal Loss: 0.0343, 0.0809| Residual Loss: 0.0746, 0.0783
Epoch 49/100, (Training, Validation) Trend Loss: 0.0175, 0.0209| Seasonal Loss: 0.0339, 0.0807| Residual Loss: 0.0742, 0.0782
Epoch 50/100, (Training, Validation) Trend Loss: 0.0173, 0.0207| Seasonal Loss: 0.0336, 0.0804| Residual Loss: 0.0738, 0.0782
Epoch 51/100, (Training, Validation) Trend Loss: 0.0171, 0.0206| Seasonal Loss: 0.0333, 0.0802| Residual Loss: 0.0734, 0.0781
Epoch 52/100, (Training, Validation) Trend Loss: 0.0170, 0.0204| Seasonal Loss: 0.0330, 0.0800| Residual Loss: 0.0731, 0.0781
Epoch 53/100, (Training, Validation) Trend Loss: 0.0169, 0.0203| Seasonal Loss: 0.0327, 0.0798| Residual Loss: 0.0727, 0.0780
Epoch 54/100, (Training, Validation) Trend Loss: 0.0167, 0.0202| Seasonal Loss: 0.0325, 0.0796| Residual Loss: 0.0724, 0.0780
Epoch 55/100, (Training, Validation) Trend Loss: 0.0166, 0.0201| Seasonal Loss: 0.0322, 0.0794| Residual Loss: 0.0721, 0.0779
Epoch 56/100, (Training, Validation) Trend Loss: 0.0165, 0.0199| Seasonal Loss: 0.0320, 0.0792| Residual Loss: 0.0718, 0.0779
Epoch 57/100, (Training, Validation) Trend Loss: 0.0164, 0.0198| Seasonal Loss: 0.0318, 0.0790| Residual Loss: 0.0716, 0.0778
Epoch 58/100, (Training, Validation) Trend Loss: 0.0163, 0.0197| Seasonal Loss: 0.0316, 0.0789| Residual Loss: 0.0713, 0.0778
Epoch 59/100, (Training, Validation) Trend Loss: 0.0162, 0.0196| Seasonal Loss: 0.0314, 0.0788| Residual Loss: 0.0711, 0.0778
Epoch 60/100, (Training, Validation) Trend Loss: 0.0161, 0.0195| Seasonal Loss: 0.0312, 0.0786| Residual Loss: 0.0708, 0.0777
Epoch 61/100, (Training, Validation) Trend Loss: 0.0160, 0.0195| Seasonal Loss: 0.0310, 0.0785| Residual Loss: 0.0706, 0.0777
Epoch 62/100, (Training, Validation) Trend Loss: 0.0159, 0.0194| Seasonal Loss: 0.0309, 0.0784| Residual Loss: 0.0704, 0.0777
Epoch 63/100, (Training, Validation) Trend Loss: 0.0158, 0.0193| Seasonal Loss: 0.0307, 0.0783| Residual Loss: 0.0702, 0.0776
Epoch 64/100, (Training, Validation) Trend Loss: 0.0157, 0.0192| Seasonal Loss: 0.0306, 0.0782| Residual Loss: 0.0700, 0.0776
Epoch 65/100, (Training, Validation) Trend Loss: 0.0157, 0.0191| Seasonal Loss: 0.0304, 0.0781| Residual Loss: 0.0698, 0.0776
Epoch 66/100, (Training, Validation) Trend Loss: 0.0156, 0.0191| Seasonal Loss: 0.0303, 0.0780| Residual Loss: 0.0697, 0.0776
Epoch 67/100, (Training, Validation) Trend Loss: 0.0155, 0.0190| Seasonal Loss: 0.0302, 0.0779| Residual Loss: 0.0695, 0.0776
Epoch 68/100, (Training, Validation) Trend Loss: 0.0155, 0.0190| Seasonal Loss: 0.0301, 0.0778| Residual Loss: 0.0693, 0.0775
Epoch 69/100, (Training, Validation) Trend Loss: 0.0154, 0.0189| Seasonal Loss: 0.0299, 0.0777| Residual Loss: 0.0692, 0.0775
Epoch 70/100, (Training, Validation) Trend Loss: 0.0154, 0.0188| Seasonal Loss: 0.0298, 0.0776| Residual Loss: 0.0691, 0.0775
Epoch 71/100, (Training, Validation) Trend Loss: 0.0153, 0.0188| Seasonal Loss: 0.0297, 0.0776| Residual Loss: 0.0689, 0.0775
Epoch 72/100, (Training, Validation) Trend Loss: 0.0152, 0.0187| Seasonal Loss: 0.0296, 0.0775| Residual Loss: 0.0688, 0.0775
Epoch 73/100, (Training, Validation) Trend Loss: 0.0152, 0.0187| Seasonal Loss: 0.0295, 0.0774| Residual Loss: 0.0687, 0.0775
Epoch 74/100, (Training, Validation) Trend Loss: 0.0152, 0.0186| Seasonal Loss: 0.0294, 0.0774| Residual Loss: 0.0686, 0.0774
Epoch 75/100, (Training, Validation) Trend Loss: 0.0151, 0.0186| Seasonal Loss: 0.0294, 0.0773| Residual Loss: 0.0684, 0.0774
Epoch 76/100, (Training, Validation) Trend Loss: 0.0151, 0.0186| Seasonal Loss: 0.0293, 0.0773| Residual Loss: 0.0683, 0.0774
Epoch 77/100, (Training, Validation) Trend Loss: 0.0150, 0.0185| Seasonal Loss: 0.0292, 0.0772| Residual Loss: 0.0682, 0.0774
Epoch 78/100, (Training, Validation) Trend Loss: 0.0150, 0.0185| Seasonal Loss: 0.0291, 0.0772| Residual Loss: 0.0681, 0.0774
Epoch 79/100, (Training, Validation) Trend Loss: 0.0150, 0.0185| Seasonal Loss: 0.0291, 0.0771| Residual Loss: 0.0680, 0.0774
Epoch 80/100, (Training, Validation) Trend Loss: 0.0149, 0.0184| Seasonal Loss: 0.0290, 0.0771| Residual Loss: 0.0680, 0.0774
Epoch 81/100, (Training, Validation) Trend Loss: 0.0149, 0.0184| Seasonal Loss: 0.0289, 0.0770| Residual Loss: 0.0679, 0.0774
Epoch 82/100, (Training, Validation) Trend Loss: 0.0149, 0.0184| Seasonal Loss: 0.0289, 0.0770| Residual Loss: 0.0678, 0.0774
Epoch 83/100, (Training, Validation) Trend Loss: 0.0148, 0.0183| Seasonal Loss: 0.0288, 0.0769| Residual Loss: 0.0677, 0.0773
Epoch 84/100, (Training, Validation) Trend Loss: 0.0148, 0.0183| Seasonal Loss: 0.0288, 0.0769| Residual Loss: 0.0676, 0.0773
Epoch 85/100, (Training, Validation) Trend Loss: 0.0148, 0.0183| Seasonal Loss: 0.0287, 0.0769| Residual Loss: 0.0676, 0.0773
Epoch 86/100, (Training, Validation) Trend Loss: 0.0147, 0.0182| Seasonal Loss: 0.0287, 0.0768| Residual Loss: 0.0675, 0.0773
Epoch 87/100, (Training, Validation) Trend Loss: 0.0147, 0.0182| Seasonal Loss: 0.0286, 0.0768| Residual Loss: 0.0675, 0.0773
Epoch 88/100, (Training, Validation) Trend Loss: 0.0147, 0.0182| Seasonal Loss: 0.0286, 0.0768| Residual Loss: 0.0674, 0.0773
Epoch 89/100, (Training, Validation) Trend Loss: 0.0147, 0.0182| Seasonal Loss: 0.0285, 0.0767| Residual Loss: 0.0673, 0.0773
Epoch 90/100, (Training, Validation) Trend Loss: 0.0147, 0.0182| Seasonal Loss: 0.0285, 0.0767| Residual Loss: 0.0673, 0.0773
Epoch 91/100, (Training, Validation) Trend Loss: 0.0146, 0.0181| Seasonal Loss: 0.0284, 0.0767| Residual Loss: 0.0672, 0.0773
Epoch 92/100, (Training, Validation) Trend Loss: 0.0146, 0.0181| Seasonal Loss: 0.0284, 0.0767| Residual Loss: 0.0672, 0.0773
Epoch 93/100, (Training, Validation) Trend Loss: 0.0146, 0.0181| Seasonal Loss: 0.0284, 0.0766| Residual Loss: 0.0671, 0.0773
Epoch 94/100, (Training, Validation) Trend Loss: 0.0146, 0.0181| Seasonal Loss: 0.0283, 0.0766| Residual Loss: 0.0671, 0.0773
Epoch 95/100, (Training, Validation) Trend Loss: 0.0146, 0.0181| Seasonal Loss: 0.0283, 0.0766| Residual Loss: 0.0670, 0.0773
Epoch 96/100, (Training, Validation) Trend Loss: 0.0145, 0.0180| Seasonal Loss: 0.0283, 0.0766| Residual Loss: 0.0670, 0.0773
Epoch 97/100, (Training, Validation) Trend Loss: 0.0145, 0.0180| Seasonal Loss: 0.0282, 0.0766| Residual Loss: 0.0670, 0.0773
Epoch 98/100, (Training, Validation) Trend Loss: 0.0145, 0.0180| Seasonal Loss: 0.0282, 0.0765| Residual Loss: 0.0669, 0.0773
Epoch 99/100, (Training, Validation) Trend Loss: 0.0145, 0.0180| Seasonal Loss: 0.0282, 0.0765| Residual Loss: 0.0669, 0.0773
Epoch 100/100, (Training, Validation) Trend Loss: 0.0145, 0.0180| Seasonal Loss: 0.0282, 0.0765| Residual Loss: 0.0669, 0.0773
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:229: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:230: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:231: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[169.35166006]
[-1.20647054]
[0.54724965]
[168.69243917]
actual_stock_price: [171.57914734 173.9239502  174.0332489  173.07940674 170.45640564
 170.73458862 171.87721252 174.30149841 176.1594696  176.10980225]
add_predicted_stock_price: [171.57914734 173.9239502  174.0332489  173.07940674 170.45640564
 170.73458862 171.87721252 174.30149841 176.1594696  168.69243917]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:277: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
