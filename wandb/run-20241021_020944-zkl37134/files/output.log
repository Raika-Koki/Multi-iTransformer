[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.520719, 0.395045| Seasonal Loss: 0.3905, 0.7161| Residual Loss: 1.0393, 2.0123
Epoch 2/100, (Training, Validation) Trend Loss: 0.383273, 0.119052| Seasonal Loss: 0.4067, 0.4795| Residual Loss: 0.3275, 1.1041
Epoch 3/100, (Training, Validation) Trend Loss: 0.114476, 0.090312| Seasonal Loss: 0.2104, 0.4103| Residual Loss: 0.2481, 0.9507
Epoch 4/100, (Training, Validation) Trend Loss: 0.093011, 0.068870| Seasonal Loss: 0.1487, 0.2933| Residual Loss: 0.2125, 0.8964
Epoch 5/100, (Training, Validation) Trend Loss: 0.114808, 0.075374| Seasonal Loss: 0.1341, 0.2306| Residual Loss: 0.1873, 0.8563
Epoch 6/100, (Training, Validation) Trend Loss: 0.097517, 0.132508| Seasonal Loss: 0.1452, 0.1783| Residual Loss: 0.1688, 0.8282
Epoch 7/100, (Training, Validation) Trend Loss: 0.066163, 0.088192| Seasonal Loss: 0.1425, 0.1771| Residual Loss: 0.1548, 0.8075
Epoch 8/100, (Training, Validation) Trend Loss: 0.054015, 0.057834| Seasonal Loss: 0.1168, 0.1648| Residual Loss: 0.1440, 0.7907
Epoch 9/100, (Training, Validation) Trend Loss: 0.054309, 0.034574| Seasonal Loss: 0.0932, 0.1495| Residual Loss: 0.1354, 0.7762
Epoch 10/100, (Training, Validation) Trend Loss: 0.053884, 0.025489| Seasonal Loss: 0.0781, 0.1422| Residual Loss: 0.1285, 0.7632
Epoch 11/100, (Training, Validation) Trend Loss: 0.044520, 0.025010| Seasonal Loss: 0.0713, 0.1390| Residual Loss: 0.1229, 0.7513
Epoch 12/100, (Training, Validation) Trend Loss: 0.039029, 0.023402| Seasonal Loss: 0.0705, 0.1380| Residual Loss: 0.1182, 0.7400
Epoch 13/100, (Training, Validation) Trend Loss: 0.038396, 0.024101| Seasonal Loss: 0.0768, 0.1257| Residual Loss: 0.1142, 0.7294
Epoch 14/100, (Training, Validation) Trend Loss: 0.034051, 0.036137| Seasonal Loss: 0.0878, 0.1163| Residual Loss: 0.1108, 0.7192
Epoch 15/100, (Training, Validation) Trend Loss: 0.026161, 0.049736| Seasonal Loss: 0.0834, 0.1215| Residual Loss: 0.1079, 0.7096
Epoch 16/100, (Training, Validation) Trend Loss: 0.019747, 0.051893| Seasonal Loss: 0.0685, 0.1146| Residual Loss: 0.1053, 0.7003
Epoch 17/100, (Training, Validation) Trend Loss: 0.018228, 0.049983| Seasonal Loss: 0.0590, 0.1098| Residual Loss: 0.1030, 0.6915
Epoch 18/100, (Training, Validation) Trend Loss: 0.023535, 0.040331| Seasonal Loss: 0.0529, 0.1050| Residual Loss: 0.1009, 0.6831
Epoch 19/100, (Training, Validation) Trend Loss: 0.033463, 0.018094| Seasonal Loss: 0.0489, 0.0993| Residual Loss: 0.0991, 0.6751
Epoch 20/100, (Training, Validation) Trend Loss: 0.032650, 0.017190| Seasonal Loss: 0.0464, 0.0954| Residual Loss: 0.0973, 0.6675
Epoch 21/100, (Training, Validation) Trend Loss: 0.020944, 0.018579| Seasonal Loss: 0.0444, 0.0946| Residual Loss: 0.0957, 0.6602
Epoch 22/100, (Training, Validation) Trend Loss: 0.021739, 0.015550| Seasonal Loss: 0.0429, 0.0976| Residual Loss: 0.0943, 0.6533
Epoch 23/100, (Training, Validation) Trend Loss: 0.019464, 0.033873| Seasonal Loss: 0.0423, 0.1027| Residual Loss: 0.0929, 0.6467
Epoch 24/100, (Training, Validation) Trend Loss: 0.013354, 0.027807| Seasonal Loss: 0.0438, 0.1018| Residual Loss: 0.0916, 0.6405
Epoch 25/100, (Training, Validation) Trend Loss: 0.011110, 0.019825| Seasonal Loss: 0.0472, 0.0921| Residual Loss: 0.0905, 0.6345
Epoch 26/100, (Training, Validation) Trend Loss: 0.010650, 0.016899| Seasonal Loss: 0.0457, 0.0909| Residual Loss: 0.0894, 0.6289
Epoch 27/100, (Training, Validation) Trend Loss: 0.010480, 0.015487| Seasonal Loss: 0.0400, 0.0889| Residual Loss: 0.0883, 0.6235
Epoch 28/100, (Training, Validation) Trend Loss: 0.010344, 0.014601| Seasonal Loss: 0.0377, 0.0901| Residual Loss: 0.0873, 0.6184
Epoch 29/100, (Training, Validation) Trend Loss: 0.010093, 0.013514| Seasonal Loss: 0.0369, 0.0926| Residual Loss: 0.0864, 0.6135
Epoch 30/100, (Training, Validation) Trend Loss: 0.009719, 0.012781| Seasonal Loss: 0.0358, 0.0936| Residual Loss: 0.0855, 0.6089
Epoch 31/100, (Training, Validation) Trend Loss: 0.009333, 0.012717| Seasonal Loss: 0.0351, 0.0927| Residual Loss: 0.0847, 0.6045
Epoch 32/100, (Training, Validation) Trend Loss: 0.009048, 0.012925| Seasonal Loss: 0.0343, 0.0900| Residual Loss: 0.0839, 0.6004
Epoch 33/100, (Training, Validation) Trend Loss: 0.008859, 0.012914| Seasonal Loss: 0.0332, 0.0869| Residual Loss: 0.0832, 0.5964
Epoch 34/100, (Training, Validation) Trend Loss: 0.008716, 0.012575| Seasonal Loss: 0.0316, 0.0848| Residual Loss: 0.0825, 0.5926
Epoch 35/100, (Training, Validation) Trend Loss: 0.008580, 0.012148| Seasonal Loss: 0.0304, 0.0850| Residual Loss: 0.0819, 0.5890
Epoch 36/100, (Training, Validation) Trend Loss: 0.008437, 0.011839| Seasonal Loss: 0.0296, 0.0869| Residual Loss: 0.0813, 0.5856
Epoch 37/100, (Training, Validation) Trend Loss: 0.008297, 0.011652| Seasonal Loss: 0.0284, 0.0888| Residual Loss: 0.0807, 0.5824
Epoch 38/100, (Training, Validation) Trend Loss: 0.008172, 0.011499| Seasonal Loss: 0.0271, 0.0891| Residual Loss: 0.0801, 0.5793
Epoch 39/100, (Training, Validation) Trend Loss: 0.008063, 0.011324| Seasonal Loss: 0.0262, 0.0882| Residual Loss: 0.0796, 0.5764
Epoch 40/100, (Training, Validation) Trend Loss: 0.007966, 0.011138| Seasonal Loss: 0.0254, 0.0870| Residual Loss: 0.0791, 0.5736
Epoch 41/100, (Training, Validation) Trend Loss: 0.007875, 0.010966| Seasonal Loss: 0.0247, 0.0859| Residual Loss: 0.0786, 0.5709
Epoch 42/100, (Training, Validation) Trend Loss: 0.007790, 0.010812| Seasonal Loss: 0.0241, 0.0857| Residual Loss: 0.0782, 0.5684
Epoch 43/100, (Training, Validation) Trend Loss: 0.007711, 0.010666| Seasonal Loss: 0.0236, 0.0864| Residual Loss: 0.0778, 0.5660
Epoch 44/100, (Training, Validation) Trend Loss: 0.007639, 0.010526| Seasonal Loss: 0.0230, 0.0868| Residual Loss: 0.0774, 0.5637
Epoch 45/100, (Training, Validation) Trend Loss: 0.007572, 0.010395| Seasonal Loss: 0.0226, 0.0865| Residual Loss: 0.0770, 0.5615
Epoch 46/100, (Training, Validation) Trend Loss: 0.007510, 0.010271| Seasonal Loss: 0.0222, 0.0859| Residual Loss: 0.0766, 0.5595
Epoch 47/100, (Training, Validation) Trend Loss: 0.007452, 0.010153| Seasonal Loss: 0.0219, 0.0855| Residual Loss: 0.0763, 0.5575
Epoch 48/100, (Training, Validation) Trend Loss: 0.007399, 0.010042| Seasonal Loss: 0.0216, 0.0856| Residual Loss: 0.0759, 0.5556
Epoch 49/100, (Training, Validation) Trend Loss: 0.007348, 0.009936| Seasonal Loss: 0.0213, 0.0858| Residual Loss: 0.0756, 0.5538
Epoch 50/100, (Training, Validation) Trend Loss: 0.007301, 0.009837| Seasonal Loss: 0.0210, 0.0858| Residual Loss: 0.0753, 0.5521
Epoch 51/100, (Training, Validation) Trend Loss: 0.007257, 0.009742| Seasonal Loss: 0.0208, 0.0856| Residual Loss: 0.0751, 0.5505
Epoch 52/100, (Training, Validation) Trend Loss: 0.007216, 0.009652| Seasonal Loss: 0.0206, 0.0854| Residual Loss: 0.0748, 0.5490
Epoch 53/100, (Training, Validation) Trend Loss: 0.007177, 0.009567| Seasonal Loss: 0.0204, 0.0854| Residual Loss: 0.0745, 0.5475
Epoch 54/100, (Training, Validation) Trend Loss: 0.007140, 0.009486| Seasonal Loss: 0.0202, 0.0855| Residual Loss: 0.0743, 0.5461
Epoch 55/100, (Training, Validation) Trend Loss: 0.007106, 0.009409| Seasonal Loss: 0.0200, 0.0854| Residual Loss: 0.0741, 0.5448
Epoch 56/100, (Training, Validation) Trend Loss: 0.007073, 0.009336| Seasonal Loss: 0.0199, 0.0854| Residual Loss: 0.0739, 0.5435
Epoch 57/100, (Training, Validation) Trend Loss: 0.007043, 0.009266| Seasonal Loss: 0.0197, 0.0853| Residual Loss: 0.0736, 0.5423
Epoch 58/100, (Training, Validation) Trend Loss: 0.007014, 0.009200| Seasonal Loss: 0.0196, 0.0853| Residual Loss: 0.0734, 0.5411
Epoch 59/100, (Training, Validation) Trend Loss: 0.006987, 0.009138| Seasonal Loss: 0.0195, 0.0853| Residual Loss: 0.0733, 0.5400
Epoch 60/100, (Training, Validation) Trend Loss: 0.006961, 0.009077| Seasonal Loss: 0.0194, 0.0853| Residual Loss: 0.0731, 0.5390
Epoch 61/100, (Training, Validation) Trend Loss: 0.006936, 0.009020| Seasonal Loss: 0.0192, 0.0853| Residual Loss: 0.0729, 0.5380
Epoch 62/100, (Training, Validation) Trend Loss: 0.006913, 0.008965| Seasonal Loss: 0.0191, 0.0852| Residual Loss: 0.0727, 0.5370
Epoch 63/100, (Training, Validation) Trend Loss: 0.006891, 0.008914| Seasonal Loss: 0.0190, 0.0852| Residual Loss: 0.0726, 0.5361
Epoch 64/100, (Training, Validation) Trend Loss: 0.006870, 0.008864| Seasonal Loss: 0.0190, 0.0852| Residual Loss: 0.0724, 0.5352
Epoch 65/100, (Training, Validation) Trend Loss: 0.006850, 0.008817| Seasonal Loss: 0.0189, 0.0852| Residual Loss: 0.0723, 0.5344
Epoch 66/100, (Training, Validation) Trend Loss: 0.006832, 0.008772| Seasonal Loss: 0.0188, 0.0852| Residual Loss: 0.0722, 0.5336
Epoch 67/100, (Training, Validation) Trend Loss: 0.006814, 0.008729| Seasonal Loss: 0.0187, 0.0852| Residual Loss: 0.0720, 0.5329
Epoch 68/100, (Training, Validation) Trend Loss: 0.006797, 0.008687| Seasonal Loss: 0.0186, 0.0852| Residual Loss: 0.0719, 0.5322
Epoch 69/100, (Training, Validation) Trend Loss: 0.006780, 0.008648| Seasonal Loss: 0.0186, 0.0852| Residual Loss: 0.0718, 0.5315
Epoch 70/100, (Training, Validation) Trend Loss: 0.006765, 0.008611| Seasonal Loss: 0.0185, 0.0852| Residual Loss: 0.0717, 0.5308
Epoch 71/100, (Training, Validation) Trend Loss: 0.006750, 0.008575| Seasonal Loss: 0.0184, 0.0852| Residual Loss: 0.0716, 0.5302
Epoch 72/100, (Training, Validation) Trend Loss: 0.006736, 0.008540| Seasonal Loss: 0.0184, 0.0852| Residual Loss: 0.0715, 0.5296
Epoch 73/100, (Training, Validation) Trend Loss: 0.006723, 0.008508| Seasonal Loss: 0.0183, 0.0852| Residual Loss: 0.0714, 0.5291
Epoch 74/100, (Training, Validation) Trend Loss: 0.006710, 0.008476| Seasonal Loss: 0.0183, 0.0852| Residual Loss: 0.0713, 0.5285
Epoch 75/100, (Training, Validation) Trend Loss: 0.006698, 0.008446| Seasonal Loss: 0.0182, 0.0852| Residual Loss: 0.0712, 0.5280
Epoch 76/100, (Training, Validation) Trend Loss: 0.006686, 0.008417| Seasonal Loss: 0.0182, 0.0852| Residual Loss: 0.0711, 0.5276
Epoch 77/100, (Training, Validation) Trend Loss: 0.006675, 0.008390| Seasonal Loss: 0.0181, 0.0852| Residual Loss: 0.0711, 0.5271
Epoch 78/100, (Training, Validation) Trend Loss: 0.006664, 0.008364| Seasonal Loss: 0.0181, 0.0852| Residual Loss: 0.0710, 0.5267
Epoch 79/100, (Training, Validation) Trend Loss: 0.006654, 0.008338| Seasonal Loss: 0.0180, 0.0852| Residual Loss: 0.0709, 0.5262
Epoch 80/100, (Training, Validation) Trend Loss: 0.006645, 0.008314| Seasonal Loss: 0.0180, 0.0852| Residual Loss: 0.0709, 0.5258
Epoch 81/100, (Training, Validation) Trend Loss: 0.006635, 0.008291| Seasonal Loss: 0.0180, 0.0852| Residual Loss: 0.0708, 0.5255
Epoch 82/100, (Training, Validation) Trend Loss: 0.006627, 0.008269| Seasonal Loss: 0.0179, 0.0852| Residual Loss: 0.0707, 0.5251
Epoch 83/100, (Training, Validation) Trend Loss: 0.006618, 0.008248| Seasonal Loss: 0.0179, 0.0852| Residual Loss: 0.0707, 0.5248
Epoch 84/100, (Training, Validation) Trend Loss: 0.006610, 0.008227| Seasonal Loss: 0.0179, 0.0852| Residual Loss: 0.0706, 0.5244
Epoch 85/100, (Training, Validation) Trend Loss: 0.006602, 0.008208| Seasonal Loss: 0.0178, 0.0852| Residual Loss: 0.0706, 0.5241
Epoch 86/100, (Training, Validation) Trend Loss: 0.006595, 0.008189| Seasonal Loss: 0.0178, 0.0852| Residual Loss: 0.0705, 0.5238
Epoch 87/100, (Training, Validation) Trend Loss: 0.006588, 0.008171| Seasonal Loss: 0.0178, 0.0852| Residual Loss: 0.0705, 0.5235
Epoch 88/100, (Training, Validation) Trend Loss: 0.006581, 0.008154| Seasonal Loss: 0.0178, 0.0852| Residual Loss: 0.0704, 0.5233
Epoch 89/100, (Training, Validation) Trend Loss: 0.006574, 0.008138| Seasonal Loss: 0.0177, 0.0852| Residual Loss: 0.0704, 0.5230
Epoch 90/100, (Training, Validation) Trend Loss: 0.006568, 0.008122| Seasonal Loss: 0.0177, 0.0852| Residual Loss: 0.0703, 0.5228
Epoch 91/100, (Training, Validation) Trend Loss: 0.006562, 0.008107| Seasonal Loss: 0.0177, 0.0852| Residual Loss: 0.0703, 0.5225
Epoch 92/100, (Training, Validation) Trend Loss: 0.006557, 0.008093| Seasonal Loss: 0.0177, 0.0852| Residual Loss: 0.0703, 0.5223
Epoch 93/100, (Training, Validation) Trend Loss: 0.006551, 0.008079| Seasonal Loss: 0.0176, 0.0852| Residual Loss: 0.0702, 0.5221
Epoch 94/100, (Training, Validation) Trend Loss: 0.006546, 0.008066| Seasonal Loss: 0.0176, 0.0853| Residual Loss: 0.0702, 0.5219
Epoch 95/100, (Training, Validation) Trend Loss: 0.006541, 0.008053| Seasonal Loss: 0.0176, 0.0853| Residual Loss: 0.0702, 0.5217
Epoch 96/100, (Training, Validation) Trend Loss: 0.006536, 0.008041| Seasonal Loss: 0.0176, 0.0853| Residual Loss: 0.0701, 0.5215
Epoch 97/100, (Training, Validation) Trend Loss: 0.006532, 0.008029| Seasonal Loss: 0.0176, 0.0853| Residual Loss: 0.0701, 0.5213
Epoch 98/100, (Training, Validation) Trend Loss: 0.006527, 0.008018| Seasonal Loss: 0.0175, 0.0853| Residual Loss: 0.0701, 0.5212
Epoch 99/100, (Training, Validation) Trend Loss: 0.006523, 0.008007| Seasonal Loss: 0.0175, 0.0853| Residual Loss: 0.0700, 0.5210
Epoch 100/100, (Training, Validation) Trend Loss: 0.006519, 0.007997| Seasonal Loss: 0.0175, 0.0853| Residual Loss: 0.0700, 0.5209
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:246: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:247: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:248: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[152.55390443]
[-14.55292037]
[26.42385595]
[164.42484002]
actual_stock_price: [178.05722046 176.6761322  179.40843201 179.79592896 182.60772705
 182.13078308 182.76669312 184.81344604 183.73045349 183.81987   ]
add_predicted_stock_price: [178.05722046 176.6761322  179.40843201 179.79592896 182.60772705
 182.13078308 182.76669312 184.81344604 183.73045349 164.42484002]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:294: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
