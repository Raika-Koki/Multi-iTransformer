[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.449392, 0.631633| Seasonal Loss: 0.2395, 0.5246| Residual Loss: 1.4995, 0.8938
Epoch 2/100, (Training, Validation) Trend Loss: 0.346162, 0.136837| Seasonal Loss: 0.1627, 0.2305| Residual Loss: 0.8985, 0.6078
Epoch 3/100, (Training, Validation) Trend Loss: 0.108080, 0.131889| Seasonal Loss: 0.1138, 0.2017| Residual Loss: 0.5538, 0.4351
Epoch 4/100, (Training, Validation) Trend Loss: 0.080334, 0.092733| Seasonal Loss: 0.1122, 0.1862| Residual Loss: 0.3570, 0.3417
Epoch 5/100, (Training, Validation) Trend Loss: 0.085003, 0.039222| Seasonal Loss: 0.1082, 0.1863| Residual Loss: 0.2583, 0.2966
Epoch 6/100, (Training, Validation) Trend Loss: 0.066617, 0.032429| Seasonal Loss: 0.1246, 0.1598| Residual Loss: 0.2145, 0.2750
Epoch 7/100, (Training, Validation) Trend Loss: 0.050548, 0.026062| Seasonal Loss: 0.1145, 0.1597| Residual Loss: 0.1950, 0.2625
Epoch 8/100, (Training, Validation) Trend Loss: 0.038618, 0.022148| Seasonal Loss: 0.0873, 0.1483| Residual Loss: 0.1839, 0.2532
Epoch 9/100, (Training, Validation) Trend Loss: 0.028987, 0.021168| Seasonal Loss: 0.0683, 0.1358| Residual Loss: 0.1753, 0.2455
Epoch 10/100, (Training, Validation) Trend Loss: 0.022031, 0.024168| Seasonal Loss: 0.0596, 0.1281| Residual Loss: 0.1678, 0.2387
Epoch 11/100, (Training, Validation) Trend Loss: 0.017313, 0.033102| Seasonal Loss: 0.0559, 0.1236| Residual Loss: 0.1610, 0.2328
Epoch 12/100, (Training, Validation) Trend Loss: 0.014648, 0.051193| Seasonal Loss: 0.0543, 0.1202| Residual Loss: 0.1549, 0.2276
Epoch 13/100, (Training, Validation) Trend Loss: 0.014227, 0.081004| Seasonal Loss: 0.0533, 0.1181| Residual Loss: 0.1493, 0.2229
Epoch 14/100, (Training, Validation) Trend Loss: 0.017561, 0.104967| Seasonal Loss: 0.0525, 0.1177| Residual Loss: 0.1441, 0.2187
Epoch 15/100, (Training, Validation) Trend Loss: 0.027953, 0.061949| Seasonal Loss: 0.0515, 0.1188| Residual Loss: 0.1394, 0.2149
Epoch 16/100, (Training, Validation) Trend Loss: 0.034395, 0.015445| Seasonal Loss: 0.0505, 0.1209| Residual Loss: 0.1351, 0.2115
Epoch 17/100, (Training, Validation) Trend Loss: 0.019306, 0.011685| Seasonal Loss: 0.0495, 0.1235| Residual Loss: 0.1312, 0.2084
Epoch 18/100, (Training, Validation) Trend Loss: 0.011570, 0.009364| Seasonal Loss: 0.0487, 0.1258| Residual Loss: 0.1275, 0.2055
Epoch 19/100, (Training, Validation) Trend Loss: 0.011844, 0.008710| Seasonal Loss: 0.0479, 0.1271| Residual Loss: 0.1242, 0.2029
Epoch 20/100, (Training, Validation) Trend Loss: 0.011040, 0.008631| Seasonal Loss: 0.0472, 0.1275| Residual Loss: 0.1210, 0.2005
Epoch 21/100, (Training, Validation) Trend Loss: 0.010319, 0.008612| Seasonal Loss: 0.0465, 0.1279| Residual Loss: 0.1182, 0.1983
Epoch 22/100, (Training, Validation) Trend Loss: 0.011037, 0.009056| Seasonal Loss: 0.0460, 0.1287| Residual Loss: 0.1155, 0.1963
Epoch 23/100, (Training, Validation) Trend Loss: 0.012041, 0.010376| Seasonal Loss: 0.0456, 0.1300| Residual Loss: 0.1130, 0.1944
Epoch 24/100, (Training, Validation) Trend Loss: 0.010816, 0.010290| Seasonal Loss: 0.0455, 0.1317| Residual Loss: 0.1107, 0.1927
Epoch 25/100, (Training, Validation) Trend Loss: 0.009338, 0.009397| Seasonal Loss: 0.0456, 0.1337| Residual Loss: 0.1086, 0.1911
Epoch 26/100, (Training, Validation) Trend Loss: 0.008267, 0.009115| Seasonal Loss: 0.0459, 0.1353| Residual Loss: 0.1066, 0.1896
Epoch 27/100, (Training, Validation) Trend Loss: 0.007892, 0.008272| Seasonal Loss: 0.0464, 0.1360| Residual Loss: 0.1048, 0.1883
Epoch 28/100, (Training, Validation) Trend Loss: 0.007738, 0.007725| Seasonal Loss: 0.0474, 0.1346| Residual Loss: 0.1031, 0.1870
Epoch 29/100, (Training, Validation) Trend Loss: 0.007534, 0.007440| Seasonal Loss: 0.0485, 0.1306| Residual Loss: 0.1015, 0.1858
Epoch 30/100, (Training, Validation) Trend Loss: 0.007328, 0.007390| Seasonal Loss: 0.0494, 0.1259| Residual Loss: 0.1000, 0.1847
Epoch 31/100, (Training, Validation) Trend Loss: 0.007178, 0.007345| Seasonal Loss: 0.0489, 0.1241| Residual Loss: 0.0986, 0.1837
Epoch 32/100, (Training, Validation) Trend Loss: 0.007060, 0.007214| Seasonal Loss: 0.0470, 0.1259| Residual Loss: 0.0973, 0.1827
Epoch 33/100, (Training, Validation) Trend Loss: 0.006959, 0.007039| Seasonal Loss: 0.0447, 0.1282| Residual Loss: 0.0961, 0.1818
Epoch 34/100, (Training, Validation) Trend Loss: 0.006870, 0.006868| Seasonal Loss: 0.0432, 0.1296| Residual Loss: 0.0949, 0.1810
Epoch 35/100, (Training, Validation) Trend Loss: 0.006789, 0.006737| Seasonal Loss: 0.0424, 0.1302| Residual Loss: 0.0939, 0.1802
Epoch 36/100, (Training, Validation) Trend Loss: 0.006713, 0.006638| Seasonal Loss: 0.0421, 0.1303| Residual Loss: 0.0929, 0.1795
Epoch 37/100, (Training, Validation) Trend Loss: 0.006643, 0.006549| Seasonal Loss: 0.0419, 0.1304| Residual Loss: 0.0919, 0.1788
Epoch 38/100, (Training, Validation) Trend Loss: 0.006579, 0.006462| Seasonal Loss: 0.0417, 0.1306| Residual Loss: 0.0911, 0.1781
Epoch 39/100, (Training, Validation) Trend Loss: 0.006520, 0.006377| Seasonal Loss: 0.0416, 0.1308| Residual Loss: 0.0903, 0.1775
Epoch 40/100, (Training, Validation) Trend Loss: 0.006464, 0.006299| Seasonal Loss: 0.0415, 0.1310| Residual Loss: 0.0895, 0.1770
Epoch 41/100, (Training, Validation) Trend Loss: 0.006413, 0.006227| Seasonal Loss: 0.0413, 0.1312| Residual Loss: 0.0888, 0.1764
Epoch 42/100, (Training, Validation) Trend Loss: 0.006365, 0.006161| Seasonal Loss: 0.0412, 0.1314| Residual Loss: 0.0881, 0.1759
Epoch 43/100, (Training, Validation) Trend Loss: 0.006321, 0.006099| Seasonal Loss: 0.0411, 0.1316| Residual Loss: 0.0874, 0.1755
Epoch 44/100, (Training, Validation) Trend Loss: 0.006279, 0.006041| Seasonal Loss: 0.0410, 0.1318| Residual Loss: 0.0868, 0.1750
Epoch 45/100, (Training, Validation) Trend Loss: 0.006241, 0.005987| Seasonal Loss: 0.0410, 0.1320| Residual Loss: 0.0863, 0.1746
Epoch 46/100, (Training, Validation) Trend Loss: 0.006204, 0.005937| Seasonal Loss: 0.0409, 0.1322| Residual Loss: 0.0857, 0.1742
Epoch 47/100, (Training, Validation) Trend Loss: 0.006170, 0.005889| Seasonal Loss: 0.0408, 0.1324| Residual Loss: 0.0852, 0.1738
Epoch 48/100, (Training, Validation) Trend Loss: 0.006139, 0.005845| Seasonal Loss: 0.0407, 0.1326| Residual Loss: 0.0848, 0.1735
Epoch 49/100, (Training, Validation) Trend Loss: 0.006109, 0.005803| Seasonal Loss: 0.0407, 0.1328| Residual Loss: 0.0843, 0.1731
Epoch 50/100, (Training, Validation) Trend Loss: 0.006081, 0.005764| Seasonal Loss: 0.0406, 0.1330| Residual Loss: 0.0839, 0.1728
Epoch 51/100, (Training, Validation) Trend Loss: 0.006055, 0.005728| Seasonal Loss: 0.0405, 0.1332| Residual Loss: 0.0835, 0.1725
Epoch 52/100, (Training, Validation) Trend Loss: 0.006030, 0.005692| Seasonal Loss: 0.0405, 0.1334| Residual Loss: 0.0831, 0.1722
Epoch 53/100, (Training, Validation) Trend Loss: 0.006007, 0.005660| Seasonal Loss: 0.0404, 0.1336| Residual Loss: 0.0828, 0.1720
Epoch 54/100, (Training, Validation) Trend Loss: 0.005985, 0.005629| Seasonal Loss: 0.0404, 0.1337| Residual Loss: 0.0824, 0.1717
Epoch 55/100, (Training, Validation) Trend Loss: 0.005965, 0.005599| Seasonal Loss: 0.0403, 0.1339| Residual Loss: 0.0821, 0.1715
Epoch 56/100, (Training, Validation) Trend Loss: 0.005945, 0.005572| Seasonal Loss: 0.0403, 0.1341| Residual Loss: 0.0818, 0.1712
Epoch 57/100, (Training, Validation) Trend Loss: 0.005927, 0.005545| Seasonal Loss: 0.0402, 0.1342| Residual Loss: 0.0815, 0.1710
Epoch 58/100, (Training, Validation) Trend Loss: 0.005910, 0.005521| Seasonal Loss: 0.0402, 0.1344| Residual Loss: 0.0813, 0.1708
Epoch 59/100, (Training, Validation) Trend Loss: 0.005894, 0.005497| Seasonal Loss: 0.0401, 0.1346| Residual Loss: 0.0810, 0.1706
Epoch 60/100, (Training, Validation) Trend Loss: 0.005878, 0.005474| Seasonal Loss: 0.0401, 0.1347| Residual Loss: 0.0808, 0.1704
Epoch 61/100, (Training, Validation) Trend Loss: 0.005864, 0.005454| Seasonal Loss: 0.0401, 0.1348| Residual Loss: 0.0805, 0.1703
Epoch 62/100, (Training, Validation) Trend Loss: 0.005850, 0.005433| Seasonal Loss: 0.0400, 0.1350| Residual Loss: 0.0803, 0.1701
Epoch 63/100, (Training, Validation) Trend Loss: 0.005837, 0.005414| Seasonal Loss: 0.0400, 0.1351| Residual Loss: 0.0801, 0.1699
Epoch 64/100, (Training, Validation) Trend Loss: 0.005824, 0.005395| Seasonal Loss: 0.0400, 0.1352| Residual Loss: 0.0799, 0.1698
Epoch 65/100, (Training, Validation) Trend Loss: 0.005812, 0.005378| Seasonal Loss: 0.0399, 0.1354| Residual Loss: 0.0797, 0.1696
Epoch 66/100, (Training, Validation) Trend Loss: 0.005801, 0.005362| Seasonal Loss: 0.0399, 0.1355| Residual Loss: 0.0795, 0.1695
Epoch 67/100, (Training, Validation) Trend Loss: 0.005791, 0.005346| Seasonal Loss: 0.0399, 0.1356| Residual Loss: 0.0794, 0.1694
Epoch 68/100, (Training, Validation) Trend Loss: 0.005781, 0.005331| Seasonal Loss: 0.0398, 0.1357| Residual Loss: 0.0792, 0.1692
Epoch 69/100, (Training, Validation) Trend Loss: 0.005771, 0.005317| Seasonal Loss: 0.0398, 0.1358| Residual Loss: 0.0791, 0.1691
Epoch 70/100, (Training, Validation) Trend Loss: 0.005762, 0.005303| Seasonal Loss: 0.0398, 0.1359| Residual Loss: 0.0789, 0.1690
Epoch 71/100, (Training, Validation) Trend Loss: 0.005753, 0.005290| Seasonal Loss: 0.0398, 0.1360| Residual Loss: 0.0788, 0.1689
Epoch 72/100, (Training, Validation) Trend Loss: 0.005745, 0.005278| Seasonal Loss: 0.0397, 0.1361| Residual Loss: 0.0786, 0.1688
Epoch 73/100, (Training, Validation) Trend Loss: 0.005737, 0.005266| Seasonal Loss: 0.0397, 0.1362| Residual Loss: 0.0785, 0.1687
Epoch 74/100, (Training, Validation) Trend Loss: 0.005730, 0.005255| Seasonal Loss: 0.0397, 0.1363| Residual Loss: 0.0784, 0.1686
Epoch 75/100, (Training, Validation) Trend Loss: 0.005722, 0.005244| Seasonal Loss: 0.0397, 0.1363| Residual Loss: 0.0783, 0.1685
Epoch 76/100, (Training, Validation) Trend Loss: 0.005716, 0.005234| Seasonal Loss: 0.0396, 0.1364| Residual Loss: 0.0782, 0.1684
Epoch 77/100, (Training, Validation) Trend Loss: 0.005709, 0.005224| Seasonal Loss: 0.0396, 0.1365| Residual Loss: 0.0781, 0.1684
Epoch 78/100, (Training, Validation) Trend Loss: 0.005703, 0.005214| Seasonal Loss: 0.0396, 0.1366| Residual Loss: 0.0780, 0.1683
Epoch 79/100, (Training, Validation) Trend Loss: 0.005697, 0.005206| Seasonal Loss: 0.0396, 0.1366| Residual Loss: 0.0779, 0.1682
Epoch 80/100, (Training, Validation) Trend Loss: 0.005691, 0.005197| Seasonal Loss: 0.0396, 0.1367| Residual Loss: 0.0778, 0.1681
Epoch 81/100, (Training, Validation) Trend Loss: 0.005686, 0.005189| Seasonal Loss: 0.0396, 0.1368| Residual Loss: 0.0777, 0.1681
Epoch 82/100, (Training, Validation) Trend Loss: 0.005681, 0.005181| Seasonal Loss: 0.0395, 0.1368| Residual Loss: 0.0777, 0.1680
Epoch 83/100, (Training, Validation) Trend Loss: 0.005676, 0.005173| Seasonal Loss: 0.0395, 0.1369| Residual Loss: 0.0776, 0.1680
Epoch 84/100, (Training, Validation) Trend Loss: 0.005671, 0.005166| Seasonal Loss: 0.0395, 0.1369| Residual Loss: 0.0775, 0.1679
Epoch 85/100, (Training, Validation) Trend Loss: 0.005667, 0.005159| Seasonal Loss: 0.0395, 0.1370| Residual Loss: 0.0774, 0.1678
Epoch 86/100, (Training, Validation) Trend Loss: 0.005663, 0.005153| Seasonal Loss: 0.0395, 0.1370| Residual Loss: 0.0774, 0.1678
Epoch 87/100, (Training, Validation) Trend Loss: 0.005659, 0.005147| Seasonal Loss: 0.0395, 0.1371| Residual Loss: 0.0773, 0.1677
Epoch 88/100, (Training, Validation) Trend Loss: 0.005655, 0.005141| Seasonal Loss: 0.0395, 0.1371| Residual Loss: 0.0773, 0.1677
Epoch 89/100, (Training, Validation) Trend Loss: 0.005651, 0.005135| Seasonal Loss: 0.0395, 0.1372| Residual Loss: 0.0772, 0.1677
Epoch 90/100, (Training, Validation) Trend Loss: 0.005647, 0.005130| Seasonal Loss: 0.0394, 0.1372| Residual Loss: 0.0771, 0.1676
Epoch 91/100, (Training, Validation) Trend Loss: 0.005644, 0.005124| Seasonal Loss: 0.0394, 0.1372| Residual Loss: 0.0771, 0.1676
Epoch 92/100, (Training, Validation) Trend Loss: 0.005641, 0.005119| Seasonal Loss: 0.0394, 0.1373| Residual Loss: 0.0770, 0.1675
Epoch 93/100, (Training, Validation) Trend Loss: 0.005638, 0.005115| Seasonal Loss: 0.0394, 0.1373| Residual Loss: 0.0770, 0.1675
Epoch 94/100, (Training, Validation) Trend Loss: 0.005635, 0.005110| Seasonal Loss: 0.0394, 0.1373| Residual Loss: 0.0770, 0.1675
Epoch 95/100, (Training, Validation) Trend Loss: 0.005632, 0.005106| Seasonal Loss: 0.0394, 0.1374| Residual Loss: 0.0769, 0.1674
Epoch 96/100, (Training, Validation) Trend Loss: 0.005629, 0.005101| Seasonal Loss: 0.0394, 0.1374| Residual Loss: 0.0769, 0.1674
Epoch 97/100, (Training, Validation) Trend Loss: 0.005626, 0.005097| Seasonal Loss: 0.0394, 0.1374| Residual Loss: 0.0768, 0.1674
Epoch 98/100, (Training, Validation) Trend Loss: 0.005624, 0.005094| Seasonal Loss: 0.0394, 0.1375| Residual Loss: 0.0768, 0.1673
Epoch 99/100, (Training, Validation) Trend Loss: 0.005621, 0.005090| Seasonal Loss: 0.0394, 0.1375| Residual Loss: 0.0768, 0.1673
Epoch 100/100, (Training, Validation) Trend Loss: 0.005619, 0.005087| Seasonal Loss: 0.0394, 0.1375| Residual Loss: 0.0767, 0.1673
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:246: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:247: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:248: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[152.08787892]
[-13.39427793]
[23.55811]
[162.25171098]
actual_stock_price: [178.0572052  176.6761322  179.40843201 179.79592896 182.60772705
 182.13079834 182.76669312 184.81344604 183.73043823 183.81987   ]
add_predicted_stock_price: [178.0572052  176.6761322  179.40843201 179.79592896 182.60772705
 182.13079834 182.76669312 184.81344604 183.73043823 162.25171098]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:294: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
