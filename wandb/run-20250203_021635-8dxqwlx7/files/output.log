[32m[I 2025-02-03 02:16:36,700][0m A new study created in memory with name: no-name-864f721d-ca88-4a3c-b759-aabb26d7db23[0m
[32m[I 2025-02-03 02:21:23,490][0m Trial 0 finished with value: 0.07355937045322705 and parameters: {'observation_period_num': 89, 'train_rates': 0.9747630798117973, 'learning_rate': 6.676061957292174e-05, 'batch_size': 20, 'step_size': 15, 'gamma': 0.9248803629675417}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:21:50,433][0m Trial 1 finished with value: 0.1487874337804992 and parameters: {'observation_period_num': 134, 'train_rates': 0.668513360114063, 'learning_rate': 7.323306203674984e-05, 'batch_size': 176, 'step_size': 8, 'gamma': 0.9020502748121323}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:22:15,931][0m Trial 2 finished with value: 0.11621238329471686 and parameters: {'observation_period_num': 237, 'train_rates': 0.8854128323238613, 'learning_rate': 0.0009579568636546565, 'batch_size': 220, 'step_size': 14, 'gamma': 0.9233928150954419}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:22:46,111][0m Trial 3 finished with value: 0.39667848866918815 and parameters: {'observation_period_num': 176, 'train_rates': 0.8761572691447758, 'learning_rate': 6.369798673061248e-06, 'batch_size': 194, 'step_size': 3, 'gamma': 0.8147057192523302}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:23:10,835][0m Trial 4 finished with value: 0.5593751315844803 and parameters: {'observation_period_num': 214, 'train_rates': 0.6845628417029497, 'learning_rate': 2.1486346833679683e-05, 'batch_size': 196, 'step_size': 9, 'gamma': 0.7890547748254567}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:23:43,922][0m Trial 5 finished with value: 0.34257051564292285 and parameters: {'observation_period_num': 118, 'train_rates': 0.6984180286359977, 'learning_rate': 0.00010223507566665067, 'batch_size': 146, 'step_size': 3, 'gamma': 0.8042225535651613}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:24:07,931][0m Trial 6 finished with value: 0.8269679789683398 and parameters: {'observation_period_num': 42, 'train_rates': 0.7086234303854171, 'learning_rate': 1.6952610198606903e-05, 'batch_size': 213, 'step_size': 3, 'gamma': 0.7987200826001816}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:24:50,244][0m Trial 7 finished with value: 0.26161283536961205 and parameters: {'observation_period_num': 234, 'train_rates': 0.8257840690556442, 'learning_rate': 6.208891489740196e-06, 'batch_size': 122, 'step_size': 12, 'gamma': 0.9114849633418488}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:25:17,571][0m Trial 8 finished with value: 0.14966807877442243 and parameters: {'observation_period_num': 34, 'train_rates': 0.6389459653009921, 'learning_rate': 0.00040152623928544343, 'batch_size': 181, 'step_size': 14, 'gamma': 0.8562657873916705}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:26:57,916][0m Trial 9 finished with value: 0.8055166856768787 and parameters: {'observation_period_num': 224, 'train_rates': 0.6560189326023228, 'learning_rate': 9.125587977313385e-06, 'batch_size': 42, 'step_size': 2, 'gamma': 0.8577578859468663}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:33:00,293][0m Trial 10 finished with value: 0.17514346157893157 and parameters: {'observation_period_num': 82, 'train_rates': 0.9865532052094971, 'learning_rate': 1.3207123015858467e-06, 'batch_size': 16, 'step_size': 9, 'gamma': 0.9704658406274714}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:33:25,450][0m Trial 11 finished with value: 0.0911932960152626 and parameters: {'observation_period_num': 156, 'train_rates': 0.9749735130263125, 'learning_rate': 0.0008655594084687975, 'batch_size': 251, 'step_size': 15, 'gamma': 0.9681478276110539}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:33:50,112][0m Trial 12 finished with value: 0.11390753835439682 and parameters: {'observation_period_num': 156, 'train_rates': 0.9768534949782183, 'learning_rate': 0.00018595494236662365, 'batch_size': 253, 'step_size': 12, 'gamma': 0.9836851294644241}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:35:00,722][0m Trial 13 finished with value: 0.13028678913911185 and parameters: {'observation_period_num': 81, 'train_rates': 0.9219600014232037, 'learning_rate': 0.0007199043068549947, 'batch_size': 82, 'step_size': 15, 'gamma': 0.9495579993543416}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:35:57,801][0m Trial 14 finished with value: 0.08169176864032526 and parameters: {'observation_period_num': 93, 'train_rates': 0.771790904356625, 'learning_rate': 0.00027431268800512956, 'batch_size': 92, 'step_size': 12, 'gamma': 0.9459939299912893}. Best is trial 0 with value: 0.07355937045322705.[0m
[32m[I 2025-02-03 02:37:02,952][0m Trial 15 finished with value: 0.07128424096809721 and parameters: {'observation_period_num': 80, 'train_rates': 0.7583220050184202, 'learning_rate': 6.059471016167477e-05, 'batch_size': 76, 'step_size': 11, 'gamma': 0.8839409343827408}. Best is trial 15 with value: 0.07128424096809721.[0m
[32m[I 2025-02-03 02:38:31,945][0m Trial 16 finished with value: 0.04569415238075826 and parameters: {'observation_period_num': 11, 'train_rates': 0.7759758713269315, 'learning_rate': 6.61972812278506e-05, 'batch_size': 58, 'step_size': 7, 'gamma': 0.8847577802951433}. Best is trial 16 with value: 0.04569415238075826.[0m
[32m[I 2025-02-03 02:39:48,170][0m Trial 17 finished with value: 0.10370990686656056 and parameters: {'observation_period_num': 26, 'train_rates': 0.7590232782445363, 'learning_rate': 3.1599817860409456e-05, 'batch_size': 66, 'step_size': 6, 'gamma': 0.7502797125911288}. Best is trial 16 with value: 0.04569415238075826.[0m
[32m[I 2025-02-03 02:40:28,537][0m Trial 18 finished with value: 0.13772658046896327 and parameters: {'observation_period_num': 8, 'train_rates': 0.6043675243388024, 'learning_rate': 0.00014385575257006372, 'batch_size': 113, 'step_size': 6, 'gamma': 0.8812598812223346}. Best is trial 16 with value: 0.04569415238075826.[0m
[32m[I 2025-02-03 02:41:58,630][0m Trial 19 finished with value: 0.3618867137537149 and parameters: {'observation_period_num': 51, 'train_rates': 0.8206112808507604, 'learning_rate': 2.1733538852513982e-06, 'batch_size': 59, 'step_size': 6, 'gamma': 0.8819592018756768}. Best is trial 16 with value: 0.04569415238075826.[0m
[32m[I 2025-02-03 02:42:33,602][0m Trial 20 finished with value: 0.06931716518354661 and parameters: {'observation_period_num': 5, 'train_rates': 0.7364904969572867, 'learning_rate': 4.475954777198756e-05, 'batch_size': 151, 'step_size': 10, 'gamma': 0.8427077673446598}. Best is trial 16 with value: 0.04569415238075826.[0m
[32m[I 2025-02-03 02:43:08,662][0m Trial 21 finished with value: 0.10485646104620348 and parameters: {'observation_period_num': 62, 'train_rates': 0.7434678131313815, 'learning_rate': 5.191583194855074e-05, 'batch_size': 148, 'step_size': 10, 'gamma': 0.8437443029543019}. Best is trial 16 with value: 0.04569415238075826.[0m
[32m[I 2025-02-03 02:44:01,667][0m Trial 22 finished with value: 0.07237555517863205 and parameters: {'observation_period_num': 5, 'train_rates': 0.7315873048546655, 'learning_rate': 3.6521688676165185e-05, 'batch_size': 98, 'step_size': 11, 'gamma': 0.8245025118178383}. Best is trial 16 with value: 0.04569415238075826.[0m
[32m[I 2025-02-03 02:45:59,434][0m Trial 23 finished with value: 0.07491371612124262 and parameters: {'observation_period_num': 22, 'train_rates': 0.8035860247329761, 'learning_rate': 1.2681274045569516e-05, 'batch_size': 44, 'step_size': 8, 'gamma': 0.8984449261669327}. Best is trial 16 with value: 0.04569415238075826.[0m
[32m[I 2025-02-03 02:46:41,390][0m Trial 24 finished with value: 0.12136056572198868 and parameters: {'observation_period_num': 60, 'train_rates': 0.7777882825003937, 'learning_rate': 3.887196480054018e-05, 'batch_size': 129, 'step_size': 5, 'gamma': 0.8423856023180176}. Best is trial 16 with value: 0.04569415238075826.[0m
[32m[I 2025-02-03 02:47:49,970][0m Trial 25 finished with value: 0.10842985810019583 and parameters: {'observation_period_num': 113, 'train_rates': 0.7318886939105789, 'learning_rate': 9.493161870975865e-05, 'batch_size': 70, 'step_size': 8, 'gamma': 0.875958891971776}. Best is trial 16 with value: 0.04569415238075826.[0m
[32m[I 2025-02-03 02:48:25,781][0m Trial 26 finished with value: 0.08601692358830146 and parameters: {'observation_period_num': 23, 'train_rates': 0.8475733113342333, 'learning_rate': 2.3808477272093892e-05, 'batch_size': 163, 'step_size': 10, 'gamma': 0.8330429767134289}. Best is trial 16 with value: 0.04569415238075826.[0m
[32m[I 2025-02-03 02:49:14,934][0m Trial 27 finished with value: 0.06379222838168448 and parameters: {'observation_period_num': 66, 'train_rates': 0.7890564105952256, 'learning_rate': 0.00016165662752790243, 'batch_size': 104, 'step_size': 10, 'gamma': 0.7767112507588626}. Best is trial 16 with value: 0.04569415238075826.[0m
[32m[I 2025-02-03 02:50:02,774][0m Trial 28 finished with value: 0.040726651696446604 and parameters: {'observation_period_num': 7, 'train_rates': 0.7881723865511239, 'learning_rate': 0.0002821656641811478, 'batch_size': 112, 'step_size': 7, 'gamma': 0.7714442419767206}. Best is trial 28 with value: 0.040726651696446604.[0m
[32m[I 2025-02-03 02:50:58,232][0m Trial 29 finished with value: 0.06163312216338358 and parameters: {'observation_period_num': 65, 'train_rates': 0.9345402821458525, 'learning_rate': 0.00040285618260397046, 'batch_size': 107, 'step_size': 5, 'gamma': 0.7663309397345452}. Best is trial 28 with value: 0.040726651696446604.[0m
[33m[W 2025-02-03 02:52:40,360][0m Trial 30 failed with parameters: {'observation_period_num': 40, 'train_rates': 0.92066611524775, 'learning_rate': 0.00044238731167104453, 'batch_size': 35, 'step_size': 5, 'gamma': 0.7500546578509928} because of the following error: KeyboardInterrupt().[0m
Traceback (most recent call last):
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 412, in <lambda>
    study.optimize(lambda trial: objective(trial, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 83, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 32, in train
    output = model(data)
             ^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<@beartype(src.model.iTransformer.forward) at 0x7f5a9631c0e0>", line 66, in forward
  File "/data/student/k2110261/Multi-iTransformer/src/model.py", line 191, in forward
    x = ff_post_norm(x)
        ^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/normalization.py", line 190, in forward
    return F.layer_norm(
           ^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/functional.py", line 2515, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
[33m[W 2025-02-03 02:52:40,387][0m Trial 30 failed with value None.[0m
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 412, in <module>
    study.optimize(lambda trial: objective(trial, depth, dim), n_trials=50) #check
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 412, in <lambda>
    study.optimize(lambda trial: objective(trial, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/nomstl.py", line 83, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 32, in train
    output = model(data)
             ^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<@beartype(src.model.iTransformer.forward) at 0x7f5a9631c0e0>", line 66, in forward
  File "/data/student/k2110261/Multi-iTransformer/src/model.py", line 191, in forward
    x = ff_post_norm(x)
        ^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/normalization.py", line 190, in forward
    return F.layer_norm(
           ^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/functional.py", line 2515, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
