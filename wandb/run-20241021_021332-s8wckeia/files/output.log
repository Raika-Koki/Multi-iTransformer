[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.564468, 0.060042| Seasonal Loss: 0.5234, 0.9631| Residual Loss: 0.9827, 0.8219
Epoch 2/100, (Training, Validation) Trend Loss: 0.552089, 0.676739| Seasonal Loss: 0.5422, 0.7585| Residual Loss: 0.5242, 0.6240
Epoch 3/100, (Training, Validation) Trend Loss: 0.270902, 0.532665| Seasonal Loss: 0.7239, 1.1298| Residual Loss: 0.3381, 0.5248
Epoch 4/100, (Training, Validation) Trend Loss: 0.248958, 0.585958| Seasonal Loss: 0.4489, 0.8436| Residual Loss: 0.2695, 0.4803
Epoch 5/100, (Training, Validation) Trend Loss: 0.210348, 0.158806| Seasonal Loss: 0.6312, 0.8947| Residual Loss: 0.2452, 0.4586
Epoch 6/100, (Training, Validation) Trend Loss: 0.257726, 0.642852| Seasonal Loss: 0.4964, 0.3585| Residual Loss: 0.2309, 0.4436
Epoch 7/100, (Training, Validation) Trend Loss: 0.293935, 0.246018| Seasonal Loss: 0.4031, 0.4331| Residual Loss: 0.2181, 0.4300
Epoch 8/100, (Training, Validation) Trend Loss: 0.400649, 0.431407| Seasonal Loss: 0.2453, 0.3456| Residual Loss: 0.2066, 0.4170
Epoch 9/100, (Training, Validation) Trend Loss: 0.281240, 0.143916| Seasonal Loss: 0.1699, 0.2518| Residual Loss: 0.1965, 0.4050
Epoch 10/100, (Training, Validation) Trend Loss: 0.190509, 0.122245| Seasonal Loss: 0.1430, 0.3989| Residual Loss: 0.1878, 0.3943
Epoch 11/100, (Training, Validation) Trend Loss: 0.122941, 0.172460| Seasonal Loss: 0.1225, 0.2440| Residual Loss: 0.1802, 0.3850
Epoch 12/100, (Training, Validation) Trend Loss: 0.094390, 0.109593| Seasonal Loss: 0.1261, 0.3526| Residual Loss: 0.1736, 0.3769
Epoch 13/100, (Training, Validation) Trend Loss: 0.087574, 0.142892| Seasonal Loss: 0.1044, 0.2782| Residual Loss: 0.1679, 0.3700
Epoch 14/100, (Training, Validation) Trend Loss: 0.079993, 0.125348| Seasonal Loss: 0.0999, 0.2638| Residual Loss: 0.1629, 0.3640
Epoch 15/100, (Training, Validation) Trend Loss: 0.077950, 0.128168| Seasonal Loss: 0.0890, 0.2997| Residual Loss: 0.1585, 0.3589
Epoch 16/100, (Training, Validation) Trend Loss: 0.074499, 0.130120| Seasonal Loss: 0.0832, 0.2458| Residual Loss: 0.1546, 0.3544
Epoch 17/100, (Training, Validation) Trend Loss: 0.072252, 0.123984| Seasonal Loss: 0.0836, 0.2911| Residual Loss: 0.1512, 0.3506
Epoch 18/100, (Training, Validation) Trend Loss: 0.070431, 0.125323| Seasonal Loss: 0.0763, 0.2655| Residual Loss: 0.1482, 0.3472
Epoch 19/100, (Training, Validation) Trend Loss: 0.068528, 0.121104| Seasonal Loss: 0.0725, 0.2448| Residual Loss: 0.1455, 0.3443
Epoch 20/100, (Training, Validation) Trend Loss: 0.067114, 0.118012| Seasonal Loss: 0.0678, 0.2726| Residual Loss: 0.1431, 0.3417
Epoch 21/100, (Training, Validation) Trend Loss: 0.065652, 0.115670| Seasonal Loss: 0.0655, 0.2390| Residual Loss: 0.1410, 0.3394
Epoch 22/100, (Training, Validation) Trend Loss: 0.064352, 0.111293| Seasonal Loss: 0.0646, 0.2470| Residual Loss: 0.1391, 0.3374
Epoch 23/100, (Training, Validation) Trend Loss: 0.063166, 0.108540| Seasonal Loss: 0.0604, 0.2507| Residual Loss: 0.1373, 0.3357
Epoch 24/100, (Training, Validation) Trend Loss: 0.061999, 0.104952| Seasonal Loss: 0.0583, 0.2209| Residual Loss: 0.1357, 0.3341
Epoch 25/100, (Training, Validation) Trend Loss: 0.060951, 0.101477| Seasonal Loss: 0.0578, 0.2434| Residual Loss: 0.1343, 0.3327
Epoch 26/100, (Training, Validation) Trend Loss: 0.059931, 0.098534| Seasonal Loss: 0.0565, 0.2268| Residual Loss: 0.1330, 0.3314
Epoch 27/100, (Training, Validation) Trend Loss: 0.058973, 0.095134| Seasonal Loss: 0.0546, 0.2104| Residual Loss: 0.1318, 0.3303
Epoch 28/100, (Training, Validation) Trend Loss: 0.058073, 0.092276| Seasonal Loss: 0.0521, 0.2313| Residual Loss: 0.1307, 0.3292
Epoch 29/100, (Training, Validation) Trend Loss: 0.057204, 0.089373| Seasonal Loss: 0.0525, 0.2045| Residual Loss: 0.1297, 0.3283
Epoch 30/100, (Training, Validation) Trend Loss: 0.056392, 0.086554| Seasonal Loss: 0.0521, 0.2119| Residual Loss: 0.1287, 0.3274
Epoch 31/100, (Training, Validation) Trend Loss: 0.055612, 0.084039| Seasonal Loss: 0.0496, 0.2110| Residual Loss: 0.1279, 0.3267
Epoch 32/100, (Training, Validation) Trend Loss: 0.054871, 0.081472| Seasonal Loss: 0.0482, 0.1909| Residual Loss: 0.1271, 0.3260
Epoch 33/100, (Training, Validation) Trend Loss: 0.054169, 0.079164| Seasonal Loss: 0.0471, 0.2077| Residual Loss: 0.1263, 0.3253
Epoch 34/100, (Training, Validation) Trend Loss: 0.053496, 0.076943| Seasonal Loss: 0.0471, 0.1906| Residual Loss: 0.1256, 0.3247
Epoch 35/100, (Training, Validation) Trend Loss: 0.052859, 0.074821| Seasonal Loss: 0.0457, 0.1894| Residual Loss: 0.1250, 0.3242
Epoch 36/100, (Training, Validation) Trend Loss: 0.052250, 0.072884| Seasonal Loss: 0.0440, 0.1911| Residual Loss: 0.1244, 0.3236
Epoch 37/100, (Training, Validation) Trend Loss: 0.051669, 0.070996| Seasonal Loss: 0.0433, 0.1790| Residual Loss: 0.1238, 0.3232
Epoch 38/100, (Training, Validation) Trend Loss: 0.051116, 0.069268| Seasonal Loss: 0.0423, 0.1856| Residual Loss: 0.1233, 0.3227
Epoch 39/100, (Training, Validation) Trend Loss: 0.050586, 0.067625| Seasonal Loss: 0.0419, 0.1767| Residual Loss: 0.1228, 0.3223
Epoch 40/100, (Training, Validation) Trend Loss: 0.050081, 0.066076| Seasonal Loss: 0.0410, 0.1761| Residual Loss: 0.1223, 0.3219
Epoch 41/100, (Training, Validation) Trend Loss: 0.049597, 0.064642| Seasonal Loss: 0.0402, 0.1743| Residual Loss: 0.1219, 0.3216
Epoch 42/100, (Training, Validation) Trend Loss: 0.049134, 0.063272| Seasonal Loss: 0.0396, 0.1698| Residual Loss: 0.1215, 0.3213
Epoch 43/100, (Training, Validation) Trend Loss: 0.048691, 0.062003| Seasonal Loss: 0.0390, 0.1702| Residual Loss: 0.1211, 0.3209
Epoch 44/100, (Training, Validation) Trend Loss: 0.048265, 0.060802| Seasonal Loss: 0.0386, 0.1662| Residual Loss: 0.1207, 0.3207
Epoch 45/100, (Training, Validation) Trend Loss: 0.047858, 0.059675| Seasonal Loss: 0.0380, 0.1655| Residual Loss: 0.1204, 0.3204
Epoch 46/100, (Training, Validation) Trend Loss: 0.047466, 0.058618| Seasonal Loss: 0.0376, 0.1631| Residual Loss: 0.1200, 0.3201
Epoch 47/100, (Training, Validation) Trend Loss: 0.047090, 0.057618| Seasonal Loss: 0.0371, 0.1616| Residual Loss: 0.1197, 0.3199
Epoch 48/100, (Training, Validation) Trend Loss: 0.046728, 0.056681| Seasonal Loss: 0.0367, 0.1601| Residual Loss: 0.1194, 0.3197
Epoch 49/100, (Training, Validation) Trend Loss: 0.046380, 0.055795| Seasonal Loss: 0.0363, 0.1584| Residual Loss: 0.1192, 0.3194
Epoch 50/100, (Training, Validation) Trend Loss: 0.046045, 0.054962| Seasonal Loss: 0.0360, 0.1572| Residual Loss: 0.1189, 0.3192
Epoch 51/100, (Training, Validation) Trend Loss: 0.045723, 0.054174| Seasonal Loss: 0.0356, 0.1557| Residual Loss: 0.1187, 0.3191
Epoch 52/100, (Training, Validation) Trend Loss: 0.045412, 0.053430| Seasonal Loss: 0.0353, 0.1545| Residual Loss: 0.1184, 0.3189
Epoch 53/100, (Training, Validation) Trend Loss: 0.045112, 0.052726| Seasonal Loss: 0.0350, 0.1533| Residual Loss: 0.1182, 0.3187
Epoch 54/100, (Training, Validation) Trend Loss: 0.044823, 0.052060| Seasonal Loss: 0.0347, 0.1522| Residual Loss: 0.1180, 0.3185
Epoch 55/100, (Training, Validation) Trend Loss: 0.044544, 0.051431| Seasonal Loss: 0.0344, 0.1511| Residual Loss: 0.1178, 0.3184
Epoch 56/100, (Training, Validation) Trend Loss: 0.044275, 0.050834| Seasonal Loss: 0.0341, 0.1501| Residual Loss: 0.1176, 0.3183
Epoch 57/100, (Training, Validation) Trend Loss: 0.044016, 0.050268| Seasonal Loss: 0.0339, 0.1491| Residual Loss: 0.1174, 0.3181
Epoch 58/100, (Training, Validation) Trend Loss: 0.043765, 0.049731| Seasonal Loss: 0.0336, 0.1482| Residual Loss: 0.1173, 0.3180
Epoch 59/100, (Training, Validation) Trend Loss: 0.043524, 0.049220| Seasonal Loss: 0.0334, 0.1473| Residual Loss: 0.1171, 0.3179
Epoch 60/100, (Training, Validation) Trend Loss: 0.043290, 0.048735| Seasonal Loss: 0.0332, 0.1465| Residual Loss: 0.1169, 0.3178
Epoch 61/100, (Training, Validation) Trend Loss: 0.043065, 0.048273| Seasonal Loss: 0.0329, 0.1457| Residual Loss: 0.1168, 0.3176
Epoch 62/100, (Training, Validation) Trend Loss: 0.042848, 0.047835| Seasonal Loss: 0.0327, 0.1450| Residual Loss: 0.1167, 0.3175
Epoch 63/100, (Training, Validation) Trend Loss: 0.042638, 0.047418| Seasonal Loss: 0.0325, 0.1443| Residual Loss: 0.1165, 0.3174
Epoch 64/100, (Training, Validation) Trend Loss: 0.042436, 0.047021| Seasonal Loss: 0.0324, 0.1437| Residual Loss: 0.1164, 0.3173
Epoch 65/100, (Training, Validation) Trend Loss: 0.042240, 0.046643| Seasonal Loss: 0.0322, 0.1430| Residual Loss: 0.1163, 0.3173
Epoch 66/100, (Training, Validation) Trend Loss: 0.042052, 0.046282| Seasonal Loss: 0.0320, 0.1424| Residual Loss: 0.1162, 0.3172
Epoch 67/100, (Training, Validation) Trend Loss: 0.041870, 0.045939| Seasonal Loss: 0.0318, 0.1419| Residual Loss: 0.1161, 0.3171
Epoch 68/100, (Training, Validation) Trend Loss: 0.041695, 0.045611| Seasonal Loss: 0.0317, 0.1413| Residual Loss: 0.1160, 0.3170
Epoch 69/100, (Training, Validation) Trend Loss: 0.041526, 0.045299| Seasonal Loss: 0.0315, 0.1408| Residual Loss: 0.1159, 0.3169
Epoch 70/100, (Training, Validation) Trend Loss: 0.041363, 0.045000| Seasonal Loss: 0.0314, 0.1403| Residual Loss: 0.1158, 0.3169
Epoch 71/100, (Training, Validation) Trend Loss: 0.041206, 0.044715| Seasonal Loss: 0.0313, 0.1399| Residual Loss: 0.1157, 0.3168
Epoch 72/100, (Training, Validation) Trend Loss: 0.041054, 0.044443| Seasonal Loss: 0.0311, 0.1394| Residual Loss: 0.1156, 0.3167
Epoch 73/100, (Training, Validation) Trend Loss: 0.040909, 0.044183| Seasonal Loss: 0.0310, 0.1390| Residual Loss: 0.1155, 0.3167
Epoch 74/100, (Training, Validation) Trend Loss: 0.040768, 0.043935| Seasonal Loss: 0.0309, 0.1386| Residual Loss: 0.1154, 0.3166
Epoch 75/100, (Training, Validation) Trend Loss: 0.040633, 0.043698| Seasonal Loss: 0.0308, 0.1382| Residual Loss: 0.1154, 0.3166
Epoch 76/100, (Training, Validation) Trend Loss: 0.040503, 0.043472| Seasonal Loss: 0.0307, 0.1379| Residual Loss: 0.1153, 0.3165
Epoch 77/100, (Training, Validation) Trend Loss: 0.040378, 0.043256| Seasonal Loss: 0.0306, 0.1375| Residual Loss: 0.1152, 0.3165
Epoch 78/100, (Training, Validation) Trend Loss: 0.040257, 0.043049| Seasonal Loss: 0.0305, 0.1372| Residual Loss: 0.1152, 0.3164
Epoch 79/100, (Training, Validation) Trend Loss: 0.040141, 0.042852| Seasonal Loss: 0.0304, 0.1369| Residual Loss: 0.1151, 0.3164
Epoch 80/100, (Training, Validation) Trend Loss: 0.040030, 0.042665| Seasonal Loss: 0.0303, 0.1366| Residual Loss: 0.1150, 0.3163
Epoch 81/100, (Training, Validation) Trend Loss: 0.039922, 0.042485| Seasonal Loss: 0.0302, 0.1363| Residual Loss: 0.1150, 0.3163
Epoch 82/100, (Training, Validation) Trend Loss: 0.039819, 0.042314| Seasonal Loss: 0.0301, 0.1360| Residual Loss: 0.1149, 0.3163
Epoch 83/100, (Training, Validation) Trend Loss: 0.039720, 0.042150| Seasonal Loss: 0.0300, 0.1358| Residual Loss: 0.1149, 0.3162
Epoch 84/100, (Training, Validation) Trend Loss: 0.039625, 0.041994| Seasonal Loss: 0.0300, 0.1355| Residual Loss: 0.1148, 0.3162
Epoch 85/100, (Training, Validation) Trend Loss: 0.039534, 0.041844| Seasonal Loss: 0.0299, 0.1353| Residual Loss: 0.1148, 0.3162
Epoch 86/100, (Training, Validation) Trend Loss: 0.039446, 0.041701| Seasonal Loss: 0.0298, 0.1351| Residual Loss: 0.1148, 0.3161
Epoch 87/100, (Training, Validation) Trend Loss: 0.039362, 0.041564| Seasonal Loss: 0.0298, 0.1349| Residual Loss: 0.1147, 0.3161
Epoch 88/100, (Training, Validation) Trend Loss: 0.039281, 0.041434| Seasonal Loss: 0.0297, 0.1347| Residual Loss: 0.1147, 0.3161
Epoch 89/100, (Training, Validation) Trend Loss: 0.039203, 0.041309| Seasonal Loss: 0.0296, 0.1345| Residual Loss: 0.1146, 0.3160
Epoch 90/100, (Training, Validation) Trend Loss: 0.039129, 0.041190| Seasonal Loss: 0.0296, 0.1343| Residual Loss: 0.1146, 0.3160
Epoch 91/100, (Training, Validation) Trend Loss: 0.039057, 0.041076| Seasonal Loss: 0.0295, 0.1341| Residual Loss: 0.1146, 0.3160
Epoch 92/100, (Training, Validation) Trend Loss: 0.038989, 0.040967| Seasonal Loss: 0.0295, 0.1339| Residual Loss: 0.1145, 0.3160
Epoch 93/100, (Training, Validation) Trend Loss: 0.038923, 0.040863| Seasonal Loss: 0.0294, 0.1338| Residual Loss: 0.1145, 0.3159
Epoch 94/100, (Training, Validation) Trend Loss: 0.038860, 0.040763| Seasonal Loss: 0.0294, 0.1336| Residual Loss: 0.1145, 0.3159
Epoch 95/100, (Training, Validation) Trend Loss: 0.038800, 0.040668| Seasonal Loss: 0.0293, 0.1335| Residual Loss: 0.1145, 0.3159
Epoch 96/100, (Training, Validation) Trend Loss: 0.038742, 0.040577| Seasonal Loss: 0.0293, 0.1333| Residual Loss: 0.1144, 0.3159
Epoch 97/100, (Training, Validation) Trend Loss: 0.038687, 0.040491| Seasonal Loss: 0.0293, 0.1332| Residual Loss: 0.1144, 0.3159
Epoch 98/100, (Training, Validation) Trend Loss: 0.038633, 0.040408| Seasonal Loss: 0.0292, 0.1331| Residual Loss: 0.1144, 0.3158
Epoch 99/100, (Training, Validation) Trend Loss: 0.038583, 0.040328| Seasonal Loss: 0.0292, 0.1330| Residual Loss: 0.1144, 0.3158
Epoch 100/100, (Training, Validation) Trend Loss: 0.038534, 0.040253| Seasonal Loss: 0.0291, 0.1328| Residual Loss: 0.1143, 0.3158
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:246: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:247: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:248: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[153.97012169]
[-12.67334207]
[20.66541282]
[161.96219245]
actual_stock_price: [178.0572052  176.6761322  179.40844727 179.79592896 182.60771179
 182.13079834 182.76670837 184.81344604 183.73045349 183.81985474]
add_predicted_stock_price: [178.0572052  176.6761322  179.40844727 179.79592896 182.60771179
 182.13079834 182.76670837 184.81344604 183.73045349 161.96219245]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:294: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
