ÊúÄÈÅ©ÂåñÂØæË±°: trend
[32m[I 2025-01-05 15:34:40,634][0m A new study created in memory with name: no-name-25f26a8c-0795-4dca-aae0-d5f22bc32456[0m
[32m[I 2025-01-05 15:35:09,791][0m Trial 0 finished with value: 0.6747034618221096 and parameters: {'observation_period_num': 202, 'train_rates': 0.6811369968669897, 'learning_rate': 1.272680553808529e-06, 'batch_size': 177, 'step_size': 12, 'gamma': 0.864471011314579}. Best is trial 0 with value: 0.6747034618221096.[0m
[32m[I 2025-01-05 15:35:57,763][0m Trial 1 finished with value: 0.5630971665183703 and parameters: {'observation_period_num': 120, 'train_rates': 0.6443188294801322, 'learning_rate': 4.86525596228351e-06, 'batch_size': 92, 'step_size': 8, 'gamma': 0.7505131719310046}. Best is trial 1 with value: 0.5630971665183703.[0m
[32m[I 2025-01-05 15:37:08,849][0m Trial 2 finished with value: 0.25966752984264785 and parameters: {'observation_period_num': 206, 'train_rates': 0.6497258379717837, 'learning_rate': 0.0007981258455930112, 'batch_size': 61, 'step_size': 15, 'gamma': 0.763369462809832}. Best is trial 2 with value: 0.25966752984264785.[0m
[32m[I 2025-01-05 15:37:42,332][0m Trial 3 finished with value: 0.10264565795660019 and parameters: {'observation_period_num': 109, 'train_rates': 0.9270858830549027, 'learning_rate': 3.3355088157104414e-05, 'batch_size': 213, 'step_size': 9, 'gamma': 0.8166612697239324}. Best is trial 3 with value: 0.10264565795660019.[0m
[32m[I 2025-01-05 15:38:33,533][0m Trial 4 finished with value: 0.16223210096359253 and parameters: {'observation_period_num': 158, 'train_rates': 0.9598731240791176, 'learning_rate': 1.3610676351308671e-05, 'batch_size': 113, 'step_size': 3, 'gamma': 0.9232383540133021}. Best is trial 3 with value: 0.10264565795660019.[0m
[32m[I 2025-01-05 15:39:18,610][0m Trial 5 finished with value: 0.19379875332870208 and parameters: {'observation_period_num': 171, 'train_rates': 0.900604419630417, 'learning_rate': 6.0796251315373204e-06, 'batch_size': 126, 'step_size': 11, 'gamma': 0.8253440192466172}. Best is trial 3 with value: 0.10264565795660019.[0m
[32m[I 2025-01-05 15:40:30,376][0m Trial 6 finished with value: 0.24194653807802402 and parameters: {'observation_period_num': 203, 'train_rates': 0.8633079199058037, 'learning_rate': 4.329369827568665e-06, 'batch_size': 72, 'step_size': 3, 'gamma': 0.932083633400533}. Best is trial 3 with value: 0.10264565795660019.[0m
[32m[I 2025-01-05 15:41:54,263][0m Trial 7 finished with value: 0.21669389227671282 and parameters: {'observation_period_num': 157, 'train_rates': 0.6096542085729495, 'learning_rate': 0.0008616163081436533, 'batch_size': 50, 'step_size': 2, 'gamma': 0.9099743324082851}. Best is trial 3 with value: 0.10264565795660019.[0m
[32m[I 2025-01-05 15:42:20,778][0m Trial 8 finished with value: 0.23320839965022733 and parameters: {'observation_period_num': 31, 'train_rates': 0.6184590937014448, 'learning_rate': 1.2051760529819735e-05, 'batch_size': 248, 'step_size': 11, 'gamma': 0.8869900587447435}. Best is trial 3 with value: 0.10264565795660019.[0m
[32m[I 2025-01-05 15:43:38,393][0m Trial 9 finished with value: 0.09509477646727311 and parameters: {'observation_period_num': 167, 'train_rates': 0.9184396774326318, 'learning_rate': 0.00036972569852966754, 'batch_size': 72, 'step_size': 11, 'gamma': 0.8308759660224827}. Best is trial 9 with value: 0.09509477646727311.[0m
[32m[I 2025-01-05 15:48:29,546][0m Trial 10 finished with value: 0.10395572252316758 and parameters: {'observation_period_num': 66, 'train_rates': 0.7874722703347634, 'learning_rate': 0.0001392766144203081, 'batch_size': 17, 'step_size': 6, 'gamma': 0.9860802372089448}. Best is trial 9 with value: 0.09509477646727311.[0m
[32m[I 2025-01-05 15:49:05,924][0m Trial 11 finished with value: 0.08693061023950577 and parameters: {'observation_period_num': 98, 'train_rates': 0.9650863608761888, 'learning_rate': 9.520334775007731e-05, 'batch_size': 188, 'step_size': 8, 'gamma': 0.811326586623991}. Best is trial 11 with value: 0.08693061023950577.[0m
[32m[I 2025-01-05 15:49:44,195][0m Trial 12 finished with value: 0.09781024605035782 and parameters: {'observation_period_num': 251, 'train_rates': 0.9762744333611866, 'learning_rate': 0.000150648598342171, 'batch_size': 164, 'step_size': 7, 'gamma': 0.8106508444690227}. Best is trial 11 with value: 0.08693061023950577.[0m
[32m[I 2025-01-05 15:50:20,589][0m Trial 13 finished with value: 0.052634332938627765 and parameters: {'observation_period_num': 84, 'train_rates': 0.8276781966219257, 'learning_rate': 0.0001598076017256643, 'batch_size': 162, 'step_size': 13, 'gamma': 0.8468675306225787}. Best is trial 13 with value: 0.052634332938627765.[0m
[32m[I 2025-01-05 15:50:55,580][0m Trial 14 finished with value: 0.07733677213770211 and parameters: {'observation_period_num': 85, 'train_rates': 0.7901811960185763, 'learning_rate': 7.166799641959228e-05, 'batch_size': 173, 'step_size': 15, 'gamma': 0.7847570047134674}. Best is trial 13 with value: 0.052634332938627765.[0m
[32m[I 2025-01-05 15:51:32,779][0m Trial 15 finished with value: 0.18188192664242503 and parameters: {'observation_period_num': 6, 'train_rates': 0.772764529440877, 'learning_rate': 5.5275988353350613e-05, 'batch_size': 146, 'step_size': 15, 'gamma': 0.780306348169365}. Best is trial 13 with value: 0.052634332938627765.[0m
[32m[I 2025-01-05 15:52:01,687][0m Trial 16 finished with value: 0.19388278912762444 and parameters: {'observation_period_num': 73, 'train_rates': 0.7298739445371041, 'learning_rate': 0.0001995248976889174, 'batch_size': 223, 'step_size': 13, 'gamma': 0.8562350837521111}. Best is trial 13 with value: 0.052634332938627765.[0m
[32m[I 2025-01-05 15:52:40,468][0m Trial 17 finished with value: 0.06095749856380934 and parameters: {'observation_period_num': 66, 'train_rates': 0.8458717968418168, 'learning_rate': 4.704975624407852e-05, 'batch_size': 151, 'step_size': 14, 'gamma': 0.7860723598946274}. Best is trial 13 with value: 0.052634332938627765.[0m
[32m[I 2025-01-05 15:53:19,217][0m Trial 18 finished with value: 0.047541385868687294 and parameters: {'observation_period_num': 47, 'train_rates': 0.8489383643151959, 'learning_rate': 0.0003526057409818591, 'batch_size': 148, 'step_size': 13, 'gamma': 0.8540691360223963}. Best is trial 18 with value: 0.047541385868687294.[0m
[32m[I 2025-01-05 15:54:11,238][0m Trial 19 finished with value: 0.03735843410902922 and parameters: {'observation_period_num': 26, 'train_rates': 0.840449123402423, 'learning_rate': 0.00030791820116624877, 'batch_size': 109, 'step_size': 10, 'gamma': 0.8881069716067189}. Best is trial 19 with value: 0.03735843410902922.[0m
[32m[I 2025-01-05 15:54:58,054][0m Trial 20 finished with value: 0.1609080570500518 and parameters: {'observation_period_num': 40, 'train_rates': 0.7205964442249576, 'learning_rate': 0.00031928959564883456, 'batch_size': 106, 'step_size': 10, 'gamma': 0.8912495828728524}. Best is trial 19 with value: 0.03735843410902922.[0m
[32m[I 2025-01-05 15:55:40,481][0m Trial 21 finished with value: 0.03949760906477222 and parameters: {'observation_period_num': 38, 'train_rates': 0.8380889006202266, 'learning_rate': 0.00041748081139857845, 'batch_size': 133, 'step_size': 13, 'gamma': 0.8597230017976656}. Best is trial 19 with value: 0.03735843410902922.[0m
[32m[I 2025-01-05 15:56:24,587][0m Trial 22 finished with value: 0.03208670504391194 and parameters: {'observation_period_num': 9, 'train_rates': 0.872611872535871, 'learning_rate': 0.0004941298107955051, 'batch_size': 135, 'step_size': 13, 'gamma': 0.8838639028976928}. Best is trial 22 with value: 0.03208670504391194.[0m
[32m[I 2025-01-05 15:57:11,136][0m Trial 23 finished with value: 0.03134955963569468 and parameters: {'observation_period_num': 10, 'train_rates': 0.8819580188963108, 'learning_rate': 0.0005935378651144358, 'batch_size': 126, 'step_size': 10, 'gamma': 0.8831982342497875}. Best is trial 23 with value: 0.03134955963569468.[0m
[32m[I 2025-01-05 15:58:09,668][0m Trial 24 finished with value: 0.030140925879063814 and parameters: {'observation_period_num': 7, 'train_rates': 0.8828986844177971, 'learning_rate': 0.00094982689295723, 'batch_size': 98, 'step_size': 5, 'gamma': 0.9515400839529632}. Best is trial 24 with value: 0.030140925879063814.[0m
[32m[I 2025-01-05 15:59:16,410][0m Trial 25 finished with value: 0.03945398711315964 and parameters: {'observation_period_num': 5, 'train_rates': 0.8908878966193676, 'learning_rate': 0.0009880922848073885, 'batch_size': 85, 'step_size': 5, 'gamma': 0.9739165564881871}. Best is trial 24 with value: 0.030140925879063814.[0m
[32m[I 2025-01-05 16:01:55,034][0m Trial 26 finished with value: 0.03204798941885162 and parameters: {'observation_period_num': 15, 'train_rates': 0.8747851635734523, 'learning_rate': 0.0005756196546777389, 'batch_size': 35, 'step_size': 5, 'gamma': 0.9513143302103636}. Best is trial 24 with value: 0.030140925879063814.[0m
[32m[I 2025-01-05 16:04:52,288][0m Trial 27 finished with value: 0.04924725513068997 and parameters: {'observation_period_num': 52, 'train_rates': 0.9325452620229878, 'learning_rate': 0.0005505519037436766, 'batch_size': 32, 'step_size': 5, 'gamma': 0.9491425578535893}. Best is trial 24 with value: 0.030140925879063814.[0m
[32m[I 2025-01-05 16:07:06,776][0m Trial 28 finished with value: 0.037592564050744216 and parameters: {'observation_period_num': 23, 'train_rates': 0.8183170724062543, 'learning_rate': 0.00023311251434779957, 'batch_size': 39, 'step_size': 1, 'gamma': 0.9575879862125778}. Best is trial 24 with value: 0.030140925879063814.[0m
[32m[I 2025-01-05 16:08:04,863][0m Trial 29 finished with value: 0.1661801062005221 and parameters: {'observation_period_num': 21, 'train_rates': 0.7504374209154684, 'learning_rate': 0.000712636006912439, 'batch_size': 89, 'step_size': 4, 'gamma': 0.9455625511615321}. Best is trial 24 with value: 0.030140925879063814.[0m
[32m[I 2025-01-05 16:12:52,861][0m Trial 30 finished with value: 0.10337721164543907 and parameters: {'observation_period_num': 54, 'train_rates': 0.8940616624499287, 'learning_rate': 1.4144470412579802e-06, 'batch_size': 19, 'step_size': 6, 'gamma': 0.907632502311715}. Best is trial 24 with value: 0.030140925879063814.[0m
[32m[I 2025-01-05 16:13:42,166][0m Trial 31 finished with value: 0.02451697885705044 and parameters: {'observation_period_num': 7, 'train_rates': 0.866976663851275, 'learning_rate': 0.0005523146174764602, 'batch_size': 117, 'step_size': 7, 'gamma': 0.9252147346709041}. Best is trial 31 with value: 0.02451697885705044.[0m
[32m[I 2025-01-05 16:14:27,222][0m Trial 32 finished with value: 0.04743125335486845 and parameters: {'observation_period_num': 18, 'train_rates': 0.8116194019820236, 'learning_rate': 0.0005929303389089897, 'batch_size': 117, 'step_size': 7, 'gamma': 0.9658020282862766}. Best is trial 31 with value: 0.02451697885705044.[0m
[32m[I 2025-01-05 16:15:20,890][0m Trial 33 finished with value: 0.056464631863413974 and parameters: {'observation_period_num': 34, 'train_rates': 0.8713317836786941, 'learning_rate': 0.0009413681516036548, 'batch_size': 97, 'step_size': 7, 'gamma': 0.9345542967195212}. Best is trial 31 with value: 0.02451697885705044.[0m
[32m[I 2025-01-05 16:16:50,665][0m Trial 34 finished with value: 0.032216451579922346 and parameters: {'observation_period_num': 17, 'train_rates': 0.9331954329706327, 'learning_rate': 0.0005486591204017727, 'batch_size': 64, 'step_size': 9, 'gamma': 0.9112393770609906}. Best is trial 31 with value: 0.02451697885705044.[0m
[32m[I 2025-01-05 16:18:00,597][0m Trial 35 finished with value: 0.08924846345502319 and parameters: {'observation_period_num': 136, 'train_rates': 0.9065214682020676, 'learning_rate': 0.0002330022156741838, 'batch_size': 82, 'step_size': 5, 'gamma': 0.98462795787687}. Best is trial 31 with value: 0.02451697885705044.[0m
[32m[I 2025-01-05 16:19:55,890][0m Trial 36 finished with value: 0.057516308316331824 and parameters: {'observation_period_num': 55, 'train_rates': 0.9481258805776256, 'learning_rate': 0.00010571357986466935, 'batch_size': 51, 'step_size': 4, 'gamma': 0.9212716648109377}. Best is trial 31 with value: 0.02451697885705044.[0m
[32m[I 2025-01-05 16:20:29,646][0m Trial 37 finished with value: 0.1840826922229358 and parameters: {'observation_period_num': 230, 'train_rates': 0.8768949337415961, 'learning_rate': 0.0006126152663273048, 'batch_size': 186, 'step_size': 8, 'gamma': 0.9396814568606413}. Best is trial 31 with value: 0.02451697885705044.[0m
[32m[I 2025-01-05 16:21:16,666][0m Trial 38 finished with value: 0.12117591477874526 and parameters: {'observation_period_num': 117, 'train_rates': 0.8595835558760686, 'learning_rate': 0.0002481645989829659, 'batch_size': 123, 'step_size': 6, 'gamma': 0.9589471639400152}. Best is trial 31 with value: 0.02451697885705044.[0m
[32m[I 2025-01-05 16:22:14,374][0m Trial 39 finished with value: 0.06047063920877676 and parameters: {'observation_period_num': 5, 'train_rates': 0.8083477005719423, 'learning_rate': 3.1434865415210066e-05, 'batch_size': 99, 'step_size': 3, 'gamma': 0.8698086387483239}. Best is trial 31 with value: 0.02451697885705044.[0m
[32m[I 2025-01-05 16:23:33,044][0m Trial 40 finished with value: 0.05538270216782083 and parameters: {'observation_period_num': 39, 'train_rates': 0.915384890608914, 'learning_rate': 2.2446897220699796e-05, 'batch_size': 75, 'step_size': 4, 'gamma': 0.9220779170666545}. Best is trial 31 with value: 0.02451697885705044.[0m
[32m[I 2025-01-05 16:24:19,071][0m Trial 41 finished with value: 0.028095194639207365 and parameters: {'observation_period_num': 13, 'train_rates': 0.8869311536616707, 'learning_rate': 0.00047907173311174104, 'batch_size': 136, 'step_size': 9, 'gamma': 0.8978363386122368}. Best is trial 31 with value: 0.02451697885705044.[0m
[33m[W 2025-01-05 16:24:27,827][0m Trial 42 failed with parameters: {'observation_period_num': 18, 'train_rates': 0.8849026751631937, 'learning_rate': 0.0008140027144730678, 'batch_size': 126, 'step_size': 9, 'gamma': 0.9029435197038707} because of the following error: KeyboardInterrupt().[0m
Traceback (most recent call last):
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna_change.py", line 556, in <lambda>
    study.optimize(lambda trial: objective(trial, component, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna_change.py", line 113, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 32, in train
    output = model(data)
             ^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<@beartype(src.model.iTransformer.forward) at 0x7f9ef99e00e0>", line 66, in forward
  File "/data/student/k2110261/Multi-iTransformer/src/model.py", line 177, in forward
    x = self.mlp_in(x)
        ^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/einops/layers/torch.py", line 15, in forward
    return apply_for_scriptable_torch(recipe, input, reduction_type="rearrange", axes_dims=self._axes_lengths)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/einops/_torch_specific.py", line 88, in apply_for_scriptable_torch
    ) = _reconstruct_from_shape_uncached(recipe, backend.shape(tensor), axes_dims=axes_dims)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/einops/einops.py", line 175, in _reconstruct_from_shape_uncached
    continue
KeyboardInterrupt
[33m[W 2025-01-05 16:24:27,910][0m Trial 42 failed with value None.[0m
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna_change.py", line 556, in <module>
    study.optimize(lambda trial: objective(trial, component, depth, dim), n_trials=50) #check
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna_change.py", line 556, in <lambda>
    study.optimize(lambda trial: objective(trial, component, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna_change.py", line 113, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 32, in train
    output = model(data)
             ^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<@beartype(src.model.iTransformer.forward) at 0x7f9ef99e00e0>", line 66, in forward
  File "/data/student/k2110261/Multi-iTransformer/src/model.py", line 177, in forward
    x = self.mlp_in(x)
        ^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/einops/layers/torch.py", line 15, in forward
    return apply_for_scriptable_torch(recipe, input, reduction_type="rearrange", axes_dims=self._axes_lengths)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/einops/_torch_specific.py", line 88, in apply_for_scriptable_torch
    ) = _reconstruct_from_shape_uncached(recipe, backend.shape(tensor), axes_dims=axes_dims)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/einops/einops.py", line 175, in _reconstruct_from_shape_uncached
    continue
KeyboardInterrupt
