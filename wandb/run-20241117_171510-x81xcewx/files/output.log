Using device: cuda
[*********************100%***********************]  1 of 1 completed
Ticker            AAPL
Date
2012-05-18   15.978587
2012-05-21   16.909504
2012-05-22   16.779655
2012-05-23   17.189089
2012-05-24   17.031221
...                ...
2023-05-24  170.546951
2023-05-25  171.688324
2023-05-26  174.109955
2023-05-30  175.965897
2023-05-31  175.916245

[2776 rows x 1 columns]
/data/student/k2110261/Multi-iTransformer/optunademo.py:104: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df = df.fillna(method='ffill')  # ÂâçÊó•„ÅÆ„Éá„Éº„Çø„Çí‰ΩøÁî®
{'AAPL': Date
2012-05-18     18.353258
2012-05-21     18.337500
2012-05-22     18.321752
2012-05-23     18.306014
2012-05-24     18.290288
                 ...
2023-05-24    161.245434
2023-05-25    161.303006
2023-05-26    161.360574
2023-05-30    161.418137
2023-05-31    161.475698
Name: trend, Length: 2776, dtype: float64, 'DTWEXBGS': Date
2012-05-18     93.1395
2012-05-21     93.0945
2012-05-22     93.1113
2012-05-23     93.8855
2012-05-24     93.8027
                ...
2023-05-24    120.6481
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
Length: 2776, dtype: float64, 'VIXCLS': Date
2012-05-18    25.10
2012-05-21    22.01
2012-05-22    22.48
2012-05-23    22.33
2012-05-24    21.54
              ...
2023-05-24    20.03
2023-05-25    19.14
2023-05-26    17.95
2023-05-30    17.46
2023-05-31    17.94
Length: 2776, dtype: float64, 'DFII10': Date
2012-05-18   -0.39
2012-05-21   -0.41
2012-05-22   -0.38
2012-05-23   -0.41
2012-05-24   -0.37
              ...
2023-05-24    1.48
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
Length: 2776, dtype: float64, 'T10Y2Y': Date
2012-05-18    1.39
2012-05-21    1.45
2012-05-22    1.49
2012-05-23    1.45
2012-05-24    1.48
              ...
2023-05-24   -0.58
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
Length: 2776, dtype: float64}
AAPL„Å´„ÅÇ„Çã„Åå‰ªñ„ÅÆ„Éá„Éº„Çø1„Å´„ÅØ„Å™„ÅÑÊó•‰ªò: DatetimeIndex([], dtype='datetime64[ns]', name='Date', freq=None)
‰ªñ„ÅÆ„Éá„Éº„Çø1„Å´„ÅÇ„Çã„ÅåAAPL„Å´„ÅØ„Å™„ÅÑÊó•‰ªò: DatetimeIndex([], dtype='datetime64[ns]', name='Date', freq=None)
Price      BB_Upper BB_Lower BB_Middle MACD MACD_Signal MACD_Diff RSI SMA_50 SMA_200
Ticker
Date
2012-05-18      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
2012-05-21      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
2012-05-22      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
2012-05-23      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
2012-05-24      NaN      NaN       NaN  NaN         NaN       NaN NaN    NaN     NaN
['AAPL', 'DTWEXBGS', 'VIXCLS', 'DFII10', 'T10Y2Y', 'BB_Upper', 'BB_Lower', 'BB_Middle', 'MACD', 'MACD_Signal', 'MACD_Diff', 'RSI', 'SMA_50', 'SMA_200']
dataframes_trend: dict_items([('AAPL', Date
2012-05-18     18.353258
2012-05-21     18.337500
2012-05-22     18.321752
2012-05-23     18.306014
2012-05-24     18.290288
                 ...
2023-05-24    161.245434
2023-05-25    161.303006
2023-05-26    161.360574
2023-05-30    161.418137
2023-05-31    161.475698
Name: trend, Length: 2776, dtype: float64), ('DTWEXBGS', Date
2012-05-18     93.1395
2012-05-21     93.0945
2012-05-22     93.1113
2012-05-23     93.8855
2012-05-24     93.8027
                ...
2023-05-24    120.6481
2023-05-25    121.0126
2023-05-26    120.8022
2023-05-30    120.7387
2023-05-31    121.1527
Length: 2776, dtype: float64), ('VIXCLS', Date
2012-05-18    25.10
2012-05-21    22.01
2012-05-22    22.48
2012-05-23    22.33
2012-05-24    21.54
              ...
2023-05-24    20.03
2023-05-25    19.14
2023-05-26    17.95
2023-05-30    17.46
2023-05-31    17.94
Length: 2776, dtype: float64), ('DFII10', Date
2012-05-18   -0.39
2012-05-21   -0.41
2012-05-22   -0.38
2012-05-23   -0.41
2012-05-24   -0.37
              ...
2023-05-24    1.48
2023-05-25    1.58
2023-05-26    1.57
2023-05-30    1.47
2023-05-31    1.46
Length: 2776, dtype: float64), ('T10Y2Y', Date
2012-05-18    1.39
2012-05-21    1.45
2012-05-22    1.49
2012-05-23    1.45
2012-05-24    1.48
              ...
2023-05-24   -0.58
2023-05-25   -0.67
2023-05-26   -0.74
2023-05-30   -0.77
2023-05-31   -0.76
Length: 2776, dtype: float64), ('BB_Upper', Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    175.360184
2023-05-25    175.401875
2023-05-26    175.825119
2023-05-30    176.541932
2023-05-31    177.020401
Name: BB_Upper, Length: 2776, dtype: float64), ('BB_Lower', Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    165.081606
2023-05-25    165.517555
2023-05-26    165.688245
2023-05-30    165.759880
2023-05-31    166.168960
Name: BB_Lower, Length: 2776, dtype: float64), ('BB_Middle', Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    170.220895
2023-05-25    170.459715
2023-05-26    170.756682
2023-05-30    171.150906
2023-05-31    171.594681
Name: BB_Middle, Length: 2776, dtype: float64), ('MACD', Date
2012-05-18         NaN
2012-05-21         NaN
2012-05-22         NaN
2012-05-23         NaN
2012-05-24         NaN
                ...
2023-05-24    2.332936
2023-05-25    2.209841
2023-05-26    2.281394
2023-05-30    2.459508
2023-05-31    2.567066
Name: MACD, Length: 2776, dtype: float64), ('MACD_Signal', Date
2012-05-18         NaN
2012-05-21         NaN
2012-05-22         NaN
2012-05-23         NaN
2012-05-24         NaN
                ...
2023-05-24    2.724337
2023-05-25    2.621437
2023-05-26    2.553429
2023-05-30    2.534645
2023-05-31    2.541129
Name: MACD_Signal, Length: 2776, dtype: float64), ('MACD_Diff', Date
2012-05-18         NaN
2012-05-21         NaN
2012-05-22         NaN
2012-05-23         NaN
2012-05-24         NaN
                ...
2023-05-24   -0.391400
2023-05-25   -0.411596
2023-05-26   -0.272035
2023-05-30   -0.075137
2023-05-31    0.025937
Name: MACD_Diff, Length: 2776, dtype: float64), ('RSI', Date
2012-05-18          NaN
2012-05-21          NaN
2012-05-22          NaN
2012-05-23          NaN
2012-05-24          NaN
                ...
2023-05-24    55.867145
2023-05-25    58.637805
2023-05-26    63.826695
2023-05-30    67.220694
2023-05-31    67.039471
Name: RSI, Length: 2776, dtype: float64), ('SMA_50', Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    164.409243
2023-05-25    164.810428
2023-05-26    165.203354
2023-05-30    165.650248
2023-05-31    166.048576
Name: SMA_50, Length: 2776, dtype: float64), ('SMA_200', Date
2012-05-18           NaN
2012-05-21           NaN
2012-05-22           NaN
2012-05-23           NaN
2012-05-24           NaN
                 ...
2023-05-24    150.685263
2023-05-25    150.729037
2023-05-26    150.763580
2023-05-30    150.811107
2023-05-31    150.840553
Name: SMA_200, Length: 2776, dtype: float64)])
AAPL null values:
0
DTWEXBGS null values:
0
VIXCLS null values:
0
DFII10 null values:
0
T10Y2Y null values:
0
BB_Upper null values:
0
BB_Lower null values:
0
BB_Middle null values:
0
MACD null values:
0
MACD_Signal null values:
0
MACD_Diff null values:
0
RSI null values:
0
SMA_50 null values:
0
SMA_200 null values:
0
[32m[I 2024-11-17 17:15:18,718][0m A new study created in memory with name: no-name-4b0a5c0a-dc64-47cd-a0e0-25d33c8c1aef[0m
Non-A100 GPU detected, using math or mem efficient attention if input tensor is on cuda
/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/contextlib.py:105: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
[32m[I 2024-11-17 17:15:21,320][0m Trial 0 finished with value: 0.899644672870636 and parameters: {'observation_period_num': 247, 'train_rates': 0.9280538395949738, 'learning_rate': 0.000110962576177196, 'batch_size': 180, 'step_size': 3, 'gamma': 0.8826072273440744, 'depth': 6, 'dim': 176}. Best is trial 0 with value: 0.899644672870636.[0m
[32m[I 2024-11-17 17:15:21,320][0m A new study created in memory with name: no-name-e2ad2a32-9498-429f-bf08-5a8a439b4100[0m
[32m[I 2024-11-17 17:15:22,015][0m Trial 0 finished with value: 1.4937816501279295 and parameters: {'observation_period_num': 137, 'train_rates': 0.7619385616321899, 'learning_rate': 2.3022311396043493e-05, 'batch_size': 170, 'step_size': 6, 'gamma': 0.752454651298267, 'depth': 3, 'dim': 89}. Best is trial 0 with value: 1.4937816501279295.[0m
[32m[I 2024-11-17 17:15:22,016][0m A new study created in memory with name: no-name-dccd0d7a-0f47-4e5a-b40f-a2edda133c90[0m
[32m[I 2024-11-17 17:15:22,988][0m Trial 0 finished with value: 2.0021027893367047 and parameters: {'observation_period_num': 132, 'train_rates': 0.841823917346962, 'learning_rate': 2.2236040431984875e-06, 'batch_size': 77, 'step_size': 6, 'gamma': 0.8789813674103555, 'depth': 4, 'dim': 66}. Best is trial 0 with value: 2.0021027893367047.[0m
Best hyperparameters (trend): {'observation_period_num': 247, 'train_rates': 0.9280538395949738, 'learning_rate': 0.000110962576177196, 'batch_size': 180, 'step_size': 3, 'gamma': 0.8826072273440744, 'depth': 6, 'dim': 176}
Best hyperparameters (seasonal): {'observation_period_num': 137, 'train_rates': 0.7619385616321899, 'learning_rate': 2.3022311396043493e-05, 'batch_size': 170, 'step_size': 6, 'gamma': 0.752454651298267, 'depth': 3, 'dim': 89}
Best hyperparameters (resid): {'observation_period_num': 132, 'train_rates': 0.841823917346962, 'learning_rate': 2.2236040431984875e-06, 'batch_size': 77, 'step_size': 6, 'gamma': 0.8789813674103555, 'depth': 4, 'dim': 66}
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/optunademo.py", line 276, in <module>
    lookback_len=observation_period,
                 ^^^^^^^^^^^^^^^^^^
NameError: name 'observation_period' is not defined
