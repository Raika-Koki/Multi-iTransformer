[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.3385, 0.2031| Seasonal Loss: 0.4600, 0.3412| Residual Loss: 0.6044, 0.5300
Epoch 2/100, (Training, Validation) Trend Loss: 0.1592, 0.1999| Seasonal Loss: 0.2959, 0.2950| Residual Loss: 0.3163, 0.3252
Epoch 3/100, (Training, Validation) Trend Loss: 0.1323, 0.1100| Seasonal Loss: 0.2477, 0.2638| Residual Loss: 0.2503, 0.2481
Epoch 4/100, (Training, Validation) Trend Loss: 0.1104, 0.1189| Seasonal Loss: 0.2152, 0.2297| Residual Loss: 0.1969, 0.2023
Epoch 5/100, (Training, Validation) Trend Loss: 0.1077, 0.0823| Seasonal Loss: 0.2024, 0.1627| Residual Loss: 0.1884, 0.1998
Epoch 6/100, (Training, Validation) Trend Loss: 0.1000, 0.0785| Seasonal Loss: 0.1922, 0.1820| Residual Loss: 0.1864, 0.1772
Epoch 7/100, (Training, Validation) Trend Loss: 0.1065, 0.0795| Seasonal Loss: 0.1887, 0.1450| Residual Loss: 0.2007, 0.1853
Epoch 8/100, (Training, Validation) Trend Loss: 0.0808, 0.0527| Seasonal Loss: 0.1696, 0.1499| Residual Loss: 0.2103, 0.1708
Epoch 9/100, (Training, Validation) Trend Loss: 0.0732, 0.1173| Seasonal Loss: 0.1393, 0.1543| Residual Loss: 0.1926, 0.1870
Epoch 10/100, (Training, Validation) Trend Loss: 0.0692, 0.0836| Seasonal Loss: 0.1236, 0.1435| Residual Loss: 0.1577, 0.1791
Epoch 11/100, (Training, Validation) Trend Loss: 0.0899, 0.1651| Seasonal Loss: 0.1223, 0.1778| Residual Loss: 0.1433, 0.1697
Epoch 12/100, (Training, Validation) Trend Loss: 0.0774, 0.0682| Seasonal Loss: 0.1271, 0.2146| Residual Loss: 0.1345, 0.1479
Epoch 13/100, (Training, Validation) Trend Loss: 0.0685, 0.0631| Seasonal Loss: 0.1424, 0.2552| Residual Loss: 0.1279, 0.1413
Epoch 14/100, (Training, Validation) Trend Loss: 0.0458, 0.0533| Seasonal Loss: 0.1332, 0.1989| Residual Loss: 0.1186, 0.1261
Epoch 15/100, (Training, Validation) Trend Loss: 0.0396, 0.0413| Seasonal Loss: 0.1193, 0.1325| Residual Loss: 0.1151, 0.1263
Epoch 16/100, (Training, Validation) Trend Loss: 0.0394, 0.0459| Seasonal Loss: 0.0918, 0.1294| Residual Loss: 0.1096, 0.1162
Epoch 17/100, (Training, Validation) Trend Loss: 0.0347, 0.0402| Seasonal Loss: 0.0843, 0.1229| Residual Loss: 0.1080, 0.1191
Epoch 18/100, (Training, Validation) Trend Loss: 0.0371, 0.0382| Seasonal Loss: 0.0806, 0.1220| Residual Loss: 0.1042, 0.1107
Epoch 19/100, (Training, Validation) Trend Loss: 0.0365, 0.0383| Seasonal Loss: 0.0758, 0.1179| Residual Loss: 0.1037, 0.1162
Epoch 20/100, (Training, Validation) Trend Loss: 0.0472, 0.0384| Seasonal Loss: 0.0732, 0.1192| Residual Loss: 0.1004, 0.1078
Epoch 21/100, (Training, Validation) Trend Loss: 0.0502, 0.0307| Seasonal Loss: 0.0720, 0.1148| Residual Loss: 0.1011, 0.1159
Epoch 22/100, (Training, Validation) Trend Loss: 0.0488, 0.0423| Seasonal Loss: 0.0739, 0.1210| Residual Loss: 0.0979, 0.1066
Epoch 23/100, (Training, Validation) Trend Loss: 0.0341, 0.0268| Seasonal Loss: 0.0820, 0.1142| Residual Loss: 0.0991, 0.1157
Epoch 24/100, (Training, Validation) Trend Loss: 0.0293, 0.0396| Seasonal Loss: 0.0996, 0.1189| Residual Loss: 0.0956, 0.1045
Epoch 25/100, (Training, Validation) Trend Loss: 0.0265, 0.0282| Seasonal Loss: 0.0969, 0.1140| Residual Loss: 0.0963, 0.1111
Epoch 26/100, (Training, Validation) Trend Loss: 0.0261, 0.0334| Seasonal Loss: 0.0788, 0.1116| Residual Loss: 0.0923, 0.1000
Epoch 27/100, (Training, Validation) Trend Loss: 0.0243, 0.0274| Seasonal Loss: 0.0640, 0.1157| Residual Loss: 0.0919, 0.1035
Epoch 28/100, (Training, Validation) Trend Loss: 0.0240, 0.0306| Seasonal Loss: 0.0626, 0.1122| Residual Loss: 0.0887, 0.0964
Epoch 29/100, (Training, Validation) Trend Loss: 0.0227, 0.0255| Seasonal Loss: 0.0605, 0.1106| Residual Loss: 0.0880, 0.0980
Epoch 30/100, (Training, Validation) Trend Loss: 0.0227, 0.0290| Seasonal Loss: 0.0587, 0.1107| Residual Loss: 0.0861, 0.0948
Epoch 31/100, (Training, Validation) Trend Loss: 0.0216, 0.0242| Seasonal Loss: 0.0574, 0.1098| Residual Loss: 0.0854, 0.0951
Epoch 32/100, (Training, Validation) Trend Loss: 0.0217, 0.0278| Seasonal Loss: 0.0563, 0.1091| Residual Loss: 0.0843, 0.0939
Epoch 33/100, (Training, Validation) Trend Loss: 0.0207, 0.0234| Seasonal Loss: 0.0552, 0.1087| Residual Loss: 0.0835, 0.0935
Epoch 34/100, (Training, Validation) Trend Loss: 0.0208, 0.0265| Seasonal Loss: 0.0543, 0.1082| Residual Loss: 0.0827, 0.0929
Epoch 35/100, (Training, Validation) Trend Loss: 0.0199, 0.0229| Seasonal Loss: 0.0534, 0.1077| Residual Loss: 0.0820, 0.0924
Epoch 36/100, (Training, Validation) Trend Loss: 0.0199, 0.0252| Seasonal Loss: 0.0526, 0.1072| Residual Loss: 0.0813, 0.0920
Epoch 37/100, (Training, Validation) Trend Loss: 0.0192, 0.0227| Seasonal Loss: 0.0519, 0.1068| Residual Loss: 0.0807, 0.0915
Epoch 38/100, (Training, Validation) Trend Loss: 0.0192, 0.0240| Seasonal Loss: 0.0512, 0.1064| Residual Loss: 0.0801, 0.0911
Epoch 39/100, (Training, Validation) Trend Loss: 0.0187, 0.0226| Seasonal Loss: 0.0505, 0.1060| Residual Loss: 0.0795, 0.0908
Epoch 40/100, (Training, Validation) Trend Loss: 0.0185, 0.0231| Seasonal Loss: 0.0499, 0.1056| Residual Loss: 0.0790, 0.0904
Epoch 41/100, (Training, Validation) Trend Loss: 0.0182, 0.0224| Seasonal Loss: 0.0493, 0.1052| Residual Loss: 0.0784, 0.0901
Epoch 42/100, (Training, Validation) Trend Loss: 0.0180, 0.0224| Seasonal Loss: 0.0488, 0.1049| Residual Loss: 0.0779, 0.0898
Epoch 43/100, (Training, Validation) Trend Loss: 0.0178, 0.0222| Seasonal Loss: 0.0483, 0.1045| Residual Loss: 0.0775, 0.0895
Epoch 44/100, (Training, Validation) Trend Loss: 0.0176, 0.0220| Seasonal Loss: 0.0478, 0.1042| Residual Loss: 0.0770, 0.0892
Epoch 45/100, (Training, Validation) Trend Loss: 0.0174, 0.0218| Seasonal Loss: 0.0473, 0.1039| Residual Loss: 0.0766, 0.0890
Epoch 46/100, (Training, Validation) Trend Loss: 0.0172, 0.0217| Seasonal Loss: 0.0469, 0.1036| Residual Loss: 0.0762, 0.0887
Epoch 47/100, (Training, Validation) Trend Loss: 0.0171, 0.0215| Seasonal Loss: 0.0465, 0.1033| Residual Loss: 0.0758, 0.0885
Epoch 48/100, (Training, Validation) Trend Loss: 0.0169, 0.0214| Seasonal Loss: 0.0461, 0.1031| Residual Loss: 0.0755, 0.0883
Epoch 49/100, (Training, Validation) Trend Loss: 0.0168, 0.0213| Seasonal Loss: 0.0458, 0.1028| Residual Loss: 0.0751, 0.0881
Epoch 50/100, (Training, Validation) Trend Loss: 0.0166, 0.0211| Seasonal Loss: 0.0454, 0.1025| Residual Loss: 0.0748, 0.0879
Epoch 51/100, (Training, Validation) Trend Loss: 0.0165, 0.0210| Seasonal Loss: 0.0451, 0.1023| Residual Loss: 0.0745, 0.0877
Epoch 52/100, (Training, Validation) Trend Loss: 0.0164, 0.0209| Seasonal Loss: 0.0448, 0.1021| Residual Loss: 0.0742, 0.0876
Epoch 53/100, (Training, Validation) Trend Loss: 0.0163, 0.0208| Seasonal Loss: 0.0445, 0.1019| Residual Loss: 0.0739, 0.0874
Epoch 54/100, (Training, Validation) Trend Loss: 0.0162, 0.0207| Seasonal Loss: 0.0443, 0.1017| Residual Loss: 0.0737, 0.0872
Epoch 55/100, (Training, Validation) Trend Loss: 0.0161, 0.0206| Seasonal Loss: 0.0440, 0.1015| Residual Loss: 0.0734, 0.0871
Epoch 56/100, (Training, Validation) Trend Loss: 0.0160, 0.0206| Seasonal Loss: 0.0437, 0.1013| Residual Loss: 0.0732, 0.0870
Epoch 57/100, (Training, Validation) Trend Loss: 0.0159, 0.0205| Seasonal Loss: 0.0435, 0.1011| Residual Loss: 0.0730, 0.0868
Epoch 58/100, (Training, Validation) Trend Loss: 0.0158, 0.0204| Seasonal Loss: 0.0433, 0.1009| Residual Loss: 0.0727, 0.0867
Epoch 59/100, (Training, Validation) Trend Loss: 0.0157, 0.0203| Seasonal Loss: 0.0431, 0.1008| Residual Loss: 0.0725, 0.0866
Epoch 60/100, (Training, Validation) Trend Loss: 0.0157, 0.0203| Seasonal Loss: 0.0429, 0.1006| Residual Loss: 0.0723, 0.0865
Epoch 61/100, (Training, Validation) Trend Loss: 0.0156, 0.0202| Seasonal Loss: 0.0427, 0.1005| Residual Loss: 0.0722, 0.0864
Epoch 62/100, (Training, Validation) Trend Loss: 0.0155, 0.0201| Seasonal Loss: 0.0425, 0.1003| Residual Loss: 0.0720, 0.0863
Epoch 63/100, (Training, Validation) Trend Loss: 0.0155, 0.0201| Seasonal Loss: 0.0423, 0.1002| Residual Loss: 0.0718, 0.0862
Epoch 64/100, (Training, Validation) Trend Loss: 0.0154, 0.0200| Seasonal Loss: 0.0422, 0.1000| Residual Loss: 0.0717, 0.0861
Epoch 65/100, (Training, Validation) Trend Loss: 0.0153, 0.0200| Seasonal Loss: 0.0420, 0.0999| Residual Loss: 0.0715, 0.0861
Epoch 66/100, (Training, Validation) Trend Loss: 0.0153, 0.0199| Seasonal Loss: 0.0419, 0.0998| Residual Loss: 0.0714, 0.0860
Epoch 67/100, (Training, Validation) Trend Loss: 0.0152, 0.0199| Seasonal Loss: 0.0417, 0.0997| Residual Loss: 0.0712, 0.0859
Epoch 68/100, (Training, Validation) Trend Loss: 0.0152, 0.0198| Seasonal Loss: 0.0416, 0.0996| Residual Loss: 0.0711, 0.0858
Epoch 69/100, (Training, Validation) Trend Loss: 0.0151, 0.0198| Seasonal Loss: 0.0415, 0.0995| Residual Loss: 0.0710, 0.0858
Epoch 70/100, (Training, Validation) Trend Loss: 0.0151, 0.0198| Seasonal Loss: 0.0414, 0.0994| Residual Loss: 0.0708, 0.0857
Epoch 71/100, (Training, Validation) Trend Loss: 0.0151, 0.0197| Seasonal Loss: 0.0412, 0.0993| Residual Loss: 0.0707, 0.0856
Epoch 72/100, (Training, Validation) Trend Loss: 0.0150, 0.0197| Seasonal Loss: 0.0411, 0.0992| Residual Loss: 0.0706, 0.0856
Epoch 73/100, (Training, Validation) Trend Loss: 0.0150, 0.0197| Seasonal Loss: 0.0410, 0.0991| Residual Loss: 0.0705, 0.0855
Epoch 74/100, (Training, Validation) Trend Loss: 0.0150, 0.0196| Seasonal Loss: 0.0409, 0.0990| Residual Loss: 0.0704, 0.0855
Epoch 75/100, (Training, Validation) Trend Loss: 0.0149, 0.0196| Seasonal Loss: 0.0408, 0.0990| Residual Loss: 0.0703, 0.0854
Epoch 76/100, (Training, Validation) Trend Loss: 0.0149, 0.0196| Seasonal Loss: 0.0408, 0.0989| Residual Loss: 0.0702, 0.0854
Epoch 77/100, (Training, Validation) Trend Loss: 0.0149, 0.0195| Seasonal Loss: 0.0407, 0.0988| Residual Loss: 0.0701, 0.0853
Epoch 78/100, (Training, Validation) Trend Loss: 0.0148, 0.0195| Seasonal Loss: 0.0406, 0.0988| Residual Loss: 0.0701, 0.0853
Epoch 79/100, (Training, Validation) Trend Loss: 0.0148, 0.0195| Seasonal Loss: 0.0405, 0.0987| Residual Loss: 0.0700, 0.0853
Epoch 80/100, (Training, Validation) Trend Loss: 0.0148, 0.0195| Seasonal Loss: 0.0404, 0.0986| Residual Loss: 0.0699, 0.0852
Epoch 81/100, (Training, Validation) Trend Loss: 0.0147, 0.0194| Seasonal Loss: 0.0404, 0.0986| Residual Loss: 0.0698, 0.0852
Epoch 82/100, (Training, Validation) Trend Loss: 0.0147, 0.0194| Seasonal Loss: 0.0403, 0.0985| Residual Loss: 0.0698, 0.0852
Epoch 83/100, (Training, Validation) Trend Loss: 0.0147, 0.0194| Seasonal Loss: 0.0402, 0.0985| Residual Loss: 0.0697, 0.0851
Epoch 84/100, (Training, Validation) Trend Loss: 0.0147, 0.0194| Seasonal Loss: 0.0402, 0.0984| Residual Loss: 0.0696, 0.0851
Epoch 85/100, (Training, Validation) Trend Loss: 0.0147, 0.0193| Seasonal Loss: 0.0401, 0.0984| Residual Loss: 0.0696, 0.0851
Epoch 86/100, (Training, Validation) Trend Loss: 0.0146, 0.0193| Seasonal Loss: 0.0401, 0.0983| Residual Loss: 0.0695, 0.0850
Epoch 87/100, (Training, Validation) Trend Loss: 0.0146, 0.0193| Seasonal Loss: 0.0400, 0.0983| Residual Loss: 0.0695, 0.0850
Epoch 88/100, (Training, Validation) Trend Loss: 0.0146, 0.0193| Seasonal Loss: 0.0400, 0.0982| Residual Loss: 0.0694, 0.0850
Epoch 89/100, (Training, Validation) Trend Loss: 0.0146, 0.0193| Seasonal Loss: 0.0399, 0.0982| Residual Loss: 0.0694, 0.0850
Epoch 90/100, (Training, Validation) Trend Loss: 0.0146, 0.0193| Seasonal Loss: 0.0399, 0.0982| Residual Loss: 0.0693, 0.0849
Epoch 91/100, (Training, Validation) Trend Loss: 0.0146, 0.0192| Seasonal Loss: 0.0398, 0.0981| Residual Loss: 0.0693, 0.0849
Epoch 92/100, (Training, Validation) Trend Loss: 0.0145, 0.0192| Seasonal Loss: 0.0398, 0.0981| Residual Loss: 0.0692, 0.0849
Epoch 93/100, (Training, Validation) Trend Loss: 0.0145, 0.0192| Seasonal Loss: 0.0397, 0.0981| Residual Loss: 0.0692, 0.0849
Epoch 94/100, (Training, Validation) Trend Loss: 0.0145, 0.0192| Seasonal Loss: 0.0397, 0.0980| Residual Loss: 0.0692, 0.0849
Epoch 95/100, (Training, Validation) Trend Loss: 0.0145, 0.0192| Seasonal Loss: 0.0397, 0.0980| Residual Loss: 0.0691, 0.0848
Epoch 96/100, (Training, Validation) Trend Loss: 0.0145, 0.0192| Seasonal Loss: 0.0396, 0.0980| Residual Loss: 0.0691, 0.0848
Epoch 97/100, (Training, Validation) Trend Loss: 0.0145, 0.0192| Seasonal Loss: 0.0396, 0.0979| Residual Loss: 0.0691, 0.0848
Epoch 98/100, (Training, Validation) Trend Loss: 0.0145, 0.0192| Seasonal Loss: 0.0396, 0.0979| Residual Loss: 0.0690, 0.0848
Epoch 99/100, (Training, Validation) Trend Loss: 0.0145, 0.0192| Seasonal Loss: 0.0395, 0.0979| Residual Loss: 0.0690, 0.0848
Epoch 100/100, (Training, Validation) Trend Loss: 0.0144, 0.0191| Seasonal Loss: 0.0395, 0.0979| Residual Loss: 0.0690, 0.0848
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:189: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:190: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[169.31054492]
[-0.50814916]
[1.54290453]
[170.3453003]
stock_trend: Date
2019-12-31     78.597264
2020-01-02     78.442334
2020-01-03     78.286202
2020-01-06     78.128774
2020-01-07     77.969957
                 ...
2023-05-24    173.117852
2023-05-25    173.456801
2023-05-26    173.795648
2023-05-30    174.134453
2023-05-31    174.473268
Name: trend, Length: 860, dtype: float64
actual_stock_price: [171.57913208 173.9239502  174.03321838 173.07940674 170.45639038
 170.73460388 171.87721252 174.30151367 176.1594696  176.1098175 ]
add_predicted_stock_price: [171.57913208 173.9239502  174.03321838 173.07940674 170.45639038
 170.73460388 171.87721252 174.30151367 176.1594696  170.3453003 ]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:237: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
