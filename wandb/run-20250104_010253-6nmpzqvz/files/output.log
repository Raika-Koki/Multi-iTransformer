ÊúÄÈÅ©ÂåñÂØæË±°: trend
[32m[I 2025-01-04 01:02:54,261][0m A new study created in memory with name: no-name-2d5c6ee1-713b-45dd-b363-dc4ea204516a[0m
Non-A100 GPU detected, using math or mem efficient attention if input tensor is on cuda
[32m[I 2025-01-04 01:03:20,314][0m Trial 0 finished with value: 0.057150506710733906 and parameters: {'observation_period_num': 53, 'train_rates': 0.7885206403137539, 'learning_rate': 0.0008971382636822246, 'batch_size': 232, 'step_size': 3, 'gamma': 0.9108294534458936}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:03:57,295][0m Trial 1 finished with value: 0.10296300798654556 and parameters: {'observation_period_num': 14, 'train_rates': 0.9493157483305141, 'learning_rate': 1.305027483564073e-05, 'batch_size': 165, 'step_size': 12, 'gamma': 0.7942249116496665}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:05:03,287][0m Trial 2 finished with value: 0.18854019290750143 and parameters: {'observation_period_num': 109, 'train_rates': 0.6437771176464813, 'learning_rate': 0.0001359682664476218, 'batch_size': 67, 'step_size': 13, 'gamma': 0.860872694340422}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:06:51,271][0m Trial 3 finished with value: 0.18670480262248887 and parameters: {'observation_period_num': 249, 'train_rates': 0.7984961809716112, 'learning_rate': 4.926795399733701e-05, 'batch_size': 44, 'step_size': 14, 'gamma': 0.8978714309555044}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:07:17,555][0m Trial 4 finished with value: 0.16403365584028193 and parameters: {'observation_period_num': 5, 'train_rates': 0.7053133962724234, 'learning_rate': 0.0002872187851513492, 'batch_size': 203, 'step_size': 3, 'gamma': 0.8668079600285133}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:07:40,417][0m Trial 5 finished with value: 0.23777593741739603 and parameters: {'observation_period_num': 60, 'train_rates': 0.7700292525554147, 'learning_rate': 5.3072021831785704e-05, 'batch_size': 246, 'step_size': 13, 'gamma': 0.9282457027737632}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:08:26,012][0m Trial 6 finished with value: 0.328456269370185 and parameters: {'observation_period_num': 227, 'train_rates': 0.901202861111323, 'learning_rate': 1.4665270200852474e-05, 'batch_size': 120, 'step_size': 3, 'gamma': 0.8265498679415954}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:09:35,278][0m Trial 7 finished with value: 0.2454367197576106 and parameters: {'observation_period_num': 18, 'train_rates': 0.6732381614788853, 'learning_rate': 9.659145790767535e-06, 'batch_size': 67, 'step_size': 4, 'gamma': 0.8389043879163158}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:10:24,431][0m Trial 8 finished with value: 0.6025090444255883 and parameters: {'observation_period_num': 147, 'train_rates': 0.6708923632579635, 'learning_rate': 5.5744356590134765e-06, 'batch_size': 92, 'step_size': 4, 'gamma': 0.9020215263976992}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:10:50,986][0m Trial 9 finished with value: 0.19947471743915754 and parameters: {'observation_period_num': 95, 'train_rates': 0.6883217496512508, 'learning_rate': 0.00020294855900272984, 'batch_size': 182, 'step_size': 7, 'gamma': 0.899051476262537}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:11:14,618][0m Trial 10 finished with value: 0.15329159659160163 and parameters: {'observation_period_num': 163, 'train_rates': 0.8344218120850508, 'learning_rate': 0.000970462816288802, 'batch_size': 251, 'step_size': 8, 'gamma': 0.9823276212756455}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:11:50,692][0m Trial 11 finished with value: 0.6180453896522522 and parameters: {'observation_period_num': 54, 'train_rates': 0.969011740286398, 'learning_rate': 1.3686018054846454e-06, 'batch_size': 172, 'step_size': 10, 'gamma': 0.7507493818016439}. Best is trial 0 with value: 0.057150506710733906.[0m
Early stopping at epoch 41
[32m[I 2025-01-04 01:12:08,983][0m Trial 12 finished with value: 1.8637274884163064 and parameters: {'observation_period_num': 52, 'train_rates': 0.886565173303961, 'learning_rate': 2.194391858982586e-06, 'batch_size': 140, 'step_size': 1, 'gamma': 0.7792351661444858}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:12:38,411][0m Trial 13 finished with value: 0.08953836560249329 and parameters: {'observation_period_num': 33, 'train_rates': 0.9687347915016374, 'learning_rate': 2.46811100625212e-05, 'batch_size': 212, 'step_size': 10, 'gamma': 0.9578231281173563}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:13:01,697][0m Trial 14 finished with value: 0.24689128854645473 and parameters: {'observation_period_num': 82, 'train_rates': 0.7558906980328797, 'learning_rate': 0.0009168399539918103, 'batch_size': 218, 'step_size': 6, 'gamma': 0.970302114247884}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:13:26,671][0m Trial 15 finished with value: 0.12530748573315403 and parameters: {'observation_period_num': 180, 'train_rates': 0.8517636631992526, 'learning_rate': 3.0996418852275915e-05, 'batch_size': 219, 'step_size': 11, 'gamma': 0.9502077347715906}. Best is trial 0 with value: 0.057150506710733906.[0m
[32m[I 2025-01-04 01:13:57,527][0m Trial 16 finished with value: 0.055904364127619 and parameters: {'observation_period_num': 42, 'train_rates': 0.9178864831740543, 'learning_rate': 0.0001238401687350693, 'batch_size': 200, 'step_size': 9, 'gamma': 0.9355819043517902}. Best is trial 16 with value: 0.055904364127619.[0m
[32m[I 2025-01-04 01:14:38,796][0m Trial 17 finished with value: 0.08464222907599422 and parameters: {'observation_period_num': 128, 'train_rates': 0.9122111104639667, 'learning_rate': 0.0004864331511966648, 'batch_size': 143, 'step_size': 6, 'gamma': 0.9335910157434081}. Best is trial 16 with value: 0.055904364127619.[0m
[32m[I 2025-01-04 01:15:00,189][0m Trial 18 finished with value: 0.4481583090331194 and parameters: {'observation_period_num': 76, 'train_rates': 0.6024553119024249, 'learning_rate': 9.427437770056935e-05, 'batch_size': 235, 'step_size': 1, 'gamma': 0.9185592453761295}. Best is trial 16 with value: 0.055904364127619.[0m
[32m[I 2025-01-04 01:15:29,079][0m Trial 19 finished with value: 0.17416400979467048 and parameters: {'observation_period_num': 40, 'train_rates': 0.736196422850493, 'learning_rate': 0.0003848028349304506, 'batch_size': 190, 'step_size': 9, 'gamma': 0.8808510506722771}. Best is trial 16 with value: 0.055904364127619.[0m
[32m[I 2025-01-04 01:15:55,683][0m Trial 20 finished with value: 0.12443699540407485 and parameters: {'observation_period_num': 114, 'train_rates': 0.8148649242123861, 'learning_rate': 8.757635804490385e-05, 'batch_size': 226, 'step_size': 15, 'gamma': 0.939643187166987}. Best is trial 16 with value: 0.055904364127619.[0m
[32m[I 2025-01-04 01:16:32,714][0m Trial 21 finished with value: 0.10590778484653968 and parameters: {'observation_period_num': 196, 'train_rates': 0.9246181367269184, 'learning_rate': 0.0005905744075315125, 'batch_size': 151, 'step_size': 6, 'gamma': 0.9231764268652582}. Best is trial 16 with value: 0.055904364127619.[0m
[33m[W 2025-01-04 01:16:58,342][0m Trial 22 failed with parameters: {'observation_period_num': 137, 'train_rates': 0.875637874104127, 'learning_rate': 0.0004772907300431501, 'batch_size': 118, 'step_size': 5, 'gamma': 0.9883660129441213} because of the following error: KeyboardInterrupt().[0m
Traceback (most recent call last):
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna.py", line 550, in <lambda>
    study.optimize(lambda trial: objective(trial, component, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna.py", line 113, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 40, in train
    loss.backward()  # ÈÄÜ‰ºùÊí≠
    ^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
[33m[W 2025-01-04 01:16:58,350][0m Trial 22 failed with value None.[0m
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna.py", line 550, in <module>
    study.optimize(lambda trial: objective(trial, component, depth, dim), n_trials=50) #check
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna.py", line 550, in <lambda>
    study.optimize(lambda trial: objective(trial, component, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/roop_optuna.py", line 113, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 40, in train
    loss.backward()  # ÈÄÜ‰ºùÊí≠
    ^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
