[32m[I 2025-01-08 13:41:01,555][0m A new study created in memory with name: no-name-bf5b73fc-6f4a-4357-a78a-70c196ee0b0f[0m
[32m[I 2025-01-08 13:42:50,144][0m Trial 0 finished with value: 0.7426574237835712 and parameters: {'observation_period_num': 86, 'train_rates': 0.811065033969395, 'learning_rate': 0.0006994154597036475, 'batch_size': 74, 'step_size': 2, 'gamma': 0.9580007348560796}. Best is trial 0 with value: 0.7426574237835712.[0m
[32m[I 2025-01-08 13:45:47,589][0m Trial 1 finished with value: 0.9313486805240784 and parameters: {'observation_period_num': 137, 'train_rates': 0.7618605517347262, 'learning_rate': 0.0004181620148775004, 'batch_size': 55, 'step_size': 15, 'gamma': 0.9167668036848058}. Best is trial 0 with value: 0.7426574237835712.[0m
[32m[I 2025-01-08 13:46:49,876][0m Trial 2 finished with value: 0.8701685667037964 and parameters: {'observation_period_num': 44, 'train_rates': 0.9754536891299841, 'learning_rate': 1.8420097958583243e-06, 'batch_size': 122, 'step_size': 15, 'gamma': 0.7623604524941963}. Best is trial 0 with value: 0.7426574237835712.[0m
[32m[I 2025-01-08 13:52:15,612][0m Trial 3 finished with value: 0.17203453898599202 and parameters: {'observation_period_num': 196, 'train_rates': 0.9367992740839846, 'learning_rate': 0.0003126612199219204, 'batch_size': 21, 'step_size': 10, 'gamma': 0.7988490092293954}. Best is trial 3 with value: 0.17203453898599202.[0m
[32m[I 2025-01-08 13:52:57,893][0m Trial 4 finished with value: 0.6677193576964715 and parameters: {'observation_period_num': 37, 'train_rates': 0.7051651271730265, 'learning_rate': 0.00014581071692493371, 'batch_size': 216, 'step_size': 12, 'gamma': 0.778086505752203}. Best is trial 3 with value: 0.17203453898599202.[0m
[32m[I 2025-01-08 13:54:08,289][0m Trial 5 finished with value: 0.9776234197492095 and parameters: {'observation_period_num': 11, 'train_rates': 0.7253921877926479, 'learning_rate': 0.0004711962479261195, 'batch_size': 47, 'step_size': 9, 'gamma': 0.9388879363313503}. Best is trial 3 with value: 0.17203453898599202.[0m
Early stopping at epoch 88
[32m[I 2025-01-08 13:55:48,883][0m Trial 6 finished with value: 1.3577020005482 and parameters: {'observation_period_num': 107, 'train_rates': 0.6425610694767759, 'learning_rate': 4.247257224520947e-05, 'batch_size': 234, 'step_size': 2, 'gamma': 0.762861636300021}. Best is trial 3 with value: 0.17203453898599202.[0m
[32m[I 2025-01-08 13:58:47,722][0m Trial 7 finished with value: 2.3317246797653657 and parameters: {'observation_period_num': 29, 'train_rates': 0.7395289689660948, 'learning_rate': 0.0006498190151491595, 'batch_size': 18, 'step_size': 5, 'gamma': 0.9110617899916404}. Best is trial 3 with value: 0.17203453898599202.[0m
[32m[I 2025-01-08 14:00:52,752][0m Trial 8 finished with value: 1.5130349988806737 and parameters: {'observation_period_num': 109, 'train_rates': 0.7451304136319739, 'learning_rate': 1.013106898124702e-06, 'batch_size': 238, 'step_size': 10, 'gamma': 0.8608615269663054}. Best is trial 3 with value: 0.17203453898599202.[0m
[32m[I 2025-01-08 14:05:21,905][0m Trial 9 finished with value: 0.9980889601536481 and parameters: {'observation_period_num': 231, 'train_rates': 0.6340411373297411, 'learning_rate': 0.00040053586565464474, 'batch_size': 112, 'step_size': 6, 'gamma': 0.7606506863769662}. Best is trial 3 with value: 0.17203453898599202.[0m
[32m[I 2025-01-08 14:11:03,538][0m Trial 10 finished with value: 0.31296274065971375 and parameters: {'observation_period_num': 217, 'train_rates': 0.9745850610439184, 'learning_rate': 1.3265045716252857e-05, 'batch_size': 172, 'step_size': 12, 'gamma': 0.8274310212620773}. Best is trial 3 with value: 0.17203453898599202.[0m
[32m[I 2025-01-08 14:16:41,451][0m Trial 11 finished with value: 0.534982442855835 and parameters: {'observation_period_num': 215, 'train_rates': 0.987442974292118, 'learning_rate': 7.299688362866829e-06, 'batch_size': 181, 'step_size': 11, 'gamma': 0.843045572227496}. Best is trial 3 with value: 0.17203453898599202.[0m
[32m[I 2025-01-08 14:20:58,596][0m Trial 12 finished with value: 0.27178670066807953 and parameters: {'observation_period_num': 181, 'train_rates': 0.8999036390875306, 'learning_rate': 2.0412852565199588e-05, 'batch_size': 173, 'step_size': 13, 'gamma': 0.819146132258893}. Best is trial 3 with value: 0.17203453898599202.[0m
[32m[I 2025-01-08 14:24:35,243][0m Trial 13 finished with value: 0.2636334749705651 and parameters: {'observation_period_num': 159, 'train_rates': 0.8793022446250778, 'learning_rate': 6.719295256034923e-05, 'batch_size': 162, 'step_size': 7, 'gamma': 0.8125422673772297}. Best is trial 3 with value: 0.17203453898599202.[0m
[32m[I 2025-01-08 14:28:20,632][0m Trial 14 finished with value: 0.24776748745011054 and parameters: {'observation_period_num': 164, 'train_rates': 0.8760272379676599, 'learning_rate': 9.185250618744851e-05, 'batch_size': 100, 'step_size': 7, 'gamma': 0.8058076663202061}. Best is trial 3 with value: 0.17203453898599202.[0m
[32m[I 2025-01-08 14:32:41,142][0m Trial 15 finished with value: 0.23830065291886235 and parameters: {'observation_period_num': 183, 'train_rates': 0.8906570807719403, 'learning_rate': 0.00015798798199726058, 'batch_size': 93, 'step_size': 4, 'gamma': 0.8010620500650579}. Best is trial 3 with value: 0.17203453898599202.[0m
[32m[I 2025-01-08 14:39:30,892][0m Trial 16 finished with value: 0.12786248902667244 and parameters: {'observation_period_num': 252, 'train_rates': 0.9223138880063766, 'learning_rate': 0.00018476151803193072, 'batch_size': 24, 'step_size': 4, 'gamma': 0.8736456647866941}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 14:46:18,648][0m Trial 17 finished with value: 0.18274866608576587 and parameters: {'observation_period_num': 243, 'train_rates': 0.9351901606632631, 'learning_rate': 0.00025611993625954083, 'batch_size': 20, 'step_size': 4, 'gamma': 0.8858300369944918}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 14:52:21,471][0m Trial 18 finished with value: 0.4348988135226602 and parameters: {'observation_period_num': 250, 'train_rates': 0.830154180364204, 'learning_rate': 0.00019947658184499073, 'batch_size': 62, 'step_size': 1, 'gamma': 0.8815713145079069}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 14:57:45,078][0m Trial 19 finished with value: 2.124983005717321 and parameters: {'observation_period_num': 206, 'train_rates': 0.9289077628425405, 'learning_rate': 0.0009148932718932848, 'batch_size': 36, 'step_size': 9, 'gamma': 0.8572645907321083}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 15:02:05,140][0m Trial 20 finished with value: 0.4925823697534064 and parameters: {'observation_period_num': 190, 'train_rates': 0.8387724651971485, 'learning_rate': 7.913041599591133e-05, 'batch_size': 90, 'step_size': 8, 'gamma': 0.9815964288333581}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 15:09:05,790][0m Trial 21 finished with value: 0.13943953351541 and parameters: {'observation_period_num': 241, 'train_rates': 0.9399573828828992, 'learning_rate': 0.0002744787854246464, 'batch_size': 16, 'step_size': 4, 'gamma': 0.8900641346683144}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 15:15:59,602][0m Trial 22 finished with value: 0.23858377522563343 and parameters: {'observation_period_num': 252, 'train_rates': 0.9410016636487701, 'learning_rate': 0.00027352430142592586, 'batch_size': 33, 'step_size': 4, 'gamma': 0.9021627797298188}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 15:21:42,752][0m Trial 23 finished with value: 0.2390955255016104 and parameters: {'observation_period_num': 226, 'train_rates': 0.9159602505251543, 'learning_rate': 4.020902195179844e-05, 'batch_size': 75, 'step_size': 3, 'gamma': 0.8883032978186589}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 15:26:37,463][0m Trial 24 finished with value: 0.29739764487916565 and parameters: {'observation_period_num': 200, 'train_rates': 0.8512740724797234, 'learning_rate': 0.00010571634448954045, 'batch_size': 41, 'step_size': 6, 'gamma': 0.8396778688420053}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 15:33:14,434][0m Trial 25 finished with value: 0.1886066636443138 and parameters: {'observation_period_num': 230, 'train_rates': 0.9455471693794137, 'learning_rate': 0.000277074337273262, 'batch_size': 18, 'step_size': 1, 'gamma': 0.8681029715710489}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 15:36:55,567][0m Trial 26 finished with value: 0.3039692936799465 and parameters: {'observation_period_num': 164, 'train_rates': 0.8613515814645464, 'learning_rate': 0.00013085128551233025, 'batch_size': 146, 'step_size': 6, 'gamma': 0.9258757681783305}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 15:43:11,263][0m Trial 27 finished with value: 2.1182833520265727 and parameters: {'observation_period_num': 236, 'train_rates': 0.9622581457160058, 'learning_rate': 0.0009961387202557389, 'batch_size': 66, 'step_size': 8, 'gamma': 0.783835443113164}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 15:48:23,395][0m Trial 28 finished with value: 0.20942951476042584 and parameters: {'observation_period_num': 202, 'train_rates': 0.9069861470327056, 'learning_rate': 5.423903952913026e-05, 'batch_size': 37, 'step_size': 3, 'gamma': 0.8457485763497825}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 15:49:59,419][0m Trial 29 finished with value: 0.8298455317815144 and parameters: {'observation_period_num': 77, 'train_rates': 0.7928262486521692, 'learning_rate': 0.0005768621815786034, 'batch_size': 80, 'step_size': 10, 'gamma': 0.9529926544113403}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 15:53:14,238][0m Trial 30 finished with value: 0.5936932773685138 and parameters: {'observation_period_num': 146, 'train_rates': 0.7873081323269896, 'learning_rate': 2.6317964653437766e-05, 'batch_size': 54, 'step_size': 5, 'gamma': 0.8967282608500908}. Best is trial 16 with value: 0.12786248902667244.[0m
[32m[I 2025-01-08 16:00:32,238][0m Trial 31 finished with value: 0.12743068082661896 and parameters: {'observation_period_num': 252, 'train_rates': 0.9476973079641878, 'learning_rate': 0.0002145611618634665, 'batch_size': 17, 'step_size': 3, 'gamma': 0.8735995417492352}. Best is trial 31 with value: 0.12743068082661896.[0m
[32m[I 2025-01-08 16:06:36,532][0m Trial 32 finished with value: 0.20869511652451295 and parameters: {'observation_period_num': 221, 'train_rates': 0.962216895830123, 'learning_rate': 0.0003357989669780762, 'batch_size': 28, 'step_size': 2, 'gamma': 0.8715030746238317}. Best is trial 31 with value: 0.12743068082661896.[0m
[32m[I 2025-01-08 16:13:07,367][0m Trial 33 finished with value: 0.15357605706561694 and parameters: {'observation_period_num': 251, 'train_rates': 0.9151807302755112, 'learning_rate': 0.00018743807140227228, 'batch_size': 56, 'step_size': 3, 'gamma': 0.9208160743354504}. Best is trial 31 with value: 0.12743068082661896.[0m
[32m[I 2025-01-08 16:19:02,025][0m Trial 34 finished with value: 0.3393804873552759 and parameters: {'observation_period_num': 249, 'train_rates': 0.8155615045296896, 'learning_rate': 0.00018129681344740192, 'batch_size': 68, 'step_size': 3, 'gamma': 0.925523094004028}. Best is trial 31 with value: 0.12743068082661896.[0m
[32m[I 2025-01-08 16:25:09,915][0m Trial 35 finished with value: 0.1589434115176505 and parameters: {'observation_period_num': 237, 'train_rates': 0.9144114182160379, 'learning_rate': 0.00012537760492690555, 'batch_size': 50, 'step_size': 5, 'gamma': 0.9091592622394363}. Best is trial 31 with value: 0.12743068082661896.[0m
[32m[I 2025-01-08 16:30:41,204][0m Trial 36 finished with value: 0.3288796071065675 and parameters: {'observation_period_num': 211, 'train_rates': 0.9607365879891303, 'learning_rate': 0.0005098502243596918, 'batch_size': 48, 'step_size': 2, 'gamma': 0.9565631414825528}. Best is trial 31 with value: 0.12743068082661896.[0m
[32m[I 2025-01-08 16:36:11,441][0m Trial 37 finished with value: 0.9552636422812594 and parameters: {'observation_period_num': 236, 'train_rates': 0.6847082947651486, 'learning_rate': 4.906838581134663e-06, 'batch_size': 16, 'step_size': 3, 'gamma': 0.9366283880510501}. Best is trial 31 with value: 0.12743068082661896.[0m
[32m[I 2025-01-08 16:42:44,951][0m Trial 38 finished with value: 0.2598819682501595 and parameters: {'observation_period_num': 251, 'train_rates': 0.8710505145592055, 'learning_rate': 0.00020002604291431732, 'batch_size': 29, 'step_size': 1, 'gamma': 0.9771848399031162}. Best is trial 31 with value: 0.12743068082661896.[0m
[32m[I 2025-01-08 16:45:33,869][0m Trial 39 finished with value: 0.22918276488780975 and parameters: {'observation_period_num': 121, 'train_rates': 0.9822912915669118, 'learning_rate': 0.00039702319363157446, 'batch_size': 128, 'step_size': 4, 'gamma': 0.877475596507949}. Best is trial 31 with value: 0.12743068082661896.[0m
[33m[W 2025-01-08 16:45:57,284][0m Trial 40 failed with parameters: {'observation_period_num': 220, 'train_rates': 0.9206317560741324, 'learning_rate': 0.0007370707538120389, 'batch_size': 59, 'step_size': 2, 'gamma': 0.8964284919290805} because of the following error: KeyboardInterrupt().[0m
Traceback (most recent call last):
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/Transformer_nomstl.py", line 381, in <lambda>
    study.optimize(lambda trial: objective(trial, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/Transformer_nomstl.py", line 67, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 43, in train
    total_loss_train += loss.item() * data.size(0)
                        ^^^^^^^^^^^
KeyboardInterrupt
[33m[W 2025-01-08 16:45:57,289][0m Trial 40 failed with value None.[0m
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/Transformer_nomstl.py", line 381, in <module>
    study.optimize(lambda trial: objective(trial, depth, dim), n_trials=50) #check
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/Transformer_nomstl.py", line 381, in <lambda>
    study.optimize(lambda trial: objective(trial, depth, dim), n_trials=50) #check
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/Transformer_nomstl.py", line 67, in objective
    model, _, valid_loss = train(
                           ^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/train.py", line 43, in train
    total_loss_train += loss.item() * data.size(0)
                        ^^^^^^^^^^^
KeyboardInterrupt
