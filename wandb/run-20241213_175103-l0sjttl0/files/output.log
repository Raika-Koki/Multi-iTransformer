Non-A100 GPU detected, using math or mem efficient attention if input tensor is on cuda
/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/contextlib.py:105: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
Epoch 1/200, trend Loss: 0.7519 | 0.4485
Epoch 2/200, trend Loss: 0.3104 | 0.4126
Epoch 3/200, trend Loss: 0.5091 | 0.7115
Epoch 4/200, trend Loss: 0.3296 | 0.2973
Epoch 5/200, trend Loss: 0.2323 | 0.3344
Epoch 6/200, trend Loss: 0.2335 | 0.2315
Epoch 7/200, trend Loss: 0.1773 | 0.3858
Epoch 8/200, trend Loss: 0.1561 | 0.2154
Epoch 9/200, trend Loss: 0.1230 | 0.2106
Epoch 10/200, trend Loss: 0.1179 | 0.1853
Epoch 11/200, trend Loss: 0.1103 | 0.1687
Epoch 12/200, trend Loss: 0.1057 | 0.1622
Epoch 13/200, trend Loss: 0.1018 | 0.1540
Epoch 14/200, trend Loss: 0.0992 | 0.1477
Epoch 15/200, trend Loss: 0.0966 | 0.1437
Epoch 16/200, trend Loss: 0.0948 | 0.1401
Epoch 17/200, trend Loss: 0.0934 | 0.1368
Epoch 18/200, trend Loss: 0.0920 | 0.1346
Epoch 19/200, trend Loss: 0.0910 | 0.1328
Epoch 20/200, trend Loss: 0.0902 | 0.1310
Epoch 21/200, trend Loss: 0.0895 | 0.1296
Epoch 22/200, trend Loss: 0.0889 | 0.1286
Epoch 23/200, trend Loss: 0.0884 | 0.1276
Epoch 24/200, trend Loss: 0.0880 | 0.1268
Epoch 25/200, trend Loss: 0.0877 | 0.1262
Epoch 26/200, trend Loss: 0.0874 | 0.1256
Epoch 27/200, trend Loss: 0.0871 | 0.1252
Epoch 28/200, trend Loss: 0.0869 | 0.1248
Epoch 29/200, trend Loss: 0.0868 | 0.1245
Epoch 30/200, trend Loss: 0.0866 | 0.1242
Epoch 31/200, trend Loss: 0.0865 | 0.1240
Epoch 32/200, trend Loss: 0.0864 | 0.1238
Epoch 33/200, trend Loss: 0.0863 | 0.1236
Epoch 34/200, trend Loss: 0.0862 | 0.1235
Epoch 35/200, trend Loss: 0.0862 | 0.1234
Epoch 36/200, trend Loss: 0.0861 | 0.1233
Epoch 37/200, trend Loss: 0.0861 | 0.1232
Epoch 38/200, trend Loss: 0.0860 | 0.1231
Epoch 39/200, trend Loss: 0.0860 | 0.1230
Epoch 40/200, trend Loss: 0.0860 | 0.1230
Epoch 41/200, trend Loss: 0.0859 | 0.1229
Epoch 42/200, trend Loss: 0.0859 | 0.1229
Epoch 43/200, trend Loss: 0.0859 | 0.1229
Epoch 44/200, trend Loss: 0.0859 | 0.1229
Epoch 45/200, trend Loss: 0.0859 | 0.1228
Epoch 46/200, trend Loss: 0.0859 | 0.1228
Epoch 47/200, trend Loss: 0.0859 | 0.1228
Epoch 48/200, trend Loss: 0.0859 | 0.1228
Epoch 49/200, trend Loss: 0.0859 | 0.1228
Epoch 50/200, trend Loss: 0.0859 | 0.1228
Epoch 51/200, trend Loss: 0.0858 | 0.1228
Epoch 52/200, trend Loss: 0.0858 | 0.1228
Epoch 53/200, trend Loss: 0.0858 | 0.1227
Epoch 54/200, trend Loss: 0.0858 | 0.1227
Epoch 55/200, trend Loss: 0.0858 | 0.1227
Epoch 56/200, trend Loss: 0.0858 | 0.1227
Epoch 57/200, trend Loss: 0.0858 | 0.1227
Epoch 58/200, trend Loss: 0.0858 | 0.1227
Epoch 59/200, trend Loss: 0.0858 | 0.1227
Epoch 60/200, trend Loss: 0.0858 | 0.1227
Epoch 61/200, trend Loss: 0.0858 | 0.1227
Epoch 62/200, trend Loss: 0.0858 | 0.1227
Epoch 63/200, trend Loss: 0.0858 | 0.1227
Epoch 64/200, trend Loss: 0.0858 | 0.1227
Epoch 65/200, trend Loss: 0.0858 | 0.1227
Epoch 66/200, trend Loss: 0.0858 | 0.1227
Epoch 67/200, trend Loss: 0.0858 | 0.1227
Epoch 68/200, trend Loss: 0.0858 | 0.1227
Epoch 69/200, trend Loss: 0.0858 | 0.1227
Epoch 70/200, trend Loss: 0.0858 | 0.1227
Epoch 71/200, trend Loss: 0.0858 | 0.1227
Epoch 72/200, trend Loss: 0.0858 | 0.1227
Epoch 73/200, trend Loss: 0.0858 | 0.1227
Epoch 74/200, trend Loss: 0.0858 | 0.1227
Epoch 75/200, trend Loss: 0.0858 | 0.1227
Epoch 76/200, trend Loss: 0.0858 | 0.1227
Epoch 77/200, trend Loss: 0.0858 | 0.1227
Epoch 78/200, trend Loss: 0.0858 | 0.1227
Epoch 79/200, trend Loss: 0.0858 | 0.1227
Early stopping for trend
Traceback (most recent call last):
  File "/data/student/k2110261/Multi-iTransformer/main.py", line 1036, in <module>
    train_data, valid_data = create_multivariate_dataset(
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/student/k2110261/Multi-iTransformer/src/data_create.py", line 31, in create_multivariate_dataset
    label = data_norm.iloc[i + observation_period_num:i + observation_period_num + predict_period_num].values
            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/pandas/core/indexing.py", line 1729, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/pandas/core/indexing.py", line 1763, in _get_slice_axis
    labels = obj._get_axis(axis)
             ^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/pandas/core/generic.py", line 588, in _get_axis
    axis_number = self._get_axis_number(axis)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home2/y2021/k2110261/.conda/envs/tensorflow/lib/python3.11/site-packages/pandas/core/generic.py", line 572, in _get_axis_number
    @final

KeyboardInterrupt
