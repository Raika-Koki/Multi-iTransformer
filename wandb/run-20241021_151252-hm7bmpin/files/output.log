[*********************100%%**********************]  1 of 1 completed
Date
2012-05-18     18.373452
2012-05-21     18.357676
2012-05-22     18.341911
2012-05-23     18.326156
2012-05-24     18.310413
                 ...
2023-05-24    161.422808
2023-05-25    161.480443
2023-05-26    161.538074
2023-05-30    161.595701
2023-05-31    161.653324
Name: trend, Length: 2776, dtype: float64
Date
2012-05-18    -2.037156
2012-05-21    -1.339882
2012-05-22    -1.369429
2012-05-23    -1.131668
2012-05-24    -1.129781
                ...
2023-05-24    -6.710206
2023-05-25   -10.178072
2023-05-26   -10.052300
2023-05-30    -6.308044
2023-05-31    -3.033519
Name: season, Length: 2776, dtype: float64
Date
2012-05-18    -0.340123
2012-05-21    -0.089684
2012-05-22    -0.174359
2012-05-23     0.013508
2012-05-24    -0.130678
                ...
2023-05-24    16.021986
2023-05-25    20.574842
2023-05-26    22.815740
2023-05-30    20.871813
2023-05-31    17.489998
Name: resid, Length: 2776, dtype: float64
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
Dataset created successfully.
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Epoch 1/100, (Training, Validation) Trend Loss: 0.052491, 0.510050| Seasonal Loss: 0.2282, 1.3502| Residual Loss: 0.3873, 1.3660
Epoch 2/100, (Training, Validation) Trend Loss: 0.064275, 0.158057| Seasonal Loss: 0.2155, 1.6394| Residual Loss: 0.2114, 0.8474
Epoch 3/100, (Training, Validation) Trend Loss: 0.036163, 0.096047| Seasonal Loss: 0.1920, 1.7021| Residual Loss: 0.1573, 0.6976
Epoch 4/100, (Training, Validation) Trend Loss: 0.022354, 0.069494| Seasonal Loss: 0.3151, 0.9934| Residual Loss: 0.1382, 0.6153
Epoch 5/100, (Training, Validation) Trend Loss: 0.018831, 0.057780| Seasonal Loss: 0.4096, 0.8095| Residual Loss: 0.1234, 0.5591
Epoch 6/100, (Training, Validation) Trend Loss: 0.026561, 0.046397| Seasonal Loss: 0.2058, 0.8331| Residual Loss: 0.1108, 0.5167
Epoch 7/100, (Training, Validation) Trend Loss: 0.039151, 0.062373| Seasonal Loss: 0.1834, 0.7631| Residual Loss: 0.1001, 0.4833
Epoch 8/100, (Training, Validation) Trend Loss: 0.027931, 0.057986| Seasonal Loss: 0.1605, 0.9810| Residual Loss: 0.0911, 0.4561
Epoch 9/100, (Training, Validation) Trend Loss: 0.031178, 0.230079| Seasonal Loss: 0.1679, 0.9401| Residual Loss: 0.0836, 0.4335
Epoch 10/100, (Training, Validation) Trend Loss: 0.042818, 0.418719| Seasonal Loss: 0.1600, 1.0637| Residual Loss: 0.0775, 0.4145
Epoch 11/100, (Training, Validation) Trend Loss: 0.063119, 0.821301| Seasonal Loss: 0.1595, 1.0916| Residual Loss: 0.0725, 0.3987
Epoch 12/100, (Training, Validation) Trend Loss: 0.040108, 0.260649| Seasonal Loss: 0.1324, 1.2115| Residual Loss: 0.0685, 0.3853
Epoch 13/100, (Training, Validation) Trend Loss: 0.030520, 0.075643| Seasonal Loss: 0.1178, 1.2363| Residual Loss: 0.0652, 0.3741
Epoch 14/100, (Training, Validation) Trend Loss: 0.032921, 0.486792| Seasonal Loss: 0.1055, 1.2537| Residual Loss: 0.0625, 0.3646
Epoch 15/100, (Training, Validation) Trend Loss: 0.040528, 0.212453| Seasonal Loss: 0.0910, 1.2867| Residual Loss: 0.0603, 0.3566
Epoch 16/100, (Training, Validation) Trend Loss: 0.055858, 0.452759| Seasonal Loss: 0.0802, 1.3394| Residual Loss: 0.0584, 0.3497
Epoch 17/100, (Training, Validation) Trend Loss: 0.021951, 0.106470| Seasonal Loss: 0.0741, 1.3804| Residual Loss: 0.0567, 0.3437
Epoch 18/100, (Training, Validation) Trend Loss: 0.038302, 0.084904| Seasonal Loss: 0.0689, 1.4053| Residual Loss: 0.0553, 0.3385
Epoch 19/100, (Training, Validation) Trend Loss: 0.022983, 0.077968| Seasonal Loss: 0.0632, 1.4086| Residual Loss: 0.0541, 0.3339
Epoch 20/100, (Training, Validation) Trend Loss: 0.009821, 0.047204| Seasonal Loss: 0.0570, 1.3747| Residual Loss: 0.0529, 0.3299
Epoch 21/100, (Training, Validation) Trend Loss: 0.019741, 0.049406| Seasonal Loss: 0.0520, 1.2929| Residual Loss: 0.0519, 0.3262
Epoch 22/100, (Training, Validation) Trend Loss: 0.011229, 0.037696| Seasonal Loss: 0.0495, 1.2127| Residual Loss: 0.0510, 0.3230
Epoch 23/100, (Training, Validation) Trend Loss: 0.012055, 0.038126| Seasonal Loss: 0.0510, 1.2128| Residual Loss: 0.0502, 0.3200
Epoch 24/100, (Training, Validation) Trend Loss: 0.007405, 0.030909| Seasonal Loss: 0.0506, 1.2857| Residual Loss: 0.0494, 0.3173
Epoch 25/100, (Training, Validation) Trend Loss: 0.007998, 0.029167| Seasonal Loss: 0.0473, 1.2851| Residual Loss: 0.0487, 0.3148
Epoch 26/100, (Training, Validation) Trend Loss: 0.005455, 0.024849| Seasonal Loss: 0.0426, 1.2599| Residual Loss: 0.0480, 0.3124
Epoch 27/100, (Training, Validation) Trend Loss: 0.005341, 0.022360| Seasonal Loss: 0.0410, 1.2085| Residual Loss: 0.0474, 0.3103
Epoch 28/100, (Training, Validation) Trend Loss: 0.004102, 0.019570| Seasonal Loss: 0.0392, 1.1735| Residual Loss: 0.0469, 0.3083
Epoch 29/100, (Training, Validation) Trend Loss: 0.003770, 0.017241| Seasonal Loss: 0.0404, 1.1291| Residual Loss: 0.0463, 0.3065
Epoch 30/100, (Training, Validation) Trend Loss: 0.003188, 0.015280| Seasonal Loss: 0.0415, 1.1694| Residual Loss: 0.0458, 0.3048
Epoch 31/100, (Training, Validation) Trend Loss: 0.002831, 0.013656| Seasonal Loss: 0.0416, 1.2180| Residual Loss: 0.0454, 0.3032
Epoch 32/100, (Training, Validation) Trend Loss: 0.002536, 0.012391| Seasonal Loss: 0.0362, 1.2248| Residual Loss: 0.0449, 0.3017
Epoch 33/100, (Training, Validation) Trend Loss: 0.002282, 0.011450| Seasonal Loss: 0.0349, 1.2027| Residual Loss: 0.0445, 0.3003
Epoch 34/100, (Training, Validation) Trend Loss: 0.002087, 0.010774| Seasonal Loss: 0.0341, 1.1504| Residual Loss: 0.0442, 0.2989
Epoch 35/100, (Training, Validation) Trend Loss: 0.001935, 0.010293| Seasonal Loss: 0.0351, 1.1001| Residual Loss: 0.0438, 0.2977
Epoch 36/100, (Training, Validation) Trend Loss: 0.001806, 0.009946| Seasonal Loss: 0.0501, 1.0646| Residual Loss: 0.0435, 0.2965
Epoch 37/100, (Training, Validation) Trend Loss: 0.001698, 0.009695| Seasonal Loss: 0.0399, 1.1979| Residual Loss: 0.0432, 0.2954
Epoch 38/100, (Training, Validation) Trend Loss: 0.001612, 0.009512| Seasonal Loss: 0.0343, 1.1447| Residual Loss: 0.0429, 0.2943
Epoch 39/100, (Training, Validation) Trend Loss: 0.001539, 0.009374| Seasonal Loss: 0.0287, 1.0464| Residual Loss: 0.0426, 0.2934
Epoch 40/100, (Training, Validation) Trend Loss: 0.001477, 0.009268| Seasonal Loss: 0.0298, 1.0873| Residual Loss: 0.0423, 0.2924
Epoch 41/100, (Training, Validation) Trend Loss: 0.001427, 0.009186| Seasonal Loss: 0.0279, 1.1388| Residual Loss: 0.0421, 0.2915
Epoch 42/100, (Training, Validation) Trend Loss: 0.001385, 0.009119| Seasonal Loss: 0.0269, 1.1112| Residual Loss: 0.0419, 0.2907
Epoch 43/100, (Training, Validation) Trend Loss: 0.001350, 0.009066| Seasonal Loss: 0.0278, 1.0527| Residual Loss: 0.0416, 0.2899
Epoch 44/100, (Training, Validation) Trend Loss: 0.001319, 0.009024| Seasonal Loss: 0.0251, 1.1092| Residual Loss: 0.0414, 0.2892
Epoch 45/100, (Training, Validation) Trend Loss: 0.001291, 0.008991| Seasonal Loss: 0.0245, 1.1129| Residual Loss: 0.0412, 0.2884
Epoch 46/100, (Training, Validation) Trend Loss: 0.001266, 0.008963| Seasonal Loss: 0.0226, 1.0588| Residual Loss: 0.0410, 0.2878
Epoch 47/100, (Training, Validation) Trend Loss: 0.001243, 0.008943| Seasonal Loss: 0.0218, 1.0821| Residual Loss: 0.0409, 0.2871
Epoch 48/100, (Training, Validation) Trend Loss: 0.001222, 0.008927| Seasonal Loss: 0.0216, 1.1056| Residual Loss: 0.0407, 0.2865
Epoch 49/100, (Training, Validation) Trend Loss: 0.001202, 0.008914| Seasonal Loss: 0.0205, 1.0807| Residual Loss: 0.0405, 0.2859
Epoch 50/100, (Training, Validation) Trend Loss: 0.001184, 0.008905| Seasonal Loss: 0.0202, 1.0619| Residual Loss: 0.0404, 0.2854
Epoch 51/100, (Training, Validation) Trend Loss: 0.001167, 0.008898| Seasonal Loss: 0.0198, 1.0913| Residual Loss: 0.0402, 0.2849
Epoch 52/100, (Training, Validation) Trend Loss: 0.001151, 0.008894| Seasonal Loss: 0.0200, 1.0988| Residual Loss: 0.0401, 0.2844
Epoch 53/100, (Training, Validation) Trend Loss: 0.001137, 0.008891| Seasonal Loss: 0.0188, 1.0633| Residual Loss: 0.0400, 0.2839
Epoch 54/100, (Training, Validation) Trend Loss: 0.001123, 0.008889| Seasonal Loss: 0.0183, 1.0682| Residual Loss: 0.0398, 0.2835
Epoch 55/100, (Training, Validation) Trend Loss: 0.001110, 0.008888| Seasonal Loss: 0.0183, 1.0919| Residual Loss: 0.0397, 0.2830
Epoch 56/100, (Training, Validation) Trend Loss: 0.001098, 0.008888| Seasonal Loss: 0.0180, 1.0816| Residual Loss: 0.0396, 0.2826
Epoch 57/100, (Training, Validation) Trend Loss: 0.001087, 0.008889| Seasonal Loss: 0.0176, 1.0563| Residual Loss: 0.0395, 0.2822
Epoch 58/100, (Training, Validation) Trend Loss: 0.001077, 0.008890| Seasonal Loss: 0.0170, 1.0747| Residual Loss: 0.0394, 0.2819
Epoch 59/100, (Training, Validation) Trend Loss: 0.001067, 0.008891| Seasonal Loss: 0.0173, 1.0871| Residual Loss: 0.0393, 0.2815
Epoch 60/100, (Training, Validation) Trend Loss: 0.001058, 0.008893| Seasonal Loss: 0.0165, 1.0609| Residual Loss: 0.0392, 0.2812
Epoch 61/100, (Training, Validation) Trend Loss: 0.001050, 0.008894| Seasonal Loss: 0.0160, 1.0601| Residual Loss: 0.0391, 0.2809
Epoch 62/100, (Training, Validation) Trend Loss: 0.001042, 0.008896| Seasonal Loss: 0.0161, 1.0780| Residual Loss: 0.0391, 0.2806
Epoch 63/100, (Training, Validation) Trend Loss: 0.001035, 0.008898| Seasonal Loss: 0.0157, 1.0682| Residual Loss: 0.0390, 0.2803
Epoch 64/100, (Training, Validation) Trend Loss: 0.001028, 0.008900| Seasonal Loss: 0.0154, 1.0546| Residual Loss: 0.0389, 0.2800
Epoch 65/100, (Training, Validation) Trend Loss: 0.001021, 0.008902| Seasonal Loss: 0.0152, 1.0672| Residual Loss: 0.0388, 0.2797
Epoch 66/100, (Training, Validation) Trend Loss: 0.001015, 0.008903| Seasonal Loss: 0.0152, 1.0688| Residual Loss: 0.0388, 0.2795
Epoch 67/100, (Training, Validation) Trend Loss: 0.001009, 0.008904| Seasonal Loss: 0.0148, 1.0545| Residual Loss: 0.0387, 0.2792
Epoch 68/100, (Training, Validation) Trend Loss: 0.001003, 0.008906| Seasonal Loss: 0.0145, 1.0597| Residual Loss: 0.0386, 0.2790
Epoch 69/100, (Training, Validation) Trend Loss: 0.000998, 0.008907| Seasonal Loss: 0.0145, 1.0643| Residual Loss: 0.0386, 0.2788
Epoch 70/100, (Training, Validation) Trend Loss: 0.000993, 0.008908| Seasonal Loss: 0.0143, 1.0547| Residual Loss: 0.0385, 0.2786
Epoch 71/100, (Training, Validation) Trend Loss: 0.000988, 0.008909| Seasonal Loss: 0.0140, 1.0554| Residual Loss: 0.0385, 0.2784
Epoch 72/100, (Training, Validation) Trend Loss: 0.000984, 0.008909| Seasonal Loss: 0.0140, 1.0589| Residual Loss: 0.0384, 0.2782
Epoch 73/100, (Training, Validation) Trend Loss: 0.000980, 0.008910| Seasonal Loss: 0.0138, 1.0533| Residual Loss: 0.0384, 0.2780
Epoch 74/100, (Training, Validation) Trend Loss: 0.000976, 0.008911| Seasonal Loss: 0.0137, 1.0527| Residual Loss: 0.0383, 0.2779
Epoch 75/100, (Training, Validation) Trend Loss: 0.000972, 0.008911| Seasonal Loss: 0.0136, 1.0541| Residual Loss: 0.0383, 0.2777
Epoch 76/100, (Training, Validation) Trend Loss: 0.000968, 0.008911| Seasonal Loss: 0.0135, 1.0507| Residual Loss: 0.0382, 0.2776
Epoch 77/100, (Training, Validation) Trend Loss: 0.000965, 0.008911| Seasonal Loss: 0.0134, 1.0501| Residual Loss: 0.0382, 0.2774
Epoch 78/100, (Training, Validation) Trend Loss: 0.000961, 0.008911| Seasonal Loss: 0.0133, 1.0499| Residual Loss: 0.0382, 0.2773
Epoch 79/100, (Training, Validation) Trend Loss: 0.000958, 0.008910| Seasonal Loss: 0.0132, 1.0479| Residual Loss: 0.0381, 0.2771
Epoch 80/100, (Training, Validation) Trend Loss: 0.000955, 0.008910| Seasonal Loss: 0.0131, 1.0473| Residual Loss: 0.0381, 0.2770
Epoch 81/100, (Training, Validation) Trend Loss: 0.000952, 0.008909| Seasonal Loss: 0.0130, 1.0464| Residual Loss: 0.0381, 0.2769
Epoch 82/100, (Training, Validation) Trend Loss: 0.000949, 0.008909| Seasonal Loss: 0.0129, 1.0451| Residual Loss: 0.0380, 0.2768
Epoch 83/100, (Training, Validation) Trend Loss: 0.000947, 0.008908| Seasonal Loss: 0.0128, 1.0443| Residual Loss: 0.0380, 0.2767
Epoch 84/100, (Training, Validation) Trend Loss: 0.000944, 0.008907| Seasonal Loss: 0.0128, 1.0432| Residual Loss: 0.0380, 0.2766
Epoch 85/100, (Training, Validation) Trend Loss: 0.000942, 0.008906| Seasonal Loss: 0.0127, 1.0423| Residual Loss: 0.0380, 0.2765
Epoch 86/100, (Training, Validation) Trend Loss: 0.000940, 0.008905| Seasonal Loss: 0.0126, 1.0414| Residual Loss: 0.0379, 0.2764
Epoch 87/100, (Training, Validation) Trend Loss: 0.000937, 0.008904| Seasonal Loss: 0.0125, 1.0404| Residual Loss: 0.0379, 0.2763
Epoch 88/100, (Training, Validation) Trend Loss: 0.000935, 0.008903| Seasonal Loss: 0.0125, 1.0395| Residual Loss: 0.0379, 0.2762
Epoch 89/100, (Training, Validation) Trend Loss: 0.000933, 0.008902| Seasonal Loss: 0.0124, 1.0386| Residual Loss: 0.0379, 0.2761
Epoch 90/100, (Training, Validation) Trend Loss: 0.000931, 0.008901| Seasonal Loss: 0.0124, 1.0378| Residual Loss: 0.0378, 0.2761
Epoch 91/100, (Training, Validation) Trend Loss: 0.000929, 0.008900| Seasonal Loss: 0.0123, 1.0369| Residual Loss: 0.0378, 0.2760
Epoch 92/100, (Training, Validation) Trend Loss: 0.000928, 0.008898| Seasonal Loss: 0.0123, 1.0361| Residual Loss: 0.0378, 0.2759
Epoch 93/100, (Training, Validation) Trend Loss: 0.000926, 0.008897| Seasonal Loss: 0.0122, 1.0353| Residual Loss: 0.0378, 0.2758
Epoch 94/100, (Training, Validation) Trend Loss: 0.000924, 0.008896| Seasonal Loss: 0.0122, 1.0345| Residual Loss: 0.0378, 0.2758
Epoch 95/100, (Training, Validation) Trend Loss: 0.000923, 0.008894| Seasonal Loss: 0.0121, 1.0338| Residual Loss: 0.0378, 0.2757
Epoch 96/100, (Training, Validation) Trend Loss: 0.000921, 0.008893| Seasonal Loss: 0.0121, 1.0330| Residual Loss: 0.0377, 0.2757
Epoch 97/100, (Training, Validation) Trend Loss: 0.000920, 0.008892| Seasonal Loss: 0.0120, 1.0323| Residual Loss: 0.0377, 0.2756
Epoch 98/100, (Training, Validation) Trend Loss: 0.000918, 0.008890| Seasonal Loss: 0.0120, 1.0316| Residual Loss: 0.0377, 0.2756
Epoch 99/100, (Training, Validation) Trend Loss: 0.000917, 0.008889| Seasonal Loss: 0.0120, 1.0310| Residual Loss: 0.0377, 0.2755
Epoch 100/100, (Training, Validation) Trend Loss: 0.000916, 0.008887| Seasonal Loss: 0.0119, 1.0303| Residual Loss: 0.0377, 0.2755
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:258: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_trend_aapl = predicted_trend[1][0, :, 0].cpu().numpy().flatten() * std_list_trend[0] + mean_list_trend[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:259: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_seasonal_aapl = predicted_seasonal[1][0, :, 0].cpu().numpy().flatten() * std_list_seasonal[0] + mean_list_seasonal[0]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:260: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  predicted_resid_aapl = predicted_resid[1][0, :, 0].cpu().numpy().flatten() * std_list_resid[0] + mean_list_resid[0]
[160.07048169]
[-6.09566096]
[16.99009576]
[170.96491648]
actual_stock_price: [171.57914734 173.92393494 174.0332489  173.079422   170.45639038
 170.73458862 171.87721252 174.30151367 176.1594696  176.10980225]
add_predicted_stock_price: [171.57914734 173.92393494 174.0332489  173.079422   170.45639038
 170.73458862 171.87721252 174.30151367 176.1594696  170.96491648]
/mnt/c/Users/RAIKA KOKI/B4研究/Multi_iTransformer/STLdemo.py:306: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
