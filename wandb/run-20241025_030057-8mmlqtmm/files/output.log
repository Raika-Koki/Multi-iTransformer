[*********************100%%**********************]  1 of 1 completed
Date
2012-05-18     18.373452
2012-05-21     18.357676
2012-05-22     18.341910
2012-05-23     18.326156
2012-05-24     18.310412
                 ...
2023-05-24    161.422833
2023-05-25    161.480468
2023-05-26    161.538099
2023-05-30    161.595726
2023-05-31    161.653350
Name: trend, Length: 2776, dtype: float64
Date
2012-05-18    -2.037155
2012-05-21    -1.339882
2012-05-22    -1.369428
2012-05-23    -1.131663
2012-05-24    -1.129781
                ...
2023-05-24    -6.710192
2023-05-25   -10.178073
2023-05-26   -10.052285
2023-05-30    -6.308026
2023-05-31    -3.033491
Name: season, Length: 2776, dtype: float64
Date
2012-05-18    -0.340124
2012-05-21    -0.089686
2012-05-22    -0.174360
2012-05-23     0.013507
2012-05-24    -0.130676
                ...
2023-05-24    16.021962
2023-05-25    20.574817
2023-05-26    22.815685
2023-05-30    20.871769
2023-05-31    17.489959
Name: resid, Length: 2776, dtype: float64
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[*********************100%%**********************]  1 of 1 completed
[32m[I 2024-10-25 03:01:02,171][0m A new study created in memory with name: no-name-e354f897-2514-4571-8f1d-1a72f5cf6d46[0m
study_trend: <optuna.study.study.Study object at 0x7fc86f8800a0>
/mnt/c/Users/RAIKA KOKI/B4ç ”ç©¶/Multi_iTransformer/STLdemo.py:160: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  learning_rate = trial.suggest_loguniform('learning_rate', 1e-6, 1e-3)
/home/raikakoki/.local/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
[33m[W 2024-10-25 03:01:04,844][0m Trial 0 failed with parameters: {'learning_rate': 0.00011264022483285931, 'batch_size': 45, 'step_size': 1, 'gamma': 0.9637546771656976, 'depth': 6, 'dim': 112} because of the following error: NameError("name 'train_loss_seasonal' is not defined").[0m
Traceback (most recent call last):
  File "/home/raikakoki/.local/lib/python3.10/site-packages/optuna/study/_optimize.py", line 196, in _run_trial
    value_or_values = func(trial)
  File "/mnt/c/Users/RAIKA KOKI/B4ç ”ç©¶/Multi_iTransformer/STLdemo.py", line 197, in <lambda>
    study_trend.optimize(lambda trial: objective(trial, "trend"), n_trials=200)
  File "/mnt/c/Users/RAIKA KOKI/B4ç ”ç©¶/Multi_iTransformer/STLdemo.py", line 190, in objective
    print(f"(Training, Validation){train_loss:.6f}, {valid_loss:.6f}| Seasonal Loss: {train_loss_seasonal:.4f}, {valid_loss_seasonal:.4f}| Residual Loss: {train_loss_resid:.4f}, {valid_loss_resid:.4f}")
NameError: name 'train_loss_seasonal' is not defined
[33m[W 2024-10-25 03:01:04,846][0m Trial 0 failed with value None.[0m
Traceback (most recent call last):
  File "/mnt/c/Users/RAIKA KOKI/B4ç ”ç©¶/Multi_iTransformer/STLdemo.py", line 197, in <module>
    study_trend.optimize(lambda trial: objective(trial, "trend"), n_trials=200)
  File "/home/raikakoki/.local/lib/python3.10/site-packages/optuna/study/study.py", line 451, in optimize
    _optimize(
  File "/home/raikakoki/.local/lib/python3.10/site-packages/optuna/study/_optimize.py", line 62, in _optimize
    _optimize_sequential(
  File "/home/raikakoki/.local/lib/python3.10/site-packages/optuna/study/_optimize.py", line 159, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/home/raikakoki/.local/lib/python3.10/site-packages/optuna/study/_optimize.py", line 247, in _run_trial
    raise func_err
  File "/home/raikakoki/.local/lib/python3.10/site-packages/optuna/study/_optimize.py", line 196, in _run_trial
    value_or_values = func(trial)
  File "/mnt/c/Users/RAIKA KOKI/B4ç ”ç©¶/Multi_iTransformer/STLdemo.py", line 197, in <lambda>
    study_trend.optimize(lambda trial: objective(trial, "trend"), n_trials=200)
  File "/mnt/c/Users/RAIKA KOKI/B4ç ”ç©¶/Multi_iTransformer/STLdemo.py", line 190, in objective
    print(f"(Training, Validation){train_loss:.6f}, {valid_loss:.6f}| Seasonal Loss: {train_loss_seasonal:.4f}, {valid_loss_seasonal:.4f}| Residual Loss: {train_loss_resid:.4f}, {valid_loss_resid:.4f}")
NameError: name 'train_loss_seasonal' is not defined
Traceback (most recent call last):
  File "/mnt/c/Users/RAIKA KOKI/B4ç ”ç©¶/Multi_iTransformer/STLdemo.py", line 197, in <module>
    study_trend.optimize(lambda trial: objective(trial, "trend"), n_trials=200)
  File "/home/raikakoki/.local/lib/python3.10/site-packages/optuna/study/study.py", line 451, in optimize
    _optimize(
  File "/home/raikakoki/.local/lib/python3.10/site-packages/optuna/study/_optimize.py", line 62, in _optimize
    _optimize_sequential(
  File "/home/raikakoki/.local/lib/python3.10/site-packages/optuna/study/_optimize.py", line 159, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/home/raikakoki/.local/lib/python3.10/site-packages/optuna/study/_optimize.py", line 247, in _run_trial
    raise func_err
  File "/home/raikakoki/.local/lib/python3.10/site-packages/optuna/study/_optimize.py", line 196, in _run_trial
    value_or_values = func(trial)
  File "/mnt/c/Users/RAIKA KOKI/B4ç ”ç©¶/Multi_iTransformer/STLdemo.py", line 197, in <lambda>
    study_trend.optimize(lambda trial: objective(trial, "trend"), n_trials=200)
  File "/mnt/c/Users/RAIKA KOKI/B4ç ”ç©¶/Multi_iTransformer/STLdemo.py", line 190, in objective
    print(f"(Training, Validation){train_loss:.6f}, {valid_loss:.6f}| Seasonal Loss: {train_loss_seasonal:.4f}, {valid_loss_seasonal:.4f}| Residual Loss: {train_loss_resid:.4f}, {valid_loss_resid:.4f}")
NameError: name 'train_loss_seasonal' is not defined. Did you mean: 'mean_list_seasonal'?
